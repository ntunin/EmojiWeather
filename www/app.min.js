/*
 * Anime v1.0.0
 * http://anime-js.com
 * JavaScript animation engine
 * Copyright (c) 2016 Julian Garnier
 * http://juliangarnier.com
 * Released under the MIT license
 */

(function (root, factory) {
  if (typeof define === 'function' && define.amd) {
    // AMD. Register as an anonymous module.
    define([], factory);
  } else if (typeof module === 'object' && module.exports) {
    // Node. Does not work with strict CommonJS, but
    // only CommonJS-like environments that support module.exports,
    // like Node.
    module.exports = factory();
  } else {
    // Browser globals (root is window)
    root.anime = factory();
  }
}(this, function () {
  // Defaults

  var defaultSettings = {
    duration: 1000,
    delay: 0,
    loop: false,
    autoplay: true,
    direction: 'normal',
    easing: 'easeOutElastic',
    elasticity: 400,
    round: false,
    begin: undefined,
    update: undefined,
    complete: undefined
  }

  var validTransforms = ['translateX', 'translateY', 'translateZ', 'rotate', 'rotateX', 'rotateY', 'rotateZ', 'scale', 'scaleX', 'scaleY', 'scaleZ', 'skewX', 'skewY'];

  // Utils

  var is = (function() {
    return {
      array:  function(a) { return Array.isArray(a) },
      object: function(a) { return Object.prototype.toString.call(a).indexOf('Object') > -1 },
      html:   function(a) { return (a instanceof NodeList || a instanceof HTMLCollection) },
      node:   function(a) { return a.nodeType },
      svg:    function(a) { return a instanceof SVGElement },
      number: function(a) { return !isNaN(parseInt(a)) },
      string: function(a) { return typeof a === 'string' },
      func:   function(a) { return typeof a === 'function' },
      undef:  function(a) { return typeof a === 'undefined' },
      null:   function(a) { return typeof a === 'null' },
      hex:    function(a) { return /(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(a) },
      rgb:    function(a) { return /^rgb/.test(a) },
      rgba:   function(a) { return /^rgba/.test(a) },
      hsl:    function(a) { return /^hsl/.test(a) },
      color:  function(a) { return (is.hex(a) || is.rgb(a) || is.rgba(a) || is.hsl(a))}
    }
  })();

  // Easings functions adapted from http://jqueryui.com/

  var easings = (function() {
    var eases = {};
    var names = ['Quad', 'Cubic', 'Quart', 'Quint', 'Expo'];
    var functions = {
      Sine: function(t) { return 1 - Math.cos( t * Math.PI / 2 ); },
      Circ: function(t) { return 1 - Math.sqrt( 1 - t * t ); },
      Elastic: function(t, m) {
        if( t === 0 || t === 1 ) return t;
        var p = (1 - Math.min(m, 998) / 1000), st = t / 1, st1 = st - 1, s = p / ( 2 * Math.PI ) * Math.asin( 1 );
        return -( Math.pow( 2, 10 * st1 ) * Math.sin( ( st1 - s ) * ( 2 * Math.PI ) / p ) );
      },
      Back: function(t) { return t * t * ( 3 * t - 2 ); },
      Bounce: function(t) {
        var pow2, bounce = 4;
        while ( t < ( ( pow2 = Math.pow( 2, --bounce ) ) - 1 ) / 11 ) {}
        return 1 / Math.pow( 4, 3 - bounce ) - 7.5625 * Math.pow( ( pow2 * 3 - 2 ) / 22 - t, 2 );
      }
    }
    names.forEach(function(name, i) {
      functions[name] = function(t) {
        return Math.pow( t, i + 2 );
      }
    });
    Object.keys(functions).forEach(function(name) {
      var easeIn = functions[name];
      eases['easeIn' + name] = easeIn;
      eases['easeOut' + name] = function(t, m) { return 1 - easeIn(1 - t, m); };
      eases['easeInOut' + name] = function(t, m) { return t < 0.5 ? easeIn(t * 2, m) / 2 : 1 - easeIn(t * -2 + 2, m) / 2; };
    });
    eases.linear = function(t) { return t; };
    return eases;
  })();

  // Strings

  var numberToString = function(val) {
    return (is.string(val)) ? val : val + '';
  }

  var stringToHyphens = function(str) {
    return str.replace(/([a-z])([A-Z])/g, '$1-$2').toLowerCase();
  }

  var selectString = function(str) {
    if (is.color(str)) return false;
    try {
      var nodes = document.querySelectorAll(str);
      return nodes;
    } catch(e) {
      return false;
    }
  }

  // Numbers

  var random = function(min, max) {
    return Math.floor(Math.random() * (max - min + 1)) + min;
  }

  // Arrays

  var flattenArray = function(arr) {
    return arr.reduce(function(a, b) {
      return a.concat(is.array(b) ? flattenArray(b) : b);
    }, []);
  }

  var toArray = function(o) {
    if (is.array(o)) return o;
    if (is.string(o)) o = selectString(o) || o;
    if (is.html(o)) return [].slice.call(o);
    return [o];
  }

  var arrayContains = function(arr, val) {
    return arr.some(function(a) { return a === val; });
  }

  var groupArrayByProps = function(arr, propsArr) {
    var groups = {};
    arr.forEach(function(o) {
      var group = JSON.stringify(propsArr.map(function(p) { return o[p]; }));
      groups[group] = groups[group] || [];
      groups[group].push(o);
    });
    return Object.keys(groups).map(function(group) {
      return groups[group];
    });
  }

  var removeArrayDuplicates = function(arr) {
    return arr.filter(function(item, pos, self) {
      return self.indexOf(item) === pos;
    });
  }

  // Objects

  var cloneObject = function(o) {
    var newObject = {};
    for (var p in o) newObject[p] = o[p];
    return newObject;
  }

  var mergeObjects = function(o1, o2) {
    for (var p in o2) o1[p] = !is.undef(o1[p]) ? o1[p] : o2[p];
    return o1;
  }

  // Colors

  var hexToRgb = function(hex) {
    var rgx = /^#?([a-f\d])([a-f\d])([a-f\d])$/i;
    var hex = hex.replace(rgx, function(m, r, g, b) { return r + r + g + g + b + b; });
    var rgb = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
    var r = parseInt(rgb[1], 16);
    var g = parseInt(rgb[2], 16);
    var b = parseInt(rgb[3], 16);
    return 'rgb(' + r + ',' + g + ',' + b + ')';
  }

  var hslToRgb = function(hsl) {
    var hsl = /hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(hsl);
    var h = parseInt(hsl[1]) / 360;
    var s = parseInt(hsl[2]) / 100;
    var l = parseInt(hsl[3]) / 100;
    var hue2rgb = function(p, q, t) {
      if (t < 0) t += 1;
      if (t > 1) t -= 1;
      if (t < 1/6) return p + (q - p) * 6 * t;
      if (t < 1/2) return q;
      if (t < 2/3) return p + (q - p) * (2/3 - t) * 6;
      return p;
    }
    var r, g, b;
    if (s == 0) {
      r = g = b = l;
    } else {
      var q = l < 0.5 ? l * (1 + s) : l + s - l * s;
      var p = 2 * l - q;
      r = hue2rgb(p, q, h + 1/3);
      g = hue2rgb(p, q, h);
      b = hue2rgb(p, q, h - 1/3);
    }
    return 'rgb(' + r * 255 + ',' + g * 255 + ',' + b * 255 + ')';
  }

  var colorToRgb = function(val) {
    if (is.rgb(val) || is.rgba(val)) return val;
    if (is.hex(val)) return hexToRgb(val);
    if (is.hsl(val)) return hslToRgb(val);
  }

  // Units

  var getUnit = function(val) {
    return /([\+\-]?[0-9|auto\.]+)(%|px|pt|em|rem|in|cm|mm|ex|pc|vw|vh|deg)?/.exec(val)[2];
  }

  var addDefaultTransformUnit = function(prop, val, intialVal) {
    if (getUnit(val)) return val;
    if (prop.indexOf('translate') > -1) return getUnit(intialVal) ? val + getUnit(intialVal) : val + 'px';
    if (prop.indexOf('rotate') > -1 || prop.indexOf('skew') > -1) return val + 'deg';
    return val;
  }

  // Values

  var getAnimationType = function(el, prop) {
    if ((is.node(el) || is.svg(el)) && arrayContains(validTransforms, prop)) return 'transform';
    if ((is.node(el) || is.svg(el)) && (prop !== 'transform' && getCSSValue(el, prop))) return 'css';
    if ((is.node(el) || is.svg(el)) && (el.getAttribute(prop) || (is.svg(el) && el[prop]))) return 'attribute';
    if (!is.null(el[prop]) && !is.undef(el[prop])) return 'object';
  }

  var getCSSValue = function(el, prop) {
    // First check if prop is a valid CSS property
    if (prop in el.style) {
      // Then return the property value or fallback to '0' when getPropertyValue fails
      return getComputedStyle(el).getPropertyValue(stringToHyphens(prop)) || '0';
    }
  }

  var getTransformValue = function(el, prop) {
    var defaultVal = prop.indexOf('scale') > -1 ? 1 : 0;
    var str = el.style.transform;
    if (!str) return defaultVal;
    var rgx = /(\w+)\((.+?)\)/g;
    var match = [];
    var props = [];
    var values = [];
    while (match = rgx.exec(str)) {
      props.push(match[1]);
      values.push(match[2]);
    }
    var val = values.filter(function(f, i) { return props[i] === prop; });
    return val.length ? val[0] : defaultVal;
  }

  var getInitialTargetValue = function(target, prop) {
    switch (getAnimationType(target, prop)) {
      case 'transform': return getTransformValue(target, prop);
      case 'css': return getCSSValue(target, prop);
      case 'attribute': return target.getAttribute(prop);
    }
    return target[prop] || 0;
  }

  var getValidValue = function(values, val, originalCSS) {
    if (is.color(val)) return colorToRgb(val);
    if (getUnit(val)) return val;
    var unit = getUnit(values.to) ? getUnit(values.to) : getUnit(values.from);
    if (!unit && originalCSS) unit = getUnit(originalCSS);
    return unit ? val + unit : val;
  }

  var decomposeValue = function(val) {
    var rgx = /-?\d*\.?\d+/g;
    return {
      original: val,
      numbers: numberToString(val).match(rgx) ? numberToString(val).match(rgx).map(Number) : [0],
      strings: numberToString(val).split(rgx)
    }
  }

  var recomposeValue = function(numbers, strings, initialStrings) {
    return strings.reduce(function(a, b, i) {
      var b = (b ? b : initialStrings[i - 1]);
      return a + numbers[i - 1] + b;
    });
  }

  // Animatables

  var getAnimatables = function(targets) {
    var targets = targets ? (flattenArray(is.array(targets) ? targets.map(toArray) : toArray(targets))) : [];
    return targets.map(function(t, i) {
      return { target: t, id: i };
    });
  }

  // Properties

  var getProperties = function(params, settings) {
    var props = [];
    for (var p in params) {
      if (!defaultSettings.hasOwnProperty(p) && p !== 'targets') {
        var prop = is.object(params[p]) ? cloneObject(params[p]) : {value: params[p]};
        prop.name = p;
        props.push(mergeObjects(prop, settings));
      }
    }
    return props;
  }

  var getPropertiesValues = function(target, prop, value, i) {
    var values = toArray( is.func(value) ? value(target, i) : value);
    return {
      from: (values.length > 1) ? values[0] : getInitialTargetValue(target, prop),
      to: (values.length > 1) ? values[1] : values[0]
    }
  }

  var getTweenValues = function(prop, values, type, target) {
    var valid = {};
    if (type === 'transform') {
      valid.from = prop + '(' + addDefaultTransformUnit(prop, values.from, values.to) + ')';
      valid.to = prop + '(' + addDefaultTransformUnit(prop, values.to) + ')';
    } else {
      var originalCSS = (type === 'css') ? getCSSValue(target, prop) : undefined;
      valid.from = getValidValue(values, values.from, originalCSS);
      valid.to = getValidValue(values, values.to, originalCSS);
    }
    return { from: decomposeValue(valid.from), to: decomposeValue(valid.to) };
  }

  var getTweensProps = function(animatables, props) {
    var tweensProps = [];
    animatables.forEach(function(animatable, i) {
      var target = animatable.target;
      return props.forEach(function(prop) {
        var animType = getAnimationType(target, prop.name);
        if (animType) {
          var values = getPropertiesValues(target, prop.name, prop.value, i);
          var tween = cloneObject(prop);
          tween.animatables = animatable;
          tween.type = animType;
          tween.from = getTweenValues(prop.name, values, tween.type, target).from;
          tween.to = getTweenValues(prop.name, values, tween.type, target).to;
          tween.round = (is.color(values.from) || tween.round) ? 1 : 0;
          tween.delay = (is.func(tween.delay) ? tween.delay(target, i, animatables.length) : tween.delay) / animation.speed;
          tween.duration = (is.func(tween.duration) ? tween.duration(target, i, animatables.length) : tween.duration) / animation.speed;
          tweensProps.push(tween);
        }
      });
    });
    return tweensProps;
  }

  // Tweens

  var getTweens = function(animatables, props) {
    var tweensProps = getTweensProps(animatables, props);
    var splittedProps = groupArrayByProps(tweensProps, ['name', 'from', 'to', 'delay', 'duration']);
    return splittedProps.map(function(tweenProps) {
      var tween = cloneObject(tweenProps[0]);
      tween.animatables = tweenProps.map(function(p) { return p.animatables });
      tween.totalDuration = tween.delay + tween.duration;
      return tween;
    });
  }

  var reverseTweens = function(anim, delays) {
    anim.tweens.forEach(function(tween) {
      var toVal = tween.to;
      var fromVal = tween.from;
      var delayVal = anim.duration - (tween.delay + tween.duration);
      tween.from = toVal;
      tween.to = fromVal;
      if (delays) tween.delay = delayVal;
    });
    anim.reversed = anim.reversed ? false : true;
  }

  // will-change

  var getWillChange = function(anim) {
    var props = [];
    var els = [];
    anim.tweens.forEach(function(tween) {
      if (tween.type === 'css' || tween.type === 'transform' ) {
        props.push(tween.type === 'css' ? stringToHyphens(tween.name) : 'transform');
        tween.animatables.forEach(function(animatable) { els.push(animatable.target); });
      }
    });
    return {
      properties: removeArrayDuplicates(props).join(', '),
      elements: removeArrayDuplicates(els)
    }
  }

  var setWillChange = function(anim) {
    var willChange = getWillChange(anim);
    willChange.elements.forEach(function(element) {
      element.style.willChange = willChange.properties;
    });
  }

  var removeWillChange = function(anim) {
    var willChange = getWillChange(anim);
    willChange.elements.forEach(function(element) {
      element.style.removeProperty('will-change');
    });
  }

  /* Svg path */

  var getPathProps = function(path) {
    var el = is.string(path) ? selectString(path)[0] : path;
    return {
      path: el,
      value: el.getTotalLength()
    }
  }

  var snapProgressToPath = function(tween, progress) {
    var pathEl = tween.path;
    var pathProgress = tween.value * progress;
    var point = function(offset) {
      var o = offset || 0;
      var p = progress > 1 ? tween.value + o : pathProgress + o;
      return pathEl.getPointAtLength(p);
    }
    var p = point();
    var p0 = point(-1);
    var p1 = point(+1);
    switch (tween.name) {
      case 'translateX': return p.x;
      case 'translateY': return p.y;
      case 'rotate': return Math.atan2(p1.y - p0.y, p1.x - p0.x) * 180 / Math.PI;
    }
  }

  // Progress

  var getTweenProgress = function(tween, time) {
    var elapsed = Math.min(Math.max(time - tween.delay, 0), tween.duration);
    var percent = elapsed / tween.duration;
    var progress = tween.to.numbers.map(function(number, p) {
      var start = tween.from.numbers[p];
      var eased = easings[tween.easing](percent, tween.elasticity);
      var val = tween.path ? snapProgressToPath(tween, eased) : start + eased * (number - start);
      val = tween.round ? Math.round(val * tween.round) / tween.round : val;
      return val;
    });
    return recomposeValue(progress, tween.to.strings, tween.from.strings);
  }

  var setAnimationProgress = function(anim, time) {
    var transforms = undefined;
    anim.time = Math.min(time, anim.duration);
    anim.progress = (anim.time / anim.duration) * 100;
    anim.tweens.forEach(function(tween) {
      tween.currentValue = getTweenProgress(tween, time);
      var progress = tween.currentValue;
      tween.animatables.forEach(function(animatable) {
        var id = animatable.id;
        switch (tween.type) {
          case 'css': animatable.target.style[tween.name] = progress; break;
          case 'attribute': animatable.target.setAttribute(tween.name, progress); break;
          case 'object': animatable.target[tween.name] = progress; break;
          case 'transform':
          if (!transforms) transforms = {};
          if (!transforms[id]) transforms[id] = [];
          transforms[id].push(progress);
          break;
        }
      });
    });
    if (transforms) for (var t in transforms) {
      var transform = transforms[t].join(' ');
      anim.animatables[t].target.style['-webkit-transform'] = transform;
    }
    if (anim.settings.update) anim.settings.update(anim);
  }

  // Animation

  var createAnimation = function(params) {
    var anim = {};
    anim.animatables = getAnimatables(params.targets);
    anim.settings = mergeObjects(params, defaultSettings);
    anim.properties = getProperties(params, anim.settings);
    anim.tweens = getTweens(anim.animatables, anim.properties);
    anim.duration = anim.tweens.length ? Math.max.apply(Math, anim.tweens.map(function(tween){ return tween.totalDuration; })) : params.duration / animation.speed;
    anim.time = 0;
    anim.progress = 0;
    anim.running = false;
    anim.ended = false;
    return anim;
  }

  // Public

  var animations = [];

  var animation = function(params) {

    var anim = createAnimation(params);
    var time = {};

    time.tick = function() {
      if (anim.running) {
        anim.ended = false;
        time.now = +new Date();
        time.current = time.last + time.now - time.start;
        setAnimationProgress(anim, time.current);
        var s = anim.settings;
        if (s.begin && time.current >= s.delay) { s.begin(anim); s.begin = undefined; };
        if (time.current >= anim.duration) {
          if (s.loop) {
            time.start = +new Date();
            if (s.direction === 'alternate') reverseTweens(anim, true);
            if (is.number(s.loop)) s.loop--;
            time.raf = requestAnimationFrame(time.tick);
          } else {
            anim.ended = true;
            if (s.complete) s.complete(anim);
            anim.pause();
          }
          time.last = 0;
        } else {
          time.raf = requestAnimationFrame(time.tick);
        }
      }
    }

    anim.seek = function(progress) {
      var time = (progress / 100) * anim.duration;
      setAnimationProgress(anim, time);
    }

    anim.pause = function() {
      anim.running = false;
      cancelAnimationFrame(time.raf);
      removeWillChange(anim);
      var i = animations.indexOf(anim);
      if (i > -1) animations.splice(i, 1);
    }

    anim.play = function(params) {
      if (params) anim = mergeObjects(createAnimation(mergeObjects(params, anim.settings)), anim);
      anim.pause();
      anim.running = true;
      time.start = +new Date();
      time.last = anim.ended ? 0 : anim.time;
      var s = anim.settings;
      if (s.direction === 'reverse') reverseTweens(anim);
      if (s.direction === 'alternate' && !s.loop) s.loop = 1;
      setWillChange(anim);
      animations.push(anim);
      time.raf = requestAnimationFrame(time.tick);
    }

    anim.restart = function() {
      if (anim.reversed) reverseTweens(anim);
      anim.pause();
      anim.seek(0);
      anim.play();
    }

    if (anim.settings.autoplay) anim.play();

    return anim;

  }

  // Remove on one or multiple targets from all active animations.

  var remove = function(elements) {
    var targets = flattenArray(is.array(elements) ? elements.map(toArray) : toArray(elements));
    for (var i = animations.length-1; i >= 0; i--) {
      var animation = animations[i];
      for (var t = animation.tweens.length-1; t >= 0; t--) {
        var tween = animation.tweens[t];
        for (var a = tween.animatables.length-1; a >= 0; a--) {
          if (arrayContains(targets, tween.animatables[a].target)) {
            tween.animatables.splice(a, 1);
            if (!tween.animatables.length) animation.tweens.splice(t, 1);
            if (!animation.tweens.length) animation.pause();
          }
        }
      }
    }
  }

  animation.speed = 1;
  animation.list = animations;
  animation.remove = remove;
  animation.easings = easings;
  animation.getValue = getInitialTargetValue;
  animation.path = getPathProps;
  animation.random = random;

  return animation;

}));

// Ionic Starter App

// angular.module is a global place for creating, registering and retrieving Angular modules
// 'starter' is the name of this angular module example (also set in a <body> attribute in index.html)
// the 2nd parameter is an array of 'requires'
// 'starter.services' is found in services.js
// 'starter.controllers' is found in controllers.js

angular.module('app', ['ionic', 'ion-place-tools', 'app.routes', 'ngCordova'])
.constant('FirebaseUrl', 'https://ionicle.firebaseio.com/')

.run(["$ionicPlatform", "config", function($ionicPlatform, config) {
  $ionicPlatform.ready(function() {
    // Hide the accessory bar by default (remove this to show the accessory bar above the keyboard
    // for form inputs)
    if (window.cordova && window.cordova.plugins && window.cordova.plugins.Keyboard) {
      cordova.plugins.Keyboard.hideKeyboardAccessoryBar(true);
      cordova.plugins.Keyboard.disableScroll(true);
    }
    if (window.StatusBar) {
      // org.apache.cordova.statusbar required
      StatusBar.styleDefault();
    }
  });
}])
.config(['$ionicConfigProvider', function($ionicConfigProvider) {

    $ionicConfigProvider.tabs.position('bottom'); // other values: top

}]);

window.placeTools = angular.module('ion-place-tools', []);
placeTools.directive('ionGooglePlace', [
        '$ionicTemplateLoader',
        '$ionicPlatform',
        '$q',
        '$timeout',
        '$rootScope',
        '$document',
        function($ionicTemplateLoader, $ionicPlatform, $q, $timeout, $rootScope, $document) {
            return {
                require: ['?ngModel', '?submit'],
                restrict: 'E',
                templateUrl: 'templates/autocomplete.html',
                replace: true,
                scope: {
                    searchQuery: '=ngModel',
                    locationChanged: '&',
                    radius: '=',
                    super: '=submit',
                    submitted: '=submitted'
                },
                controller: ["$scope", "$http", "LocationService", function($scope, $http, LocationService) {
                  $scope.current = LocationService("current location");

                  $scope.submit = function() {
                    $scope.submitted = true;
                    $scope.super($scope.current);
                    $scope.$apply();
                  }

                  $scope.service = {
                    getQueryPredictions: function(req, callback) {

                      $.ajax({
                      url:"http://autocomplete.wunderground.com/aq?cb=call=?",
                      dataType: "jsonp",
                      data:{
                      "query":req.input
                      },
                      crossDomain: true,
                      success: function (json) {
                        var locations = [];
                        json.RESULTS.forEach(function(item){
                          if(item.type != "city") return;
                          var location = item.ll.split(" ");
                          locations.push({
                            description: item.name,
                            location: {
                              lat: location[0],
                              lng: location[1]
                            }
                          })
                        })
                        callback(locations, 200);
                      },
                      error: function(err) {
                        throw err;
                      }
                    })
                  }
                }
              }],

                compile: function(element, attrs) {
                  var input = element.find('input');
                  var button = element.find('button');
                  button.html(attrs.title);
                  button.attr("ng-hide", "submitted");

                  return {
                    pre: function(scope) {
                      scope.submitted = true;
                      scope.dropDownActive = true;
                      var searchEventTimeout = undefined;
                      var latLng = null;

                      navigator.geolocation.getCurrentPosition(function (position) {
                          latLng = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);
                      });

                      var searchInputElement = angular.element(element.find('input'));

                      scope.selectLocation = function(location) {
                          scope.dropDownActive = false;
                          scope.searchQuery = location.description;
                          scope.current = location;
                      };
                      if (!scope.radius) {
                          scope.radius = 1500000;
                      }

                      scope.locations = []

                      scope.$watch('searchQuery', function(query) {
                          if (!query) {
                              query = '';
                          }
                          scope.dropDownActive = (query.length >= 3 && scope.locations.length);
                          if (searchEventTimeout) $timeout.cancel(searchEventTimeout);
                          searchEventTimeout = $timeout(function() {
                              scope.$apply();
                              if(!query) return;
                              if (query.length < 3) {
                                  scope.locations = [];
                                  return;
                              };
                              scope.submitted = false;
                              var req = {};
                              req.input = query;
                              if (latLng) {
                                  req.location = latLng;
                                  req.radius = scope.radius;
                              }
                              scope.service.getQueryPredictions(req, function (predictions, status) {
                                  if (status == 200) {
                                      scope.locations = predictions;
                                      scope.dropDownActive = true;
                                      scope.submitted = false;
                                      scope.$digest();
                                  }
                              });
                          }, 350); // we're throttling the input by 350ms to be nice to google's API
                      });

                      var onClick = function(e) {
                          e.preventDefault();
                          e.stopPropagation();
                          scope.dropDownActive = true;
                          scope.submitted = false;
                          scope.$digest();
                          searchInputElement[0].focus();
                          setTimeout(function(){
                              searchInputElement[0].focus();
                          },0);
                      };

                      var onCancel = function(e){
                          setTimeout(function () {
                              scope.dropDownActive = false;
                              scope.$digest();
                          }, 200);
                      };

                      input.bind('click', onClick);
                      input.bind('blur', onCancel);
                      input.bind('touchend', onClick);


                      if(attrs.placeholder){
                          input.attr('placeholder', attrs.placeholder);
                      }

                    }
                  }
                }
            };
        }
    ]);

placeTools
  .directive('ionGooglePlaceMap', ['$timeout', function ($timeout) {
  	return {
  		restrict: 'E',
  		template: [
  			'<div class="ion-place-tools-map-holder" ng-class="{ \'visible\': visible }">',
  				'<div class="ion-place-tools-map-wrapper">',
	  				'<div class="ion-place-tools-map"></div>',
	  				'<div class="autocomplete-wrap">',
	  					'<ion-google-place radius="options.radius" placeholder="Your address" location-changed="locationChanged" ng-model="data.address" required name="address"/>',
	  				'</div>',
	  				'<div class="controls">',
	  					'<button type="button" class="button button-stable" ng-click="hideModal()">Cancel</button>',
	  					'&nbsp;',
	  					'<button type="button" class="button button-positive" ng-click="callSuccess()">OK</button>',
	  				'</div>',
	  			'</div>',
  			'</div>'
  		].join(''),
  		scope: {
        visible: '=',
        data: '=',
        options: '=',
        onSuccess: '&'
      },
  		replace: true,
  		link: function (scope, element, attrs) {
  			options = angular.extend({
  				radius: 15000,
  				fitBounds: true,
  				marker: true
  			}, scope.options);

  			var mapEl = element.find('div')[0].children[0],
  				mapProp = {
				    center: new google.maps.LatLng(51.508742,-0.120850),
				    zoom: 5,
				    mapTypeId: google.maps.MapTypeId.ROADMAP
				  },
			  	map = new google.maps.Map(mapEl, mapProp),
			  	geocoder = new google.maps.Geocoder(),
			  	marker = new google.maps.Marker({
			  		position: mapProp.center,
			  		map: map,
			  		draggable: true
			  	});

			  if (!options.marker) {
			  	marker.setVisible(false);
			  }

			  scope.hideModal = function () {
			  	scope.visible = false;
			  };

			  scope.callSuccess = function () {
			  	scope.hideModal();
			  	if (scope.onSuccess) {
            scope.onSuccess()();
          }
			  };

			  scope.locationChanged = function (address) {
					geocoder.geocode({
					  address: address
					}, function(results, status) {
					  if (status == google.maps.GeocoderStatus.OK) {
					  	scope.data.latitude = results[0].geometry.location.lat();
			  			scope.data.longitude = results[0].geometry.location.lng();
					    map.setCenter(results[0].geometry.location);
					    marker.setPosition(results[0].geometry.location);
					    if (options.fitBounds) {
					    	map.fitBounds(results[0].geometry.viewport);
					    }
					  }
					});
			  };

			  var geoCodeByCoords = function (latLng) {
			  	geocoder.geocode({
			  		latLng: latLng
			  	}, function (results, status) {
			  		if (status == google.maps.GeocoderStatus.OK) {
			  			scope.data.address = results[0].formatted_address;
			  			scope.data.latitude = results[0].geometry.location.lat();
			  			scope.data.longitude = results[0].geometry.location.lng();
			  			scope.$apply();
			  			map.setCenter(results[0].geometry.location);
			  			marker.setPosition(results[0].geometry.location);
			  			if (options.fitBounds) {
					    	map.fitBounds(results[0].geometry.viewport);
					    }
			  		}
			  	});
			  };

			  google.maps.event.addListener(map, 'dragend', function() {
			  	geoCodeByCoords(map.getCenter());
			  });

			  var infoWindow = null;

			  google.maps.event.addListener(map, 'click', function (ev) {
			  	geocoder.geocode({
			  		latLng: ev.latLng
			  	}, function (results, status) {
			  		if (status == google.maps.GeocoderStatus.OK) {
			  			if (infoWindow) {
			  				infoWindow.close();
			  			}
				  		infoWindow = new google.maps.InfoWindow({
		            content: results[0].formatted_address,
		            position: ev.latLng
		          });
		          infoWindow.open(map);
				  	}
			  	});
			  });

			  google.maps.event.addListener(marker, 'dragend', function () {
      		geoCodeByCoords(marker.getPosition());
      	});

			  navigator.geolocation.getCurrentPosition(function (position) {
          latLng = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);
          geoCodeByCoords(latLng);
        });

        scope.$watch('options.marker', function(val) {
			  	options.marker = val;
			  	marker.setVisible(options.marker);
			  });
  		}
  	};
  }]);
angular.module('app.routes', [])

.config(["$stateProvider", "$urlRouterProvider", function($stateProvider, $urlRouterProvider) {

  // Ionic uses AngularUI Router which uses the concept of states
  // Learn more here: https://github.com/angular-ui/ui-router
  // Set up the various states which the app can be in.
  // Each state's controller can be found in controllers.js
  $stateProvider


.state('getStarted', {
      url: '/getStarted',
      controller: 'GetStartedCtrl'
    })
.state('welcome', {
      url: '/welcome',
      templateUrl: 'templates/getStarted.html',
      controller: 'WelcomePageCtrl'
    })
  .state('signIn', {
      url: '/signIn',
      templateUrl: 'templates/signIn.html',
      controller: 'SignInCtrl'
  })

  .state('signUp', {
      url: '/signUp',
      templateUrl: 'templates/signUp.html',
      controller: 'SingUpCtrl'
  })
  .state('app', {
      url: '/app',
      templateUrl: 'templates/sideMenu.html',
      controller: 'AppNavigationCtrl'
  })

  .state('app.forecast', {
      url: '/forecast',
      abstract: true,
      templateUrl: 'templates/forecast.html',
      controller: 'AppNavigationCtrl'
  })
  .state('app.forecast.current', {
      url: '/forecast/current',
      views: {
        'current': {
          templateUrl: 'templates/main.html',
          controller: 'mainCtrl'
        }
      }
  })

    .state('app.forecast.weekly', {
      url: '/weekly',
      views: {
        'weekly': {
          templateUrl: 'templates/weeklyForecast.html',
          controller: 'WeeklyForecastCtrl'
        }
      }
    })

    .state('app.forecast.hourly', {
      url: '/hourly',
      views: {
        'hourly': {
          templateUrl: 'templates/hourlyForecast.html',
          controller: 'HourlyForecastCtrl'
        }
      }
    })

  .state('app.settings', {
      url: '/settings',
      templateUrl: 'templates/settings.html',
      controller: 'AppNavigationCtrl'
  })
  .state('app.profile', {
      url: '/profile',
      templateUrl: 'templates/profile.html',
      controller: 'ProfileCtrl'
  })
  .state('app.changeLocation', {
      url: '/location',
      templateUrl: 'templates/changeLocation.html',
      controller: 'EnterLocationCtrl'
  })

  .state('app.changeBackround', {
      url: '/background',
      templateUrl: 'templates/backgroundSelection.html',
      controller: 'backgroundSelectionCtrl'
  })

  .state('app.changeStickers', {
      url: '/stickers',
      templateUrl: 'templates/stickers.html',
      controller: 'StickersSelectionCtrl'
  })

  .state('app.map', {
    url: '/map',
    templateUrl: 'templates/map.html',
    controller: 'mapCtrl'
  })

  .state('addEmojis', {
    url: '/add_emojis',
    templateUrl: 'templates/addEmojis.html',
    controller: 'addEmojisCtrl'
  })


  .state('backgroundSelection', {
    url: '/page12',
    templateUrl: 'templates/backgroundSelection.html',
    controller: 'backgroundSelectionCtrl'
  })

  .state('app.store', {
      url: '/store',
      abstract: true,
      templateUrl: 'templates/store.html',
      controller: 'AppNavigationCtrl'
  })
  .state('app.store.stickers', {
      url: '/stickers',
      views: {
        'stickers': {
          templateUrl: 'templates/stickersStore.html',
          controller: 'StickersStoreCtrl'
        }
      }
  })

    .state('app.store.backgrounds', {
      url: '/background',
      views: {
        'backgrounds': {
          templateUrl: 'templates/backgroundStore.html',
          controller: 'backgroundStoreCtrl'
        }
      }
    })

    .state('app.store.ads', {
      url: '/ads',
      views: {
        'ads': {
          templateUrl: 'templates/ads.html',
          controller: 'purchaseAdsCtrl'
        }
      }
    })
    .state('app.about', {
        url: '/about',
        templateUrl: 'templates/about.html'
    })
$urlRouterProvider.otherwise('/getStarted')



}]);

angular.module('app')

.directive('ads', function() {
  return {
    restrict: 'A',
    controller: ["$scope", "$sce", "Ads", function($scope, $sce, Ads) {
      getAds();
      var refresher = setInterval(getAds, 45*1000);
      $scope.sce = function(html) {
        return $sce.trustAsHtml(html);
      }
      Ads.subscribe(function() {
        $scope.html = "";
        $scope.$apply();
        clearInterval(refresher);

      });
      function getAds() {
        if(Ads.purchased()) {
          $('.has-ads').removeClass('has-ads');
        }
        Ads.get().then(function(html) {
          $scope.html = html;
          $scope.$apply();
        });
      }
    }],
    compile: function($element, $attrs) {
      $element.html(
        '<div class = "ads" ng-bind-html = "sce(html)"></div>'
      );
    }
  }
})

angular.module('app')

.directive('background', function() {
  return {
    restrict: 'A',
    controller: ["$scope", "Backgrounds", "EndPoints", "User", "$http", function($scope, Backgrounds, EndPoints, User, $http) {
        $scope.background = "img/background.png";
        $scope.$on("$ionicView.enter", update);
        var subscribed;
        function update() {
            var timeout;
            getPack();
            if(!subscribed) {
              Backgrounds.subscribe(getPack);
              subscribe = true;
            }
            function getPack() {
              Backgrounds.current().then(success, error);
            }
            function success(pack) {
                var background =  Backgrounds.image(pack);
                $scope.background = background;
                apply();

                function apply() {
                  if(timeout) clearTimeout(timeout);
                  timeout = setTimeout(update, 60*60*1000);
                  $scope.$apply();
                }
            }
            function error(err) {
                console.error(err);
            }

        };
    }],
    compile: function($element, $attrs) {
      $element.html(
        '<div ng-if = "background" class = "background" style = "background-image: url({{background}});"></div>'
      );
    }
  }
})

angular.module('app')

.directive('animatedUiSref', function() {
  return {
    restrict: 'A',
    scope: true,
    controller: ["$scope", "$state", function($scope, $state) {
      $scope.go = function() {
        $state.go($scope.ref);
      }
    }],
    link: function ($scope, $element, $attrs) {
      $element = $($element);
      $scope.ref = $attrs.animatedUiSref;
    	animateAction($element, $scope.go);
    }
  }
})
.directive('animatedClick', function() {
  return {
    restrict: 'A',
    scope: true,
    link: function ($scope, $element, $attrs) {
      $element = $($element);
      var mainScope = $scope;
      animateAction($element, getAction());

      function getAction() {
        var animatedClick = $attrs.animatedClick;
        var parsedClick = animatedClick.split(/\(|\)/);

        var method = getMethod();
        var attrs = getAttrs();

        return function() {
          method.apply(method, attrs);
        }
        function getMethod() {
          var name = parsedClick[0];
          return mainScope[name];
        }

        function getAttrs() {
          var attrs = [];
          parsedClick[1].split(/,/).forEach(
            function(element) {
              attrs.push(mainScope[element]);
            }
          );
          return attrs;
        }

      }
    }
  }
})

function animateAction($element, action) {

  $element.click(function(){
    var marker = $('<div class = "active-button-marker"></div>');
    $element.append(marker);
    var duration = 700;
    setTimeout(function(){marker.remove(); action()}, duration)
  });

}

angular.module('app')
.controller('OnboardingCtrl', ["$scope", "$element", "$attrs", "strings", function($scope, $element, $attrs, strings){
  var params =  $attrs.onboarding.split(' ');
  var selector = params[0];
  var delay = 0 || params[1]*1000;
  var duration = 3000 || params[2]*1000;

  var reference = $(selector);
  var element = $($element);
  var referenceOffset = reference.offset();
  var referenceHCenter = referenceOffset.left + reference.width()/2;
  var referenceVCenter = referenceOffset.top + reference.height()/2;
  var vLoc = "bottom"
  var vOffset = 0;
  setupContent();
  setupPointer();
  if(referenceVCenter > $('ion-content').height()/2) {
    vLoc = "top";
      vOffset = -2*element.height();
  }
  element.offset({top: (referenceVCenter - 44 + vOffset), left: 20});

  setTimeout(appear, delay);

  function defineIsUnderReference() {
    var screenCenter = $('ion-content').height()/2;
    return (vCenter < screenCenter);
  }
  function setupContent() {
    var onboardingContent = element.find('.onboarding-content');
    onboardingContent.html(strings(selector));
  }
  function setupPointer() {
    var pointer = element.find('.onboarding-pointer');
      var offset = {left: referenceHCenter};
      offset[vLoc] = 0;
      pointer.offset(offset);
  }
  function appear() {
    fade();
    setTimeout(remove, duration);
    element.click(remove);

    function fade() {
      element.fadeTo(1000, 1);
    }
  }
  var destroy = function() {
    element.remove()
  };
  function remove() {
      fade();
      setTimeout(destroy, 1000);
      function fade() {
        element.fadeTo(1000, 0);
      }
  }

}])
.directive('onboarding', function() {
  return {
    restrict: 'A',
    compile: function($element, $attrs) {
      $element.addClass('onboarding');
      $element.html(
        "<div class = 'onboarding-content'></div>"+
        "<div class = 'onboarding-pointer'></div>"
      );
    },
    controller: 'OnboardingCtrl'
  }
})

angular.module('app')


.controller('addEmojisCtrl', ["$scope", "$state", function($scope, $state) {

}])

angular.module('app')


.controller('AppNavigationCtrl', ["$scope", "$rootScope", "$state", "$ionicSideMenuDelegate", "User", function($scope, $rootScope, $state, $ionicSideMenuDelegate, User ) {
  $rootScope.mainPage = true;
  $rootScope.moment = moment;
  reload();
  User.me("subscribe", reload);
  function reload() {
    $scope.user = User.me();
  }
  $scope. getMenuButtonClass = function() {
    return ($ionicSideMenuDelegate.isOpen())? "ion-android-close" : "ion-navicon";
  }
  $scope.logOut = function() {
    User.logOut().then(
      function() {
        $state.go("welcome");
      },
      function( err ) {
        throw err;
      });
  }
}])

angular.module('app')


.controller('backgroundSelectionCtrl', ["$scope", "$state", "Backgrounds", "strings", "User", function($scope, $state, Backgrounds, strings, User) {
  $scope.strings = strings;
  var background = {id: -1};
  update();
  User.me("subscribe", update);
  Backgrounds.subscribe(update);
  function update() {
      Backgrounds.current().then(function(pack) {
        background = pack;
        $scope.$apply();
      });
      Backgrounds.available().then(function(list) {
        $scope.backgrounds = list;
        $scope.$apply();
      });
  }
	$scope.select = function(item) {
		Backgrounds.current(item);
    background = item;
	}
	$scope.isSelected = function( item ) {
		return (item.id == background.id)? "item-selected": "";
	}

}])

angular.module('app')


.controller('backgroundStoreCtrl', ["$scope", "$state", "Backgrounds", "strings", "$ionicPopup", "$ionicLoading", "User", function($scope, $state, Backgrounds, strings, $ionicPopup, $ionicLoading, User) {
  $scope.strings = strings;
  var background = {id: -1};
  User.me("subscribe", update);
  update();
  function update() {
      Backgrounds.current().then(function(pack) {
        background = pack;
        $scope.$apply();
      });
      Backgrounds.all().then(function(list) {
        $scope.backgrounds = list;
        $scope.$apply();
      });
  }
	$scope.select = function(item) {
    $ionicLoading.show();
		Backgrounds.purchase(item).then(function () {
      update();
      $ionicLoading.hide();
    }, function () {
      $ionicLoading.hide();
    });
	}
	$scope.isSelected = function( item ) {
		return (item.id == background.id)? "item-selected": "";
	}

}])

angular.module('app')


.controller('EnterLocationCtrl', ["$scope", "$state", "LocationService", "Geocode", function($scope, $state, LocationService, Geocode ) {
  $scope.location = "";
  $scope.allowGeolocation = LocationService("allowed auto define");
  $scope.userLocations = LocationService("user locations");
  $scope.addLocation = function(loc) {
    Geocode(loc).then(
      function (location) {
        $scope.userLocations = LocationService("user locations", location);
        $scope.$apply();
      },
      function (err) {
          throw err;
      }
    );
  }
  $scope.isSelected = function(item) {
    return LocationService("is current", item)? "item-selected": "";
  }
  $scope.remove = function(item) {
    $scope.userLocations = LocationService("remove user location", item);
  }
  $scope.select = function(item) {
    LocationService("current location", item);
  }
}])

angular.module('app')

   
.controller('errorCtrl', ["$scope", function($scope) {

}])
   
angular.module('app')

.controller('GetStartedCtrl', ["$scope", "$state", "UserData", "$ionicLoading", function($scope, $state, UserData, $ionicLoading) {
  $scope.$on("$ionicView.enter", function() {
    var target = (UserData())? "app.forecast.current" : "welcome";
    $state.go(target);
  })
}])

angular.module('app')

.controller('HourlyForecastCtrl', ["$scope", "$rootScope", "$state", "$ionicLoading", "$ionicPopup", "Weather", "LocationService", "Emojy", function($scope, $rootScope, $state, $ionicLoading, $ionicPopup, Weather, LocationService, Emojy) {
	$ionicLoading.show();
	Emojy.subscribe(load);
	LocationService("subscribe", load);
	LocationService("define location").then(successLocationRequest, errorLocationRequest);
	$scope.$on('$stateChangeSuccess', function(event, toState, toParams, fromState, fromParams) {
		if(toState.name == "app.forecast.hourly") {
			$rootScope.mainPage = true;
			$ionicLoading.show();
			load();
			setTimeout(load, 60*60*1000);
		}
	});
	function load() {
		successLocationRequest(LocationService("current location"));
	}
	function successLocationRequest(location) {
		Weather(location, "hourly").then(successWeatherRequest, errorWeatherRequest);
	}
	function errorLocationRequest(error) {
		$ionicLoading.hide();
		throw error;
	}

	function successWeatherRequest(weather) {
		$ionicLoading.hide();
		$scope.hourlyForecast = sortByDays(weather);
	}
	function sortByDays(weather) {
		var sorted = {};
		for(var i = 0; i < weather.length; i++) {
			if(i == 24) break;
			var value = weather[i];
			var key = moment(value.date).format("dddd");
			sorted[key] = sorted[key] || [];
			sorted[key].push(value);
		}
		return sorted;
	}
	function errorWeatherRequest(error) {
		$ionicPopup.alert({title: "Error", template: "Cannot get weather. " + error});
		$ionicLoading.hide();
	}

}])

angular.module('app')


.controller('loginCtrl', ["$scope", "$state", "Background", "UserDataVerify", "strings", "$ionicPopup", "UserData", function($scope, $state, Background, UserDataVerify, strings, $ionicPopup, UserData) {
	$scope.strings = strings;
	Background.setup($scope, $state);
	$scope.user = {
		name: "",
    username: "",
    password: "",
    confirmPassword: "",

		location: {
			state: "",
			country: "",
			city: ""
		}
	}
	$scope.submit = function() {
    UserDataVerify($scope.user).then(success, error);
		function success() {
			UserData($scope.user);
			$state.go("preview");
		}
		function error(e) {
			$ionicPopup.alert({title: "Warning", template: e})
		}
	}
}])

angular.module('app')

.controller('mainCtrl', ["$scope", "$rootScope", "$state", "$ionicLoading", "LocationService", "Weather", "$ionicPopup", "Emojy", function($scope, $rootScope, $state, $ionicLoading, LocationService, Weather, $ionicPopup, Emojy) {
		var updater;
		var needCheckLocation = true;
		$scope.$on("$ionicView.enter", locationRequest);
		LocationService("subscribe", load);
		Emojy.subscribe(load);
		function load() {
			successLocationRequest(LocationService("current location"));
		}
		function locationRequest() {
				if(!needCheckLocation) return;
				$ionicLoading.show();
				var location = LocationService("current location")
				if(location) {
					successLocationRequest(location)
				} else {
					LocationService("define location").then(
						function(location) {
							successLocationRequest(location);
						},
						function(err) {
							$ionicLoading.hide();
							$ionicPopup.alert({title: "Warning!", template: "There is not some user location info"});
							$state.go('app.changeLocation');
						}
					);
				}
		}
		function successLocationRequest(location) {
			needCheckLocation = false;
			Weather(location, "hourly").then(successWeatherRequest, errorWeatherRequest);
			if(updater) clearTimeout(updater);
			updater = setTimeout(load, 60*60*1000);
		}

		function requireLocation(err) {
			var title = "Error!";
			var template = "Cannot define your geoposition. " + err;
			$ionicPopup.alert({title: title, template: template});
		}

		function successWeatherRequest(weather) {
			$rootScope.location = LocationService("current location");
			$scope.weather = weather;
			$scope.$apply();
			$ionicLoading.hide();
		}

		function errorWeatherRequest(error) {
			console.log(JSON.stringify(error));
			$ionicPopup.alert({title: "Error", template: "Cannot get weather. " + error});
			$ionicLoading.hide();
		}
}])

angular.module('app')


.controller('ProfileCtrl', ["$scope", "$state", "UserDataVerify", "$ionicPopup", "User", "strings", "$ionicLoading", function($scope, $state, UserDataVerify, $ionicPopup, User, strings, $ionicLoading) {
	reload();
	User.me("subscribe", reload);
	function reload() {
			var user = User.me();
			if(user) {
				$scope.user = {
			    name: user.name,
			    email: user.email,
					avatar: user.avatar,
			    password: "",
			    confirmPassword: "",
					OAuth: user.OAuth || false
			  };
			}
	}
	$scope.getAvatar = function() {
		$ionicLoading.show();
		User.me("select avatar").then(function(response) {
			$ionicLoading.hide();
		}, function (err) {
			$ionicLoading.hide();
			$ionicPopup.alert({
				title: "Error", template: "Could nod upload image"
			});
			console.error(err);
		});
	}
  $scope.save = function() {
		$ionicLoading.show();
    var userData = $scope.user;
		User.me("edit", userData).then(function(response) {
			$ionicLoading.hide();
		}, function (err) {
			$ionicLoading.hide();
			$ionicPopup.alert({
				title: "Error", template: err.join(",")
			});
		});
  }

}])

angular.module('app')

.controller('SignInCtrl', ["$scope", "$state", "User", "Emojy", "Backgrounds", "$ionicLoading", "$ionicPopup", function($scope, $state, User, Emojy, Backgrounds, $ionicLoading, $ionicPopup) {
  $scope.userData = {
    email: "admin@admin.com",
    password: "admin"
  }
	$scope.someParam = "param1";
  $scope.signIn = function() {
    $ionicLoading.show();
    User.signIn($scope.userData).then(
      function() {
        $state.go("app.forecast.current");
        $ionicLoading.hide();
      },
      function(err) {
        $ionicLoading.hide();
        $ionicPopup.alert({title: "Error", template: err});
      }
    );
  }
}]);

angular.module('app')

.controller('SingUpCtrl', ["$scope", "$state", "$ionicPopup", "$ionicLoading", "LocationService", "Geocode", "SignUp", function($scope, $state, $ionicPopup, $ionicLoading, LocationService, Geocode, SignUp) {
  $ionicLoading.show();

  $scope.userData = {
    name: "",
    email: "",
    password: "",
    confirmPassword: ""
  };

  LocationService("define location").then(
    function(loc) {
      $ionicLoading.hide();
      $scope.location = loc.city + ", " + loc.state + ", " + loc.country;
    },
    function (err) {
      $ionicLoading.hide();
      $ionicPopup.alert({title: "Warning", template: "Cannot difine your location"});
    }
  );


  $scope.setLocation = function(loc) {
    Geocode(loc).then(
      function (location) {
        LocationService("user locations", location);
      },
      function (err) {
          $ionicPopup.alert({title: "Error", template: "Location is required"});
      }
    );
  }



  $scope.signUp = function() {
    SignUp("email", $scope.userData).then(
      function (response) {
        $state.go("signIn");
      },
      function (err) {
        $ionicPopup.alert({title: "Error", template: err});
      }
    );
  }
}])

angular.module('app')


.controller('StickersSelectionCtrl', ["$scope", "$state", "strings", "Emojy", "User", function($scope, $state, strings, Emojy, User) {
	var emojy;
	update();
  User.me("subscribe", update);
	function update() {
			Emojy.available().then(function(list) {
				$scope.stickers = list;
				$scope.$apply();
			})
			Emojy.current().then(function(pack) {
				emojy = pack;
				$scope.$apply();
			});
	}
	Emojy.subscribe(update);
	$scope.select = function(item) {
		emojy = item;
		Emojy.current(item);
	}
	$scope.isSelected = function( item ) {
		if(!emojy || item.id != emojy.id) return "";
		return "item-selected";
	}

}])

angular.module('app')


.controller('StickersStoreCtrl', ["$scope", "$state", "strings", "Emojy", "$ionicPopup", "$ionicLoading", "User", function($scope, $state, strings, Emojy, $ionicPopup, $ionicLoading, User) {
	var emojy;
	update();
  User.me("subscribe", update);
	function update() {
		Emojy.all().then(function(list) {
			$scope.stickers = list;
			$scope.$apply();
		})
		Emojy.current().then(function(pack) {
			emojy = pack;
			$scope.$apply();
		});
	}
	$scope.select = function(item) {
		$ionicLoading.show();
		Emojy.purchase(item).then(function() {
			update();
			$ionicLoading.hide();
		}, function () {
			$ionicLoading.hide();
		});
	}

}])

angular.module('app')

.controller('WeeklyForecastCtrl', ["$scope", "$rootScope", "$state", "$ionicLoading", "$ionicPopup", "LocationService", "Weather", "Emojy", function($scope, $rootScope, $state, $ionicLoading, $ionicPopup, LocationService, Weather, Emojy) {

	$ionicLoading.show();
	Emojy.subscribe(load);
	LocationService("subscribe", load);
	LocationService("define location").then(successLocationRequest, errorLocationRequest);
	$scope.$on('$stateChangeSuccess', function(event, toState, toParams, fromState, fromParams) {
		if(toState.name == "app.forecast.weekly") {
			$ionicLoading.show();
			load();
			setTimeout(load, 60*60*1000);
		}
	});

	function load() {
			successLocationRequest(LocationService("current location"));
	}
	function successLocationRequest(location) {
		Weather(location, "forecast10day").then(successWeatherRequest, errorWeatherRequest);
	}
	function errorLocationRequest(error) {
		$ionicLoading.hide();
		throw error;
	}

	function successWeatherRequest(weather) {
		$ionicLoading.hide();
		$scope.forecast = weather;
		$scope.moment = moment;
	}

	function errorWeatherRequest(error) {
		$ionicPopup.alert({title: "Error", template: "Cannot get weather. " + error});
		$ionicLoading.hide();
	}

}])

angular.module('app')

.controller('WelcomePageCtrl', ["$scope", "$state", "User", "$ionicPopup", function($scope, $state, User, $ionicPopup) {
  $scope.logInWith = function(service) {
    User.signIn(service).then(
      function( response ) {
        console.log(response);
        $state.go("app.forecast.current");
      },
      function ( err ) {
        $ionicPopup.alert({
          title: "Warning",
          template: JSON.stringify(err)
        });
      }
    );
  }
}])

angular.module('app')


.controller('mapCtrl', ["$scope", "$state", "Map", "LocationService", "Emojy", "$ionicLoading", "$ionicPopup", function($scope, $state, Map, LocationService, Emojy, $ionicLoading, $ionicPopup) {
  var needCheckLocation = true;
  var map;
  $scope.findLocation = function(location) {
    address = location;
    map = Map('map-canvas', address);
  }
  $scope.location = "";
  $scope.$on("$ionicView.enter", function () {
    if(!needCheckLocation) return;
    var location = LocationService("current location");
    if(location) $scope.findLocation (location);
    else {
      $ionicLoading.show();
      LocationService("define location").then($scope.findLocation,
        function(err) {
          $ionicLoading.hide();
          $ionicPopup.alert({title: "Warning!", template: "There is not some user location info"});
          $state.go('app.changeLocation');
        }
      );
    }

  });
  Emojy.subscribe(function () {
    map.reset();
  });
  function getAdress(location) {
  		var address = [location.country, location.state, location.city].join(", ");
  		return address;
  }
}])

angular.module('app')


.controller('purchaseAdsCtrl', ["$scope", "$state", "Ads", "$ionicLoading", function($scope, $state, Ads, $ionicLoading) {
  $scope.purchased = Ads.purchased();
  $scope.purchase = function() {
    $ionicLoading.show();
    Ads.purchase().then(function() {
      $ionicLoading.hide();
      $scope.purchased = Ads.purchased();
    }, function () {
      $ionicLoading.hide();
    });
  }
}])

angular.module('app')

.service('Ads', ["AuthorizedRequest", "Purchase", "EndPoints", function(AuthorizedRequest, Purchase, EndPoints) {
  var id;
  var subscribers = [];

	return {
    get: get,
    purchase: purchase,
    subscribe: subscribe,
    purchased: purchased
  }
  function subscribe(subscriber) {
    subscribers.push(subscriber);
  }
  function purchased () {
    return localStorage.ew_ads_purchased;
  }
  function purchase() {
    return new Promise(function(resolve, reject) {
        Purchase('com.rhinoda.weatherwiggy.removeads').then(
          function() {
            localStorage.ew_ads_purchased = "yes";
            apply();
            resolve();
          },
          function(err) {
            console.error(err);
            reject();
          }
        );
    });
  }
  function apply() {
    subscribers.forEach(function(subscriber) {  subscriber()  });
  }
  function get() {
    return new Promise(function(resolve, reject) {
        if(localStorage.ew_ads_purchased) {
          apply();
          return;
        }
        AuthorizedRequest("GET", EndPoints.action('get-advertising') + getParams()).then(success, reject);

        function getParams() {
          return (id)? "?current_ad_id=" + id : "";
        }

        function success(response) {
          id = response.id;
          resolve(response.html);
        }
    });
  }
}]);

angular.module('app')

.service('Backgrounds', ["Pack", "User", "EndPoints", function(Pack, User, EndPoints) {

  var backgrounds = Pack(
    {
      available: 'get-bought-background-packs',
      name: 'backrounds-pack',
      all: 'get-all-background-packs',
      purchase: 'purchase-background-pack'
    });

  backgrounds.image = function (pack) {
    var token = User.me().token;
    return EndPoints.action('get-background') + getQueryParams();

    function getQueryParams() {
    	var times = ["night", "morning", "day", "evening"];
    	var hour = new Date().getHours() - 2;
    	var devider = 24 / times.length;
    	var index = Math.floor(hour / devider);
      try {
          return "?background_pack_id="+pack.id+"&time_of_day="+times[index]+"&token="+token;
        } catch (e) {
          return "";
        }
      }
    }

  return backgrounds;
}]);

angular.module('app')

.service('Emojy', ["Pack", "User", "EndPoints", function(Pack, User, EndPoints) {
  var emojy = Pack({
      available: 'get-bought-icon-packs',
      all: 'get-all-icon-packs',
      name: 'icons-pack',
      purchase: 'purchase-icon-pack'
    });

  emojy.image = function (pack, weather, type) {
  		var token = User.me().token;
      type = type || "wunderground";
  		return EndPoints.action(type+'/get-icons') + getQueryParams();

  		function getQueryParams() {
        var params = {
          "wunderground" : wundergroundAMPM,
          "open-weather-map" : openWeatherMapAMPM
        }
        try {
  			     return "?condition=" + (weather.condition || weather.conditions).split(' ').join('_') +
             "&icon_pack_id="+pack.id +"&ampm="+params[type]()+"&token="+token;
        } catch (e) {
          return "";
        }

          function openWeatherMapAMPM() {
            return weather.ampm;
          }
          function wundergroundAMPM() {
            var date = new Date(weather.date);
            date.setHours(date.getHours() + 2);
            return moment(date).format('A');
          }
  		}
	}
  return emojy;
}]);

angular.module('app')

.service('EndPoints', ["config", function(config) {
	var EndPoints = {
		action: action,
		url: url
	}
	return EndPoints;
	function url(url) {
		return config.server + url;
	}
	function action (point) {
		return config.server + 'api/' + point;
	}


}])

angular.module('app')

.service('Geocode', function() {
	var requiredFields = {
		"country" : "country",
		"administrative_area_level_1": "state",
		"locality": "city",
		"administrative_area_level_2": "district"
	};

	return function(attr) {
		return new Promise(function(resolve, reject) {
				var location = {};
				configureAttr();
				var geocoder = new google.maps.Geocoder();
				geocoder.geocode(attr, useGeocode);

				function useGeocode(results, status) {
					 if (status === google.maps.GeocoderStatus.OK) {
						 getInfoFromGeocodes(results);
						 if(!location.city) location.city = location.district;
	 					 resolve(location);
					 } else {
						 reject('Geocode was not successful for the following reason: ' + status)
					 }
				}

				function getInfoFromGeocodes(results) {
					for(var i = 0; i < results.length; i++) {
						getInfoFromGeocode(results[i]);
					}
				}

				function getInfoFromGeocode(code) {
					if(!location.location && code.geometry) location.location = code.geometry.location;
					for(var j = 0; j < code.types.length; j++) {
						var type = code.types[j];
						if(code.address_components) {
							getInfoFromGeocodes(code.address_components);
							return;
						}
						if (!requiredFields[type]) continue;
						var value = code;
						setLocationInfo(type, value);
					}
				}

				function setLocationInfo(type, value) {
					var locationInfoType = requiredFields[type];
					location[locationInfoType] = value.long_name;
				}

				function configureAttr() {
					if(!attr) return;
					if(typeof attr == "string") {
						attr = {
							address: attr
						}
						return;
					}
					if(attr.location) {
						if(typeof attr.location == "object") {
							var lat = +attr.location.lat;
							var lng = +attr.location.lng;
							attr = {
								location: new google.maps.LatLng(lat, lng)
							}
						}
					} else {
						if(attr.description) {
							attr = {
								address: attr.description
							}
						}
					}
				}

			});
		}
})

angular.module('app')

.service('Language', function() {
    var _language = localStorage.ew_language || 'en';
    return function(language) {
      if(!language) {
        return _language;
      }
      _language = language.toLowerCase();
      localStorage.ew_language = _language;
    }
});

angular.module('app')

.service('LocationService', ["LocationAutoDefine", function(LocationAutoDefine) {


	var requiredFields = {
		"country" : "country",
		"administrative_area_level_1": "state",
		"sublocality": "city"
	};
	var subscribers = [];
	var services = {
		"allowed auto define": allowedAutoDefineService,
		"define location": defineLocationService,
		"current location": myLocationService,
		"user locations": userLocationsService,
		"remove user location": removeUserLocationService,
		"is current": isCurrent,
		"subscribe": subscribe
	}
	function subscribe(subscriber) {
		subscribers.push(subscriber);
	}
	return function(name, value) {
		var service = getService(name);
		return service(value);
	}

	function getService(name) {
		var service = services[name];
		if(!service) throw "There is not requested service";
		return service;
	}
	function defineLocationService(value) {
		return defineLocation();
	}
	function allowedAutoDefineService(value) {
		if(localStorage.ew_autodefine === undefined) localStorage.ew_autodefine = true;
		return apply(localStorage, "ew_autodefine", value);
	}

	function myLocationService(value) {
		if(value) return setUserLocation(value);
		return getUserLocation();
	}

	function apply(source, key, value) {
		if(value !== undefined) {
			source[key] = value;
		} else {
			return source[key];
		}
	}

	function defineLocation() {
		return new Promise(function(resolve, reject) {
				var location = getUserLocation();
				if(location) {
					resolve(location);
					return;
				}
				LocationAutoDefine().then(successLocationDefine, errorLocationDefine);
				var rejected;
				var timeOut = setTimeout(function(){
					errorLocationDefine("Location service do not responce");
				}, 30000)
				function successLocationDefine(location) {
						setUserLocation(location);
						resolve(location);
				}

				function errorLocationDefine(error) {
						reject(error);
				}
			}
		);
	}

	function userLocationsService(value) {
		if(value) {
			return setUserLocation(value);
		} else {
			return getUserLocations();
		}
	}
	function setUserLocation(value) {
		localStorage.ew_current_location = JSON.stringify(value);
		var locations = getUserLocations();
		subscribers.forEach(function(subscriber) {
			subscriber();
		});
		if(~indexOf(locations, value)) return locations;
		locations.push(value);
		localStorage.ew_user_locations = JSON.stringify(locations);
		return locations;
	}
	function getUserLocation() {
		var value = localStorage.ew_current_location;
		if(value)	return JSON.parse(value);
	}
	function removeUserLocationService(value) {
		var locations = getUserLocations();
		var index = indexOf(locations, value);
		if(index < 0) return locations;
		locations.splice(index, 1);
		localStorage.ew_user_locations = JSON.stringify(locations);
		return locations;
	}
	function indexOf(locations, value) {
		var result = -1;
		locations.forEach(function(element, index) {
			if (isEqual(element, value)) result = index;
		});
		return result;
	}
	function getUserLocations() {
		var locations = localStorage.ew_user_locations;
		if(!locations) return [];
		return JSON.parse(locations);
	}

	function isCurrent(value) {
		var stored = localStorage.ew_current_location;
		if(!stored) return false;
		var location = JSON.parse(stored);
		return isEqual(value, location);
	}

	function isEqual(a, b) {
		if(!a || !b) return false;
		var result = true;
		["city", "country", "state"].forEach(function(element){
			if(a[element] != b[element]) result = false;
		});
		return result;
	}
}])

angular.module('app')

.service('LocationAutoDefine', ["$cordovaGeolocation", "Geocode", function($cordovaGeolocation, Geocode) {
	var requiredFields = {
		"country" : "country",
		"administrative_area_level_1": "state",
		"sublocality": "city"
	};

	return function() {
		return new Promise(function(resolve, reject) {
			try {
				autoDefineLocation();

				function autoDefineLocation() {
					$cordovaGeolocation.getCurrentPosition().then(defineLocationByCoords, geolocationError);
				}

				function defineLocationByCoords(position) {
					var latLng = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);
					var geocoder = new google.maps.Geocoder();
					Geocode({'location': latLng}).then(
						function(location) {
							resolve(location);
						},
					 	function(err){
							reject(err);
						});
				}

				function geolocationError(err) {
					reject(err.message);
				}

			} catch (e) {
				reject(e);
			}
		});
	}


}])

angular.module('app')

.service('SignIn', ["UserDataVerify", "UserData", "Location", function(UserDataVerify, UserData, Location) {

    return function(userInfo) {
        if(typeof userInfo == "string") {

        } else
        return new Promise(function(resolve, reject) {
            UserData(userInfo);
            Location(userInfo.location);
            resolve();

          function error(e) {
            reject(e);
          }
        });

    }
}]);

angular.module('app')
.service('Map', ["$http", "config", "Geocode", "EndPoints", "AuthorizedRequest", "Emojy", function($http, config, Geocode, EndPoints, AuthorizedRequest, Emojy) {
	var requestTimeout;
	return function(canvas, address) {
			var map;
			Geocode(address).then(useGeocode)
			return {
				reset: function() {
					map.reset();
				}
			}
			function useGeocode(geocode) {
				position = geocode.location;
				if(map) {
					map.center = position;
				} else {
					initialize(position);
				}
			}
	  	function initialize(position) {
		  	var geoJSON;
		  	var request;
		  	var gettingData = false;
		  	var openWeatherMapKey = config.openWeatherApiKey;
		    canvas = document.getElementById(canvas);

				createNativeMap();

				function createNativeMap() {
						map = new google.maps.Map(canvas,  {
							zoom: 8,
							center: position
						});
						google.maps.event.addListener(map, 'idle', checkIfDataRequested);
						map.reset = function() {
							reset();
							getCoords();
						}
				}

		    function checkIfDataRequested() {
					if(requestTimeout) return;
				while (gettingData === true) {
      				gettingData = false;
    			}
    			getCoords();
  			};

  			function getCoords() {
			    var bounds = map.getBounds();
			    var NE = bounds.getNorthEast();
			    var SW = bounds.getSouthWest();
					getWeather(NE.lat(), NE.lng(), SW.lat(), SW.lng());
  			};

  			function getWeather(northLat, eastLng, southLat, westLng) {
			    gettingData = true;
					var requestString = EndPoints.action("get-forecast-cities-within-rectangle-zone") +
						"?lon_left=" + westLng +
						"&lat_bottom=" + southLat +
						"&lon_right="+ eastLng+
						"&lat_top="+ northLat +
						"&zoom=" + map.getZoom();
						AuthorizedRequest("GET", requestString).then(success, error);

			    function success(response) {
						console.log(JSON.stringify(response));
						Emojy.current().then(
							function (pack) {
						    	var results = response;
									reset();
							    if (results.length > 0) {
							        for (var i = 0; i < results.length; i++) {
							          jsonToGeoJson(results[i], pack)
							        }
							    }
							},
							function (err) {
								throw err;
							}
						);

			    }

			    function error() {

			    }
  			};
				var markers = [];
  			function jsonToGeoJson(weatherItem, pack) {
					var icon = weatherItem.weather[0].icon;
					var ampm = {"d":"PM", "n":"AM"}[icon.substr(icon.length - 1, 1)];
					var image = {
						  url: Emojy.image(
								pack,
								{
									ampm: ampm,
									condition: weatherItem.weather[0].main
								},
								'open-weather-map'
							),
						  size: new google.maps.Size(60, 60),
						  origin: new google.maps.Point(0, 0),
						  anchor: new google.maps.Point(30, 30),
						  scaledSize: new google.maps.Size(60, 60)
						};

					var marker = new google.maps.Marker({
            position: {lat: weatherItem.coord.lat, lng: weatherItem.coord.lon},
            map: map,
            icon: image,
						optimized: false
          });
					markers.push(marker);
					element = "<div class = 'city-weather blank'>"
					$(canvas).append(element);
					var feature = event.feature;
					[
						{name: "City", value: weatherItem.name},
						{name: "Weather", value: weatherItem.weather[0].main},
						{name: "Temperature", value: weatherItem.main.temp + "&deg;C"},
						{name: "Pressure", value: weatherItem.main.pressure+ "hb"},
						{name: "Humidity", value: weatherItem.main.humidity+"%"},
						{name: "Wind Speed", value: weatherItem.wind.speed+"m/s"},
						{name: "Wind Degree", value: weatherItem.wind.deg + "&deg;"},
					].forEach(function(item) {
						element += "<div>"+item.name +" : "+item.value+"</div>";
					});
					element += "</div>"

					var infowindow = new google.maps.InfoWindow({
						content: element
					});
					google.maps.event.addDomListener(marker, "mousedown", function() {
						clearTimeout(requestTimeout);
						requestTimeout = setTimeout(function() {
							requestTimeout = null;
						}, 10*1000);
	          infowindow.open(map, marker);
					});

			}

			function reset() {
				markers.forEach(function(marker) {
					marker.setMap(null);
				});
				markers = [];
			}

		}
	}
}]);

angular.module('app')

.service('Pack', ["EndPoints", "AuthorizedRequest", "SingleRequest", "Purchase", "User", function(EndPoints, AuthorizedRequest, SingleRequest, Purchase, User) {
  return function(options) {
    var pack;
    var subscribers = [];
    var required = [
      {name: 'available', message: "Available packs action required"},
      {name: 'all', message: "All packs action required"},
      {name: 'name', message: "Name required"},
      {name: 'purchase', message: "Purchase action required"}];

    required.forEach(function(requirement) {
      if(!options[requirement.name]) throw requirement.message;
    })
    var lists = {};
    User.me("subscribe", function() {
          pack = null;
          lists = {};
    });
    var request = new SingleRequest();
    return {
      all: function() {
        return list(options.all);
      },
      available: function() {
        return list(options.available);
      },
      current: current,
      subscribe: subscribe,
      purchase: purchase
    }

    function subscribe(subscriber) {
      subscribers.push(subscriber);
    }

      function list(action) {
        return new Promise(
          function(resolve, reject) {

            if(lists[action]) {
              resolve(lists[action]);
              return;
            }

                var url = EndPoints.action(action);
                AuthorizedRequest("GET", url).then(
                    function(response) {
                      var packsList = [];
                      for(var field in response) {
                        var item = response[field];
                        if(Array.isArray(item)) {
                            item.forEach(function(item) {
                              var pack = {
                                name: item.name,
                                id: item.id,
                                picture: EndPoints.url(item.preview_img),
                              }
                              if(typeof item.cost != "undefined") pack.cost = item.cost;
                              if(typeof item.available != "undefined") pack.available = +item.available;
                              if(typeof item.sku != "undefined") pack.sku = item.sku;
                              packsList.push(pack);
                            });
                        }
                      }
                      lists[action] = packsList;
                      resolve(packsList);
                    },

                    function (err) {
                      reject(err);
                    }
                );
          }
        );
      }

      var currentPack;
      function current( data ) {
        if(typeof data == "undefined") {
          return getCurrentPack();
        } else {
          setCurrentPack(data);
        }

        function getCurrentPack() {
            return new Promise(function(resolve, reject) {
              if(currentPack) {
                resolve(currentPack);
                return;
              }

              list(options.available).then(
                function( list ) {
                  var packName = localStorage[options.name] || "Default";

                  list.forEach(function(item) {
                      if(packName == item.name) pack = item;
                  });

                  setCurrentPack(pack);
                  resolve(pack);
                },
                reject
              );
            });
          }

          function setCurrentPack(pack) {
            if(!pack) return;
            currentPack = pack;
            localStorage[options.name] = pack.name;
            apply();
          }


      }
      function apply() {
          subscribers.forEach(function(subscriber) {
            subscriber();
          });
      }
      function purchase( item ) {
          return new Promise(function(resolve, reject) {
                Purchase(item.sku).then( sendAboutPurchase, reject);

                function sendAboutPurchase() {
                    AuthorizedRequest("POST", url(), {sku: item.sku}).then(managePurchased, reject);

                    function url() {
                        return EndPoints.action(options.purchase);
                    }
                }

                function managePurchased() {
                    var all = lists[options.all];
                    var index = all.indexOf(item);
                    all.splice(index, 1);
                    lists[options.available].push(item);
                    apply();
                    resolve();
                }
          });


      }
  }
}]);

angular.module('app')

.service('PickImage', ["$cordovaCamera", "AuthData", "$cordovaImagePicker", function($cordovaCamera, AuthData, $cordovaImagePicker) {
	return function(success, error) {
		var options = {
		 maximumImagesCount: 1,
		 width: 400,
		 height: 400,
		 quality: 30
		};

		$cordovaImagePicker.getPictures(options)
			.then(
				function (results) {
					success(results[0])
				},
				function(err){
					error("Cannot load image")
				});
		}
}]);

angular.module('app')

.service('SingleRequest', function() {
  return function() {
    var waiting = [];
    var processor;

    this.send = function(request) {
      return new Promise(function (resolve, reject) {
        waiting.push({resolve: resolve, reject: reject});
        if(processor) return;
        processor = setTimeout(function() {
          request().then(
            function (response) {
              apply('resolve', response);
            },
            function (err) {
              apply('reject', err);
            });
        });
      });

      function apply(action, response) {
        processor = null;
        var processing = waiting;
        waiting = [];

        processing.forEach(
          function(handler) {
            handler[action](response);
          });
        }
      }
    }
  });

angular.module('app')

.service('Stickers', function() {
	var _stickers;
	var _sticker;
  load();

	return {
		list: list,
		isSelected: isSelected,
    select: select
	}
  function select(item) {
    _sticker = item;
  }
	function list() {
		return _stickers;
	}
	function load(success, error) {
    var url = "https://encrypted-tbn1.gstatic.com/images?q=tbn:ANd9GcSRSYuCu2hZSQTjWdW3BYQ43uZPYovKNVcuG7yQaIUlFvudvpbR";
  	var pack1 = {name: "magic stricker pack", price: 0.99, image: url};
  	var pack2 = {name: "magic stricker pack", price: 0.99, image: url};
  	var pack3 = {name: "magic stricker pack", price: 0.99, image: url};
  	var pack4 = {name: "magic stricker pack", price: 0.99, image: url};
  	var pack5 = {name: "magic stricker pack", price: 0.99, image: url};
  	var pack6 = {name: "magic stricker pack", price: 0.99, image: url};
    _stickers = [pack1, pack2, pack3, pack4, pack5, pack6];
    _sticker = pack1;
	}

	function isSelected (item) {
		return _sticker === item;
	}
});

angular.module('app')

.service('Subscription', function( ) {
  return function() {
    return new Subscription();

    function Subscription() {
      this.subscribers = [];
      this.subscribe = function(subscriber) {
        this.subscribers.push(subscriber);
      }
      this.send = function() {
        this.subscribers.forEach(function(subscriber) {
          subscriber();
        });
      }
    }
  }
});

angular.module('app')

.service('UploadImage', ["$cordovaImagePicker", "$cordovaFileTransfer", "EndPoints", "$ionicLoading", "config", "$timeout", function($cordovaImagePicker, $cordovaFileTransfer, EndPoints, $ionicLoading, config,  $timeout) {
	return function(customOptions) {
		return new Promise(function(resolve, reject) {
				if(!device) {
					reject({text: "err"});
					return;
				}
				$cordovaImagePicker.getPictures(config.pickedImage).then(
					function(uri) {
						uri = uri[0];
						var options = new FileUploadOptions();
						options.fileKey = 'file';
						options.fileName = getFileName(uri);
						options.mimeType = 'image/jpeg';
						if(customOptions) {
								for (var variable in customOptions) {
									if (customOptions.hasOwnProperty(variable)) {
										options[variable] = customOptions[variable];
									}
								}						}
						var transfer = new FileTransfer();



						$ionicLoading.show();
							transfer.upload(uri, EndPoints.action('upload-avatar'), success, error, options);
						function success(response) {
							$ionicLoading.hide();
							if(response.responseCode != 200) {
								error(response);
							}
							var uri = JSON.parse(response.response).avatar_url;
							if(uri[0] == '/') uri = uri.substr(1, uri.length);
							resolve(uri);
						}
						function error(err) {
							$ionicLoading.hide();
							alert(JSON.stringify(err));
							reject(err)
						}
						function progress(progress) {
        			$timeout(function () {
          			alert(progress.loaded / progress.total) * 100;
        			});
      			}

					},
					function(err) {
						reject(err);
					}
				)
			});

			function getFileName(uri) {
				var start = uri.lastIndexOf('/') + 1;
				var length = uri.length - start;
				return uri.substr(start, length);
			}
	}
}])

angular.module('app')

.service('UserDataVerify', ["strings", function(strings) {
    return function (data, required) {
        var alerts = [exists, empty, password];
        return new Promise(function(resolve, reject) {
          for(var i = 0; i < alerts.length; i++) {
            var alert = alerts[i]();
            if (alert) {
              reject(alert);
            }
          }
          resolve();
        });

        function exists() {
          if(!data) {
            return strings("needsUserInfo");
          }
        }
        function empty() {
          for(var i = 0; i < required.length; i++) {
            var field = required[i];
            var value = data[field];
            if(!value || !value.length) {
              return strings(field)+strings('isRequired');
            }
          }
        }

        function password() {
          if(!data.password || data.password !== data.confirmPassword) {
            return "Password not confirmed";
          }
        }
    }
}]);

angular.module('app')

.service('config', ["$ionicPlatform", function($ionicPlatform) {
  var platform = "browser";
  if(window.cordova) {
  	["ios", "android", "browser"].forEach(function(item) {
      if($ionicPlatform.is(item)) platform = item;
  	});
  }
	return {
		openWeatherApiKey: "7d7815cd5721b778c79d97dff92ea533",
		wundergroundApiKey: "a7f3e44e9dfd4036",
		server: "http://weather.rhinoda.ru/",
		facebookAppId: '998953410224967',
		facbookAppSecret: '7865d4c46ebef4a8bbea3ef8dd245272',
		googleAppKey : {
      "ios": '302892683317-4608t711qkgohlg20qa89egdal1gvgmp.apps.googleusercontent.com',
      "android": '302892683317-k2oupm4a6bpbjaha2j4rqds7ts14lgae.apps.googleusercontent.com',
      "browser": '302892683317-7abkar3075t8g9hiie06l0fgmr6u6stt.apps.googleusercontent.com'
    }["browser"],
		twitterAppId: "9wg1OLo2jXnj9Y6foOsxKAQWT",
		twitterAppSecret: "VZaId0DpPla0oLSyaALKnW7K7J5WGYnK7hHoeajY2s64JHvWyZ",
		twitterAccessToken: "756094328909471744-vD011XrPTUeGlTKxio2FGgQkzz8vEig",
		twitterAccessTokenSecret: "	bxL20muzOBQEZF6Hqan0DKOiB3Yzu1ZonmQJ25WrrtHSz",
		oauthRedirectURL: 'http://localhost:8100/oauthcallback.html',
		oauthProxy: 'https://auth-server.herokuapp.com/proxy',
		pickedImage: {
		 maximumImagesCount: 1,
		 width: 400,
		 height: 400,
		 quality: 30
		}
	}
}])

angular.module('app')

.service('strings', ["Language", function(Language) {
  var languages = {
    en: {
      "owerview": "Overview",
      "summary": "_____________________\n ________________________\n  Summary\n _____________________\n ________________________\n ",
      "features-title": "Features",
      "features": [
        "Animated Weather gadget changes with weather conditions,Up to date weather forecast",
        "Date/Time",
        "Hourly/Weekly forecast",
        "Weather tracking",
        "Atmospheric pressure",
        "Add your location",
        "Search weather if different locations"],
      "user-state-placeholder": "State",
      "user-country-placeholder": "Country",
      "user-city-placeholder": "City",
      "needsUserInfo": "Some userinfo is required",
      "isRequired": " is required",
      "username": "Username",

      "name": "Name",
      "email": "email",
      "confirm-password": "Confirm password",
      "password": "Password",
      "location": "Location",
      "submit": "Submit",
      "edit": "Edit",
      "preview": "Preview",
      ".overview": "Touch screen to start using",
      ".login-data": "Enter data to presentation",
      "#preview-button": "Touch to preview",
      "#login-button": "Register this data",
      "#edit-button": "You can change this data",
      "#menu-button": "To get more options go to menu",
      ".linear-hourly-forecast": "Houry forecast",
      "hello": "Hello",
      "wellcome": "Wellcome",
      "menu": "Menu",
      "search": "Search",
      "weekly forecast": "Weekly forecast",
      "hourly forecast": "Hourly forecast",
      "map": "Map",
      "background": "Background",
      "search location": "Search location",
      "Monday": "Monday",
      "Tuesday": "Tuesday",
      "Wednesday": "Wednesday",
      "Thursday": "Thursday",
      "Friday": "Friday",
      "Saturday": "Saturday",
      "Sunday": "Sunday",
      "upload background": "Upload your background"

    },
    ru: {
      "owerview": "",
      "summary": "_____________________\n ________________________\n  \n _____________________\n ________________________\n ",
      "features-title": "",
      "features": [
        " ,   ",
        "/",
        "/ ",
        " ",
        " ",
        "  ",
        "    "],
      "user-state-placeholder": "",
      "user-country-placeholder": "",
      "user-city-placeholder": "",
      "needsUserInfo": "  ",
      "isRequired": " ",
      "username": " ",
      "name": "",
      "confirm-password": " ",
      "password": "",
      "submit": "",
      "edit": "",
      "preview": "",
      ".overview": "     ",
      ".login-data": " ,      ",
      "#preview-button": "  ",
      "#login-button": "  ",
      "#edit-button": "  ",
      "#menu-button": "      ",
      ".linear-hourly-forecast": " ",
      "hello": "",
      "wellcome": " ",
      "menu": "",
      "search": "",
      "weekly forecast": " ",
      "hourly forecast": " ",
      "map": "",
      "background": "",
      "search location": "  ",
      "Monday": "",
      "Tuesday": "",
      "Wednesday": "",
      "Thursday": "",
      "Friday": "",
      "Saturday": "",
      "Sunday": "",
      "upload background": "    "

    }
  }
  return function(string) {
    if(string) {
      var strings = languages[Language()];
      return strings[string];
    } else {
      return languages;
    }
  }
}]);

angular.module('app')

.service('AndroidBilling', function() {
  var purchases;

  if((isPluginAvailabel())) {
      init();
  } else {
    console.error("plugin not availabel");
    return;
  }
  return {
    buy: buy,
    purchases: purchases
  }
  function isPluginAvailabel() {
    return window.device && device.platform == "Android" && typeof inappbilling !== "undefined";
  }
  function init() {
      inappbilling.init(success, error);

      function success( response ) {
        purchases().then(function(response) {
          console.log("Android in-app billing initialized success");
        }, function (err) {
          console.log("Android in-app billing initialize fail occured");
        });
      }

      function error(err) {
        alert(JSON.stringify(err))
      }
  }
  function purchases() {
    return new Promise(function(resolve, reject) {
        if(purchases) {
          resolve(purchases);
          return;
        }
        inappbilling.getPurchases(success, error);

        function success(response) {
          resolve(response);
        }

        function error(err) {
          reject(err);
        }

    });
  }
  function getPurchases() {


    function success(response) {
      alert("PURCHASES " + JSON.stringify(response));
    }

    function error(err) {
      alert(JSON.stringify(err))
    }
  }

  function buy(sku) {
    return new Promise(function (resolve, reject) {
        inappbilling.consumePurchase(function() {
          inappbilling.buy(success, fail, sku);
        }, function() {
          inappbilling.buy(success, fail, sku);
        }, sku)

        function success(response) {
          resolve(response);
        }
        function fail(err) {
          reject(err);
        }
    });
  }


});

angular.module('app')

.service('Purchase', ["AuthorizedRequest", "EndPoints", "AndroidBilling", "StroreKit", "$ionicPlatform", function(AuthorizedRequest, EndPoints, AndroidBilling, StroreKit, $ionicPlatform) {
  var native;
  return function(id) {
    if(!window.device) {
      return new Promise(function (resolve, reject) {
        resolve("success");
        return;
      });

    }


      if($ionicPlatform.is('Android')) {
        native = AndroidBilling;
      }
      if($ionicPlatform.is('iOS')) {
        native = StoreKit;
      }

    return native.buy(id);

  }

}]);

angular.module('app')

.service('StroreKit', function() {
  var purchaseProcess;
  if((isPluginAvailabel())) {
      init();
  } else {
    console.error("plugin not availabel");
    return;
  }
  var success;
  var error;

  return {
    buy: buy
  }

  function isPluginAvailabel() {
    return window.device && device.platform == "iOS" && typeof storekit !== "undefined";
  }
  function init() {
    storekit.init({
        debug:    true,
        ready:    function() {
        },
        purchase: function(transactionId, productId, receipt) {
          console.log("Purchased product id " + productId);
          success(productId);
        },
        restore:  function(transactionId, productId, transactionReceipt) {
          console.log("Restored product id" +productId+ "purchase")
        },
        error:    function(errorCode, errorMessage) {
          console.log("ERROR: " + errorMessage);
          error(errorMessage);
        }
      })
    }


  function buy() {
    return new Promise(function(resolve, reject) {
        storekit.purchase('default_background_pack');
        success = resolve;
        error = reject;
    });
  }

});

angular.module('app')

.service('SignIn', ["EmailLogIn", "OAuth", function(EmailLogIn,  OAuth) {
  return function( data) {
    return (typeof data == "string")? OAuth(data) : EmailLogIn(data);
  }
}]);

angular.module('app')

.service('SignUp', ["EmailSignUp", function( EmailSignUp ) {
  return function(type, data) {
    var services = {
      email: EmailSignUp
    }
    return new Promise(services[type](data));
  }
}]);

angular.module('app')

.service('User', ["SignIn", "SignUp", "UserData", "EndPoints", function(SignIn, SignUp, UserData, EndPoints) {
  return {
    signIn: signIn,
    signUp: signUp,
    logOut: logOut,
    me: UserData
  }

  function signIn(data) {
    return new Promise(
      function( resolve, reject ) {
        SignIn(data).then(
          function( response ) {
            UserData(response);
            resolve(response);
          },
          function (error ) {
            reject(error);
          }
        );
      }
    );
  }

  function signUp() {
    return new Promise(
      function(resolve, reject) {
        SignUp()
      }
    );
  }
  function logOut() {
    return new Promise(function (resolve, reject) {
      UserData("reset");
      resolve();
    });
  }

}]);

angular.module('app')

.service('UserData', ["UploadImage", "EndPoints", "config", function(UploadImage, EndPoints, config) {
  var subscribers = [];
	var commands = {
		"reset": reset,
		"select avatar": selectAvatar,
		"subscribe": subscribe,
		"edit": edit
	}
	return function(data) {
		if(data) {
			if(typeof data === "string") {
				return command.apply(this, arguments);
			} else {
				setData(data);
			}
		} else {
			user = getData();
			return user;
		}
	}

	function getData() {
		var userInfo = localStorage.ew_user;
		if(userInfo && userInfo != "undefined") {
			return JSON.parse(userInfo);
		}
	}
	function setData(data) {
		localStorage.ew_user = JSON.stringify(data);
		apply();
	}

	function command(commandName) {
		var action = commands[commandName];
		if(action) {
			var args = [];
			for(var i = 1; i < arguments.length; i++) args.push(arguments[i]);
			return action.apply(this, args);
		}
	}

	function reset() {
		localStorage.removeItem("ew_user");
	}
	function edit(newUserData) {
		return new Promise(function(resolve, reject) {
				$.ajax({
						method: "POST",
						url: EndPoints.action('edit-profile'),
						success: function(response) {
							if(response.status != "success") {
								var errors = [];
								for(var field in response.errors ) {
									response.errors[field].forEach(function(error) {
											switch(error) {
													case "email_id_required": {
														errors.push("Please type valid email");
														break;
													};
													case "email_is_not_valid" : {
														errors.push("Please type valid email");
														break;
													}
													case "passwords_do_not_match":
														errors.push("Passwords do not match");
														break;
											}
									});
								};
								reject(errors);
								return;
							}
							for(var field in {name: newUserData.name, email: newUserData.email, password: newUserData.password}) {
								if(newUserData[field] && user[field] != newUserData[field]) user[field] = newUserData[field];
							}
							setData(user);
							resolve("success");
						},
						data: {
							name: newUserData.name,
							email: newUserData.email,
							new_password: newUserData.password,
							confirm_password: newUserData.confirmPassword
						},
						error: function(err) {
							console.error(err);
							reject(["Internal Server Error"])
						},
						beforeSend: function(xhr) {
								xhr.setRequestHeader ("Authorization", "Bearer "+ user.token);
						}
					});
		});
	}
	function subscribe(subscriber) {
		subscribers.push(subscriber);
	}
	function apply() {
		subscribers.forEach(function(subscriber) {
			subscriber();
		});
	}
  function selectAvatar() {
		return new Promise(function(resolve, reject) {
				UploadImage( {headers : {
					"Authorization": "Bearer "+ user.token
				}}).then(
					function(uri) {
						user.avatar  = config.server + uri;
            console.log(user.avatar);
            setData(user);
		        subscribers.forEach(function(subscriber) {
		          subscriber();
		        });
						resolve("success");
					},
					reject
				);

		});
  }
}])

angular.module('app')
.service('AuthorizedRequest', ["User", "EndPoints", "SingleRequest", "$window", "$state", "$ionicLoading", function(User, EndPoints, SingleRequest, $window, $state, $ionicLoading) {

  var request = new SingleRequest();
  var waitings = [];
  var processor;

  return function(method, url, data) {
    return new Promise(function(resolve, reject) {

      sendRequest(resolve, analize);

      function sendRequest(success, error) {
        	$.ajax({
              method: method,
        		  url: url,
        			success: success,
              data: data,
        			error: error,
        			beforeSend: function(xhr) {
        					xhr.setRequestHeader ("Authorization", "Bearer "+ User.me().token);
        			}
          	});
      }

      function analize(err) {

        if(err.status != 401) {
          apply("reject", err);
          return;
        }
        waitings.push(function() {
          sendRequest(resolve, reject);
        });
        if(processor) return;
        refresh();

      }

      function apply() {
        var processing = waitings;
        processor = false;
        waitings = [];
        processing.forEach(function(handler) {
          handler();
        });
      }
      function refresh() {
            processor = true;
            setTimeout(function() {
              processor = false;
            }, 60*1000);
            var user = User.me();
            $.ajax({
                method: "POST",
                url: EndPoints.action('refresh') + "?token="+User.me().token,
                success: function(response) {
                  user.token = response.token;
                  User.me(user);
                  apply();

                },
                error: function(err) {
                  processor = false;
                  $ionicLoading.hide();
                  User.signIn(user).then(function() {
                    apply();
                  }, function () {
                    $state.go("signIn");
                  });
                },
                beforeSend: function(xhr) {
                    xhr.setRequestHeader ("Authorization", "Bearer "+ User.me().token);
                }
              });
              //$window.location.reload(true);
      }
    });
  }
}]);

angular.module("app")

.service('Hourly', function() {
  return {
    adapter: adapter
  }

  function adapter(pack, response ) {

          var items = response = JSON.parse(response);
          var result = [];
          if(!items) {
              reject(response);
              return;
          }
          items.forEach(function(item) {
              var forecast = getForecastItem(item);
              result.push(forecast);
          });
          return result;

      function getForecastItem(item) {
        item = {
          temp: +item.temp,
          condition: item.condition.replace(/_/g, ' '),
          date: new Date( item.date.replace(' ', 'T') ),
          feelsLike: +item.feelslike,
          humidity: item.humidity,
          wind: {
            speed: item.wind.speed,
            direction: getWindDirection()
          }
        }
        return item;
        function getWindDirection() {
          var directions = {
            'N': 'Nord',
            'W': 'West',
            'S': 'South',
            'E': 'East'
          }
          var res = "";
          var dir = item.wind.direction.dir;
          for(var i = 0; i < dir.length; i++) {
            res += directions[dir[i]] + ' ';
          }
          return {
            degrees: item.wind.direction.deg,
            name: res.trim()
          }
        }
      }
  }
});

angular.module('app')
.service('Weather', ["AuthorizedRequest", "EndPoints", "Hourly", "Weekly", "Emojy", function(AuthorizedRequest, EndPoints, Hourly, Weekly, Emojy) {
	var adapters = {
		"hourly10day": Hourly.adapter,
		"hourly": Hourly.adapter,
		"forecast10day": Weekly.adapter
	}
	var cache = {};
	return function weather(location, query) {
		return new Promise(function(resolve, reject) {
			Emojy.current().then(function(emojyPack) {
				var url = weatherQuery(location, query);
				var record = cache[query];
				if(record && url === record.url) success(record.response);
				AuthorizedRequest("GET", url ).then(
					function (response) {
						if(~response.indexOf("error")) {
							reject("Invalid location");
							return;
						}
						var result = adapters[query](emojyPack, response);
							cache[query] = {
								url: url,
								response: result
							}
							setTimeout(function() {
								cache = [];
							}, 60*60*1000);
						success(result);
					},
					function(e) {
						if(e.error) {
							reject(e.error.description)
						} else {
							reject("Geo info is not enough");
						}
					});
					function success(result){
						result.forEach(function(weather) {
							weather.icon = Emojy.image(emojyPack, weather);
						});
						resolve(result);
						return;
					}
			});
		});


		function weatherQuery(location, query) {

				var queryParams = getQueryParams();
				var url = EndPoints.action(query)+queryParams;
					return url;

					function getQueryParams() {
						location = location.location;
						var result = "?lat="+location.lat+"&lng="+location.lng;
						return encodeURI(result);
				}
		}
	}
}])

angular.module("app")

.service('Weekly', ["EndPoints", "User", function(EndPoints, User) {
  return {
    adapter: adapter
  }

  function adapter( pack, response ) {

    var result = [];
    var forecast = JSON.parse(response);
    for(var i = 0; i < forecast.length; i++) {
      var item = forecast[i];
      result[i] = getForecastItem(item);
    }
    return result;


      function getForecastItem(item) {
        item = {
          temp: {
            high: +item.temp.high,
            low: +item.temp.low
          },
          condition: item.conditions.replace(/_/g, ' '),
          date: new Date( item.date + 'T12:00:00')
        }
        return item;
      }
  }
}]);

angular.module('app')

.service('EmailLogIn', ["$http", "EndPoints", "config", function($http, EndPoints, config) {
  return function (data) {
    return new Promise(function(resolve, reject) {
      $.ajax({
          method: "POST",
          dataType: "json",
          data: data,
          crossDomain: true,
          url: EndPoints.action('authenticate'),
          success: success,
          error: error
      });
      function success ( response ) {
        var user = response.user;
        resolve ({
          email: data.email,
          password: data.password,
          avatar: config.server + user.avatar_url,
          name: user.name,
          token: response.token
        });
      }
      function error ( err ) {
        var message;
        message = (err.status == 401)?
          "Invalid username or password" :
          "Invalid request";
        reject( message );
      }
    });
  }
}]);

angular.module('app')

.service('EmailSignUp', ["$http", "EndPoints", "UserDataVerify", function($http, EndPoints, UserDataVerify) {
  return function (data) {
    return function(resolve, reject) {
      UserDataVerify(data, ["name", "email", "password"]).then(signUp, reject);

      function signUp() {
        $.ajax({
          method: "POST",
          data: data,
          crossDomain: true,
          url: EndPoints.action('register'),
          success: success,
          error:  error
        });

        function success( response ) {
            if(response && response.error) {
              error(response.error);
            } else {
              resolve();
            }
        }

        function error( err ) {
            var message = getErrorMessage();
            reject( message );

            function getErrorMessage() {
                var message = "";
                for(var key in err) {
                    var issue = "";
                    var issues = err[key];
                    for(var i = 0; i < issues.length; i++) {
                        issue += issues[i] + "\n";
                    }
                    message += issue + "\n";
                }
                return message;
            }
        }
      }
    }
  }
}]);

angular.module('app')

.run(["$ionicPlatform", "config", function($ionicPlatform, config) {
    hello.init({
    	'twitter' : config.twitterAppId,
      'facebook': config.facebookAppId,
      'google': config.googleAppKey
    },
    {
      oauth_proxy : config.oauthProxy,
      response_type: 'token',
      oauth_version: '2.0a',
      redirect_uri: "http://adodson.com/hello.js/redirect.html"
    });
}])

.service('OAuth', ["config", "EndPoints", function(config, EndPoints) {
  return function ( network ) {
    return new Promise(
      function (resolve, reject) {
          var service = hello(network);
          service.login({scope: "email"}).then(function(response) {
              response = response.authResponse;
              var access_token = response.access_token;
              console.log(JSON.stringify(response));
              $.ajax({
                  method: "POST",
                  url: EndPoints.action(network+'-authentication'),
                  data: {
                    "access_token": access_token
                  },
                    success: function(response) {
                      var user = response.user;
                      resolve ({
                          email: user.email,
                          avatar: config.server + user.avatar_url,
                          name: user.name,
                          token: response.token,
                          OAuth: true
                      });
                    },
                    error: reject
              });
          });

      }
    );
  }
}]);

/*! hellojs v1.13.3 | (c) 2012-2016 Andrew Dodson | MIT https://adodson.com/hello.js/LICENSE */
// ES5 Object.create
if (!Object.create) {

	// Shim, Object create
	// A shim for Object.create(), it adds a prototype to a new object
	Object.create = (function() {

		function F() {}

		return function(o) {

			if (arguments.length != 1) {
				throw new Error('Object.create implementation only accepts one parameter.');
			}

			F.prototype = o;
			return new F();
		};

	})();

}

// ES5 Object.keys
if (!Object.keys) {
	Object.keys = function(o, k, r) {
		r = [];
		for (k in o) {
			if (r.hasOwnProperty.call(o, k))
				r.push(k);
		}

		return r;
	};
}

// ES5 [].indexOf
if (!Array.prototype.indexOf) {
	Array.prototype.indexOf = function(s) {

		for (var j = 0; j < this.length; j++) {
			if (this[j] === s) {
				return j;
			}
		}

		return -1;
	};
}

// ES5 [].forEach
if (!Array.prototype.forEach) {
	Array.prototype.forEach = function(fun/*, thisArg*/) {

		if (this === void 0 || this === null) {
			throw new TypeError();
		}

		var t = Object(this);
		var len = t.length >>> 0;
		if (typeof fun !== 'function') {
			throw new TypeError();
		}

		var thisArg = arguments.length >= 2 ? arguments[1] : void 0;
		for (var i = 0; i < len; i++) {
			if (i in t) {
				fun.call(thisArg, t[i], i, t);
			}
		}

		return this;
	};
}

// ES5 [].filter
if (!Array.prototype.filter) {
	Array.prototype.filter = function(fun, thisArg) {

		var a = [];
		this.forEach(function(val, i, t) {
			if (fun.call(thisArg || void 0, val, i, t)) {
				a.push(val);
			}
		});

		return a;
	};
}

// Production steps of ECMA-262, Edition 5, 15.4.4.19
// Reference: http://es5.github.io/#x15.4.4.19
if (!Array.prototype.map) {

	Array.prototype.map = function(fun, thisArg) {

		var a = [];
		this.forEach(function(val, i, t) {
			a.push(fun.call(thisArg || void 0, val, i, t));
		});

		return a;
	};
}

// ES5 isArray
if (!Array.isArray) {

	// Function Array.isArray
	Array.isArray = function(o) {
		return Object.prototype.toString.call(o) === '[object Array]';
	};

}

// Test for location.assign
if (typeof window === 'object' && typeof window.location === 'object' && !window.location.assign) {

	window.location.assign = function(url) {
		window.location = url;
	};

}

// Test for Function.bind
if (!Function.prototype.bind) {

	// MDN
	// Polyfill IE8, does not support native Function.bind
	Function.prototype.bind = function(b) {

		if (typeof this !== 'function') {
			throw new TypeError('Function.prototype.bind - what is trying to be bound is not callable');
		}

		function C() {}

		var a = [].slice;
		var f = a.call(arguments, 1);
		var _this = this;
		var D = function() {
			return _this.apply(this instanceof C ? this : b || window, f.concat(a.call(arguments)));
		};

		C.prototype = this.prototype;
		D.prototype = new C();

		return D;
	};

}

/**
 * @hello.js
 *
 * HelloJS is a client side Javascript SDK for making OAuth2 logins and subsequent REST calls.
 *
 * @author Andrew Dodson
 * @website https://adodson.com/hello.js/
 *
 * @copyright Andrew Dodson, 2012 - 2015
 * @license MIT: You are free to use and modify this code for any use, on the condition that this copyright notice remains.
 */

var hello = function(name) {
	return hello.use(name);
};

hello.utils = {

	// Extend the first object with the properties and methods of the second
	extend: function(r /*, a[, b[, ...]] */) {

		// Get the arguments as an array but ommit the initial item
		Array.prototype.slice.call(arguments, 1).forEach(function(a) {
			if (Array.isArray(r) && Array.isArray(a)) {
				Array.prototype.push.apply(r, a);
			}
			else if (r instanceof Object && a instanceof Object && r !== a) {
				for (var x in a) {
					r[x] = hello.utils.extend(r[x], a[x]);
				}
			}
			else {

				if (Array.isArray(a)) {
					// Clone it
					a = a.slice(0);
				}

				r = a;
			}
		});

		return r;
	}
};

// Core library
hello.utils.extend(hello, {

	settings: {

		// OAuth2 authentication defaults
		redirect_uri: window.location.href.split('#')[0],
		response_type: 'token',
		display: 'popup',
		state: '',

		// OAuth1 shim
		// The path to the OAuth1 server for signing user requests
		// Want to recreate your own? Checkout https://github.com/MrSwitch/node-oauth-shim
		oauth_proxy: 'https://auth-server.herokuapp.com/proxy',

		// API timeout in milliseconds
		timeout: 20000,

		// Popup Options
		popup: {
			resizable: 1,
			scrollbars: 1,
			width: 500,
			height: 550
		},

		// Default scope
		// Many services require atleast a profile scope,
		// HelloJS automatially includes the value of provider.scope_map.basic
		// If that's not required it can be removed via hello.settings.scope.length = 0;
		scope: ['basic'],

		// Scope Maps
		// This is the default module scope, these are the defaults which each service is mapped too.
		// By including them here it prevents the scope from being applied accidentally
		scope_map: {
			basic: ''
		},

		// Default service / network
		default_service: null,

		// Force authentication
		// When hello.login is fired.
		// (null): ignore current session expiry and continue with login
		// (true): ignore current session expiry and continue with login, ask for user to reauthenticate
		// (false): if the current session looks good for the request scopes return the current session.
		force: null,

		// Page URL
		// When 'display=page' this property defines where the users page should end up after redirect_uri
		// Ths could be problematic if the redirect_uri is indeed the final place,
		// Typically this circumvents the problem of the redirect_url being a dumb relay page.
		page_uri: window.location.href
	},

	// Service configuration objects
	services: {},

	// Use
	// Define a new instance of the HelloJS library with a default service
	use: function(service) {

		// Create self, which inherits from its parent
		var self = Object.create(this);

		// Inherit the prototype from its parent
		self.settings = Object.create(this.settings);

		// Define the default service
		if (service) {
			self.settings.default_service = service;
		}

		// Create an instance of Events
		self.utils.Event.call(self);

		return self;
	},

	// Initialize
	// Define the client_ids for the endpoint services
	// @param object o, contains a key value pair, service => clientId
	// @param object opts, contains a key value pair of options used for defining the authentication defaults
	// @param number timeout, timeout in seconds
	init: function(services, options) {

		var utils = this.utils;

		if (!services) {
			return this.services;
		}

		// Define provider credentials
		// Reformat the ID field
		for (var x in services) {if (services.hasOwnProperty(x)) {
			if (typeof (services[x]) !== 'object') {
				services[x] = {id: services[x]};
			}
		}}

		// Merge services if there already exists some
		utils.extend(this.services, services);

		// Update the default settings with this one.
		if (options) {
			utils.extend(this.settings, options);

			// Do this immediatly incase the browser changes the current path.
			if ('redirect_uri' in options) {
				this.settings.redirect_uri = utils.url(options.redirect_uri).href;
			}
		}

		return this;
	},

	// Login
	// Using the endpoint
	// @param network stringify       name to connect to
	// @param options object    (optional)  {display mode, is either none|popup(default)|page, scope: email,birthday,publish, .. }
	// @param callback  function  (optional)  fired on signin
	login: function() {

		// Create an object which inherits its parent as the prototype and constructs a new event chain.
		var _this = this;
		var utils = _this.utils;
		var error = utils.error;
		var promise = utils.Promise();

		// Get parameters
		var p = utils.args({network: 's', options: 'o', callback: 'f'}, arguments);

		// Local vars
		var url;

		// Get all the custom options and store to be appended to the querystring
		var qs = utils.diffKey(p.options, _this.settings);

		// Merge/override options with app defaults
		var opts = p.options = utils.merge(_this.settings, p.options || {});

		// Merge/override options with app defaults
		opts.popup = utils.merge(_this.settings.popup, p.options.popup || {});

		// Network
		p.network = p.network || _this.settings.default_service;

		// Bind callback to both reject and fulfill states
		promise.proxy.then(p.callback, p.callback);

		// Trigger an event on the global listener
		function emit(s, value) {
			hello.emit(s, value);
		}

		promise.proxy.then(emit.bind(this, 'auth.login auth'), emit.bind(this, 'auth.failed auth'));

		// Is our service valid?
		if (typeof (p.network) !== 'string' || !(p.network in _this.services)) {
			// Trigger the default login.
			// Ahh we dont have one.
			return promise.reject(error('invalid_network', 'The provided network was not recognized'));
		}

		var provider = _this.services[p.network];

		// Create a global listener to capture events triggered out of scope
		var callbackId = utils.globalEvent(function(str) {

			// The responseHandler returns a string, lets save this locally
			var obj;

			if (str) {
				obj = JSON.parse(str);
			}
			else {
				obj = error('cancelled', 'The authentication was not completed');
			}

			// Handle these response using the local
			// Trigger on the parent
			if (!obj.error) {

				// Save on the parent window the new credentials
				// This fixes an IE10 bug i think... atleast it does for me.
				utils.store(obj.network, obj);

				// Fulfill a successful login
				promise.fulfill({
					network: obj.network,
					authResponse: obj
				});
			}
			else {
				// Reject a successful login
				promise.reject(obj);
			}
		});

		var redirectUri = utils.url(opts.redirect_uri).href;

		// May be a space-delimited list of multiple, complementary types
		var responseType = provider.oauth.response_type || opts.response_type;

		// Fallback to token if the module hasn't defined a grant url
		if (/\bcode\b/.test(responseType) && !provider.oauth.grant) {
			responseType = responseType.replace(/\bcode\b/, 'token');
		}

		// Query string parameters, we may pass our own arguments to form the querystring
		p.qs = utils.merge(qs, {
			client_id: encodeURIComponent(provider.id),
			response_type: encodeURIComponent(responseType),
			redirect_uri: encodeURIComponent(redirectUri),
			state: {
				client_id: provider.id,
				network: p.network,
				display: opts.display,
				callback: callbackId,
				state: opts.state,
				redirect_uri: redirectUri
			}
		});

		// Get current session for merging scopes, and for quick auth response
		var session = utils.store(p.network);

		// Scopes (authentication permisions)
		// Ensure this is a string - IE has a problem moving Arrays between windows
		// Append the setup scope
		var SCOPE_SPLIT = /[,\s]+/;

		// Include default scope settings (cloned).
		var scope = _this.settings.scope ? [_this.settings.scope.toString()] : [];

		// Extend the providers scope list with the default
		var scopeMap = utils.merge(_this.settings.scope_map, provider.scope || {});

		// Add user defined scopes...
		if (opts.scope) {
			scope.push(opts.scope.toString());
		}

		// Append scopes from a previous session.
		// This helps keep app credentials constant,
		// Avoiding having to keep tabs on what scopes are authorized
		if (session && 'scope' in session && session.scope instanceof String) {
			scope.push(session.scope);
		}

		// Join and Split again
		scope = scope.join(',').split(SCOPE_SPLIT);

		// Format remove duplicates and empty values
		scope = utils.unique(scope).filter(filterEmpty);

		// Save the the scopes to the state with the names that they were requested with.
		p.qs.state.scope = scope.join(',');

		// Map scopes to the providers naming convention
		scope = scope.map(function(item) {
			// Does this have a mapping?
			return (item in scopeMap) ? scopeMap[item] : item;
		});

		// Stringify and Arrayify so that double mapped scopes are given the chance to be formatted
		scope = scope.join(',').split(SCOPE_SPLIT);

		// Again...
		// Format remove duplicates and empty values
		scope = utils.unique(scope).filter(filterEmpty);

		// Join with the expected scope delimiter into a string
		p.qs.scope = scope.join(provider.scope_delim || ',');

		// Is the user already signed in with the appropriate scopes, valid access_token?
		if (opts.force === false) {

			if (session && 'access_token' in session && session.access_token && 'expires' in session && session.expires > ((new Date()).getTime() / 1e3)) {
				// What is different about the scopes in the session vs the scopes in the new login?
				var diff = utils.diff((session.scope || '').split(SCOPE_SPLIT), (p.qs.state.scope || '').split(SCOPE_SPLIT));
				if (diff.length === 0) {

					// OK trigger the callback
					promise.fulfill({
						unchanged: true,
						network: p.network,
						authResponse: session
					});

					// Nothing has changed
					return promise;
				}
			}
		}

		// Page URL
		if (opts.display === 'page' && opts.page_uri) {
			// Add a page location, place to endup after session has authenticated
			p.qs.state.page_uri = utils.url(opts.page_uri).href;
		}

		// Bespoke
		// Override login querystrings from auth_options
		if ('login' in provider && typeof (provider.login) === 'function') {
			// Format the paramaters according to the providers formatting function
			provider.login(p);
		}

		// Add OAuth to state
		// Where the service is going to take advantage of the oauth_proxy
		if (!/\btoken\b/.test(responseType) ||
		parseInt(provider.oauth.version, 10) < 2 ||
		(opts.display === 'none' && provider.oauth.grant && session && session.refresh_token)) {

			// Add the oauth endpoints
			p.qs.state.oauth = provider.oauth;

			// Add the proxy url
			p.qs.state.oauth_proxy = opts.oauth_proxy;

		}

		// Convert state to a string
		p.qs.state = encodeURIComponent(JSON.stringify(p.qs.state));

		// URL
		if (parseInt(provider.oauth.version, 10) === 1) {

			// Turn the request to the OAuth Proxy for 3-legged auth
			url = utils.qs(opts.oauth_proxy, p.qs, encodeFunction);
		}

		// Refresh token
		else if (opts.display === 'none' && provider.oauth.grant && session && session.refresh_token) {

			// Add the refresh_token to the request
			p.qs.refresh_token = session.refresh_token;

			// Define the request path
			url = utils.qs(opts.oauth_proxy, p.qs, encodeFunction);
		}
		else {
			url = utils.qs(provider.oauth.auth, p.qs, encodeFunction);
		}

		// Broadcast this event as an auth:init
		emit('auth.init', p);

		// Execute
		// Trigger how we want self displayed
		if (opts.display === 'none') {
			// Sign-in in the background, iframe
			utils.iframe(url, redirectUri);
		}

		// Triggering popup?
		else if (opts.display === 'popup') {

			var popup = utils.popup(url, redirectUri, opts.popup);
			var timer = setInterval(function() {
				if (!popup || popup.closed) {
					clearInterval(timer);
					if (!promise.state) {

						var response = error('cancelled', 'Login has been cancelled');

						if (!popup) {
							response = error('blocked', 'Popup was blocked');
						}

						response.network = p.network;

						promise.reject(response);
					}
				}
			}, 100);
		}

		else {
			window.location = url;
		}

		return promise.proxy;

		function encodeFunction(s) {return s;}

		function filterEmpty(s) {return !!s;}
	},

	// Remove any data associated with a given service
	// @param string name of the service
	// @param function callback
	logout: function() {

		var _this = this;
		var utils = _this.utils;
		var error = utils.error;

		// Create a new promise
		var promise = utils.Promise();

		var p = utils.args({name:'s', options: 'o', callback: 'f'}, arguments);

		p.options = p.options || {};

		// Add callback to events
		promise.proxy.then(p.callback, p.callback);

		// Trigger an event on the global listener
		function emit(s, value) {
			hello.emit(s, value);
		}

		promise.proxy.then(emit.bind(this, 'auth.logout auth'), emit.bind(this, 'error'));

		// Network
		p.name = p.name || this.settings.default_service;
		p.authResponse = utils.store(p.name);

		if (p.name && !(p.name in _this.services)) {

			promise.reject(error('invalid_network', 'The network was unrecognized'));

		}
		else if (p.name && p.authResponse) {

			// Define the callback
			var callback = function(opts) {

				// Remove from the store
				utils.store(p.name, null);

				// Emit events by default
				promise.fulfill(hello.utils.merge({network:p.name}, opts || {}));
			};

			// Run an async operation to remove the users session
			var _opts = {};
			if (p.options.force) {
				var logout = _this.services[p.name].logout;
				if (logout) {
					// Convert logout to URL string,
					// If no string is returned, then this function will handle the logout async style
					if (typeof (logout) === 'function') {
						logout = logout(callback, p);
					}

					// If logout is a string then assume URL and open in iframe.
					if (typeof (logout) === 'string') {
						utils.iframe(logout);
						_opts.force = null;
						_opts.message = 'Logout success on providers site was indeterminate';
					}
					else if (logout === undefined) {
						// The callback function will handle the response.
						return promise.proxy;
					}
				}
			}

			// Remove local credentials
			callback(_opts);
		}
		else {
			promise.reject(error('invalid_session', 'There was no session to remove'));
		}

		return promise.proxy;
	},

	// Returns all the sessions that are subscribed too
	// @param string optional, name of the service to get information about.
	getAuthResponse: function(service) {

		// If the service doesn't exist
		service = service || this.settings.default_service;

		if (!service || !(service in this.services)) {
			return null;
		}

		return this.utils.store(service) || null;
	},

	// Events: placeholder for the events
	events: {}
});

// Core utilities
hello.utils.extend(hello.utils, {

	// Error
	error: function(code, message) {
		return {
			error: {
				code: code,
				message: message
			}
		};
	},

	// Append the querystring to a url
	// @param string url
	// @param object parameters
	qs: function(url, params, formatFunction) {

		if (params) {

			// Set default formatting function
			formatFunction = formatFunction || encodeURIComponent;

			// Override the items in the URL which already exist
			for (var x in params) {
				var str = '([\\?\\&])' + x + '=[^\\&]*';
				var reg = new RegExp(str);
				if (url.match(reg)) {
					url = url.replace(reg, '$1' + x + '=' + formatFunction(params[x]));
					delete params[x];
				}
			}
		}

		if (!this.isEmpty(params)) {
			return url + (url.indexOf('?') > -1 ? '&' : '?') + this.param(params, formatFunction);
		}

		return url;
	},

	// Param
	// Explode/encode the parameters of an URL string/object
	// @param string s, string to decode
	param: function(s, formatFunction) {
		var b;
		var a = {};
		var m;

		if (typeof (s) === 'string') {

			formatFunction = formatFunction || decodeURIComponent;

			m = s.replace(/^[\#\?]/, '').match(/([^=\/\&]+)=([^\&]+)/g);
			if (m) {
				for (var i = 0; i < m.length; i++) {
					b = m[i].match(/([^=]+)=(.*)/);
					a[b[1]] = formatFunction(b[2]);
				}
			}

			return a;
		}
		else {

			formatFunction = formatFunction || encodeURIComponent;

			var o = s;

			a = [];

			for (var x in o) {if (o.hasOwnProperty(x)) {
				if (o.hasOwnProperty(x)) {
					a.push([x, o[x] === '?' ? '?' : formatFunction(o[x])].join('='));
				}
			}}

			return a.join('&');
		}
	},

	// Local storage facade
	store: (function() {

		var a = ['localStorage', 'sessionStorage'];
		var i = -1;
		var prefix = 'test';

		// Set LocalStorage
		var localStorage;

		while (a[++i]) {
			try {
				// In Chrome with cookies blocked, calling localStorage throws an error
				localStorage = window[a[i]];
				localStorage.setItem(prefix + i, i);
				localStorage.removeItem(prefix + i);
				break;
			}
			catch (e) {
				localStorage = null;
			}
		}

		if (!localStorage) {

			var cache = null;

			localStorage = {
				getItem: function(prop) {
					prop = prop + '=';
					var m = document.cookie.split(';');
					for (var i = 0; i < m.length; i++) {
						var _m = m[i].replace(/(^\s+|\s+$)/, '');
						if (_m && _m.indexOf(prop) === 0) {
							return _m.substr(prop.length);
						}
					}

					return cache;
				},

				setItem: function(prop, value) {
					cache = value;
					document.cookie = prop + '=' + value;
				}
			};

			// Fill the cache up
			cache = localStorage.getItem('hello');
		}

		function get() {
			var json = {};
			try {
				json = JSON.parse(localStorage.getItem('hello')) || {};
			}
			catch (e) {}

			return json;
		}

		function set(json) {
			localStorage.setItem('hello', JSON.stringify(json));
		}

		// Check if the browser support local storage
		return function(name, value, days) {

			// Local storage
			var json = get();

			if (name && value === undefined) {
				return json[name] || null;
			}
			else if (name && value === null) {
				try {
					delete json[name];
				}
				catch (e) {
					json[name] = null;
				}
			}
			else if (name) {
				json[name] = value;
			}
			else {
				return json;
			}

			set(json);

			return json || null;
		};

	})(),

	// Create and Append new DOM elements
	// @param node string
	// @param attr object literal
	// @param dom/string
	append: function(node, attr, target) {

		var n = typeof (node) === 'string' ? document.createElement(node) : node;

		if (typeof (attr) === 'object') {
			if ('tagName' in attr) {
				target = attr;
			}
			else {
				for (var x in attr) {if (attr.hasOwnProperty(x)) {
					if (typeof (attr[x]) === 'object') {
						for (var y in attr[x]) {if (attr[x].hasOwnProperty(y)) {
							n[x][y] = attr[x][y];
						}}
					}
					else if (x === 'html') {
						n.innerHTML = attr[x];
					}

					// IE doesn't like us setting methods with setAttribute
					else if (!/^on/.test(x)) {
						n.setAttribute(x, attr[x]);
					}
					else {
						n[x] = attr[x];
					}
				}}
			}
		}

		if (target === 'body') {
			(function self() {
				if (document.body) {
					document.body.appendChild(n);
				}
				else {
					setTimeout(self, 16);
				}
			})();
		}
		else if (typeof (target) === 'object') {
			target.appendChild(n);
		}
		else if (typeof (target) === 'string') {
			document.getElementsByTagName(target)[0].appendChild(n);
		}

		return n;
	},

	// An easy way to create a hidden iframe
	// @param string src
	iframe: function(src) {
		this.append('iframe', {src: src, style: {position:'absolute', left: '-1000px', bottom: 0, height: '1px', width: '1px'}}, 'body');
	},

	// Recursive merge two objects into one, second parameter overides the first
	// @param a array
	merge: function(/* Args: a, b, c, .. n */) {
		var args = Array.prototype.slice.call(arguments);
		args.unshift({});
		return this.extend.apply(null, args);
	},

	// Makes it easier to assign parameters, where some are optional
	// @param o object
	// @param a arguments
	args: function(o, args) {

		var p = {};
		var i = 0;
		var t = null;
		var x = null;

		// 'x' is the first key in the list of object parameters
		for (x in o) {if (o.hasOwnProperty(x)) {
			break;
		}}

		// Passing in hash object of arguments?
		// Where the first argument can't be an object
		if ((args.length === 1) && (typeof (args[0]) === 'object') && o[x] != 'o!') {

			// Could this object still belong to a property?
			// Check the object keys if they match any of the property keys
			for (x in args[0]) {if (o.hasOwnProperty(x)) {
				// Does this key exist in the property list?
				if (x in o) {
					// Yes this key does exist so its most likely this function has been invoked with an object parameter
					// Return first argument as the hash of all arguments
					return args[0];
				}
			}}
		}

		// Else loop through and account for the missing ones.
		for (x in o) {if (o.hasOwnProperty(x)) {

			t = typeof (args[i]);

			if ((typeof (o[x]) === 'function' && o[x].test(args[i])) || (typeof (o[x]) === 'string' && (
			(o[x].indexOf('s') > -1 && t === 'string') ||
			(o[x].indexOf('o') > -1 && t === 'object') ||
			(o[x].indexOf('i') > -1 && t === 'number') ||
			(o[x].indexOf('a') > -1 && t === 'object') ||
			(o[x].indexOf('f') > -1 && t === 'function')
			))
			) {
				p[x] = args[i++];
			}

			else if (typeof (o[x]) === 'string' && o[x].indexOf('!') > -1) {
				return false;
			}
		}}

		return p;
	},

	// Returns a URL instance
	url: function(path) {

		// If the path is empty
		if (!path) {
			return window.location;
		}

		// Chrome and FireFox support new URL() to extract URL objects
		else if (window.URL && URL instanceof Function && URL.length !== 0) {
			return new URL(path, window.location);
		}

		// Ugly shim, it works!
		else {
			var a = document.createElement('a');
			a.href = path;
			return a.cloneNode(false);
		}
	},

	diff: function(a, b) {
		return b.filter(function(item) {
			return a.indexOf(item) === -1;
		});
	},

	// Get the different hash of properties unique to `a`, and not in `b`
	diffKey: function(a, b) {
		if (a || !b) {
			var r = {};
			for (var x in a) {
				// Does the property not exist?
				if (!(x in b)) {
					r[x] = a[x];
				}
			}

			return r;
		}

		return a;
	},

	// Unique
	// Remove duplicate and null values from an array
	// @param a array
	unique: function(a) {
		if (!Array.isArray(a)) { return []; }

		return a.filter(function(item, index) {
			// Is this the first location of item
			return a.indexOf(item) === index;
		});
	},

	isEmpty: function(obj) {

		// Scalar
		if (!obj)
			return true;

		// Array
		if (Array.isArray(obj)) {
			return !obj.length;
		}
		else if (typeof (obj) === 'object') {
			// Object
			for (var key in obj) {
				if (obj.hasOwnProperty(key)) {
					return false;
				}
			}
		}

		return true;
	},

	//jscs:disable

	/*!
	 **  Thenable -- Embeddable Minimum Strictly-Compliant Promises/A+ 1.1.1 Thenable
	 **  Copyright (c) 2013-2014 Ralf S. Engelschall <http://engelschall.com>
	 **  Licensed under The MIT License <http://opensource.org/licenses/MIT>
	 **  Source-Code distributed on <http://github.com/rse/thenable>
	 */
	Promise: (function(){
		/*  promise states [Promises/A+ 2.1]  */
		var STATE_PENDING   = 0;                                         /*  [Promises/A+ 2.1.1]  */
		var STATE_FULFILLED = 1;                                         /*  [Promises/A+ 2.1.2]  */
		var STATE_REJECTED  = 2;                                         /*  [Promises/A+ 2.1.3]  */

		/*  promise object constructor  */
		var api = function (executor) {
			/*  optionally support non-constructor/plain-function call  */
			if (!(this instanceof api))
				return new api(executor);

			/*  initialize object  */
			this.id           = "Thenable/1.0.6";
			this.state        = STATE_PENDING; /*  initial state  */
			this.fulfillValue = undefined;     /*  initial value  */     /*  [Promises/A+ 1.3, 2.1.2.2]  */
			this.rejectReason = undefined;     /*  initial reason */     /*  [Promises/A+ 1.5, 2.1.3.2]  */
			this.onFulfilled  = [];            /*  initial handlers  */
			this.onRejected   = [];            /*  initial handlers  */

			/*  provide optional information-hiding proxy  */
			this.proxy = {
				then: this.then.bind(this)
			};

			/*  support optional executor function  */
			if (typeof executor === "function")
				executor.call(this, this.fulfill.bind(this), this.reject.bind(this));
		};

		/*  promise API methods  */
		api.prototype = {
			/*  promise resolving methods  */
			fulfill: function (value) { return deliver(this, STATE_FULFILLED, "fulfillValue", value); },
			reject:  function (value) { return deliver(this, STATE_REJECTED,  "rejectReason", value); },

			/*  "The then Method" [Promises/A+ 1.1, 1.2, 2.2]  */
			then: function (onFulfilled, onRejected) {
				var curr = this;
				var next = new api();                                    /*  [Promises/A+ 2.2.7]  */
				curr.onFulfilled.push(
					resolver(onFulfilled, next, "fulfill"));             /*  [Promises/A+ 2.2.2/2.2.6]  */
				curr.onRejected.push(
					resolver(onRejected,  next, "reject" ));             /*  [Promises/A+ 2.2.3/2.2.6]  */
				execute(curr);
				return next.proxy;                                       /*  [Promises/A+ 2.2.7, 3.3]  */
			}
		};

		/*  deliver an action  */
		var deliver = function (curr, state, name, value) {
			if (curr.state === STATE_PENDING) {
				curr.state = state;                                      /*  [Promises/A+ 2.1.2.1, 2.1.3.1]  */
				curr[name] = value;                                      /*  [Promises/A+ 2.1.2.2, 2.1.3.2]  */
				execute(curr);
			}
			return curr;
		};

		/*  execute all handlers  */
		var execute = function (curr) {
			if (curr.state === STATE_FULFILLED)
				execute_handlers(curr, "onFulfilled", curr.fulfillValue);
			else if (curr.state === STATE_REJECTED)
				execute_handlers(curr, "onRejected",  curr.rejectReason);
		};

		/*  execute particular set of handlers  */
		var execute_handlers = function (curr, name, value) {
			/* global process: true */
			/* global setImmediate: true */
			/* global setTimeout: true */

			/*  short-circuit processing  */
			if (curr[name].length === 0)
				return;

			/*  iterate over all handlers, exactly once  */
			var handlers = curr[name];
			curr[name] = [];                                             /*  [Promises/A+ 2.2.2.3, 2.2.3.3]  */
			var func = function () {
				for (var i = 0; i < handlers.length; i++)
					handlers[i](value);                                  /*  [Promises/A+ 2.2.5]  */
			};

			/*  execute procedure asynchronously  */                     /*  [Promises/A+ 2.2.4, 3.1]  */
			if (typeof process === "object" && typeof process.nextTick === "function")
				process.nextTick(func);
			else if (typeof setImmediate === "function")
				setImmediate(func);
			else
				setTimeout(func, 0);
		};

		/*  generate a resolver function  */
		var resolver = function (cb, next, method) {
			return function (value) {
				if (typeof cb !== "function")                            /*  [Promises/A+ 2.2.1, 2.2.7.3, 2.2.7.4]  */
					next[method].call(next, value);                      /*  [Promises/A+ 2.2.7.3, 2.2.7.4]  */
				else {
					var result;
					try { result = cb(value); }                          /*  [Promises/A+ 2.2.2.1, 2.2.3.1, 2.2.5, 3.2]  */
					catch (e) {
						next.reject(e);                                  /*  [Promises/A+ 2.2.7.2]  */
						return;
					}
					resolve(next, result);                               /*  [Promises/A+ 2.2.7.1]  */
				}
			};
		};

		/*  "Promise Resolution Procedure"  */                           /*  [Promises/A+ 2.3]  */
		var resolve = function (promise, x) {
			/*  sanity check arguments  */                               /*  [Promises/A+ 2.3.1]  */
			if (promise === x || promise.proxy === x) {
				promise.reject(new TypeError("cannot resolve promise with itself"));
				return;
			}

			/*  surgically check for a "then" method
				(mainly to just call the "getter" of "then" only once)  */
			var then;
			if ((typeof x === "object" && x !== null) || typeof x === "function") {
				try { then = x.then; }                                   /*  [Promises/A+ 2.3.3.1, 3.5]  */
				catch (e) {
					promise.reject(e);                                   /*  [Promises/A+ 2.3.3.2]  */
					return;
				}
			}

			/*  handle own Thenables    [Promises/A+ 2.3.2]
				and similar "thenables" [Promises/A+ 2.3.3]  */
			if (typeof then === "function") {
				var resolved = false;
				try {
					/*  call retrieved "then" method */                  /*  [Promises/A+ 2.3.3.3]  */
					then.call(x,
						/*  resolvePromise  */                           /*  [Promises/A+ 2.3.3.3.1]  */
						function (y) {
							if (resolved) return; resolved = true;       /*  [Promises/A+ 2.3.3.3.3]  */
							if (y === x)                                 /*  [Promises/A+ 3.6]  */
								promise.reject(new TypeError("circular thenable chain"));
							else
								resolve(promise, y);
						},

						/*  rejectPromise  */                            /*  [Promises/A+ 2.3.3.3.2]  */
						function (r) {
							if (resolved) return; resolved = true;       /*  [Promises/A+ 2.3.3.3.3]  */
							promise.reject(r);
						}
					);
				}
				catch (e) {
					if (!resolved)                                       /*  [Promises/A+ 2.3.3.3.3]  */
						promise.reject(e);                               /*  [Promises/A+ 2.3.3.3.4]  */
				}
				return;
			}

			/*  handle other values  */
			promise.fulfill(x);                                          /*  [Promises/A+ 2.3.4, 2.3.3.4]  */
		};

		/*  export API  */
		return api;
	})(),

	//jscs:enable

	// Event
	// A contructor superclass for adding event menthods, on, off, emit.
	Event: function() {

		var separator = /[\s\,]+/;

		// If this doesn't support getPrototype then we can't get prototype.events of the parent
		// So lets get the current instance events, and add those to a parent property
		this.parent = {
			events: this.events,
			findEvents: this.findEvents,
			parent: this.parent,
			utils: this.utils
		};

		this.events = {};

		// On, subscribe to events
		// @param evt   string
		// @param callback  function
		this.on = function(evt, callback) {

			if (callback && typeof (callback) === 'function') {
				var a = evt.split(separator);
				for (var i = 0; i < a.length; i++) {

					// Has this event already been fired on this instance?
					this.events[a[i]] = [callback].concat(this.events[a[i]] || []);
				}
			}

			return this;
		};

		// Off, unsubscribe to events
		// @param evt   string
		// @param callback  function
		this.off = function(evt, callback) {

			this.findEvents(evt, function(name, index) {
				if (!callback || this.events[name][index] === callback) {
					this.events[name][index] = null;
				}
			});

			return this;
		};

		// Emit
		// Triggers any subscribed events
		this.emit = function(evt /*, data, ... */) {

			// Get arguments as an Array, knock off the first one
			var args = Array.prototype.slice.call(arguments, 1);
			args.push(evt);

			// Handler
			var handler = function(name, index) {

				// Replace the last property with the event name
				args[args.length - 1] = (name === '*' ? evt : name);

				// Trigger
				this.events[name][index].apply(this, args);
			};

			// Find the callbacks which match the condition and call
			var _this = this;
			while (_this && _this.findEvents) {

				// Find events which match
				_this.findEvents(evt + ',*', handler);
				_this = _this.parent;
			}

			return this;
		};

		//
		// Easy functions
		this.emitAfter = function() {
			var _this = this;
			var args = arguments;
			setTimeout(function() {
				_this.emit.apply(_this, args);
			}, 0);

			return this;
		};

		this.findEvents = function(evt, callback) {

			var a = evt.split(separator);

			for (var name in this.events) {if (this.events.hasOwnProperty(name)) {

				if (a.indexOf(name) > -1) {

					for (var i = 0; i < this.events[name].length; i++) {

						// Does the event handler exist?
						if (this.events[name][i]) {
							// Emit on the local instance of this
							callback.call(this, name, i);
						}
					}
				}
			}}
		};

		return this;
	},

	// Global Events
	// Attach the callback to the window object
	// Return its unique reference
	globalEvent: function(callback, guid) {
		// If the guid has not been supplied then create a new one.
		guid = guid || '_hellojs_' + parseInt(Math.random() * 1e12, 10).toString(36);

		// Define the callback function
		window[guid] = function() {
			// Trigger the callback
			try {
				if (callback.apply(this, arguments)) {
					delete window[guid];
				}
			}
			catch (e) {
				console.error(e);
			}
		};

		return guid;
	},

	// Trigger a clientside popup
	// This has been augmented to support PhoneGap
	popup: function(url, redirectUri, options) {

		var documentElement = document.documentElement;

		// Multi Screen Popup Positioning (http://stackoverflow.com/a/16861050)
		// Credit: http://www.xtf.dk/2011/08/center-new-popup-window-even-on.html
		// Fixes dual-screen position                         Most browsers      Firefox

		if (options.height) {
			var dualScreenTop = window.screenTop !== undefined ? window.screenTop : screen.top;
			var height = screen.height || window.innerHeight || documentElement.clientHeight;
			options.top = parseInt((height - options.height) / 2, 10) + dualScreenTop;
		}

		if (options.width) {
			var dualScreenLeft = window.screenLeft !== undefined ? window.screenLeft : screen.left;
			var width = screen.width || window.innerWidth || documentElement.clientWidth;
			options.left = parseInt((width - options.width) / 2, 10) + dualScreenLeft;
		}

		// Convert options into an array
		var optionsArray = [];
		Object.keys(options).forEach(function(name) {
			var value = options[name];
			optionsArray.push(name + (value !== null ? '=' + value : ''));
		});

		// Call the open() function with the initial path
		//
		// OAuth redirect, fixes URI fragments from being lost in Safari
		// (URI Fragments within 302 Location URI are lost over HTTPS)
		// Loading the redirect.html before triggering the OAuth Flow seems to fix it.
		//
		// Firefox  decodes URL fragments when calling location.hash.
		//  - This is bad if the value contains break points which are escaped
		//  - Hence the url must be encoded twice as it contains breakpoints.
		if (navigator.userAgent.indexOf('Safari') !== -1 && navigator.userAgent.indexOf('Chrome') === -1) {
			url = redirectUri + '#oauth_redirect=' + encodeURIComponent(encodeURIComponent(url));
		}
		var popup = window.open(
			url,
			'_blank',
			optionsArray.join(',')
		);

		if (popup && popup.focus) {
			popup.focus();
		}

		return popup;
	},

	// OAuth and API response handler
	responseHandler: function(window, parent) {

		var _this = this;
		var p;
		var location = window.location;

		// Is this an auth relay message which needs to call the proxy?
		p = _this.param(location.search);

		// OAuth2 or OAuth1 server response?
		if (p && p.state && (p.code || p.oauth_token)) {

			var state = JSON.parse(p.state);

			// Add this path as the redirect_uri
			p.redirect_uri = state.redirect_uri || location.href.replace(/[\?\#].*$/, '');

			// Redirect to the host
			var path = state.oauth_proxy + '?' + _this.param(p);

			location.assign(path);

			return;
		}

		// Save session, from redirected authentication
		// #access_token has come in?
		//
		// FACEBOOK is returning auth errors within as a query_string... thats a stickler for consistency.
		// SoundCloud is the state in the querystring and the token in the hashtag, so we'll mix the two together

		p = _this.merge(_this.param(location.search || ''), _this.param(location.hash || ''));

		// If p.state
		if (p && 'state' in p) {

			// Remove any addition information
			// E.g. p.state = 'facebook.page';
			try {
				var a = JSON.parse(p.state);
				_this.extend(p, a);
			}
			catch (e) {
				console.error('Could not decode state parameter');
			}

			// Access_token?
			if (('access_token' in p && p.access_token) && p.network) {

				if (!p.expires_in || parseInt(p.expires_in, 10) === 0) {
					// If p.expires_in is unset, set to 0
					p.expires_in = 0;
				}

				p.expires_in = parseInt(p.expires_in, 10);
				p.expires = ((new Date()).getTime() / 1e3) + (p.expires_in || (60 * 60 * 24 * 365));

				// Lets use the "state" to assign it to one of our networks
				authCallback(p, window, parent);
			}

			// Error=?
			// &error_description=?
			// &state=?
			else if (('error' in p && p.error) && p.network) {

				p.error = {
					code: p.error,
					message: p.error_message || p.error_description
				};

				// Let the state handler handle it
				authCallback(p, window, parent);
			}

			// API call, or a cancelled login
			// Result is serialized JSON string
			else if (p.callback && p.callback in parent) {

				// Trigger a function in the parent
				var res = 'result' in p && p.result ? JSON.parse(p.result) : false;

				// Trigger the callback on the parent
				parent[p.callback](res);
				closeWindow();
			}

			// If this page is still open
			if (p.page_uri) {
				location.assign(p.page_uri);
			}
		}

		// OAuth redirect, fixes URI fragments from being lost in Safari
		// (URI Fragments within 302 Location URI are lost over HTTPS)
		// Loading the redirect.html before triggering the OAuth Flow seems to fix it.
		else if ('oauth_redirect' in p) {

			location.assign(decodeURIComponent(p.oauth_redirect));
			return;
		}

		// Trigger a callback to authenticate
		function authCallback(obj, window, parent) {

			var cb = obj.callback;
			var network = obj.network;

			// Trigger the callback on the parent
			_this.store(network, obj);

			// If this is a page request it has no parent or opener window to handle callbacks
			if (('display' in obj) && obj.display === 'page') {
				return;
			}

			// Remove from session object
			if (parent && cb && cb in parent) {

				try {
					delete obj.callback;
				}
				catch (e) {}

				// Update store
				_this.store(network, obj);

				// Call the globalEvent function on the parent
				// It's safer to pass back a string to the parent,
				// Rather than an object/array (better for IE8)
				var str = JSON.stringify(obj);

				try {
					parent[cb](str);
				}
				catch (e) {
					// Error thrown whilst executing parent callback
				}
			}

			closeWindow();
		}

		function closeWindow() {

			if (window.frameElement) {
				// Inside an iframe, remove from parent
				parent.document.body.removeChild(window.frameElement);
			}
			else {
				// Close this current window
				try {
					window.close();
				}
				catch (e) {}

				// IOS bug wont let us close a popup if still loading
				if (window.addEventListener) {
					window.addEventListener('load', function() {
						window.close();
					});
				}
			}

		}
	}
});

// Events
// Extend the hello object with its own event instance
hello.utils.Event.call(hello);

///////////////////////////////////
// Monitoring session state
// Check for session changes
///////////////////////////////////

(function(hello) {

	// Monitor for a change in state and fire
	var oldSessions = {};

	// Hash of expired tokens
	var expired = {};

	// Listen to other triggers to Auth events, use these to update this
	hello.on('auth.login, auth.logout', function(auth) {
		if (auth && typeof (auth) === 'object' && auth.network) {
			oldSessions[auth.network] = hello.utils.store(auth.network) || {};
		}
	});

	(function self() {

		var CURRENT_TIME = ((new Date()).getTime() / 1e3);
		var emit = function(eventName) {
			hello.emit('auth.' + eventName, {
				network: name,
				authResponse: session
			});
		};

		// Loop through the services
		for (var name in hello.services) {if (hello.services.hasOwnProperty(name)) {

			if (!hello.services[name].id) {
				// We haven't attached an ID so dont listen.
				continue;
			}

			// Get session
			var session = hello.utils.store(name) || {};
			var provider = hello.services[name];
			var oldSess = oldSessions[name] || {};

			// Listen for globalEvents that did not get triggered from the child
			if (session && 'callback' in session) {

				// To do remove from session object...
				var cb = session.callback;
				try {
					delete session.callback;
				}
				catch (e) {}

				// Update store
				// Removing the callback
				hello.utils.store(name, session);

				// Emit global events
				try {
					window[cb](session);
				}
				catch (e) {}
			}

			// Refresh token
			if (session && ('expires' in session) && session.expires < CURRENT_TIME) {

				// If auto refresh is possible
				// Either the browser supports
				var refresh = provider.refresh || session.refresh_token;

				// Has the refresh been run recently?
				if (refresh && (!(name in expired) || expired[name] < CURRENT_TIME)) {
					// Try to resignin
					hello.emit('notice', name + ' has expired trying to resignin');
					hello.login(name, {display: 'none', force: false});

					// Update expired, every 10 minutes
					expired[name] = CURRENT_TIME + 600;
				}

				// Does this provider not support refresh
				else if (!refresh && !(name in expired)) {
					// Label the event
					emit('expired');
					expired[name] = true;
				}

				// If session has expired then we dont want to store its value until it can be established that its been updated
				continue;
			}

			// Has session changed?
			else if (oldSess.access_token === session.access_token &&
			oldSess.expires === session.expires) {
				continue;
			}

			// Access_token has been removed
			else if (!session.access_token && oldSess.access_token) {
				emit('logout');
			}

			// Access_token has been created
			else if (session.access_token && !oldSess.access_token) {
				emit('login');
			}

			// Access_token has been updated
			else if (session.expires !== oldSess.expires) {
				emit('update');
			}

			// Updated stored session
			oldSessions[name] = session;

			// Remove the expired flags
			if (name in expired) {
				delete expired[name];
			}
		}}

		// Check error events
		setTimeout(self, 1000);
	})();

})(hello);

// EOF CORE lib
//////////////////////////////////

/////////////////////////////////////////
// API
// @param path    string
// @param query   object (optional)
// @param method  string (optional)
// @param data    object (optional)
// @param timeout integer (optional)
// @param callback  function (optional)

hello.api = function() {

	// Shorthand
	var _this = this;
	var utils = _this.utils;
	var error = utils.error;

	// Construct a new Promise object
	var promise = utils.Promise();

	// Arguments
	var p = utils.args({path: 's!', query: 'o', method: 's', data: 'o', timeout: 'i', callback: 'f'}, arguments);

	// Method
	p.method = (p.method || 'get').toLowerCase();

	// Headers
	p.headers = p.headers || {};

	// Query
	p.query = p.query || {};

	// If get, put all parameters into query
	if (p.method === 'get' || p.method === 'delete') {
		utils.extend(p.query, p.data);
		p.data = {};
	}

	var data = p.data = p.data || {};

	// Completed event callback
	promise.then(p.callback, p.callback);

	// Remove the network from path, e.g. facebook:/me/friends
	// Results in { network : facebook, path : me/friends }
	if (!p.path) {
		return promise.reject(error('invalid_path', 'Missing the path parameter from the request'));
	}

	p.path = p.path.replace(/^\/+/, '');
	var a = (p.path.split(/[\/\:]/, 2) || [])[0].toLowerCase();

	if (a in _this.services) {
		p.network = a;
		var reg = new RegExp('^' + a + ':?\/?');
		p.path = p.path.replace(reg, '');
	}

	// Network & Provider
	// Define the network that this request is made for
	p.network = _this.settings.default_service = p.network || _this.settings.default_service;
	var o = _this.services[p.network];

	// INVALID
	// Is there no service by the given network name?
	if (!o) {
		return promise.reject(error('invalid_network', 'Could not match the service requested: ' + p.network));
	}

	// PATH
	// As long as the path isn't flagged as unavaiable, e.g. path == false

	if (!(!(p.method in o) || !(p.path in o[p.method]) || o[p.method][p.path] !== false)) {
		return promise.reject(error('invalid_path', 'The provided path is not available on the selected network'));
	}

	// PROXY
	// OAuth1 calls always need a proxy

	if (!p.oauth_proxy) {
		p.oauth_proxy = _this.settings.oauth_proxy;
	}

	if (!('proxy' in p)) {
		p.proxy = p.oauth_proxy && o.oauth && parseInt(o.oauth.version, 10) === 1;
	}

	// TIMEOUT
	// Adopt timeout from global settings by default

	if (!('timeout' in p)) {
		p.timeout = _this.settings.timeout;
	}

	// Format response
	// Whether to run the raw response through post processing.
	if (!('formatResponse' in p)) {
		p.formatResponse = true;
	}

	// Get the current session
	// Append the access_token to the query
	p.authResponse = _this.getAuthResponse(p.network);
	if (p.authResponse && p.authResponse.access_token) {
		p.query.access_token = p.authResponse.access_token;
	}

	var url = p.path;
	var m;

	// Store the query as options
	// This is used to populate the request object before the data is augmented by the prewrap handlers.
	p.options = utils.clone(p.query);

	// Clone the data object
	// Prevent this script overwriting the data of the incoming object.
	// Ensure that everytime we run an iteration the callbacks haven't removed some data
	p.data = utils.clone(data);

	// URL Mapping
	// Is there a map for the given URL?
	var actions = o[{'delete': 'del'}[p.method] || p.method] || {};

	// Extrapolate the QueryString
	// Provide a clean path
	// Move the querystring into the data
	if (p.method === 'get') {

		var query = url.split(/[\?#]/)[1];
		if (query) {
			utils.extend(p.query, utils.param(query));

			// Remove the query part from the URL
			url = url.replace(/\?.*?(#|$)/, '$1');
		}
	}

	// Is the hash fragment defined
	if ((m = url.match(/#(.+)/, ''))) {
		url = url.split('#')[0];
		p.path = m[1];
	}
	else if (url in actions) {
		p.path = url;
		url = actions[url];
	}
	else if ('default' in actions) {
		url = actions['default'];
	}

	// Redirect Handler
	// This defines for the Form+Iframe+Hash hack where to return the results too.
	p.redirect_uri = _this.settings.redirect_uri;

	// Define FormatHandler
	// The request can be procesed in a multitude of ways
	// Here's the options - depending on the browser and endpoint
	p.xhr = o.xhr;
	p.jsonp = o.jsonp;
	p.form = o.form;

	// Make request
	if (typeof (url) === 'function') {
		// Does self have its own callback?
		url(p, getPath);
	}
	else {
		// Else the URL is a string
		getPath(url);
	}

	return promise.proxy;

	// If url needs a base
	// Wrap everything in
	function getPath(url) {

		// Format the string if it needs it
		url = url.replace(/\@\{([a-z\_\-]+)(\|.*?)?\}/gi, function(m, key, defaults) {
			var val = defaults ? defaults.replace(/^\|/, '') : '';
			if (key in p.query) {
				val = p.query[key];
				delete p.query[key];
			}
			else if (p.data && key in p.data) {
				val = p.data[key];
				delete p.data[key];
			}
			else if (!defaults) {
				promise.reject(error('missing_attribute', 'The attribute ' + key + ' is missing from the request'));
			}

			return val;
		});

		// Add base
		if (!url.match(/^https?:\/\//)) {
			url = o.base + url;
		}

		// Define the request URL
		p.url = url;

		// Make the HTTP request with the curated request object
		// CALLBACK HANDLER
		// @ response object
		// @ statusCode integer if available
		utils.request(p, function(r, headers) {

			// Is this a raw response?
			if (!p.formatResponse) {
				// Bad request? error statusCode or otherwise contains an error response vis JSONP?
				if (typeof headers === 'object' ? (headers.statusCode >= 400) : (typeof r === 'object' && 'error' in r)) {
					promise.reject(r);
				}
				else {
					promise.fulfill(r);
				}

				return;
			}

			// Should this be an object
			if (r === true) {
				r = {success:true};
			}
			else if (!r) {
				r = {};
			}

			// The delete callback needs a better response
			if (p.method === 'delete') {
				r = (!r || utils.isEmpty(r)) ? {success:true} : r;
			}

			// FORMAT RESPONSE?
			// Does self request have a corresponding formatter
			if (o.wrap && ((p.path in o.wrap) || ('default' in o.wrap))) {
				var wrap = (p.path in o.wrap ? p.path : 'default');
				var time = (new Date()).getTime();

				// FORMAT RESPONSE
				var b = o.wrap[wrap](r, headers, p);

				// Has the response been utterly overwritten?
				// Typically self augments the existing object.. but for those rare occassions
				if (b) {
					r = b;
				}
			}

			// Is there a next_page defined in the response?
			if (r && 'paging' in r && r.paging.next) {

				// Add the relative path if it is missing from the paging/next path
				if (r.paging.next[0] === '?') {
					r.paging.next = p.path + r.paging.next;
				}

				// The relative path has been defined, lets markup the handler in the HashFragment
				else {
					r.paging.next += '#' + p.path;
				}
			}

			// Dispatch to listeners
			// Emit events which pertain to the formatted response
			if (!r || 'error' in r) {
				promise.reject(r);
			}
			else {
				promise.fulfill(r);
			}
		});
	}
};

// API utilities
hello.utils.extend(hello.utils, {

	// Make an HTTP request
	request: function(p, callback) {

		var _this = this;
		var error = _this.error;

		// This has to go through a POST request
		if (!_this.isEmpty(p.data) && !('FileList' in window) && _this.hasBinary(p.data)) {

			// Disable XHR and JSONP
			p.xhr = false;
			p.jsonp = false;
		}

		// Check if the browser and service support CORS
		var cors = this.request_cors(function() {
			// If it does then run this...
			return ((p.xhr === undefined) || (p.xhr && (typeof (p.xhr) !== 'function' || p.xhr(p, p.query))));
		});

		if (cors) {

			formatUrl(p, function(url) {

				var x = _this.xhr(p.method, url, p.headers, p.data, callback);
				x.onprogress = p.onprogress || null;

				// Windows Phone does not support xhr.upload, see #74
				// Feature detect
				if (x.upload && p.onuploadprogress) {
					x.upload.onprogress = p.onuploadprogress;
				}

			});

			return;
		}

		// Clone the query object
		// Each request modifies the query object and needs to be tared after each one.
		var _query = p.query;

		p.query = _this.clone(p.query);

		// Assign a new callbackID
		p.callbackID = _this.globalEvent();

		// JSONP
		if (p.jsonp !== false) {

			// Clone the query object
			p.query.callback = p.callbackID;

			// If the JSONP is a function then run it
			if (typeof (p.jsonp) === 'function') {
				p.jsonp(p, p.query);
			}

			// Lets use JSONP if the method is 'get'
			if (p.method === 'get') {

				formatUrl(p, function(url) {
					_this.jsonp(url, callback, p.callbackID, p.timeout);
				});

				return;
			}
			else {
				// It's not compatible reset query
				p.query = _query;
			}

		}

		// Otherwise we're on to the old school, iframe hacks and JSONP
		if (p.form !== false) {

			// Add some additional query parameters to the URL
			// We're pretty stuffed if the endpoint doesn't like these
			p.query.redirect_uri = p.redirect_uri;
			p.query.state = JSON.stringify({callback:p.callbackID});

			var opts;

			if (typeof (p.form) === 'function') {

				// Format the request
				opts = p.form(p, p.query);
			}

			if (p.method === 'post' && opts !== false) {

				formatUrl(p, function(url) {
					_this.post(url, p.data, opts, callback, p.callbackID, p.timeout);
				});

				return;
			}
		}

		// None of the methods were successful throw an error
		callback(error('invalid_request', 'There was no mechanism for handling this request'));

		return;

		// Format URL
		// Constructs the request URL, optionally wraps the URL through a call to a proxy server
		// Returns the formatted URL
		function formatUrl(p, callback) {

			// Are we signing the request?
			var sign;

			// OAuth1
			// Remove the token from the query before signing
			if (p.authResponse && p.authResponse.oauth && parseInt(p.authResponse.oauth.version, 10) === 1) {

				// OAUTH SIGNING PROXY
				sign = p.query.access_token;

				// Remove the access_token
				delete p.query.access_token;

				// Enfore use of Proxy
				p.proxy = true;
			}

			// POST body to querystring
			if (p.data && (p.method === 'get' || p.method === 'delete')) {
				// Attach the p.data to the querystring.
				_this.extend(p.query, p.data);
				p.data = null;
			}

			// Construct the path
			var path = _this.qs(p.url, p.query);

			// Proxy the request through a server
			// Used for signing OAuth1
			// And circumventing services without Access-Control Headers
			if (p.proxy) {
				// Use the proxy as a path
				path = _this.qs(p.oauth_proxy, {
					path: path,
					access_token: sign || '',

					// This will prompt the request to be signed as though it is OAuth1
					then: p.proxy_response_type || (p.method.toLowerCase() === 'get' ? 'redirect' : 'proxy'),
					method: p.method.toLowerCase(),
					suppress_response_codes: true
				});
			}

			callback(path);
		}
	},

	// Test whether the browser supports the CORS response
	request_cors: function(callback) {
		return 'withCredentials' in new XMLHttpRequest() && callback();
	},

	// Return the type of DOM object
	domInstance: function(type, data) {
		var test = 'HTML' + (type || '').replace(
			/^[a-z]/,
			function(m) {
				return m.toUpperCase();
			}

		) + 'Element';

		if (!data) {
			return false;
		}

		if (window[test]) {
			return data instanceof window[test];
		}
		else if (window.Element) {
			return data instanceof window.Element && (!type || (data.tagName && data.tagName.toLowerCase() === type));
		}
		else {
			return (!(data instanceof Object || data instanceof Array || data instanceof String || data instanceof Number) && data.tagName && data.tagName.toLowerCase() === type);
		}
	},

	// Create a clone of an object
	clone: function(obj) {
		// Does not clone DOM elements, nor Binary data, e.g. Blobs, Filelists
		if (obj === null || typeof (obj) !== 'object' || obj instanceof Date || 'nodeName' in obj || this.isBinary(obj) || (typeof FormData === 'function' && obj instanceof FormData)) {
			return obj;
		}

		if (Array.isArray(obj)) {
			// Clone each item in the array
			return obj.map(this.clone.bind(this));
		}

		// But does clone everything else.
		var clone = {};
		for (var x in obj) {
			clone[x] = this.clone(obj[x]);
		}

		return clone;
	},

	// XHR: uses CORS to make requests
	xhr: function(method, url, headers, data, callback) {

		var r = new XMLHttpRequest();
		var error = this.error;

		// Binary?
		var binary = false;
		if (method === 'blob') {
			binary = method;
			method = 'GET';
		}

		method = method.toUpperCase();

		// Xhr.responseType 'json' is not supported in any of the vendors yet.
		r.onload = function(e) {
			var json = r.response;
			try {
				json = JSON.parse(r.responseText);
			}
			catch (_e) {
				if (r.status === 401) {
					json = error('access_denied', r.statusText);
				}
			}

			var headers = headersToJSON(r.getAllResponseHeaders());
			headers.statusCode = r.status;

			callback(json || (method === 'GET' ? error('empty_response', 'Could not get resource') : {}), headers);
		};

		r.onerror = function(e) {
			var json = r.responseText;
			try {
				json = JSON.parse(r.responseText);
			}
			catch (_e) {}

			callback(json || error('access_denied', 'Could not get resource'));
		};

		var x;

		// Should we add the query to the URL?
		if (method === 'GET' || method === 'DELETE') {
			data = null;
		}
		else if (data && typeof (data) !== 'string' && !(data instanceof FormData) && !(data instanceof File) && !(data instanceof Blob)) {
			// Loop through and add formData
			var f = new FormData();
			for (x in data) if (data.hasOwnProperty(x)) {
				if (data[x] instanceof HTMLInputElement) {
					if ('files' in data[x] && data[x].files.length > 0) {
						f.append(x, data[x].files[0]);
					}
				}
				else if (data[x] instanceof Blob) {
					f.append(x, data[x], data.name);
				}
				else {
					f.append(x, data[x]);
				}
			}

			data = f;
		}

		// Open the path, async
		r.open(method, url, true);

		if (binary) {
			if ('responseType' in r) {
				r.responseType = binary;
			}
			else {
				r.overrideMimeType('text/plain; charset=x-user-defined');
			}
		}

		// Set any bespoke headers
		if (headers) {
			for (x in headers) {
				r.setRequestHeader(x, headers[x]);
			}
		}

		r.send(data);

		return r;

		// Headers are returned as a string
		function headersToJSON(s) {
			var r = {};
			var reg = /([a-z\-]+):\s?(.*);?/gi;
			var m;
			while ((m = reg.exec(s))) {
				r[m[1]] = m[2];
			}

			return r;
		}
	},

	// JSONP
	// Injects a script tag into the DOM to be executed and appends a callback function to the window object
	// @param string/function pathFunc either a string of the URL or a callback function pathFunc(querystringhash, continueFunc);
	// @param function callback a function to call on completion;
	jsonp: function(url, callback, callbackID, timeout) {

		var _this = this;
		var error = _this.error;

		// Change the name of the callback
		var bool = 0;
		var head = document.getElementsByTagName('head')[0];
		var operaFix;
		var result = error('server_error', 'server_error');
		var cb = function() {
			if (!(bool++)) {
				window.setTimeout(function() {
					callback(result);
					head.removeChild(script);
				}, 0);
			}

		};

		// Add callback to the window object
		callbackID = _this.globalEvent(function(json) {
			result = json;
			return true;

			// Mark callback as done
		}, callbackID);

		// The URL is a function for some cases and as such
		// Determine its value with a callback containing the new parameters of this function.
		url = url.replace(new RegExp('=\\?(&|$)'), '=' + callbackID + '$1');

		// Build script tag
		var script = _this.append('script', {
			id: callbackID,
			name: callbackID,
			src: url,
			async: true,
			onload: cb,
			onerror: cb,
			onreadystatechange: function() {
				if (/loaded|complete/i.test(this.readyState)) {
					cb();
				}
			}
		});

		// Opera fix error
		// Problem: If an error occurs with script loading Opera fails to trigger the script.onerror handler we specified
		//
		// Fix:
		// By setting the request to synchronous we can trigger the error handler when all else fails.
		// This action will be ignored if we've already called the callback handler "cb" with a successful onload event
		if (window.navigator.userAgent.toLowerCase().indexOf('opera') > -1) {
			operaFix = _this.append('script', {
				text: 'document.getElementById(\'' + callbackID + '\').onerror();'
			});
			script.async = false;
		}

		// Add timeout
		if (timeout) {
			window.setTimeout(function() {
				result = error('timeout', 'timeout');
				cb();
			}, timeout);
		}

		// TODO: add fix for IE,
		// However: unable recreate the bug of firing off the onreadystatechange before the script content has been executed and the value of "result" has been defined.
		// Inject script tag into the head element
		head.appendChild(script);

		// Append Opera Fix to run after our script
		if (operaFix) {
			head.appendChild(operaFix);
		}
	},

	// Post
	// Send information to a remote location using the post mechanism
	// @param string uri path
	// @param object data, key value data to send
	// @param function callback, function to execute in response
	post: function(url, data, options, callback, callbackID, timeout) {

		var _this = this;
		var error = _this.error;
		var doc = document;

		// This hack needs a form
		var form = null;
		var reenableAfterSubmit = [];
		var newform;
		var i = 0;
		var x = null;
		var bool = 0;
		var cb = function(r) {
			if (!(bool++)) {
				callback(r);
			}
		};

		// What is the name of the callback to contain
		// We'll also use this to name the iframe
		_this.globalEvent(cb, callbackID);

		// Build the iframe window
		var win;
		try {
			// IE7 hack, only lets us define the name here, not later.
			win = doc.createElement('<iframe name="' + callbackID + '">');
		}
		catch (e) {
			win = doc.createElement('iframe');
		}

		win.name = callbackID;
		win.id = callbackID;
		win.style.display = 'none';

		// Override callback mechanism. Triggger a response onload/onerror
		if (options && options.callbackonload) {
			// Onload is being fired twice
			win.onload = function() {
				cb({
					response: 'posted',
					message: 'Content was posted'
				});
			};
		}

		if (timeout) {
			setTimeout(function() {
				cb(error('timeout', 'The post operation timed out'));
			}, timeout);
		}

		doc.body.appendChild(win);

		// If we are just posting a single item
		if (_this.domInstance('form', data)) {
			// Get the parent form
			form = data.form;

			// Loop through and disable all of its siblings
			for (i = 0; i < form.elements.length; i++) {
				if (form.elements[i] !== data) {
					form.elements[i].setAttribute('disabled', true);
				}
			}

			// Move the focus to the form
			data = form;
		}

		// Posting a form
		if (_this.domInstance('form', data)) {
			// This is a form element
			form = data;

			// Does this form need to be a multipart form?
			for (i = 0; i < form.elements.length; i++) {
				if (!form.elements[i].disabled && form.elements[i].type === 'file') {
					form.encoding = form.enctype = 'multipart/form-data';
					form.elements[i].setAttribute('name', 'file');
				}
			}
		}
		else {
			// Its not a form element,
			// Therefore it must be a JSON object of Key=>Value or Key=>Element
			// If anyone of those values are a input type=file we shall shall insert its siblings into the form for which it belongs.
			for (x in data) if (data.hasOwnProperty(x)) {
				// Is this an input Element?
				if (_this.domInstance('input', data[x]) && data[x].type === 'file') {
					form = data[x].form;
					form.encoding = form.enctype = 'multipart/form-data';
				}
			}

			// Do If there is no defined form element, lets create one.
			if (!form) {
				// Build form
				form = doc.createElement('form');
				doc.body.appendChild(form);
				newform = form;
			}

			var input;

			// Add elements to the form if they dont exist
			for (x in data) if (data.hasOwnProperty(x)) {

				// Is this an element?
				var el = (_this.domInstance('input', data[x]) || _this.domInstance('textArea', data[x]) || _this.domInstance('select', data[x]));

				// Is this not an input element, or one that exists outside the form.
				if (!el || data[x].form !== form) {

					// Does an element have the same name?
					var inputs = form.elements[x];
					if (input) {
						// Remove it.
						if (!(inputs instanceof NodeList)) {
							inputs = [inputs];
						}

						for (i = 0; i < inputs.length; i++) {
							inputs[i].parentNode.removeChild(inputs[i]);
						}

					}

					// Create an input element
					input = doc.createElement('input');
					input.setAttribute('type', 'hidden');
					input.setAttribute('name', x);

					// Does it have a value attribute?
					if (el) {
						input.value = data[x].value;
					}
					else if (_this.domInstance(null, data[x])) {
						input.value = data[x].innerHTML || data[x].innerText;
					}
					else {
						input.value = data[x];
					}

					form.appendChild(input);
				}

				// It is an element, which exists within the form, but the name is wrong
				else if (el && data[x].name !== x) {
					data[x].setAttribute('name', x);
					data[x].name = x;
				}
			}

			// Disable elements from within the form if they weren't specified
			for (i = 0; i < form.elements.length; i++) {

				input = form.elements[i];

				// Does the same name and value exist in the parent
				if (!(input.name in data) && input.getAttribute('disabled') !== true) {
					// Disable
					input.setAttribute('disabled', true);

					// Add re-enable to callback
					reenableAfterSubmit.push(input);
				}
			}
		}

		// Set the target of the form
		form.setAttribute('method', 'POST');
		form.setAttribute('target', callbackID);
		form.target = callbackID;

		// Update the form URL
		form.setAttribute('action', url);

		// Submit the form
		// Some reason this needs to be offset from the current window execution
		setTimeout(function() {
			form.submit();

			setTimeout(function() {
				try {
					// Remove the iframe from the page.
					//win.parentNode.removeChild(win);
					// Remove the form
					if (newform) {
						newform.parentNode.removeChild(newform);
					}
				}
				catch (e) {
					try {
						console.error('HelloJS: could not remove iframe');
					}
					catch (ee) {}
				}

				// Reenable the disabled form
				for (var i = 0; i < reenableAfterSubmit.length; i++) {
					if (reenableAfterSubmit[i]) {
						reenableAfterSubmit[i].setAttribute('disabled', false);
						reenableAfterSubmit[i].disabled = false;
					}
				}
			}, 0);
		}, 100);
	},

	// Some of the providers require that only multipart is used with non-binary forms.
	// This function checks whether the form contains binary data
	hasBinary: function(data) {
		for (var x in data) if (data.hasOwnProperty(x)) {
			if (this.isBinary(data[x])) {
				return true;
			}
		}

		return false;
	},

	// Determines if a variable Either Is or like a FormInput has the value of a Blob

	isBinary: function(data) {

		return data instanceof Object && (
		(this.domInstance('input', data) && data.type === 'file') ||
		('FileList' in window && data instanceof window.FileList) ||
		('File' in window && data instanceof window.File) ||
		('Blob' in window && data instanceof window.Blob));

	},

	// Convert Data-URI to Blob string
	toBlob: function(dataURI) {
		var reg = /^data\:([^;,]+(\;charset=[^;,]+)?)(\;base64)?,/i;
		var m = dataURI.match(reg);
		if (!m) {
			return dataURI;
		}

		var binary = atob(dataURI.replace(reg, ''));
		var array = [];
		for (var i = 0; i < binary.length; i++) {
			array.push(binary.charCodeAt(i));
		}

		return new Blob([new Uint8Array(array)], {type: m[1]});
	}

});

// EXTRA: Convert FormElement to JSON for POSTing
// Wrappers to add additional functionality to existing functions
(function(hello) {

	// Copy original function
	var api = hello.api;
	var utils = hello.utils;

	utils.extend(utils, {

		// DataToJSON
		// This takes a FormElement|NodeList|InputElement|MixedObjects and convers the data object to JSON.
		dataToJSON: function(p) {

			var _this = this;
			var w = window;
			var data = p.data;

			// Is data a form object
			if (_this.domInstance('form', data)) {
				data = _this.nodeListToJSON(data.elements);
			}
			else if ('NodeList' in w && data instanceof NodeList) {
				data = _this.nodeListToJSON(data);
			}
			else if (_this.domInstance('input', data)) {
				data = _this.nodeListToJSON([data]);
			}

			// Is data a blob, File, FileList?
			if (('File' in w && data instanceof w.File) ||
				('Blob' in w && data instanceof w.Blob) ||
				('FileList' in w && data instanceof w.FileList)) {
				data = {file: data};
			}

			// Loop through data if it's not form data it must now be a JSON object
			if (!('FormData' in w && data instanceof w.FormData)) {

				for (var x in data) if (data.hasOwnProperty(x)) {

					if ('FileList' in w && data[x] instanceof w.FileList) {
						if (data[x].length === 1) {
							data[x] = data[x][0];
						}
					}
					else if (_this.domInstance('input', data[x]) && data[x].type === 'file') {
						continue;
					}
					else if (_this.domInstance('input', data[x]) ||
						_this.domInstance('select', data[x]) ||
						_this.domInstance('textArea', data[x])) {
						data[x] = data[x].value;
					}
					else if (_this.domInstance(null, data[x])) {
						data[x] = data[x].innerHTML || data[x].innerText;
					}
				}
			}

			p.data = data;
			return data;
		},

		// NodeListToJSON
		// Given a list of elements extrapolate their values and return as a json object
		nodeListToJSON: function(nodelist) {

			var json = {};

			// Create a data string
			for (var i = 0; i < nodelist.length; i++) {

				var input = nodelist[i];

				// If the name of the input is empty or diabled, dont add it.
				if (input.disabled || !input.name) {
					continue;
				}

				// Is this a file, does the browser not support 'files' and 'FormData'?
				if (input.type === 'file') {
					json[input.name] = input;
				}
				else {
					json[input.name] = input.value || input.innerHTML;
				}
			}

			return json;
		}
	});

	// Replace it
	hello.api = function() {

		// Get arguments
		var p = utils.args({path: 's!', method: 's', data:'o', timeout: 'i', callback: 'f'}, arguments);

		// Change for into a data object
		if (p.data) {
			utils.dataToJSON(p);
		}

		return api.call(this, p);
	};

})(hello);

/////////////////////////////////////
//
// Save any access token that is in the current page URL
// Handle any response solicited through iframe hash tag following an API request
//
/////////////////////////////////////

hello.utils.responseHandler(window, window.opener || window.parent);

// Script to support ChromeApps
// This overides the hello.utils.popup method to support chrome.identity.launchWebAuthFlow
// See https://developer.chrome.com/apps/app_identity#non

// Is this a chrome app?

if (typeof chrome === 'object' && typeof chrome.identity === 'object' && chrome.identity.launchWebAuthFlow) {

	(function() {

		// Swap the popup method
		hello.utils.popup = function(url) {

			return _open(url, true);

		};

		// Swap the hidden iframe method
		hello.utils.iframe = function(url) {

			_open(url, false);

		};

		// Swap the request_cors method
		hello.utils.request_cors = function(callback) {

			callback();

			// Always run as CORS

			return true;
		};

		// Swap the storage method
		var _cache = {};
		chrome.storage.local.get('hello', function(r) {
			// Update the cache
			_cache = r.hello || {};
		});

		hello.utils.store = function(name, value) {

			// Get all
			if (arguments.length === 0) {
				return _cache;
			}

			// Get
			if (arguments.length === 1) {
				return _cache[name] || null;
			}

			// Set
			if (value) {
				_cache[name] = value;
				chrome.storage.local.set({hello: _cache});
				return value;
			}

			// Delete
			if (value === null) {
				delete _cache[name];
				chrome.storage.local.set({hello: _cache});
				return null;
			}
		};

		// Open function
		function _open(url, interactive) {

			// Launch
			var ref = {
				closed: false
			};

			// Launch the webAuthFlow
			chrome.identity.launchWebAuthFlow({
				url: url,
				interactive: interactive
			}, function(responseUrl) {

				// Did the user cancel this prematurely
				if (responseUrl === undefined) {
					ref.closed = true;
					return;
				}

				// Split appart the URL
				var a = hello.utils.url(responseUrl);

				// The location can be augmented in to a location object like so...
				// We dont have window operations on the popup so lets create some
				var _popup = {
					location: {

						// Change the location of the popup
						assign: function(url) {

							// If there is a secondary reassign
							// In the case of OAuth1
							// Trigger this in non-interactive mode.
							_open(url, false);
						},

						search: a.search,
						hash: a.hash,
						href: a.href
					},
					close: function() {}
				};

				// Then this URL contains information which HelloJS must process
				// URL string
				// Window - any action such as window relocation goes here
				// Opener - the parent window which opened this, aka this script

				hello.utils.responseHandler(_popup, window);
			});

			// Return the reference
			return ref;
		}

	})();
}

// Phonegap override for hello.phonegap.js
(function() {

	// Is this a phonegap implementation?
	if (!(/^file:\/{3}[^\/]/.test(window.location.href) && window.cordova)) {
		// Cordova is not included.
		return;
	}

	// Augment the hidden iframe method
	hello.utils.iframe = function(url, redirectUri) {
		hello.utils.popup(url, redirectUri, {hidden: 'yes'});
	};

	// Augment the popup
	var utilPopup = hello.utils.popup;

	// Replace popup
	hello.utils.popup = function(url, redirectUri, options) {

		// Run the standard
		var popup = utilPopup.call(this, url, redirectUri, options);

		// Create a function for reopening the popup, and assigning events to the new popup object
		// PhoneGap support
		// Add an event listener to listen to the change in the popup windows URL
		// This must appear before popup.focus();
		try {
			if (popup && popup.addEventListener) {

				// Get the origin of the redirect URI

				var a = hello.utils.url(redirectUri);
				var redirectUriOrigin = a.origin || (a.protocol + '//' + a.hostname);

				// Listen to changes in the InAppBrowser window

				popup.addEventListener('loadstart', function(e) {

					var url = e.url;

					// Is this the path, as given by the redirectUri?
					// Check the new URL agains the redirectUriOrigin.
					// According to #63 a user could click 'cancel' in some dialog boxes ....
					// The popup redirects to another page with the same origin, yet we still wish it to close.

					if (url.indexOf(redirectUriOrigin) !== 0) {
						return;
					}

					// Split appart the URL
					var a = hello.utils.url(url);

					// We dont have window operations on the popup so lets create some
					// The location can be augmented in to a location object like so...

					var _popup = {
						location: {
							// Change the location of the popup
							assign: function(location) {

								// Unfourtunatly an app is may not change the location of a InAppBrowser window.
								// So to shim this, just open a new one.
								popup.executeScript({code: 'window.location.href = "' + location + '";'});
							},

							search: a.search,
							hash: a.hash,
							href: a.href
						},
						close: function() {
							if (popup.close) {
								popup.close();
								try {
									popup.closed = true;
								}
								catch (_e) {}
							}
						}
					};

					// Then this URL contains information which HelloJS must process
					// URL string
					// Window - any action such as window relocation goes here
					// Opener - the parent window which opened this, aka this script

					hello.utils.responseHandler(_popup, window);

				});
			}
		}
		catch (e) {}

		return popup;
	};

})();

(function(hello) {

	// OAuth1
	var OAuth1Settings = {
		version: '1.0',
		auth: 'https://www.dropbox.com/1/oauth/authorize',
		request: 'https://api.dropbox.com/1/oauth/request_token',
		token: 'https://api.dropbox.com/1/oauth/access_token'
	};

	// OAuth2 Settings
	var OAuth2Settings = {
		version: 2,
		auth: 'https://www.dropbox.com/1/oauth2/authorize',
		grant: 'https://api.dropbox.com/1/oauth2/token'
	};

	// Initiate the Dropbox module
	hello.init({

		dropbox: {

			name: 'Dropbox',

			oauth: OAuth2Settings,

			login: function(p) {
				// OAuth2 non-standard adjustments
				p.qs.scope = '';

				// Should this be run as OAuth1?
				// If the redirect_uri is is HTTP (non-secure) then its required to revert to the OAuth1 endpoints
				var redirect = decodeURIComponent(p.qs.redirect_uri);
				if (redirect.indexOf('http:') === 0 && redirect.indexOf('http://localhost/') !== 0) {

					// Override the dropbox OAuth settings.
					hello.services.dropbox.oauth = OAuth1Settings;
				}
				else {
					// Override the dropbox OAuth settings.
					hello.services.dropbox.oauth = OAuth2Settings;
				}

				// The dropbox login window is a different size
				p.options.popup.width = 1000;
				p.options.popup.height = 1000;
			},

			/*
				Dropbox does not allow insecure HTTP URI's in the redirect_uri field
				...otherwise I'd love to use OAuth2

				Follow request https://forums.dropbox.com/topic.php?id=106505

				p.qs.response_type = 'code';
				oauth: {
					version: 2,
					auth: 'https://www.dropbox.com/1/oauth2/authorize',
					grant: 'https://api.dropbox.com/1/oauth2/token'
				}
			*/

			// API Base URL
			base: 'https://api.dropbox.com/1/',

			// Bespoke setting: this is states whether to use the custom environment of Dropbox or to use their own environment
			// Because it's notoriously difficult for Dropbox too provide access from other webservices, this defaults to Sandbox
			root: 'sandbox',

			// Map GET requests
			get: {
				me: 'account/info',

				// Https://www.dropbox.com/developers/core/docs#metadata
				'me/files': req('metadata/auto/@{parent|}'),
				'me/folder': req('metadata/auto/@{id}'),
				'me/folders': req('metadata/auto/'),

				'default': function(p, callback) {
					if (p.path.match('https://api-content.dropbox.com/1/files/')) {
						// This is a file, return binary data
						p.method = 'blob';
					}

					callback(p.path);
				}
			},

			post: {
				'me/files': function(p, callback) {

					var path = p.data.parent;
					var fileName = p.data.name;

					p.data = {
						file: p.data.file
					};

					// Does this have a data-uri to upload as a file?
					if (typeof (p.data.file) === 'string') {
						p.data.file = hello.utils.toBlob(p.data.file);
					}

					callback('https://api-content.dropbox.com/1/files_put/auto/' + path + '/' + fileName);
				},

				'me/folders': function(p, callback) {

					var name = p.data.name;
					p.data = {};

					callback('fileops/create_folder?root=@{root|sandbox}&' + hello.utils.param({
						path: name
					}));
				}
			},

			// Map DELETE requests
			del: {
				'me/files': 'fileops/delete?root=@{root|sandbox}&path=@{id}',
				'me/folder': 'fileops/delete?root=@{root|sandbox}&path=@{id}'
			},

			wrap: {
				me: function(o) {
					formatError(o);
					if (!o.uid) {
						return o;
					}

					o.name = o.display_name;
					var m = o.name.split(' ');
					o.first_name = m.shift();
					o.last_name = m.join(' ');
					o.id = o.uid;
					delete o.uid;
					delete o.display_name;
					return o;
				},

				'default': function(o, headers, req) {
					formatError(o);
					if (o.is_dir && o.contents) {
						o.data = o.contents;
						delete o.contents;

						o.data.forEach(function(item) {
							item.root = o.root;
							formatFile(item, headers, req);
						});
					}

					formatFile(o, headers, req);

					if (o.is_deleted) {
						o.success = true;
					}

					return o;
				}
			},

			// Doesn't return the CORS headers
			xhr: function(p) {

				// The proxy supports allow-cross-origin-resource
				// Alas that's the only thing we're using.
				if (p.data && p.data.file) {
					var file = p.data.file;
					if (file) {
						if (file.files) {
							p.data = file.files[0];
						}
						else {
							p.data = file;
						}
					}
				}

				if (p.method === 'delete') {
					p.method = 'post';
				}

				return true;
			},

			form: function(p, qs) {
				delete qs.state;
				delete qs.redirect_uri;
			}
		}
	});

	function formatError(o) {
		if (o && 'error' in o) {
			o.error = {
				code: 'server_error',
				message: o.error.message || o.error
			};
		}
	}

	function formatFile(o, headers, req) {

		if (typeof o !== 'object' ||
			(typeof Blob !== 'undefined' && o instanceof Blob) ||
			(typeof ArrayBuffer !== 'undefined' && o instanceof ArrayBuffer)) {
			// This is a file, let it through unformatted
			return;
		}

		if ('error' in o) {
			return;
		}

		var path = (o.root !== 'app_folder' ? o.root : '') + o.path.replace(/\&/g, '%26');
		path = path.replace(/^\//, '');
		if (o.thumb_exists) {
			o.thumbnail = req.oauth_proxy + '?path=' +
			encodeURIComponent('https://api-content.dropbox.com/1/thumbnails/auto/' + path + '?format=jpeg&size=m') + '&access_token=' + req.options.access_token;
		}

		o.type = (o.is_dir ? 'folder' : o.mime_type);
		o.name = o.path.replace(/.*\//g, '');
		if (o.is_dir) {
			o.files = path.replace(/^\//, '');
		}
		else {
			o.downloadLink = hello.settings.oauth_proxy + '?path=' +
			encodeURIComponent('https://api-content.dropbox.com/1/files/auto/' + path) + '&access_token=' + req.options.access_token;
			o.file = 'https://api-content.dropbox.com/1/files/auto/' + path;
		}

		if (!o.id) {
			o.id = o.path.replace(/^\//, '');
		}

		// O.media = 'https://api-content.dropbox.com/1/files/' + path;
	}

	function req(str) {
		return function(p, cb) {
			delete p.query.limit;
			cb(str);
		};
	}

})(hello);

(function(hello) {

	hello.init({

		facebook: {

			name: 'Facebook',

			// SEE https://developers.facebook.com/docs/facebook-login/manually-build-a-login-flow/v2.1
			oauth: {
				version: 2,
				auth: 'https://www.facebook.com/dialog/oauth/',
				grant: 'https://graph.facebook.com/oauth/access_token'
			},

			// Authorization scopes
			scope: {
				basic: 'public_profile',
				email: 'email',
				share: 'user_posts',
				birthday: 'user_birthday',
				events: 'user_events',
				photos: 'user_photos',
				videos: 'user_videos',
				friends: 'user_friends',
				files: 'user_photos,user_videos',
				publish_files: 'user_photos,user_videos,publish_actions',
				publish: 'publish_actions',

				// Deprecated in v2.0
				// Create_event	: 'create_event',

				offline_access: ''
			},

			// Refresh the access_token
			refresh: true,

			login: function(p) {

				// Reauthenticate
				// https://developers.facebook.com/docs/facebook-login/reauthentication
				if (p.options.force) {
					p.qs.auth_type = 'reauthenticate';
				}
			},

			logout: function(callback, options) {
				// Assign callback to a global handler
				var callbackID = hello.utils.globalEvent(callback);
				var redirect = encodeURIComponent(hello.settings.redirect_uri + '?' + hello.utils.param({callback:callbackID, result: JSON.stringify({force:true}), state: '{}'}));
				var token = (options.authResponse || {}).access_token;
				hello.utils.iframe('https://www.facebook.com/logout.php?next=' + redirect + '&access_token=' + token);

				// Possible responses:
				// String URL	- hello.logout should handle the logout
				// Undefined	- this function will handle the callback
				// True - throw a success, this callback isn't handling the callback
				// False - throw a error
				if (!token) {
					// If there isn't a token, the above wont return a response, so lets trigger a response
					return false;
				}
			},

			// API Base URL
			base: 'https://graph.facebook.com/v2.4/',

			// Map GET requests
			get: {
				me: 'me?fields=email,first_name,last_name,name,timezone,verified',
				'me/friends': 'me/friends',
				'me/following': 'me/friends',
				'me/followers': 'me/friends',
				'me/share': 'me/feed',
				'me/like': 'me/likes',
				'me/files': 'me/albums',
				'me/albums': 'me/albums?fields=cover_photo,name',
				'me/album': '@{id}/photos?fields=picture',
				'me/photos': 'me/photos',
				'me/photo': '@{id}',
				'friend/albums': '@{id}/albums',
				'friend/photos': '@{id}/photos'

				// Pagination
				// Https://developers.facebook.com/docs/reference/api/pagination/
			},

			// Map POST requests
			post: {
				'me/share': 'me/feed',
				'me/photo': '@{id}'

				// Https://developers.facebook.com/docs/graph-api/reference/v2.2/object/likes/
			},

			wrap: {
				me: formatUser,
				'me/friends': formatFriends,
				'me/following': formatFriends,
				'me/followers': formatFriends,
				'me/albums': format,
				'me/photos': format,
				'me/files': format,
				'default': format
			},

			// Special requirements for handling XHR
			xhr: function(p, qs) {
				if (p.method === 'get' || p.method === 'post') {
					qs.suppress_response_codes = true;
				}

				// Is this a post with a data-uri?
				if (p.method === 'post' && p.data && typeof (p.data.file) === 'string') {
					// Convert the Data-URI to a Blob
					p.data.file = hello.utils.toBlob(p.data.file);
				}

				return true;
			},

			// Special requirements for handling JSONP fallback
			jsonp: function(p, qs) {
				var m = p.method;
				if (m !== 'get' && !hello.utils.hasBinary(p.data)) {
					p.data.method = m;
					p.method = 'get';
				}
				else if (p.method === 'delete') {
					qs.method = 'delete';
					p.method = 'post';
				}
			},

			// Special requirements for iframe form hack
			form: function(p) {
				return {
					// Fire the callback onload
					callbackonload: true
				};
			}
		}
	});

	var base = 'https://graph.facebook.com/';

	function formatUser(o) {
		if (o.id) {
			o.thumbnail = o.picture = 'https://graph.facebook.com/' + o.id + '/picture';
		}

		return o;
	}

	function formatFriends(o) {
		if ('data' in o) {
			o.data.forEach(formatUser);
		}

		return o;
	}

	function format(o, headers, req) {
		if (typeof o === 'boolean') {
			o = {success: o};
		}

		if (o && 'data' in o) {
			var token = req.query.access_token;

			if (!(o.data instanceof Array)) {
				var data = o.data;
				delete o.data;
				o.data = [data];
			}

			o.data.forEach(function(d) {

				if (d.picture) {
					d.thumbnail = d.picture;
				}

				d.pictures = (d.images || [])
					.sort(function(a, b) {
						return a.width - b.width;
					});

				if (d.cover_photo && d.cover_photo.id) {
					d.thumbnail = base + d.cover_photo.id + '/picture?access_token=' + token;
				}

				if (d.type === 'album') {
					d.files = d.photos = base + d.id + '/photos';
				}

				if (d.can_upload) {
					d.upload_location = base + d.id + '/photos';
				}
			});
		}

		return o;
	}

})(hello);

(function(hello) {

	hello.init({

		flickr: {

			name: 'Flickr',

			// Ensure that you define an oauth_proxy
			oauth: {
				version: '1.0a',
				auth: 'https://www.flickr.com/services/oauth/authorize?perms=read',
				request: 'https://www.flickr.com/services/oauth/request_token',
				token: 'https://www.flickr.com/services/oauth/access_token'
			},

			// API base URL
			base: 'https://api.flickr.com/services/rest',

			// Map GET resquests
			get: {
				me: sign('flickr.people.getInfo'),
				'me/friends': sign('flickr.contacts.getList', {per_page:'@{limit|50}'}),
				'me/following': sign('flickr.contacts.getList', {per_page:'@{limit|50}'}),
				'me/followers': sign('flickr.contacts.getList', {per_page:'@{limit|50}'}),
				'me/albums': sign('flickr.photosets.getList', {per_page:'@{limit|50}'}),
				'me/album': sign('flickr.photosets.getPhotos', {photoset_id: '@{id}'}),
				'me/photos': sign('flickr.people.getPhotos', {per_page:'@{limit|50}'})
			},

			wrap: {
				me: function(o) {
					formatError(o);
					o = checkResponse(o, 'person');
					if (o.id) {
						if (o.realname) {
							o.name = o.realname._content;
							var m = o.name.split(' ');
							o.first_name = m.shift();
							o.last_name = m.join(' ');
						}

						o.thumbnail = getBuddyIcon(o, 'l');
						o.picture = getBuddyIcon(o, 'l');
					}

					return o;
				},

				'me/friends': formatFriends,
				'me/followers': formatFriends,
				'me/following': formatFriends,
				'me/albums': function(o) {
					formatError(o);
					o = checkResponse(o, 'photosets');
					paging(o);
					if (o.photoset) {
						o.data = o.photoset;
						o.data.forEach(function(item) {
							item.name = item.title._content;
							item.photos = 'https://api.flickr.com/services/rest' + getApiUrl('flickr.photosets.getPhotos', {photoset_id: item.id}, true);
						});

						delete o.photoset;
					}

					return o;
				},

				'me/photos': function(o) {
					formatError(o);
					return formatPhotos(o);
				},

				'default': function(o) {
					formatError(o);
					return formatPhotos(o);
				}
			},

			xhr: false,

			jsonp: function(p, qs) {
				if (p.method == 'get') {
					delete qs.callback;
					qs.jsoncallback = p.callbackID;
				}
			}
		}
	});

	function getApiUrl(method, extraParams, skipNetwork) {
		var url = ((skipNetwork) ? '' : 'flickr:') +
			'?method=' + method +
			'&api_key=' + hello.services.flickr.id +
			'&format=json';
		for (var param in extraParams) {
			if (extraParams.hasOwnProperty(param)) {
				url += '&' + param + '=' + extraParams[param];
			}
		}

		return url;
	}

	// This is not exactly neat but avoid to call
	// The method 'flickr.test.login' for each api call

	function withUser(cb) {
		var auth = hello.getAuthResponse('flickr');
		cb(auth && auth.user_nsid ? auth.user_nsid : null);
	}

	function sign(url, params) {
		if (!params) {
			params = {};
		}

		return function(p, callback) {
			withUser(function(userId) {
				params.user_id = userId;
				callback(getApiUrl(url, params, true));
			});
		};
	}

	function getBuddyIcon(profile, size) {
		var url = 'https://www.flickr.com/images/buddyicon.gif';
		if (profile.nsid && profile.iconserver && profile.iconfarm) {
			url = 'https://farm' + profile.iconfarm + '.staticflickr.com/' +
				profile.iconserver + '/' +
				'buddyicons/' + profile.nsid +
				((size) ? '_' + size : '') + '.jpg';
		}

		return url;
	}

	// See: https://www.flickr.com/services/api/misc.urls.html
	function createPhotoUrl(id, farm, server, secret, size) {
		size = (size) ? '_' + size : '';
		return 'https://farm' + farm + '.staticflickr.com/' + server + '/' + id + '_' + secret + size + '.jpg';
	}

	function formatUser(o) {
	}

	function formatError(o) {
		if (o && o.stat && o.stat.toLowerCase() != 'ok') {
			o.error = {
				code: 'invalid_request',
				message: o.message
			};
		}
	}

	function formatPhotos(o) {
		if (o.photoset || o.photos) {
			var set = ('photoset' in o) ? 'photoset' : 'photos';
			o = checkResponse(o, set);
			paging(o);
			o.data = o.photo;
			delete o.photo;
			for (var i = 0; i < o.data.length; i++) {
				var photo = o.data[i];
				photo.name = photo.title;
				photo.picture = createPhotoUrl(photo.id, photo.farm, photo.server, photo.secret, '');
				photo.pictures = createPictures(photo.id, photo.farm, photo.server, photo.secret);
				photo.source = createPhotoUrl(photo.id, photo.farm, photo.server, photo.secret, 'b');
				photo.thumbnail = createPhotoUrl(photo.id, photo.farm, photo.server, photo.secret, 'm');
			}
		}

		return o;
	}

	// See: https://www.flickr.com/services/api/misc.urls.html
	function createPictures(id, farm, server, secret) {

		var NO_LIMIT = 2048;
		var sizes = [
			{id: 't', max: 100},
			{id: 'm', max: 240},
			{id: 'n', max: 320},
			{id: '', max: 500},
			{id: 'z', max: 640},
			{id: 'c', max: 800},
			{id: 'b', max: 1024},
			{id: 'h', max: 1600},
			{id: 'k', max: 2048},
			{id: 'o', max: NO_LIMIT}
		];

		return sizes.map(function(size) {
			return {
				source: createPhotoUrl(id, farm, server, secret, size.id),

				// Note: this is a guess that's almost certain to be wrong (unless square source)
				width: size.max,
				height: size.max
			};
		});
	}

	function checkResponse(o, key) {

		if (key in o) {
			o = o[key];
		}
		else if (!('error' in o)) {
			o.error = {
				code: 'invalid_request',
				message: o.message || 'Failed to get data from Flickr'
			};
		}

		return o;
	}

	function formatFriends(o) {
		formatError(o);
		if (o.contacts) {
			o = checkResponse(o, 'contacts');
			paging(o);
			o.data = o.contact;
			delete o.contact;
			for (var i = 0; i < o.data.length; i++) {
				var item = o.data[i];
				item.id = item.nsid;
				item.name = item.realname || item.username;
				item.thumbnail = getBuddyIcon(item, 'm');
			}
		}

		return o;
	}

	function paging(res) {
		if (res.page && res.pages && res.page !== res.pages) {
			res.paging = {
				next: '?page=' + (++res.page)
			};
		}
	}

})(hello);

(function(hello) {

	hello.init({

		foursquare: {

			name: 'Foursquare',

			oauth: {
				// See: https://developer.foursquare.com/overview/auth
				version: 2,
				auth: 'https://foursquare.com/oauth2/authenticate',
				grant: 'https://foursquare.com/oauth2/access_token'
			},

			// Refresh the access_token once expired
			refresh: true,

			base: 'https://api.foursquare.com/v2/',

			get: {
				me: 'users/self',
				'me/friends': 'users/self/friends',
				'me/followers': 'users/self/friends',
				'me/following': 'users/self/friends'
			},

			wrap: {
				me: function(o) {
					formatError(o);
					if (o && o.response) {
						o = o.response.user;
						formatUser(o);
					}

					return o;
				},

				'default': function(o) {
					formatError(o);

					// Format friends
					if (o && 'response' in o && 'friends' in o.response && 'items' in o.response.friends) {
						o.data = o.response.friends.items;
						o.data.forEach(formatUser);
						delete o.response;
					}

					return o;
				}
			},

			xhr: formatRequest,
			jsonp: formatRequest
		}
	});

	function formatError(o) {
		if (o.meta && (o.meta.code === 400 || o.meta.code === 401)) {
			o.error = {
				code: 'access_denied',
				message: o.meta.errorDetail
			};
		}
	}

	function formatUser(o) {
		if (o && o.id) {
			o.thumbnail = o.photo.prefix + '100x100' + o.photo.suffix;
			o.name = o.firstName + ' ' + o.lastName;
			o.first_name = o.firstName;
			o.last_name = o.lastName;
			if (o.contact) {
				if (o.contact.email) {
					o.email = o.contact.email;
				}
			}
		}
	}

	function formatRequest(p, qs) {
		var token = qs.access_token;
		delete qs.access_token;
		qs.oauth_token = token;
		qs.v = 20121125;
		return true;
	}

})(hello);

(function(hello) {

	hello.init({

		github: {

			name: 'GitHub',

			oauth: {
				version: 2,
				auth: 'https://github.com/login/oauth/authorize',
				grant: 'https://github.com/login/oauth/access_token',
				response_type: 'code'
			},

			scope: {
				email: 'user:email'
			},

			base: 'https://api.github.com/',

			get: {
				me: 'user',
				'me/friends': 'user/following?per_page=@{limit|100}',
				'me/following': 'user/following?per_page=@{limit|100}',
				'me/followers': 'user/followers?per_page=@{limit|100}',
				'me/like': 'user/starred?per_page=@{limit|100}'
			},

			wrap: {
				me: function(o, headers) {

					formatError(o, headers);
					formatUser(o);

					return o;
				},

				'default': function(o, headers, req) {

					formatError(o, headers);

					if (Array.isArray(o)) {
						o = {data:o};
					}

					if (o.data) {
						paging(o, headers, req);
						o.data.forEach(formatUser);
					}

					return o;
				}
			},

			xhr: function(p) {

				if (p.method !== 'get' && p.data) {

					// Serialize payload as JSON
					p.headers = p.headers || {};
					p.headers['Content-Type'] = 'application/json';
					if (typeof (p.data) === 'object') {
						p.data = JSON.stringify(p.data);
					}
				}

				return true;
			}
		}
	});

	function formatError(o, headers) {
		var code = headers ? headers.statusCode : (o && 'meta' in o && 'status' in o.meta && o.meta.status);
		if ((code === 401 || code === 403)) {
			o.error = {
				code: 'access_denied',
				message: o.message || (o.data ? o.data.message : 'Could not get response')
			};
			delete o.message;
		}
	}

	function formatUser(o) {
		if (o.id) {
			o.thumbnail = o.picture = o.avatar_url;
			o.name = o.login;
		}
	}

	function paging(res, headers, req) {
		if (res.data && res.data.length && headers && headers.Link) {
			var next = headers.Link.match(/<(.*?)>;\s*rel=\"next\"/);
			if (next) {
				res.paging = {
					next: next[1]
				};
			}
		}
	}

})(hello);

(function(hello) {

	var contactsUrl = 'https://www.google.com/m8/feeds/contacts/default/full?v=3.0&alt=json&max-results=@{limit|1000}&start-index=@{start|1}';

	hello.init({

		google: {

			name: 'Google Plus',

			// See: http://code.google.com/apis/accounts/docs/OAuth2UserAgent.html
			oauth: {
				version: 2,
				auth: 'https://accounts.google.com/o/oauth2/auth',
				grant: 'https://accounts.google.com/o/oauth2/token'
			},

			// Authorization scopes
			scope: {
				basic: 'https://www.googleapis.com/auth/plus.me profile',
				email: 'email',
				birthday: '',
				events: '',
				photos: 'https://picasaweb.google.com/data/',
				videos: 'http://gdata.youtube.com',
				friends: 'https://www.google.com/m8/feeds, https://www.googleapis.com/auth/plus.login',
				files: 'https://www.googleapis.com/auth/drive.readonly',
				publish: '',
				publish_files: 'https://www.googleapis.com/auth/drive',
				share: '',
				create_event: '',
				offline_access: ''
			},

			scope_delim: ' ',

			login: function(p) {

				if (p.qs.response_type === 'code') {

					// Let's set this to an offline access to return a refresh_token
					p.qs.access_type = 'offline';
				}

				// Reauthenticate
				// https://developers.google.com/identity/protocols/
				if (p.options.force) {
					p.qs.approval_prompt = 'force';
				}
			},

			// API base URI
			base: 'https://www.googleapis.com/',

			// Map GET requests
			get: {
				me: 'plus/v1/people/me',

				// Deprecated Sept 1, 2014
				//'me': 'oauth2/v1/userinfo?alt=json',

				// See: https://developers.google.com/+/api/latest/people/list
				'me/friends': 'plus/v1/people/me/people/visible?maxResults=@{limit|100}',
				'me/following': contactsUrl,
				'me/followers': contactsUrl,
				'me/contacts': contactsUrl,
				'me/share': 'plus/v1/people/me/activities/public?maxResults=@{limit|100}',
				'me/feed': 'plus/v1/people/me/activities/public?maxResults=@{limit|100}',
				'me/albums': 'https://picasaweb.google.com/data/feed/api/user/default?alt=json&max-results=@{limit|100}&start-index=@{start|1}',
				'me/album': function(p, callback) {
					var key = p.query.id;
					delete p.query.id;
					callback(key.replace('/entry/', '/feed/'));
				},

				'me/photos': 'https://picasaweb.google.com/data/feed/api/user/default?alt=json&kind=photo&max-results=@{limit|100}&start-index=@{start|1}',

				// See: https://developers.google.com/drive/v2/reference/files/list
				'me/file': 'drive/v2/files/@{id}',
				'me/files': 'drive/v2/files?q=%22@{parent|root}%22+in+parents+and+trashed=false&maxResults=@{limit|100}',

				// See: https://developers.google.com/drive/v2/reference/files/list
				'me/folders': 'drive/v2/files?q=%22@{id|root}%22+in+parents+and+mimeType+=+%22application/vnd.google-apps.folder%22+and+trashed=false&maxResults=@{limit|100}',

				// See: https://developers.google.com/drive/v2/reference/files/list
				'me/folder': 'drive/v2/files?q=%22@{id|root}%22+in+parents+and+trashed=false&maxResults=@{limit|100}'
			},

			// Map POST requests
			post: {

				// Google Drive
				'me/files': uploadDrive,
				'me/folders': function(p, callback) {
					p.data = {
						title: p.data.name,
						parents: [{id: p.data.parent || 'root'}],
						mimeType: 'application/vnd.google-apps.folder'
					};
					callback('drive/v2/files');
				}
			},

			// Map PUT requests
			put: {
				'me/files': uploadDrive
			},

			// Map DELETE requests
			del: {
				'me/files': 'drive/v2/files/@{id}',
				'me/folder': 'drive/v2/files/@{id}'
			},

			// Map PATCH requests
			patch: {
				'me/file': 'drive/v2/files/@{id}'
			},

			wrap: {
				me: function(o) {
					if (o.id) {
						o.last_name = o.family_name || (o.name ? o.name.familyName : null);
						o.first_name = o.given_name || (o.name ? o.name.givenName : null);

						if (o.emails && o.emails.length) {
							o.email = o.emails[0].value;
						}

						formatPerson(o);
					}

					return o;
				},

				'me/friends': function(o) {
					if (o.items) {
						paging(o);
						o.data = o.items;
						o.data.forEach(formatPerson);
						delete o.items;
					}

					return o;
				},

				'me/contacts': formatFriends,
				'me/followers': formatFriends,
				'me/following': formatFriends,
				'me/share': formatFeed,
				'me/feed': formatFeed,
				'me/albums': gEntry,
				'me/photos': formatPhotos,
				'default': gEntry
			},

			xhr: function(p) {

				if (p.method === 'post' || p.method === 'put') {
					toJSON(p);
				}
				else if (p.method === 'patch') {
					hello.utils.extend(p.query, p.data);
					p.data = null;
				}

				return true;
			},

			// Don't even try submitting via form.
			// This means no POST operations in <=IE9
			form: false
		}
	});

	function toInt(s) {
		return parseInt(s, 10);
	}

	function formatFeed(o) {
		paging(o);
		o.data = o.items;
		delete o.items;
		return o;
	}

	// Format: ensure each record contains a name, id etc.
	function formatItem(o) {
		if (o.error) {
			return;
		}

		if (!o.name) {
			o.name = o.title || o.message;
		}

		if (!o.picture) {
			o.picture = o.thumbnailLink;
		}

		if (!o.thumbnail) {
			o.thumbnail = o.thumbnailLink;
		}

		if (o.mimeType === 'application/vnd.google-apps.folder') {
			o.type = 'folder';
			o.files = 'https://www.googleapis.com/drive/v2/files?q=%22' + o.id + '%22+in+parents';
		}

		return o;
	}

	function formatImage(image) {
		return {
			source: image.url,
			width: image.width,
			height: image.height
		};
	}

	function formatPhotos(o) {
		o.data = o.feed.entry.map(formatEntry);
		delete o.feed;
	}

	// Google has a horrible JSON API
	function gEntry(o) {
		paging(o);

		if ('feed' in o && 'entry' in o.feed) {
			o.data = o.feed.entry.map(formatEntry);
			delete o.feed;
		}

		// Old style: Picasa, etc.
		else if ('entry' in o) {
			return formatEntry(o.entry);
		}

		// New style: Google Drive & Plus
		else if ('items' in o) {
			o.data = o.items.map(formatItem);
			delete o.items;
		}
		else {
			formatItem(o);
		}

		return o;
	}

	function formatPerson(o) {
		o.name = o.displayName || o.name;
		o.picture = o.picture || (o.image ? o.image.url : null);
		o.thumbnail = o.picture;
	}

	function formatFriends(o, headers, req) {
		paging(o);
		var r = [];
		if ('feed' in o && 'entry' in o.feed) {
			var token = req.query.access_token;
			for (var i = 0; i < o.feed.entry.length; i++) {
				var a = o.feed.entry[i];

				a.id	= a.id.$t;
				a.name	= a.title.$t;
				delete a.title;
				if (a.gd$email) {
					a.email	= (a.gd$email && a.gd$email.length > 0) ? a.gd$email[0].address : null;
					a.emails = a.gd$email;
					delete a.gd$email;
				}

				if (a.updated) {
					a.updated = a.updated.$t;
				}

				if (a.link) {

					var pic = (a.link.length > 0) ? a.link[0].href : null;
					if (pic && a.link[0].gd$etag) {
						pic += (pic.indexOf('?') > -1 ? '&' : '?') + 'access_token=' + token;
						a.picture = pic;
						a.thumbnail = pic;
					}

					delete a.link;
				}

				if (a.category) {
					delete a.category;
				}
			}

			o.data = o.feed.entry;
			delete o.feed;
		}

		return o;
	}

	function formatEntry(a) {

		var group = a.media$group;
		var photo = group.media$content.length ? group.media$content[0] : {};
		var mediaContent = group.media$content || [];
		var mediaThumbnail = group.media$thumbnail || [];

		var pictures = mediaContent
			.concat(mediaThumbnail)
			.map(formatImage)
			.sort(function(a, b) {
				return a.width - b.width;
			});

		var i = 0;
		var _a;
		var p = {
			id: a.id.$t,
			name: a.title.$t,
			description: a.summary.$t,
			updated_time: a.updated.$t,
			created_time: a.published.$t,
			picture: photo ? photo.url : null,
			pictures: pictures,
			images: [],
			thumbnail: photo ? photo.url : null,
			width: photo.width,
			height: photo.height
		};

		// Get feed/children
		if ('link' in a) {
			for (i = 0; i < a.link.length; i++) {
				var d = a.link[i];
				if (d.rel.match(/\#feed$/)) {
					p.upload_location = p.files = p.photos = d.href;
					break;
				}
			}
		}

		// Get images of different scales
		if ('category' in a && a.category.length) {
			_a = a.category;
			for (i = 0; i < _a.length; i++) {
				if (_a[i].scheme && _a[i].scheme.match(/\#kind$/)) {
					p.type = _a[i].term.replace(/^.*?\#/, '');
				}
			}
		}

		// Get images of different scales
		if ('media$thumbnail' in group && group.media$thumbnail.length) {
			_a = group.media$thumbnail;
			p.thumbnail = _a[0].url;
			p.images = _a.map(formatImage);
		}

		_a = group.media$content;

		if (_a && _a.length) {
			p.images.push(formatImage(_a[0]));
		}

		return p;
	}

	function paging(res) {

		// Contacts V2
		if ('feed' in res && res.feed.openSearch$itemsPerPage) {
			var limit = toInt(res.feed.openSearch$itemsPerPage.$t);
			var start = toInt(res.feed.openSearch$startIndex.$t);
			var total = toInt(res.feed.openSearch$totalResults.$t);

			if ((start + limit) < total) {
				res.paging = {
					next: '?start=' + (start + limit)
				};
			}
		}
		else if ('nextPageToken' in res) {
			res.paging = {
				next: '?pageToken=' + res.nextPageToken
			};
		}
	}

	// Construct a multipart message
	function Multipart() {

		// Internal body
		var body = [];
		var boundary = (Math.random() * 1e10).toString(32);
		var counter = 0;
		var lineBreak = '\r\n';
		var delim = lineBreak + '--' + boundary;
		var ready = function() {};

		var dataUri = /^data\:([^;,]+(\;charset=[^;,]+)?)(\;base64)?,/i;

		// Add file
		function addFile(item) {
			var fr = new FileReader();
			fr.onload = function(e) {
				addContent(btoa(e.target.result), item.type + lineBreak + 'Content-Transfer-Encoding: base64');
			};

			fr.readAsBinaryString(item);
		}

		// Add content
		function addContent(content, type) {
			body.push(lineBreak + 'Content-Type: ' + type + lineBreak + lineBreak + content);
			counter--;
			ready();
		}

		// Add new things to the object
		this.append = function(content, type) {

			// Does the content have an array
			if (typeof (content) === 'string' || !('length' in Object(content))) {
				// Converti to multiples
				content = [content];
			}

			for (var i = 0; i < content.length; i++) {

				counter++;

				var item = content[i];

				// Is this a file?
				// Files can be either Blobs or File types
				if (
					(typeof (File) !== 'undefined' && item instanceof File) ||
					(typeof (Blob) !== 'undefined' && item instanceof Blob)
				) {
					// Read the file in
					addFile(item);
				}

				// Data-URI?
				// Data:[<mime type>][;charset=<charset>][;base64],<encoded data>
				// /^data\:([^;,]+(\;charset=[^;,]+)?)(\;base64)?,/i
				else if (typeof (item) === 'string' && item.match(dataUri)) {
					var m = item.match(dataUri);
					addContent(item.replace(dataUri, ''), m[1] + lineBreak + 'Content-Transfer-Encoding: base64');
				}

				// Regular string
				else {
					addContent(item, type);
				}
			}
		};

		this.onready = function(fn) {
			ready = function() {
				if (counter === 0) {
					// Trigger ready
					body.unshift('');
					body.push('--');
					fn(body.join(delim), boundary);
					body = [];
				}
			};

			ready();
		};
	}

	// Upload to Drive
	// If this is PUT then only augment the file uploaded
	// PUT https://developers.google.com/drive/v2/reference/files/update
	// POST https://developers.google.com/drive/manage-uploads
	function uploadDrive(p, callback) {

		var data = {};

		// Test for DOM element
		if (p.data &&
			(typeof (HTMLInputElement) !== 'undefined' && p.data instanceof HTMLInputElement)
		) {
			p.data = {file: p.data};
		}

		if (!p.data.name && Object(Object(p.data.file).files).length && p.method === 'post') {
			p.data.name = p.data.file.files[0].name;
		}

		if (p.method === 'post') {
			p.data = {
				title: p.data.name,
				parents: [{id: p.data.parent || 'root'}],
				file: p.data.file
			};
		}
		else {

			// Make a reference
			data = p.data;
			p.data = {};

			// Add the parts to change as required
			if (data.parent) {
				p.data.parents = [{id: p.data.parent || 'root'}];
			}

			if (data.file) {
				p.data.file = data.file;
			}

			if (data.name) {
				p.data.title = data.name;
			}
		}

		// Extract the file, if it exists from the data object
		// If the File is an INPUT element lets just concern ourselves with the NodeList
		var file;
		if ('file' in p.data) {
			file = p.data.file;
			delete p.data.file;

			if (typeof (file) === 'object' && 'files' in file) {
				// Assign the NodeList
				file = file.files;
			}

			if (!file || !file.length) {
				callback({
					error: {
						code: 'request_invalid',
						message: 'There were no files attached with this request to upload'
					}
				});
				return;
			}
		}

		// Set type p.data.mimeType = Object(file[0]).type || 'application/octet-stream';

		// Construct a multipart message
		var parts = new Multipart();
		parts.append(JSON.stringify(p.data), 'application/json');

		// Read the file into a  base64 string... yep a hassle, i know
		// FormData doesn't let us assign our own Multipart headers and HTTP Content-Type
		// Alas GoogleApi need these in a particular format
		if (file) {
			parts.append(file);
		}

		parts.onready(function(body, boundary) {

			p.headers['content-type'] = 'multipart/related; boundary="' + boundary + '"';
			p.data = body;

			callback('upload/drive/v2/files' + (data.id ? '/' + data.id : '') + '?uploadType=multipart');
		});

	}

	function toJSON(p) {
		if (typeof (p.data) === 'object') {
			// Convert the POST into a javascript object
			try {
				p.data = JSON.stringify(p.data);
				p.headers['content-type'] = 'application/json';
			}
			catch (e) {}
		}
	}

})(hello);

(function(hello) {

	hello.init({

		instagram: {

			name: 'Instagram',

			oauth: {
				// See: http://instagram.com/developer/authentication/
				version: 2,
				auth: 'https://instagram.com/oauth/authorize/',
				grant: 'https://api.instagram.com/oauth/access_token'
			},

			// Refresh the access_token once expired
			refresh: true,

			scope: {
				basic: 'basic',
				photos: '',
				friends: 'relationships',
				publish: 'likes comments',
				email: '',
				share: '',
				publish_files: '',
				files: '',
				videos: '',
				offline_access: ''
			},

			scope_delim: ' ',

			base: 'https://api.instagram.com/v1/',

			get: {
				me: 'users/self',
				'me/feed': 'users/self/feed?count=@{limit|100}',
				'me/photos': 'users/self/media/recent?min_id=0&count=@{limit|100}',
				'me/friends': 'users/self/follows?count=@{limit|100}',
				'me/following': 'users/self/follows?count=@{limit|100}',
				'me/followers': 'users/self/followed-by?count=@{limit|100}',
				'friend/photos': 'users/@{id}/media/recent?min_id=0&count=@{limit|100}'
			},

			post: {
				'me/like': function(p, callback) {
					var id = p.data.id;
					p.data = {};
					callback('media/' + id + '/likes');
				}
			},

			del: {
				'me/like': 'media/@{id}/likes'
			},

			wrap: {
				me: function(o) {

					formatError(o);

					if ('data' in o) {
						o.id = o.data.id;
						o.thumbnail = o.data.profile_picture;
						o.name = o.data.full_name || o.data.username;
					}

					return o;
				},

				'me/friends': formatFriends,
				'me/following': formatFriends,
				'me/followers': formatFriends,
				'me/photos': function(o) {

					formatError(o);
					paging(o);

					if ('data' in o) {
						o.data = o.data.filter(function(d) {
							return d.type === 'image';
						});

						o.data.forEach(function(d) {
							d.name = d.caption ? d.caption.text : null;
							d.thumbnail = d.images.thumbnail.url;
							d.picture = d.images.standard_resolution.url;
							d.pictures = Object.keys(d.images)
								.map(function(key) {
									var image = d.images[key];
									return formatImage(image);
								})
								.sort(function(a, b) {
									return a.width - b.width;
								});
						});
					}

					return o;
				},

				'default': function(o) {
					o = formatError(o);
					paging(o);
					return o;
				}
			},

			// Instagram does not return any CORS Headers
			// So besides JSONP we're stuck with proxy
			xhr: function(p, qs) {

				var method = p.method;
				var proxy = method !== 'get';

				if (proxy) {

					if ((method === 'post' || method === 'put') && p.query.access_token) {
						p.data.access_token = p.query.access_token;
						delete p.query.access_token;
					}

					// No access control headers
					// Use the proxy instead
					p.proxy = proxy;
				}

				return proxy;
			},

			// No form
			form: false
		}
	});

	function formatImage(image) {
		return {
			source: image.url,
			width: image.width,
			height: image.height
		};
	}

	function formatError(o) {
		if (typeof o === 'string') {
			return {
				error: {
					code: 'invalid_request',
					message: o
				}
			};
		}

		if (o && 'meta' in o && 'error_type' in o.meta) {
			o.error = {
				code: o.meta.error_type,
				message: o.meta.error_message
			};
		}

		return o;
	}

	function formatFriends(o) {
		paging(o);
		if (o && 'data' in o) {
			o.data.forEach(formatFriend);
		}

		return o;
	}

	function formatFriend(o) {
		if (o.id) {
			o.thumbnail = o.profile_picture;
			o.name = o.full_name || o.username;
		}
	}

	// See: http://instagram.com/developer/endpoints/
	function paging(res) {
		if ('pagination' in res) {
			res.paging = {
				next: res.pagination.next_url
			};
			delete res.pagination;
		}
	}

})(hello);

(function(hello) {

	hello.init({

		joinme: {

			name: 'join.me',

			oauth: {
				version: 2,
				auth: 'https://secure.join.me/api/public/v1/auth/oauth2',
				grant: 'https://secure.join.me/api/public/v1/auth/oauth2'
			},

			refresh: false,

			scope: {
				basic: 'user_info',
				user: 'user_info',
				scheduler: 'scheduler',
				start: 'start_meeting',
				email: '',
				friends: '',
				share: '',
				publish: '',
				photos: '',
				publish_files: '',
				files: '',
				videos: '',
				offline_access: ''
			},

			scope_delim: ' ',

			login: function(p) {
				p.options.popup.width = 400;
				p.options.popup.height = 700;
			},

			base: 'https://api.join.me/v1/',

			get: {
				me: 'user',
				meetings: 'meetings',
				'meetings/info': 'meetings/@{id}'
			},

			post: {
				'meetings/start/adhoc': function(p, callback) {
					callback('meetings/start');
				},

				'meetings/start/scheduled': function(p, callback) {
					var meetingId = p.data.meetingId;
					p.data = {};
					callback('meetings/' + meetingId + '/start');
				},

				'meetings/schedule': function(p, callback) {
					callback('meetings');
				}
			},

			patch: {
				'meetings/update': function(p, callback) {
					callback('meetings/' + p.data.meetingId);
				}
			},

			del: {
				'meetings/delete': 'meetings/@{id}'
			},

			wrap: {
				me: function(o, headers) {
					formatError(o, headers);

					if (!o.email) {
						return o;
					}

					o.name = o.fullName;
					o.first_name = o.name.split(' ')[0];
					o.last_name = o.name.split(' ')[1];
					o.id = o.email;

					return o;
				},

				'default': function(o, headers) {
					formatError(o, headers);

					return o;
				}
			},

			xhr: formatRequest

		}
	});

	function formatError(o, headers) {
		var errorCode;
		var message;
		var details;

		if (o && ('Message' in o)) {
			message = o.Message;
			delete o.Message;

			if ('ErrorCode' in o) {
				errorCode = o.ErrorCode;
				delete o.ErrorCode;
			}
			else {
				errorCode = getErrorCode(headers);
			}

			o.error = {
				code: errorCode,
				message: message,
				details: o
			};
		}

		return o;
	}

	function formatRequest(p, qs) {
		// Move the access token from the request body to the request header
		var token = qs.access_token;
		delete qs.access_token;
		p.headers.Authorization = 'Bearer ' + token;

		// Format non-get requests to indicate json body
		if (p.method !== 'get' && p.data) {
			p.headers['Content-Type'] = 'application/json';
			if (typeof (p.data) === 'object') {
				p.data = JSON.stringify(p.data);
			}
		}

		if (p.method === 'put') {
			p.method = 'patch';
		}

		return true;
	}

	function getErrorCode(headers) {
		switch (headers.statusCode) {
			case 400:
				return 'invalid_request';
			case 403:
				return 'stale_token';
			case 401:
				return 'invalid_token';
			case 500:
				return 'server_error';
			default:
				return 'server_error';
		}
	}

}(hello));

(function(hello) {

	hello.init({

		linkedin: {

			oauth: {
				version: 2,
				response_type: 'code',
				auth: 'https://www.linkedin.com/uas/oauth2/authorization',
				grant: 'https://www.linkedin.com/uas/oauth2/accessToken'
			},

			// Refresh the access_token once expired
			refresh: true,

			scope: {
				basic: 'r_basicprofile',
				email: 'r_emailaddress',
				files: '',
				friends: '',
				photos: '',
				publish: 'w_share',
				publish_files: 'w_share',
				share: '',
				videos: '',
				offline_access: ''
			},
			scope_delim: ' ',

			base: 'https://api.linkedin.com/v1/',

			get: {
				me: 'people/~:(picture-url,first-name,last-name,id,formatted-name,email-address)',

				// See: http://developer.linkedin.com/documents/get-network-updates-and-statistics-api
				'me/share': 'people/~/network/updates?count=@{limit|250}'
			},

			post: {

				// See: https://developer.linkedin.com/documents/api-requests-json
				'me/share': function(p, callback) {
					var data = {
						visibility: {
							code: 'anyone'
						}
					};

					if (p.data.id) {

						data.attribution = {
							share: {
								id: p.data.id
							}
						};

					}
					else {
						data.comment = p.data.message;
						if (p.data.picture && p.data.link) {
							data.content = {
								'submitted-url': p.data.link,
								'submitted-image-url': p.data.picture
							};
						}
					}

					p.data = JSON.stringify(data);

					callback('people/~/shares?format=json');
				},

				'me/like': like
			},

			del:{
				'me/like': like
			},

			wrap: {
				me: function(o) {
					formatError(o);
					formatUser(o);
					return o;
				},

				'me/friends': formatFriends,
				'me/following': formatFriends,
				'me/followers': formatFriends,
				'me/share': function(o) {
					formatError(o);
					paging(o);
					if (o.values) {
						o.data = o.values.map(formatUser);
						o.data.forEach(function(item) {
							item.message = item.headline;
						});

						delete o.values;
					}

					return o;
				},

				'default': function(o, headers) {
					formatError(o);
					empty(o, headers);
					paging(o);
				}
			},

			jsonp: function(p, qs) {
				formatQuery(qs);
				if (p.method === 'get') {
					qs.format = 'jsonp';
					qs['error-callback'] = p.callbackID;
				}
			},

			xhr: function(p, qs) {
				if (p.method !== 'get') {
					formatQuery(qs);
					p.headers['Content-Type'] = 'application/json';

					// Note: x-li-format ensures error responses are not returned in XML
					p.headers['x-li-format'] = 'json';
					p.proxy = true;
					return true;
				}

				return false;
			}
		}
	});

	function formatError(o) {
		if (o && 'errorCode' in o) {
			o.error = {
				code: o.status,
				message: o.message
			};
		}
	}

	function formatUser(o) {
		if (o.error) {
			return;
		}

		o.first_name = o.firstName;
		o.last_name = o.lastName;
		o.name = o.formattedName || (o.first_name + ' ' + o.last_name);
		o.thumbnail = o.pictureUrl;
		o.email = o.emailAddress;
		return o;
	}

	function formatFriends(o) {
		formatError(o);
		paging(o);
		if (o.values) {
			o.data = o.values.map(formatUser);
			delete o.values;
		}

		return o;
	}

	function paging(res) {
		if ('_count' in res && '_start' in res && (res._count + res._start) < res._total) {
			res.paging = {
				next: '?start=' + (res._start + res._count) + '&count=' + res._count
			};
		}
	}

	function empty(o, headers) {
		if (JSON.stringify(o) === '{}' && headers.statusCode === 200) {
			o.success = true;
		}
	}

	function formatQuery(qs) {
		// LinkedIn signs requests with the parameter 'oauth2_access_token'
		// ... yeah another one who thinks they should be different!
		if (qs.access_token) {
			qs.oauth2_access_token = qs.access_token;
			delete qs.access_token;
		}
	}

	function like(p, callback) {
		p.headers['x-li-format'] = 'json';
		var id = p.data.id;
		p.data = (p.method !== 'delete').toString();
		p.method = 'put';
		callback('people/~/network/updates/key=' + id + '/is-liked');
	}

})(hello);

// See: https://developers.soundcloud.com/docs/api/reference
(function(hello) {

	hello.init({

		soundcloud: {
			name: 'SoundCloud',

			oauth: {
				version: 2,
				auth: 'https://soundcloud.com/connect',
				grant: 'https://soundcloud.com/oauth2/token'
			},

			// Request path translated
			base: 'https://api.soundcloud.com/',
			get: {
				me: 'me.json',

				// Http://developers.soundcloud.com/docs/api/reference#me
				'me/friends': 'me/followings.json',
				'me/followers': 'me/followers.json',
				'me/following': 'me/followings.json',

				// See: http://developers.soundcloud.com/docs/api/reference#activities
				'default': function(p, callback) {

					// Include '.json at the end of each request'
					callback(p.path + '.json');
				}
			},

			// Response handlers
			wrap: {
				me: function(o) {
					formatUser(o);
					return o;
				},

				'default': function(o) {
					if (Array.isArray(o)) {
						o = {
							data: o.map(formatUser)
						};
					}

					paging(o);
					return o;
				}
			},

			xhr: formatRequest,
			jsonp: formatRequest
		}
	});

	function formatRequest(p, qs) {
		// Alter the querystring
		var token = qs.access_token;
		delete qs.access_token;
		qs.oauth_token = token;
		qs['_status_code_map[302]'] = 200;
		return true;
	}

	function formatUser(o) {
		if (o.id) {
			o.picture = o.avatar_url;
			o.thumbnail = o.avatar_url;
			o.name = o.username || o.full_name;
		}

		return o;
	}

	// See: http://developers.soundcloud.com/docs/api/reference#activities
	function paging(res) {
		if ('next_href' in res) {
			res.paging = {
				next: res.next_href
			};
		}
	}

})(hello);

(function(hello) {

	var base = 'https://api.twitter.com/';

	hello.init({

		twitter: {

			// Ensure that you define an oauth_proxy
			oauth: {
				version: '1.0a',
				auth: base + 'oauth/authenticate',
				request: base + 'oauth/request_token',
				token: base + 'oauth/access_token'
			},

			login: function(p) {
				// Reauthenticate
				// https://dev.twitter.com/oauth/reference/get/oauth/authenticate
				var prefix = '?force_login=true';
				this.oauth.auth = this.oauth.auth.replace(prefix, '') + (p.options.force ? prefix : '');
			},

			base: base + '1.1/',

			get: {
				me: 'account/verify_credentials.json',
				'me/friends': 'friends/list.json?count=@{limit|200}',
				'me/following': 'friends/list.json?count=@{limit|200}',
				'me/followers': 'followers/list.json?count=@{limit|200}',

				// Https://dev.twitter.com/docs/api/1.1/get/statuses/user_timeline
				'me/share': 'statuses/user_timeline.json?count=@{limit|200}',

				// Https://dev.twitter.com/rest/reference/get/favorites/list
				'me/like': 'favorites/list.json?count=@{limit|200}'
			},

			post: {
				'me/share': function(p, callback) {

					var data = p.data;
					p.data = null;

					var status = [];

					// Change message to status
					if (data.message) {
						status.push(data.message);
						delete data.message;
					}

					// If link is given
					if (data.link) {
						status.push(data.link);
						delete data.link;
					}

					if (data.picture) {
						status.push(data.picture);
						delete data.picture;
					}

					// Compound all the components
					if (status.length) {
						data.status = status.join(' ');
					}

					// Tweet media
					if (data.file) {
						data['media[]'] = data.file;
						delete data.file;
						p.data = data;
						callback('statuses/update_with_media.json');
					}

					// Retweet?
					else if ('id' in data) {
						callback('statuses/retweet/' + data.id + '.json');
					}

					// Tweet
					else {
						// Assign the post body to the query parameters
						hello.utils.extend(p.query, data);
						callback('statuses/update.json?include_entities=1');
					}
				},

				// See: https://dev.twitter.com/rest/reference/post/favorites/create
				'me/like': function(p, callback) {
					var id = p.data.id;
					p.data = null;
					callback('favorites/create.json?id=' + id);
				}
			},

			del: {

				// See: https://dev.twitter.com/rest/reference/post/favorites/destroy
				'me/like': function() {
					p.method = 'post';
					var id = p.data.id;
					p.data = null;
					callback('favorites/destroy.json?id=' + id);
				}
			},

			wrap: {
				me: function(res) {
					formatError(res);
					formatUser(res);
					return res;
				},

				'me/friends': formatFriends,
				'me/followers': formatFriends,
				'me/following': formatFriends,

				'me/share': function(res) {
					formatError(res);
					paging(res);
					if (!res.error && 'length' in res) {
						return {data: res};
					}

					return res;
				},

				'default': function(res) {
					res = arrayToDataResponse(res);
					paging(res);
					return res;
				}
			},
			xhr: function(p) {

				// Rely on the proxy for non-GET requests.
				return (p.method !== 'get');
			}
		}
	});

	function formatUser(o) {
		if (o.id) {
			if (o.name) {
				var m = o.name.split(' ');
				o.first_name = m.shift();
				o.last_name = m.join(' ');
			}

			// See: https://dev.twitter.com/overview/general/user-profile-images-and-banners
			o.thumbnail = o.profile_image_url_https || o.profile_image_url;
		}

		return o;
	}

	function formatFriends(o) {
		formatError(o);
		paging(o);
		if (o.users) {
			o.data = o.users.map(formatUser);
			delete o.users;
		}

		return o;
	}

	function formatError(o) {
		if (o.errors) {
			var e = o.errors[0];
			o.error = {
				code: 'request_failed',
				message: e.message
			};
		}
	}

	// Take a cursor and add it to the path
	function paging(res) {
		// Does the response include a 'next_cursor_string'
		if ('next_cursor_str' in res) {
			// See: https://dev.twitter.com/docs/misc/cursoring
			res.paging = {
				next: '?cursor=' + res.next_cursor_str
			};
		}
	}

	function arrayToDataResponse(res) {
		return Array.isArray(res) ? {data: res} : res;
	}

	/**
	// The documentation says to define user in the request
	// Although its not actually required.

	var user_id;

	function withUserId(callback){
		if(user_id){
			callback(user_id);
		}
		else{
			hello.api('twitter:/me', function(o){
				user_id = o.id;
				callback(o.id);
			});
		}
	}

	function sign(url){
		return function(p, callback){
			withUserId(function(user_id){
				callback(url+'?user_id='+user_id);
			});
		};
	}
	*/

})(hello);

// Vkontakte (vk.com)
(function(hello) {

	hello.init({

		vk: {
			name: 'Vk',

			// See https://vk.com/dev/oauth_dialog
			oauth: {
				version: 2,
				auth: 'https://oauth.vk.com/authorize',
				grant: 'https://oauth.vk.com/access_token'
			},

			// Authorization scopes
			// See https://vk.com/dev/permissions
			scope: {
				email: 'email',
				friends: 'friends',
				photos: 'photos',
				videos: 'video',
				share: 'share',
				offline_access: 'offline'
			},

			// Refresh the access_token
			refresh: true,

			login: function(p) {
				p.qs.display = window.navigator &&
					window.navigator.userAgent &&
					/ipad|phone|phone|android/.test(window.navigator.userAgent.toLowerCase()) ? 'mobile' : 'popup';
			},

			// API Base URL
			base: 'https://api.vk.com/method/',

			// Map GET requests
			get: {
				me: function(p, callback) {
					p.query.fields = 'id,first_name,last_name,photo_max';
					callback('users.get');
				}
			},

			wrap: {
				me: function(res, headers, req) {
					formatError(res);
					return formatUser(res, req);
				}
			},

			// No XHR
			xhr: false,

			// All requests should be JSONP as of missing CORS headers in https://api.vk.com/method/*
			jsonp: true,

			// No form
			form: false
		}
	});

	function formatUser(o, req) {

		if (o !== null && 'response' in o && o.response !== null && o.response.length) {
			o = o.response[0];
			o.id = o.uid;
			o.thumbnail = o.picture = o.photo_max;
			o.name = o.first_name + ' ' + o.last_name;

			if (req.authResponse && req.authResponse.email !== null)
				o.email = req.authResponse.email;
		}

		return o;
	}

	function formatError(o) {

		if (o.error) {
			var e = o.error;
			o.error = {
				code: e.error_code,
				message: e.error_msg
			};
		}
	}

})(hello);

(function(hello) {

	hello.init({
		windows: {
			name: 'Windows live',

			// REF: http://msdn.microsoft.com/en-us/library/hh243641.aspx
			oauth: {
				version: 2,
				auth: 'https://login.live.com/oauth20_authorize.srf',
				grant: 'https://login.live.com/oauth20_token.srf'
			},

			// Refresh the access_token once expired
			refresh: true,

			logout: function() {
				return 'http://login.live.com/oauth20_logout.srf?ts=' + (new Date()).getTime();
			},

			// Authorization scopes
			scope: {
				basic: 'wl.signin,wl.basic',
				email: 'wl.emails',
				birthday: 'wl.birthday',
				events: 'wl.calendars',
				photos: 'wl.photos',
				videos: 'wl.photos',
				friends: 'wl.contacts_emails',
				files: 'wl.skydrive',
				publish: 'wl.share',
				publish_files: 'wl.skydrive_update',
				share: 'wl.share',
				create_event: 'wl.calendars_update,wl.events_create',
				offline_access: 'wl.offline_access'
			},

			// API base URL
			base: 'https://apis.live.net/v5.0/',

			// Map GET requests
			get: {

				// Friends
				me: 'me',
				'me/friends': 'me/friends',
				'me/following': 'me/contacts',
				'me/followers': 'me/friends',
				'me/contacts': 'me/contacts',

				'me/albums': 'me/albums',

				// Include the data[id] in the path
				'me/album': '@{id}/files',
				'me/photo': '@{id}',

				// Files
				'me/files': '@{parent|me/skydrive}/files',
				'me/folders': '@{id|me/skydrive}/files',
				'me/folder': '@{id|me/skydrive}/files'
			},

			// Map POST requests
			post: {
				'me/albums': 'me/albums',
				'me/album': '@{id}/files/',

				'me/folders': '@{id|me/skydrive/}',
				'me/files': '@{parent|me/skydrive}/files'
			},

			// Map DELETE requests
			del: {
				// Include the data[id] in the path
				'me/album': '@{id}',
				'me/photo': '@{id}',
				'me/folder': '@{id}',
				'me/files': '@{id}'
			},

			wrap: {
				me: formatUser,

				'me/friends': formatFriends,
				'me/contacts': formatFriends,
				'me/followers': formatFriends,
				'me/following': formatFriends,
				'me/albums': formatAlbums,
				'me/photos': formatDefault,
				'default': formatDefault
			},

			xhr: function(p) {
				if (p.method !== 'get' && p.method !== 'delete' && !hello.utils.hasBinary(p.data)) {

					// Does this have a data-uri to upload as a file?
					if (typeof (p.data.file) === 'string') {
						p.data.file = hello.utils.toBlob(p.data.file);
					}
					else {
						p.data = JSON.stringify(p.data);
						p.headers = {
							'Content-Type': 'application/json'
						};
					}
				}

				return true;
			},

			jsonp: function(p) {
				if (p.method !== 'get' && !hello.utils.hasBinary(p.data)) {
					p.data.method = p.method;
					p.method = 'get';
				}
			}
		}
	});

	function formatDefault(o) {
		if ('data' in o) {
			o.data.forEach(function(d) {
				if (d.picture) {
					d.thumbnail = d.picture;
				}

				if (d.images) {
					d.pictures = d.images
						.map(formatImage)
						.sort(function(a, b) {
							return a.width - b.width;
						});
				}
			});
		}

		return o;
	}

	function formatImage(image) {
		return {
			width: image.width,
			height: image.height,
			source: image.source
		};
	}

	function formatAlbums(o) {
		if ('data' in o) {
			o.data.forEach(function(d) {
				d.photos = d.files = 'https://apis.live.net/v5.0/' + d.id + '/photos';
			});
		}

		return o;
	}

	function formatUser(o, headers, req) {
		if (o.id) {
			var token = req.query.access_token;
			if (o.emails) {
				o.email = o.emails.preferred;
			}

			// If this is not an non-network friend
			if (o.is_friend !== false) {
				// Use the id of the user_id if available
				var id = (o.user_id || o.id);
				o.thumbnail = o.picture = 'https://apis.live.net/v5.0/' + id + '/picture?access_token=' + token;
			}
		}

		return o;
	}

	function formatFriends(o, headers, req) {
		if ('data' in o) {
			o.data.forEach(function(d) {
				formatUser(d, headers, req);
			});
		}

		return o;
	}

})(hello);

(function(hello) {

	hello.init({

		yahoo: {

			// Ensure that you define an oauth_proxy
			oauth: {
				version: '1.0a',
				auth: 'https://api.login.yahoo.com/oauth/v2/request_auth',
				request: 'https://api.login.yahoo.com/oauth/v2/get_request_token',
				token: 'https://api.login.yahoo.com/oauth/v2/get_token'
			},

			// Login handler
			login: function(p) {
				// Change the default popup window to be at least 560
				// Yahoo does dynamically change it on the fly for the signin screen (only, what if your already signed in)
				p.options.popup.width = 560;

				// Yahoo throws an parameter error if for whatever reason the state.scope contains a comma, so lets remove scope
				try {delete p.qs.state.scope;}
				catch (e) {}
			},

			base: 'https://social.yahooapis.com/v1/',

			get: {
				me: yql('select * from social.profile(0) where guid=me'),
				'me/friends': yql('select * from social.contacts(0) where guid=me'),
				'me/following': yql('select * from social.contacts(0) where guid=me')
			},
			wrap: {
				me: formatUser,

				// Can't get IDs
				// It might be better to loop through the social.relationship table with has unique IDs of users.
				'me/friends': formatFriends,
				'me/following': formatFriends,
				'default': paging
			}
		}
	});

	/*
		// Auto-refresh fix: bug in Yahoo can't get this to work with node-oauth-shim
		login : function(o){
			// Is the user already logged in
			var auth = hello('yahoo').getAuthResponse();

			// Is this a refresh token?
			if(o.options.display==='none'&&auth&&auth.access_token&&auth.refresh_token){
				// Add the old token and the refresh token, including path to the query
				// See http://developer.yahoo.com/oauth/guide/oauth-refreshaccesstoken.html
				o.qs.access_token = auth.access_token;
				o.qs.refresh_token = auth.refresh_token;
				o.qs.token_url = 'https://api.login.yahoo.com/oauth/v2/get_token';
			}
		},
	*/

	function formatError(o) {
		if (o && 'meta' in o && 'error_type' in o.meta) {
			o.error = {
				code: o.meta.error_type,
				message: o.meta.error_message
			};
		}
	}

	function formatUser(o) {

		formatError(o);
		if (o.query && o.query.results && o.query.results.profile) {
			o = o.query.results.profile;
			o.id = o.guid;
			o.last_name = o.familyName;
			o.first_name = o.givenName || o.nickname;
			var a = [];
			if (o.first_name) {
				a.push(o.first_name);
			}

			if (o.last_name) {
				a.push(o.last_name);
			}

			o.name = a.join(' ');
			o.email = (o.emails && o.emails[0]) ? o.emails[0].handle : null;
			o.thumbnail = o.image ? o.image.imageUrl : null;
		}

		return o;
	}

	function formatFriends(o, headers, request) {
		formatError(o);
		paging(o, headers, request);
		var contact;
		var field;
		if (o.query && o.query.results && o.query.results.contact) {
			o.data = o.query.results.contact;
			delete o.query;

			if (!Array.isArray(o.data)) {
				o.data = [o.data];
			}

			o.data.forEach(formatFriend);
		}

		return o;
	}

	function formatFriend(contact) {
		contact.id = null;

		// #362: Reports of responses returning a single item, rather than an Array of items.
		// Format the contact.fields to be an array.
		if (contact.fields && !(contact.fields instanceof Array)) {
			contact.fields = [contact.fields];
		}

		(contact.fields || []).forEach(function(field) {
			if (field.type === 'email') {
				contact.email = field.value;
			}

			if (field.type === 'name') {
				contact.first_name = field.value.givenName;
				contact.last_name = field.value.familyName;
				contact.name = field.value.givenName + ' ' + field.value.familyName;
			}

			if (field.type === 'yahooid') {
				contact.id = field.value;
			}
		});
	}

	function paging(res, headers, request) {

		// See: http://developer.yahoo.com/yql/guide/paging.html#local_limits
		if (res.query && res.query.count && request.options) {
			res.paging = {
				next: '?start=' + (res.query.count + (+request.options.start || 1))
			};
		}

		return res;
	}

	function yql(q) {
		return 'https://query.yahooapis.com/v1/yql?q=' + (q + ' limit @{limit|100} offset @{start|0}').replace(/\s/g, '%20') + '&format=json';
	}

})(hello);

// Register as anonymous AMD module
if (typeof define === 'function' && define.amd) {
	define(function() {
		return hello;
	});
}

// CommonJS module for browserify
if (typeof module === 'object' && module.exports) {
	module.exports = hello;
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFuaW1lLmpzIiwiYXBwLmpzIiwiaW9uLXBsYWNlLWF1dG9jb21wbGV0ZS5qcyIsImlvbi1wbGFjZS1tYXAuanMiLCJyb3V0ZXMuanMiLCJEaXJlY3RpdmVzL0Fkcy5qcyIsIkRpcmVjdGl2ZXMvQmFja2dyb3VuZC5qcyIsIkRpcmVjdGl2ZXMvQnV0dG9uLmpzIiwiRGlyZWN0aXZlcy9PbmJvYXJkaW5nLmpzIiwiY29udHJvbGxlcnMvQWRkRW1vamlDdHJsLmpzIiwiY29udHJvbGxlcnMvQXBwTmF2aWdhdGlvbkN0cmwuanMiLCJjb250cm9sbGVycy9CYWNrZ3JvdW5kU2VsZWN0aW9uQ3RybC5qcyIsImNvbnRyb2xsZXJzL0JhY2tncm91bmRTdG9yZUN0cmwuanMiLCJjb250cm9sbGVycy9FbnRlckxvY2F0aW9uQ3RybC5qcyIsImNvbnRyb2xsZXJzL0Vycm9yQ3RybC5qcyIsImNvbnRyb2xsZXJzL0dldFN0YXJ0ZWRDdHJsLmpzIiwiY29udHJvbGxlcnMvSG91cmx5Rm9yZWNhc3RDdHJsLmpzIiwiY29udHJvbGxlcnMvTG9naW5DdHJsLmpzIiwiY29udHJvbGxlcnMvTWFpblBhZ2VDdHJsLmpzIiwiY29udHJvbGxlcnMvUHJvZmlsZUN0cmwuanMiLCJjb250cm9sbGVycy9TaWduSW5DdHJsLmpzIiwiY29udHJvbGxlcnMvU2lnblVwQ3RybC5qcyIsImNvbnRyb2xsZXJzL1N0aWNrZXJzU2VsZWN0aW9uQ3RybC5qcyIsImNvbnRyb2xsZXJzL1N0aWNrZXJzU3RvcmVDdHJsLmpzIiwiY29udHJvbGxlcnMvV2Vla2x5Rm9yZWNhc3RDdHJsLmpzIiwiY29udHJvbGxlcnMvV2VsY29tZVBhZ2VDdHJsLmpzIiwiY29udHJvbGxlcnMvbWFwQ3RybC5qcyIsImNvbnRyb2xsZXJzL3B1cmNoYXNlQWRzQ3RybC5qcyIsInNlcnZpY2VzL0Fkcy5qcyIsInNlcnZpY2VzL0JhY2tncm91bmRzLmpzIiwic2VydmljZXMvRW1vankuanMiLCJzZXJ2aWNlcy9FbmRQb2ludHMuanMiLCJzZXJ2aWNlcy9HZW9jb2RlLmpzIiwic2VydmljZXMvTGFuZ3VhZ2UuanMiLCJzZXJ2aWNlcy9Mb2NhdGlvbi5qcyIsInNlcnZpY2VzL0xvY2F0aW9uQXV0b0RlZmluZS5qcyIsInNlcnZpY2VzL0xvZ2luLmpzIiwic2VydmljZXMvTWFwLmpzIiwic2VydmljZXMvUGFjay5qcyIsInNlcnZpY2VzL1BpY2tJbWFnZS5qcyIsInNlcnZpY2VzL1NpbmdsZVJlcXVlc3QuanMiLCJzZXJ2aWNlcy9TdGlja2Vycy5qcyIsInNlcnZpY2VzL1N1YnNjcmlwdGlvbi5qcyIsInNlcnZpY2VzL1VwbG9hZEltYWdlLmpzIiwic2VydmljZXMvVXNlckRhdGFWZXJpZnkuanMiLCJzZXJ2aWNlcy9jb25maWcuanMiLCJzZXJ2aWNlcy9zdHJpbmdzLmpzIiwic2VydmljZXMvUHVyY2hhc2UvQW5kcm9pZEJpbGxpbmcuanMiLCJzZXJ2aWNlcy9QdXJjaGFzZS9QdXJjaGFzZS5qcyIsInNlcnZpY2VzL1B1cmNoYXNlL1N0b3JlS2l0LmpzIiwic2VydmljZXMvVXNlci9TaWduSW4uanMiLCJzZXJ2aWNlcy9Vc2VyL1NpZ25VcC5qcyIsInNlcnZpY2VzL1VzZXIvVXNlci5qcyIsInNlcnZpY2VzL1VzZXIvVXNlckRhdGEuanMiLCJzZXJ2aWNlcy9XZWF0aGVyL0F1dGhvcml6ZWRSZXF1ZXN0LmpzIiwic2VydmljZXMvV2VhdGhlci9Ib3VybHkuanMiLCJzZXJ2aWNlcy9XZWF0aGVyL1dlYXRoZXIuanMiLCJzZXJ2aWNlcy9XZWF0aGVyL1dlZWtseS5qcyIsInNlcnZpY2VzL1VzZXIvRW1haWwvRW1haWxMb2dJbi5qcyIsInNlcnZpY2VzL1VzZXIvRW1haWwvRW1haWxTaWduVXAuanMiLCJzZXJ2aWNlcy9Vc2VyL09BdXRoL09BdXRoLmpzIiwic2VydmljZXMvVXNlci9PQXV0aC9oZWxsby5hbGwuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7OztBQVNBLENBQUMsVUFBVSxNQUFNLFNBQVM7RUFD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QUFJLEdBQUc7RUFDZixPQUFPLDBDQUEwQyxDQUFDLElBQUkseUNBQXlDLFFBQVEsT0FBTyxTQUFTOzs7R0FHdEg7OztBQUdILElBQUksT0FBTyxXQUFXLGNBQWMsT0FBTyxLQUFLO0NBQy9DLE9BQU8sV0FBVztFQUNqQixPQUFPOzs7OztBQUtULElBQUksT0FBTyxXQUFXLFlBQVksT0FBTyxTQUFTO0NBQ2pELE9BQU8sVUFBVTs7QUFFbEIiLCJmaWxlIjoid3d3L2FwcC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICogQW5pbWUgdjEuMC4wXG4gKiBodHRwOi8vYW5pbWUtanMuY29tXG4gKiBKYXZhU2NyaXB0IGFuaW1hdGlvbiBlbmdpbmVcbiAqIENvcHlyaWdodCAoYykgMjAxNiBKdWxpYW4gR2FybmllclxuICogaHR0cDovL2p1bGlhbmdhcm5pZXIuY29tXG4gKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2VcbiAqL1xuXG4oZnVuY3Rpb24gKHJvb3QsIGZhY3RvcnkpIHtcbiAgaWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkge1xuICAgIC8vIEFNRC4gUmVnaXN0ZXIgYXMgYW4gYW5vbnltb3VzIG1vZHVsZS5cbiAgICBkZWZpbmUoW10sIGZhY3RvcnkpO1xuICB9IGVsc2UgaWYgKHR5cGVvZiBtb2R1bGUgPT09ICdvYmplY3QnICYmIG1vZHVsZS5leHBvcnRzKSB7XG4gICAgLy8gTm9kZS4gRG9lcyBub3Qgd29yayB3aXRoIHN0cmljdCBDb21tb25KUywgYnV0XG4gICAgLy8gb25seSBDb21tb25KUy1saWtlIGVudmlyb25tZW50cyB0aGF0IHN1cHBvcnQgbW9kdWxlLmV4cG9ydHMsXG4gICAgLy8gbGlrZSBOb2RlLlxuICAgIG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpO1xuICB9IGVsc2Uge1xuICAgIC8vIEJyb3dzZXIgZ2xvYmFscyAocm9vdCBpcyB3aW5kb3cpXG4gICAgcm9vdC5hbmltZSA9IGZhY3RvcnkoKTtcbiAgfVxufSh0aGlzLCBmdW5jdGlvbiAoKSB7XG4gIC8vIERlZmF1bHRzXG5cbiAgdmFyIGRlZmF1bHRTZXR0aW5ncyA9IHtcbiAgICBkdXJhdGlvbjogMTAwMCxcbiAgICBkZWxheTogMCxcbiAgICBsb29wOiBmYWxzZSxcbiAgICBhdXRvcGxheTogdHJ1ZSxcbiAgICBkaXJlY3Rpb246ICdub3JtYWwnLFxuICAgIGVhc2luZzogJ2Vhc2VPdXRFbGFzdGljJyxcbiAgICBlbGFzdGljaXR5OiA0MDAsXG4gICAgcm91bmQ6IGZhbHNlLFxuICAgIGJlZ2luOiB1bmRlZmluZWQsXG4gICAgdXBkYXRlOiB1bmRlZmluZWQsXG4gICAgY29tcGxldGU6IHVuZGVmaW5lZFxuICB9XG5cbiAgdmFyIHZhbGlkVHJhbnNmb3JtcyA9IFsndHJhbnNsYXRlWCcsICd0cmFuc2xhdGVZJywgJ3RyYW5zbGF0ZVonLCAncm90YXRlJywgJ3JvdGF0ZVgnLCAncm90YXRlWScsICdyb3RhdGVaJywgJ3NjYWxlJywgJ3NjYWxlWCcsICdzY2FsZVknLCAnc2NhbGVaJywgJ3NrZXdYJywgJ3NrZXdZJ107XG5cbiAgLy8gVXRpbHNcblxuICB2YXIgaXMgPSAoZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGFycmF5OiAgZnVuY3Rpb24oYSkgeyByZXR1cm4gQXJyYXkuaXNBcnJheShhKSB9LFxuICAgICAgb2JqZWN0OiBmdW5jdGlvbihhKSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoYSkuaW5kZXhPZignT2JqZWN0JykgPiAtMSB9LFxuICAgICAgaHRtbDogICBmdW5jdGlvbihhKSB7IHJldHVybiAoYSBpbnN0YW5jZW9mIE5vZGVMaXN0IHx8IGEgaW5zdGFuY2VvZiBIVE1MQ29sbGVjdGlvbikgfSxcbiAgICAgIG5vZGU6ICAgZnVuY3Rpb24oYSkgeyByZXR1cm4gYS5ub2RlVHlwZSB9LFxuICAgICAgc3ZnOiAgICBmdW5jdGlvbihhKSB7IHJldHVybiBhIGluc3RhbmNlb2YgU1ZHRWxlbWVudCB9LFxuICAgICAgbnVtYmVyOiBmdW5jdGlvbihhKSB7IHJldHVybiAhaXNOYU4ocGFyc2VJbnQoYSkpIH0sXG4gICAgICBzdHJpbmc6IGZ1bmN0aW9uKGEpIHsgcmV0dXJuIHR5cGVvZiBhID09PSAnc3RyaW5nJyB9LFxuICAgICAgZnVuYzogICBmdW5jdGlvbihhKSB7IHJldHVybiB0eXBlb2YgYSA9PT0gJ2Z1bmN0aW9uJyB9LFxuICAgICAgdW5kZWY6ICBmdW5jdGlvbihhKSB7IHJldHVybiB0eXBlb2YgYSA9PT0gJ3VuZGVmaW5lZCcgfSxcbiAgICAgIG51bGw6ICAgZnVuY3Rpb24oYSkgeyByZXR1cm4gdHlwZW9mIGEgPT09ICdudWxsJyB9LFxuICAgICAgaGV4OiAgICBmdW5jdGlvbihhKSB7IHJldHVybiAvKF4jWzAtOUEtRl17Nn0kKXwoXiNbMC05QS1GXXszfSQpL2kudGVzdChhKSB9LFxuICAgICAgcmdiOiAgICBmdW5jdGlvbihhKSB7IHJldHVybiAvXnJnYi8udGVzdChhKSB9LFxuICAgICAgcmdiYTogICBmdW5jdGlvbihhKSB7IHJldHVybiAvXnJnYmEvLnRlc3QoYSkgfSxcbiAgICAgIGhzbDogICAgZnVuY3Rpb24oYSkgeyByZXR1cm4gL15oc2wvLnRlc3QoYSkgfSxcbiAgICAgIGNvbG9yOiAgZnVuY3Rpb24oYSkgeyByZXR1cm4gKGlzLmhleChhKSB8fCBpcy5yZ2IoYSkgfHwgaXMucmdiYShhKSB8fCBpcy5oc2woYSkpfVxuICAgIH1cbiAgfSkoKTtcblxuICAvLyBFYXNpbmdzIGZ1bmN0aW9ucyBhZGFwdGVkIGZyb20gaHR0cDovL2pxdWVyeXVpLmNvbS9cblxuICB2YXIgZWFzaW5ncyA9IChmdW5jdGlvbigpIHtcbiAgICB2YXIgZWFzZXMgPSB7fTtcbiAgICB2YXIgbmFtZXMgPSBbJ1F1YWQnLCAnQ3ViaWMnLCAnUXVhcnQnLCAnUXVpbnQnLCAnRXhwbyddO1xuICAgIHZhciBmdW5jdGlvbnMgPSB7XG4gICAgICBTaW5lOiBmdW5jdGlvbih0KSB7IHJldHVybiAxIC0gTWF0aC5jb3MoIHQgKiBNYXRoLlBJIC8gMiApOyB9LFxuICAgICAgQ2lyYzogZnVuY3Rpb24odCkgeyByZXR1cm4gMSAtIE1hdGguc3FydCggMSAtIHQgKiB0ICk7IH0sXG4gICAgICBFbGFzdGljOiBmdW5jdGlvbih0LCBtKSB7XG4gICAgICAgIGlmKCB0ID09PSAwIHx8IHQgPT09IDEgKSByZXR1cm4gdDtcbiAgICAgICAgdmFyIHAgPSAoMSAtIE1hdGgubWluKG0sIDk5OCkgLyAxMDAwKSwgc3QgPSB0IC8gMSwgc3QxID0gc3QgLSAxLCBzID0gcCAvICggMiAqIE1hdGguUEkgKSAqIE1hdGguYXNpbiggMSApO1xuICAgICAgICByZXR1cm4gLSggTWF0aC5wb3coIDIsIDEwICogc3QxICkgKiBNYXRoLnNpbiggKCBzdDEgLSBzICkgKiAoIDIgKiBNYXRoLlBJICkgLyBwICkgKTtcbiAgICAgIH0sXG4gICAgICBCYWNrOiBmdW5jdGlvbih0KSB7IHJldHVybiB0ICogdCAqICggMyAqIHQgLSAyICk7IH0sXG4gICAgICBCb3VuY2U6IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgdmFyIHBvdzIsIGJvdW5jZSA9IDQ7XG4gICAgICAgIHdoaWxlICggdCA8ICggKCBwb3cyID0gTWF0aC5wb3coIDIsIC0tYm91bmNlICkgKSAtIDEgKSAvIDExICkge31cbiAgICAgICAgcmV0dXJuIDEgLyBNYXRoLnBvdyggNCwgMyAtIGJvdW5jZSApIC0gNy41NjI1ICogTWF0aC5wb3coICggcG93MiAqIDMgLSAyICkgLyAyMiAtIHQsIDIgKTtcbiAgICAgIH1cbiAgICB9XG4gICAgbmFtZXMuZm9yRWFjaChmdW5jdGlvbihuYW1lLCBpKSB7XG4gICAgICBmdW5jdGlvbnNbbmFtZV0gPSBmdW5jdGlvbih0KSB7XG4gICAgICAgIHJldHVybiBNYXRoLnBvdyggdCwgaSArIDIgKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBPYmplY3Qua2V5cyhmdW5jdGlvbnMpLmZvckVhY2goZnVuY3Rpb24obmFtZSkge1xuICAgICAgdmFyIGVhc2VJbiA9IGZ1bmN0aW9uc1tuYW1lXTtcbiAgICAgIGVhc2VzWydlYXNlSW4nICsgbmFtZV0gPSBlYXNlSW47XG4gICAgICBlYXNlc1snZWFzZU91dCcgKyBuYW1lXSA9IGZ1bmN0aW9uKHQsIG0pIHsgcmV0dXJuIDEgLSBlYXNlSW4oMSAtIHQsIG0pOyB9O1xuICAgICAgZWFzZXNbJ2Vhc2VJbk91dCcgKyBuYW1lXSA9IGZ1bmN0aW9uKHQsIG0pIHsgcmV0dXJuIHQgPCAwLjUgPyBlYXNlSW4odCAqIDIsIG0pIC8gMiA6IDEgLSBlYXNlSW4odCAqIC0yICsgMiwgbSkgLyAyOyB9O1xuICAgIH0pO1xuICAgIGVhc2VzLmxpbmVhciA9IGZ1bmN0aW9uKHQpIHsgcmV0dXJuIHQ7IH07XG4gICAgcmV0dXJuIGVhc2VzO1xuICB9KSgpO1xuXG4gIC8vIFN0cmluZ3NcblxuICB2YXIgbnVtYmVyVG9TdHJpbmcgPSBmdW5jdGlvbih2YWwpIHtcbiAgICByZXR1cm4gKGlzLnN0cmluZyh2YWwpKSA/IHZhbCA6IHZhbCArICcnO1xuICB9XG5cbiAgdmFyIHN0cmluZ1RvSHlwaGVucyA9IGZ1bmN0aW9uKHN0cikge1xuICAgIHJldHVybiBzdHIucmVwbGFjZSgvKFthLXpdKShbQS1aXSkvZywgJyQxLSQyJykudG9Mb3dlckNhc2UoKTtcbiAgfVxuXG4gIHZhciBzZWxlY3RTdHJpbmcgPSBmdW5jdGlvbihzdHIpIHtcbiAgICBpZiAoaXMuY29sb3Ioc3RyKSkgcmV0dXJuIGZhbHNlO1xuICAgIHRyeSB7XG4gICAgICB2YXIgbm9kZXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHN0cik7XG4gICAgICByZXR1cm4gbm9kZXM7XG4gICAgfSBjYXRjaChlKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgLy8gTnVtYmVyc1xuXG4gIHZhciByYW5kb20gPSBmdW5jdGlvbihtaW4sIG1heCkge1xuICAgIHJldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAobWF4IC0gbWluICsgMSkpICsgbWluO1xuICB9XG5cbiAgLy8gQXJyYXlzXG5cbiAgdmFyIGZsYXR0ZW5BcnJheSA9IGZ1bmN0aW9uKGFycikge1xuICAgIHJldHVybiBhcnIucmVkdWNlKGZ1bmN0aW9uKGEsIGIpIHtcbiAgICAgIHJldHVybiBhLmNvbmNhdChpcy5hcnJheShiKSA/IGZsYXR0ZW5BcnJheShiKSA6IGIpO1xuICAgIH0sIFtdKTtcbiAgfVxuXG4gIHZhciB0b0FycmF5ID0gZnVuY3Rpb24obykge1xuICAgIGlmIChpcy5hcnJheShvKSkgcmV0dXJuIG87XG4gICAgaWYgKGlzLnN0cmluZyhvKSkgbyA9IHNlbGVjdFN0cmluZyhvKSB8fCBvO1xuICAgIGlmIChpcy5odG1sKG8pKSByZXR1cm4gW10uc2xpY2UuY2FsbChvKTtcbiAgICByZXR1cm4gW29dO1xuICB9XG5cbiAgdmFyIGFycmF5Q29udGFpbnMgPSBmdW5jdGlvbihhcnIsIHZhbCkge1xuICAgIHJldHVybiBhcnIuc29tZShmdW5jdGlvbihhKSB7IHJldHVybiBhID09PSB2YWw7IH0pO1xuICB9XG5cbiAgdmFyIGdyb3VwQXJyYXlCeVByb3BzID0gZnVuY3Rpb24oYXJyLCBwcm9wc0Fycikge1xuICAgIHZhciBncm91cHMgPSB7fTtcbiAgICBhcnIuZm9yRWFjaChmdW5jdGlvbihvKSB7XG4gICAgICB2YXIgZ3JvdXAgPSBKU09OLnN0cmluZ2lmeShwcm9wc0Fyci5tYXAoZnVuY3Rpb24ocCkgeyByZXR1cm4gb1twXTsgfSkpO1xuICAgICAgZ3JvdXBzW2dyb3VwXSA9IGdyb3Vwc1tncm91cF0gfHwgW107XG4gICAgICBncm91cHNbZ3JvdXBdLnB1c2gobyk7XG4gICAgfSk7XG4gICAgcmV0dXJuIE9iamVjdC5rZXlzKGdyb3VwcykubWFwKGZ1bmN0aW9uKGdyb3VwKSB7XG4gICAgICByZXR1cm4gZ3JvdXBzW2dyb3VwXTtcbiAgICB9KTtcbiAgfVxuXG4gIHZhciByZW1vdmVBcnJheUR1cGxpY2F0ZXMgPSBmdW5jdGlvbihhcnIpIHtcbiAgICByZXR1cm4gYXJyLmZpbHRlcihmdW5jdGlvbihpdGVtLCBwb3MsIHNlbGYpIHtcbiAgICAgIHJldHVybiBzZWxmLmluZGV4T2YoaXRlbSkgPT09IHBvcztcbiAgICB9KTtcbiAgfVxuXG4gIC8vIE9iamVjdHNcblxuICB2YXIgY2xvbmVPYmplY3QgPSBmdW5jdGlvbihvKSB7XG4gICAgdmFyIG5ld09iamVjdCA9IHt9O1xuICAgIGZvciAodmFyIHAgaW4gbykgbmV3T2JqZWN0W3BdID0gb1twXTtcbiAgICByZXR1cm4gbmV3T2JqZWN0O1xuICB9XG5cbiAgdmFyIG1lcmdlT2JqZWN0cyA9IGZ1bmN0aW9uKG8xLCBvMikge1xuICAgIGZvciAodmFyIHAgaW4gbzIpIG8xW3BdID0gIWlzLnVuZGVmKG8xW3BdKSA/IG8xW3BdIDogbzJbcF07XG4gICAgcmV0dXJuIG8xO1xuICB9XG5cbiAgLy8gQ29sb3JzXG5cbiAgdmFyIGhleFRvUmdiID0gZnVuY3Rpb24oaGV4KSB7XG4gICAgdmFyIHJneCA9IC9eIz8oW2EtZlxcZF0pKFthLWZcXGRdKShbYS1mXFxkXSkkL2k7XG4gICAgdmFyIGhleCA9IGhleC5yZXBsYWNlKHJneCwgZnVuY3Rpb24obSwgciwgZywgYikgeyByZXR1cm4gciArIHIgKyBnICsgZyArIGIgKyBiOyB9KTtcbiAgICB2YXIgcmdiID0gL14jPyhbYS1mXFxkXXsyfSkoW2EtZlxcZF17Mn0pKFthLWZcXGRdezJ9KSQvaS5leGVjKGhleCk7XG4gICAgdmFyIHIgPSBwYXJzZUludChyZ2JbMV0sIDE2KTtcbiAgICB2YXIgZyA9IHBhcnNlSW50KHJnYlsyXSwgMTYpO1xuICAgIHZhciBiID0gcGFyc2VJbnQocmdiWzNdLCAxNik7XG4gICAgcmV0dXJuICdyZ2IoJyArIHIgKyAnLCcgKyBnICsgJywnICsgYiArICcpJztcbiAgfVxuXG4gIHZhciBoc2xUb1JnYiA9IGZ1bmN0aW9uKGhzbCkge1xuICAgIHZhciBoc2wgPSAvaHNsXFwoKFxcZCspLFxccyooW1xcZC5dKyklLFxccyooW1xcZC5dKyklXFwpL2cuZXhlYyhoc2wpO1xuICAgIHZhciBoID0gcGFyc2VJbnQoaHNsWzFdKSAvIDM2MDtcbiAgICB2YXIgcyA9IHBhcnNlSW50KGhzbFsyXSkgLyAxMDA7XG4gICAgdmFyIGwgPSBwYXJzZUludChoc2xbM10pIC8gMTAwO1xuICAgIHZhciBodWUycmdiID0gZnVuY3Rpb24ocCwgcSwgdCkge1xuICAgICAgaWYgKHQgPCAwKSB0ICs9IDE7XG4gICAgICBpZiAodCA+IDEpIHQgLT0gMTtcbiAgICAgIGlmICh0IDwgMS82KSByZXR1cm4gcCArIChxIC0gcCkgKiA2ICogdDtcbiAgICAgIGlmICh0IDwgMS8yKSByZXR1cm4gcTtcbiAgICAgIGlmICh0IDwgMi8zKSByZXR1cm4gcCArIChxIC0gcCkgKiAoMi8zIC0gdCkgKiA2O1xuICAgICAgcmV0dXJuIHA7XG4gICAgfVxuICAgIHZhciByLCBnLCBiO1xuICAgIGlmIChzID09IDApIHtcbiAgICAgIHIgPSBnID0gYiA9IGw7XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhciBxID0gbCA8IDAuNSA/IGwgKiAoMSArIHMpIDogbCArIHMgLSBsICogcztcbiAgICAgIHZhciBwID0gMiAqIGwgLSBxO1xuICAgICAgciA9IGh1ZTJyZ2IocCwgcSwgaCArIDEvMyk7XG4gICAgICBnID0gaHVlMnJnYihwLCBxLCBoKTtcbiAgICAgIGIgPSBodWUycmdiKHAsIHEsIGggLSAxLzMpO1xuICAgIH1cbiAgICByZXR1cm4gJ3JnYignICsgciAqIDI1NSArICcsJyArIGcgKiAyNTUgKyAnLCcgKyBiICogMjU1ICsgJyknO1xuICB9XG5cbiAgdmFyIGNvbG9yVG9SZ2IgPSBmdW5jdGlvbih2YWwpIHtcbiAgICBpZiAoaXMucmdiKHZhbCkgfHwgaXMucmdiYSh2YWwpKSByZXR1cm4gdmFsO1xuICAgIGlmIChpcy5oZXgodmFsKSkgcmV0dXJuIGhleFRvUmdiKHZhbCk7XG4gICAgaWYgKGlzLmhzbCh2YWwpKSByZXR1cm4gaHNsVG9SZ2IodmFsKTtcbiAgfVxuXG4gIC8vIFVuaXRzXG5cbiAgdmFyIGdldFVuaXQgPSBmdW5jdGlvbih2YWwpIHtcbiAgICByZXR1cm4gLyhbXFwrXFwtXT9bMC05fGF1dG9cXC5dKykoJXxweHxwdHxlbXxyZW18aW58Y218bW18ZXh8cGN8dnd8dmh8ZGVnKT8vLmV4ZWModmFsKVsyXTtcbiAgfVxuXG4gIHZhciBhZGREZWZhdWx0VHJhbnNmb3JtVW5pdCA9IGZ1bmN0aW9uKHByb3AsIHZhbCwgaW50aWFsVmFsKSB7XG4gICAgaWYgKGdldFVuaXQodmFsKSkgcmV0dXJuIHZhbDtcbiAgICBpZiAocHJvcC5pbmRleE9mKCd0cmFuc2xhdGUnKSA+IC0xKSByZXR1cm4gZ2V0VW5pdChpbnRpYWxWYWwpID8gdmFsICsgZ2V0VW5pdChpbnRpYWxWYWwpIDogdmFsICsgJ3B4JztcbiAgICBpZiAocHJvcC5pbmRleE9mKCdyb3RhdGUnKSA+IC0xIHx8IHByb3AuaW5kZXhPZignc2tldycpID4gLTEpIHJldHVybiB2YWwgKyAnZGVnJztcbiAgICByZXR1cm4gdmFsO1xuICB9XG5cbiAgLy8gVmFsdWVzXG5cbiAgdmFyIGdldEFuaW1hdGlvblR5cGUgPSBmdW5jdGlvbihlbCwgcHJvcCkge1xuICAgIGlmICgoaXMubm9kZShlbCkgfHwgaXMuc3ZnKGVsKSkgJiYgYXJyYXlDb250YWlucyh2YWxpZFRyYW5zZm9ybXMsIHByb3ApKSByZXR1cm4gJ3RyYW5zZm9ybSc7XG4gICAgaWYgKChpcy5ub2RlKGVsKSB8fCBpcy5zdmcoZWwpKSAmJiAocHJvcCAhPT0gJ3RyYW5zZm9ybScgJiYgZ2V0Q1NTVmFsdWUoZWwsIHByb3ApKSkgcmV0dXJuICdjc3MnO1xuICAgIGlmICgoaXMubm9kZShlbCkgfHwgaXMuc3ZnKGVsKSkgJiYgKGVsLmdldEF0dHJpYnV0ZShwcm9wKSB8fCAoaXMuc3ZnKGVsKSAmJiBlbFtwcm9wXSkpKSByZXR1cm4gJ2F0dHJpYnV0ZSc7XG4gICAgaWYgKCFpcy5udWxsKGVsW3Byb3BdKSAmJiAhaXMudW5kZWYoZWxbcHJvcF0pKSByZXR1cm4gJ29iamVjdCc7XG4gIH1cblxuICB2YXIgZ2V0Q1NTVmFsdWUgPSBmdW5jdGlvbihlbCwgcHJvcCkge1xuICAgIC8vIEZpcnN0IGNoZWNrIGlmIHByb3AgaXMgYSB2YWxpZCBDU1MgcHJvcGVydHlcbiAgICBpZiAocHJvcCBpbiBlbC5zdHlsZSkge1xuICAgICAgLy8gVGhlbiByZXR1cm4gdGhlIHByb3BlcnR5IHZhbHVlIG9yIGZhbGxiYWNrIHRvICcwJyB3aGVuIGdldFByb3BlcnR5VmFsdWUgZmFpbHNcbiAgICAgIHJldHVybiBnZXRDb21wdXRlZFN0eWxlKGVsKS5nZXRQcm9wZXJ0eVZhbHVlKHN0cmluZ1RvSHlwaGVucyhwcm9wKSkgfHwgJzAnO1xuICAgIH1cbiAgfVxuXG4gIHZhciBnZXRUcmFuc2Zvcm1WYWx1ZSA9IGZ1bmN0aW9uKGVsLCBwcm9wKSB7XG4gICAgdmFyIGRlZmF1bHRWYWwgPSBwcm9wLmluZGV4T2YoJ3NjYWxlJykgPiAtMSA/IDEgOiAwO1xuICAgIHZhciBzdHIgPSBlbC5zdHlsZS50cmFuc2Zvcm07XG4gICAgaWYgKCFzdHIpIHJldHVybiBkZWZhdWx0VmFsO1xuICAgIHZhciByZ3ggPSAvKFxcdyspXFwoKC4rPylcXCkvZztcbiAgICB2YXIgbWF0Y2ggPSBbXTtcbiAgICB2YXIgcHJvcHMgPSBbXTtcbiAgICB2YXIgdmFsdWVzID0gW107XG4gICAgd2hpbGUgKG1hdGNoID0gcmd4LmV4ZWMoc3RyKSkge1xuICAgICAgcHJvcHMucHVzaChtYXRjaFsxXSk7XG4gICAgICB2YWx1ZXMucHVzaChtYXRjaFsyXSk7XG4gICAgfVxuICAgIHZhciB2YWwgPSB2YWx1ZXMuZmlsdGVyKGZ1bmN0aW9uKGYsIGkpIHsgcmV0dXJuIHByb3BzW2ldID09PSBwcm9wOyB9KTtcbiAgICByZXR1cm4gdmFsLmxlbmd0aCA/IHZhbFswXSA6IGRlZmF1bHRWYWw7XG4gIH1cblxuICB2YXIgZ2V0SW5pdGlhbFRhcmdldFZhbHVlID0gZnVuY3Rpb24odGFyZ2V0LCBwcm9wKSB7XG4gICAgc3dpdGNoIChnZXRBbmltYXRpb25UeXBlKHRhcmdldCwgcHJvcCkpIHtcbiAgICAgIGNhc2UgJ3RyYW5zZm9ybSc6IHJldHVybiBnZXRUcmFuc2Zvcm1WYWx1ZSh0YXJnZXQsIHByb3ApO1xuICAgICAgY2FzZSAnY3NzJzogcmV0dXJuIGdldENTU1ZhbHVlKHRhcmdldCwgcHJvcCk7XG4gICAgICBjYXNlICdhdHRyaWJ1dGUnOiByZXR1cm4gdGFyZ2V0LmdldEF0dHJpYnV0ZShwcm9wKTtcbiAgICB9XG4gICAgcmV0dXJuIHRhcmdldFtwcm9wXSB8fCAwO1xuICB9XG5cbiAgdmFyIGdldFZhbGlkVmFsdWUgPSBmdW5jdGlvbih2YWx1ZXMsIHZhbCwgb3JpZ2luYWxDU1MpIHtcbiAgICBpZiAoaXMuY29sb3IodmFsKSkgcmV0dXJuIGNvbG9yVG9SZ2IodmFsKTtcbiAgICBpZiAoZ2V0VW5pdCh2YWwpKSByZXR1cm4gdmFsO1xuICAgIHZhciB1bml0ID0gZ2V0VW5pdCh2YWx1ZXMudG8pID8gZ2V0VW5pdCh2YWx1ZXMudG8pIDogZ2V0VW5pdCh2YWx1ZXMuZnJvbSk7XG4gICAgaWYgKCF1bml0ICYmIG9yaWdpbmFsQ1NTKSB1bml0ID0gZ2V0VW5pdChvcmlnaW5hbENTUyk7XG4gICAgcmV0dXJuIHVuaXQgPyB2YWwgKyB1bml0IDogdmFsO1xuICB9XG5cbiAgdmFyIGRlY29tcG9zZVZhbHVlID0gZnVuY3Rpb24odmFsKSB7XG4gICAgdmFyIHJneCA9IC8tP1xcZCpcXC4/XFxkKy9nO1xuICAgIHJldHVybiB7XG4gICAgICBvcmlnaW5hbDogdmFsLFxuICAgICAgbnVtYmVyczogbnVtYmVyVG9TdHJpbmcodmFsKS5tYXRjaChyZ3gpID8gbnVtYmVyVG9TdHJpbmcodmFsKS5tYXRjaChyZ3gpLm1hcChOdW1iZXIpIDogWzBdLFxuICAgICAgc3RyaW5nczogbnVtYmVyVG9TdHJpbmcodmFsKS5zcGxpdChyZ3gpXG4gICAgfVxuICB9XG5cbiAgdmFyIHJlY29tcG9zZVZhbHVlID0gZnVuY3Rpb24obnVtYmVycywgc3RyaW5ncywgaW5pdGlhbFN0cmluZ3MpIHtcbiAgICByZXR1cm4gc3RyaW5ncy5yZWR1Y2UoZnVuY3Rpb24oYSwgYiwgaSkge1xuICAgICAgdmFyIGIgPSAoYiA/IGIgOiBpbml0aWFsU3RyaW5nc1tpIC0gMV0pO1xuICAgICAgcmV0dXJuIGEgKyBudW1iZXJzW2kgLSAxXSArIGI7XG4gICAgfSk7XG4gIH1cblxuICAvLyBBbmltYXRhYmxlc1xuXG4gIHZhciBnZXRBbmltYXRhYmxlcyA9IGZ1bmN0aW9uKHRhcmdldHMpIHtcbiAgICB2YXIgdGFyZ2V0cyA9IHRhcmdldHMgPyAoZmxhdHRlbkFycmF5KGlzLmFycmF5KHRhcmdldHMpID8gdGFyZ2V0cy5tYXAodG9BcnJheSkgOiB0b0FycmF5KHRhcmdldHMpKSkgOiBbXTtcbiAgICByZXR1cm4gdGFyZ2V0cy5tYXAoZnVuY3Rpb24odCwgaSkge1xuICAgICAgcmV0dXJuIHsgdGFyZ2V0OiB0LCBpZDogaSB9O1xuICAgIH0pO1xuICB9XG5cbiAgLy8gUHJvcGVydGllc1xuXG4gIHZhciBnZXRQcm9wZXJ0aWVzID0gZnVuY3Rpb24ocGFyYW1zLCBzZXR0aW5ncykge1xuICAgIHZhciBwcm9wcyA9IFtdO1xuICAgIGZvciAodmFyIHAgaW4gcGFyYW1zKSB7XG4gICAgICBpZiAoIWRlZmF1bHRTZXR0aW5ncy5oYXNPd25Qcm9wZXJ0eShwKSAmJiBwICE9PSAndGFyZ2V0cycpIHtcbiAgICAgICAgdmFyIHByb3AgPSBpcy5vYmplY3QocGFyYW1zW3BdKSA/IGNsb25lT2JqZWN0KHBhcmFtc1twXSkgOiB7dmFsdWU6IHBhcmFtc1twXX07XG4gICAgICAgIHByb3AubmFtZSA9IHA7XG4gICAgICAgIHByb3BzLnB1c2gobWVyZ2VPYmplY3RzKHByb3AsIHNldHRpbmdzKSk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBwcm9wcztcbiAgfVxuXG4gIHZhciBnZXRQcm9wZXJ0aWVzVmFsdWVzID0gZnVuY3Rpb24odGFyZ2V0LCBwcm9wLCB2YWx1ZSwgaSkge1xuICAgIHZhciB2YWx1ZXMgPSB0b0FycmF5KCBpcy5mdW5jKHZhbHVlKSA/IHZhbHVlKHRhcmdldCwgaSkgOiB2YWx1ZSk7XG4gICAgcmV0dXJuIHtcbiAgICAgIGZyb206ICh2YWx1ZXMubGVuZ3RoID4gMSkgPyB2YWx1ZXNbMF0gOiBnZXRJbml0aWFsVGFyZ2V0VmFsdWUodGFyZ2V0LCBwcm9wKSxcbiAgICAgIHRvOiAodmFsdWVzLmxlbmd0aCA+IDEpID8gdmFsdWVzWzFdIDogdmFsdWVzWzBdXG4gICAgfVxuICB9XG5cbiAgdmFyIGdldFR3ZWVuVmFsdWVzID0gZnVuY3Rpb24ocHJvcCwgdmFsdWVzLCB0eXBlLCB0YXJnZXQpIHtcbiAgICB2YXIgdmFsaWQgPSB7fTtcbiAgICBpZiAodHlwZSA9PT0gJ3RyYW5zZm9ybScpIHtcbiAgICAgIHZhbGlkLmZyb20gPSBwcm9wICsgJygnICsgYWRkRGVmYXVsdFRyYW5zZm9ybVVuaXQocHJvcCwgdmFsdWVzLmZyb20sIHZhbHVlcy50bykgKyAnKSc7XG4gICAgICB2YWxpZC50byA9IHByb3AgKyAnKCcgKyBhZGREZWZhdWx0VHJhbnNmb3JtVW5pdChwcm9wLCB2YWx1ZXMudG8pICsgJyknO1xuICAgIH0gZWxzZSB7XG4gICAgICB2YXIgb3JpZ2luYWxDU1MgPSAodHlwZSA9PT0gJ2NzcycpID8gZ2V0Q1NTVmFsdWUodGFyZ2V0LCBwcm9wKSA6IHVuZGVmaW5lZDtcbiAgICAgIHZhbGlkLmZyb20gPSBnZXRWYWxpZFZhbHVlKHZhbHVlcywgdmFsdWVzLmZyb20sIG9yaWdpbmFsQ1NTKTtcbiAgICAgIHZhbGlkLnRvID0gZ2V0VmFsaWRWYWx1ZSh2YWx1ZXMsIHZhbHVlcy50bywgb3JpZ2luYWxDU1MpO1xuICAgIH1cbiAgICByZXR1cm4geyBmcm9tOiBkZWNvbXBvc2VWYWx1ZSh2YWxpZC5mcm9tKSwgdG86IGRlY29tcG9zZVZhbHVlKHZhbGlkLnRvKSB9O1xuICB9XG5cbiAgdmFyIGdldFR3ZWVuc1Byb3BzID0gZnVuY3Rpb24oYW5pbWF0YWJsZXMsIHByb3BzKSB7XG4gICAgdmFyIHR3ZWVuc1Byb3BzID0gW107XG4gICAgYW5pbWF0YWJsZXMuZm9yRWFjaChmdW5jdGlvbihhbmltYXRhYmxlLCBpKSB7XG4gICAgICB2YXIgdGFyZ2V0ID0gYW5pbWF0YWJsZS50YXJnZXQ7XG4gICAgICByZXR1cm4gcHJvcHMuZm9yRWFjaChmdW5jdGlvbihwcm9wKSB7XG4gICAgICAgIHZhciBhbmltVHlwZSA9IGdldEFuaW1hdGlvblR5cGUodGFyZ2V0LCBwcm9wLm5hbWUpO1xuICAgICAgICBpZiAoYW5pbVR5cGUpIHtcbiAgICAgICAgICB2YXIgdmFsdWVzID0gZ2V0UHJvcGVydGllc1ZhbHVlcyh0YXJnZXQsIHByb3AubmFtZSwgcHJvcC52YWx1ZSwgaSk7XG4gICAgICAgICAgdmFyIHR3ZWVuID0gY2xvbmVPYmplY3QocHJvcCk7XG4gICAgICAgICAgdHdlZW4uYW5pbWF0YWJsZXMgPSBhbmltYXRhYmxlO1xuICAgICAgICAgIHR3ZWVuLnR5cGUgPSBhbmltVHlwZTtcbiAgICAgICAgICB0d2Vlbi5mcm9tID0gZ2V0VHdlZW5WYWx1ZXMocHJvcC5uYW1lLCB2YWx1ZXMsIHR3ZWVuLnR5cGUsIHRhcmdldCkuZnJvbTtcbiAgICAgICAgICB0d2Vlbi50byA9IGdldFR3ZWVuVmFsdWVzKHByb3AubmFtZSwgdmFsdWVzLCB0d2Vlbi50eXBlLCB0YXJnZXQpLnRvO1xuICAgICAgICAgIHR3ZWVuLnJvdW5kID0gKGlzLmNvbG9yKHZhbHVlcy5mcm9tKSB8fCB0d2Vlbi5yb3VuZCkgPyAxIDogMDtcbiAgICAgICAgICB0d2Vlbi5kZWxheSA9IChpcy5mdW5jKHR3ZWVuLmRlbGF5KSA/IHR3ZWVuLmRlbGF5KHRhcmdldCwgaSwgYW5pbWF0YWJsZXMubGVuZ3RoKSA6IHR3ZWVuLmRlbGF5KSAvIGFuaW1hdGlvbi5zcGVlZDtcbiAgICAgICAgICB0d2Vlbi5kdXJhdGlvbiA9IChpcy5mdW5jKHR3ZWVuLmR1cmF0aW9uKSA/IHR3ZWVuLmR1cmF0aW9uKHRhcmdldCwgaSwgYW5pbWF0YWJsZXMubGVuZ3RoKSA6IHR3ZWVuLmR1cmF0aW9uKSAvIGFuaW1hdGlvbi5zcGVlZDtcbiAgICAgICAgICB0d2VlbnNQcm9wcy5wdXNoKHR3ZWVuKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIHR3ZWVuc1Byb3BzO1xuICB9XG5cbiAgLy8gVHdlZW5zXG5cbiAgdmFyIGdldFR3ZWVucyA9IGZ1bmN0aW9uKGFuaW1hdGFibGVzLCBwcm9wcykge1xuICAgIHZhciB0d2VlbnNQcm9wcyA9IGdldFR3ZWVuc1Byb3BzKGFuaW1hdGFibGVzLCBwcm9wcyk7XG4gICAgdmFyIHNwbGl0dGVkUHJvcHMgPSBncm91cEFycmF5QnlQcm9wcyh0d2VlbnNQcm9wcywgWyduYW1lJywgJ2Zyb20nLCAndG8nLCAnZGVsYXknLCAnZHVyYXRpb24nXSk7XG4gICAgcmV0dXJuIHNwbGl0dGVkUHJvcHMubWFwKGZ1bmN0aW9uKHR3ZWVuUHJvcHMpIHtcbiAgICAgIHZhciB0d2VlbiA9IGNsb25lT2JqZWN0KHR3ZWVuUHJvcHNbMF0pO1xuICAgICAgdHdlZW4uYW5pbWF0YWJsZXMgPSB0d2VlblByb3BzLm1hcChmdW5jdGlvbihwKSB7IHJldHVybiBwLmFuaW1hdGFibGVzIH0pO1xuICAgICAgdHdlZW4udG90YWxEdXJhdGlvbiA9IHR3ZWVuLmRlbGF5ICsgdHdlZW4uZHVyYXRpb247XG4gICAgICByZXR1cm4gdHdlZW47XG4gICAgfSk7XG4gIH1cblxuICB2YXIgcmV2ZXJzZVR3ZWVucyA9IGZ1bmN0aW9uKGFuaW0sIGRlbGF5cykge1xuICAgIGFuaW0udHdlZW5zLmZvckVhY2goZnVuY3Rpb24odHdlZW4pIHtcbiAgICAgIHZhciB0b1ZhbCA9IHR3ZWVuLnRvO1xuICAgICAgdmFyIGZyb21WYWwgPSB0d2Vlbi5mcm9tO1xuICAgICAgdmFyIGRlbGF5VmFsID0gYW5pbS5kdXJhdGlvbiAtICh0d2Vlbi5kZWxheSArIHR3ZWVuLmR1cmF0aW9uKTtcbiAgICAgIHR3ZWVuLmZyb20gPSB0b1ZhbDtcbiAgICAgIHR3ZWVuLnRvID0gZnJvbVZhbDtcbiAgICAgIGlmIChkZWxheXMpIHR3ZWVuLmRlbGF5ID0gZGVsYXlWYWw7XG4gICAgfSk7XG4gICAgYW5pbS5yZXZlcnNlZCA9IGFuaW0ucmV2ZXJzZWQgPyBmYWxzZSA6IHRydWU7XG4gIH1cblxuICAvLyB3aWxsLWNoYW5nZVxuXG4gIHZhciBnZXRXaWxsQ2hhbmdlID0gZnVuY3Rpb24oYW5pbSkge1xuICAgIHZhciBwcm9wcyA9IFtdO1xuICAgIHZhciBlbHMgPSBbXTtcbiAgICBhbmltLnR3ZWVucy5mb3JFYWNoKGZ1bmN0aW9uKHR3ZWVuKSB7XG4gICAgICBpZiAodHdlZW4udHlwZSA9PT0gJ2NzcycgfHwgdHdlZW4udHlwZSA9PT0gJ3RyYW5zZm9ybScgKSB7XG4gICAgICAgIHByb3BzLnB1c2godHdlZW4udHlwZSA9PT0gJ2NzcycgPyBzdHJpbmdUb0h5cGhlbnModHdlZW4ubmFtZSkgOiAndHJhbnNmb3JtJyk7XG4gICAgICAgIHR3ZWVuLmFuaW1hdGFibGVzLmZvckVhY2goZnVuY3Rpb24oYW5pbWF0YWJsZSkgeyBlbHMucHVzaChhbmltYXRhYmxlLnRhcmdldCk7IH0pO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiB7XG4gICAgICBwcm9wZXJ0aWVzOiByZW1vdmVBcnJheUR1cGxpY2F0ZXMocHJvcHMpLmpvaW4oJywgJyksXG4gICAgICBlbGVtZW50czogcmVtb3ZlQXJyYXlEdXBsaWNhdGVzKGVscylcbiAgICB9XG4gIH1cblxuICB2YXIgc2V0V2lsbENoYW5nZSA9IGZ1bmN0aW9uKGFuaW0pIHtcbiAgICB2YXIgd2lsbENoYW5nZSA9IGdldFdpbGxDaGFuZ2UoYW5pbSk7XG4gICAgd2lsbENoYW5nZS5lbGVtZW50cy5mb3JFYWNoKGZ1bmN0aW9uKGVsZW1lbnQpIHtcbiAgICAgIGVsZW1lbnQuc3R5bGUud2lsbENoYW5nZSA9IHdpbGxDaGFuZ2UucHJvcGVydGllcztcbiAgICB9KTtcbiAgfVxuXG4gIHZhciByZW1vdmVXaWxsQ2hhbmdlID0gZnVuY3Rpb24oYW5pbSkge1xuICAgIHZhciB3aWxsQ2hhbmdlID0gZ2V0V2lsbENoYW5nZShhbmltKTtcbiAgICB3aWxsQ2hhbmdlLmVsZW1lbnRzLmZvckVhY2goZnVuY3Rpb24oZWxlbWVudCkge1xuICAgICAgZWxlbWVudC5zdHlsZS5yZW1vdmVQcm9wZXJ0eSgnd2lsbC1jaGFuZ2UnKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qIFN2ZyBwYXRoICovXG5cbiAgdmFyIGdldFBhdGhQcm9wcyA9IGZ1bmN0aW9uKHBhdGgpIHtcbiAgICB2YXIgZWwgPSBpcy5zdHJpbmcocGF0aCkgPyBzZWxlY3RTdHJpbmcocGF0aClbMF0gOiBwYXRoO1xuICAgIHJldHVybiB7XG4gICAgICBwYXRoOiBlbCxcbiAgICAgIHZhbHVlOiBlbC5nZXRUb3RhbExlbmd0aCgpXG4gICAgfVxuICB9XG5cbiAgdmFyIHNuYXBQcm9ncmVzc1RvUGF0aCA9IGZ1bmN0aW9uKHR3ZWVuLCBwcm9ncmVzcykge1xuICAgIHZhciBwYXRoRWwgPSB0d2Vlbi5wYXRoO1xuICAgIHZhciBwYXRoUHJvZ3Jlc3MgPSB0d2Vlbi52YWx1ZSAqIHByb2dyZXNzO1xuICAgIHZhciBwb2ludCA9IGZ1bmN0aW9uKG9mZnNldCkge1xuICAgICAgdmFyIG8gPSBvZmZzZXQgfHwgMDtcbiAgICAgIHZhciBwID0gcHJvZ3Jlc3MgPiAxID8gdHdlZW4udmFsdWUgKyBvIDogcGF0aFByb2dyZXNzICsgbztcbiAgICAgIHJldHVybiBwYXRoRWwuZ2V0UG9pbnRBdExlbmd0aChwKTtcbiAgICB9XG4gICAgdmFyIHAgPSBwb2ludCgpO1xuICAgIHZhciBwMCA9IHBvaW50KC0xKTtcbiAgICB2YXIgcDEgPSBwb2ludCgrMSk7XG4gICAgc3dpdGNoICh0d2Vlbi5uYW1lKSB7XG4gICAgICBjYXNlICd0cmFuc2xhdGVYJzogcmV0dXJuIHAueDtcbiAgICAgIGNhc2UgJ3RyYW5zbGF0ZVknOiByZXR1cm4gcC55O1xuICAgICAgY2FzZSAncm90YXRlJzogcmV0dXJuIE1hdGguYXRhbjIocDEueSAtIHAwLnksIHAxLnggLSBwMC54KSAqIDE4MCAvIE1hdGguUEk7XG4gICAgfVxuICB9XG5cbiAgLy8gUHJvZ3Jlc3NcblxuICB2YXIgZ2V0VHdlZW5Qcm9ncmVzcyA9IGZ1bmN0aW9uKHR3ZWVuLCB0aW1lKSB7XG4gICAgdmFyIGVsYXBzZWQgPSBNYXRoLm1pbihNYXRoLm1heCh0aW1lIC0gdHdlZW4uZGVsYXksIDApLCB0d2Vlbi5kdXJhdGlvbik7XG4gICAgdmFyIHBlcmNlbnQgPSBlbGFwc2VkIC8gdHdlZW4uZHVyYXRpb247XG4gICAgdmFyIHByb2dyZXNzID0gdHdlZW4udG8ubnVtYmVycy5tYXAoZnVuY3Rpb24obnVtYmVyLCBwKSB7XG4gICAgICB2YXIgc3RhcnQgPSB0d2Vlbi5mcm9tLm51bWJlcnNbcF07XG4gICAgICB2YXIgZWFzZWQgPSBlYXNpbmdzW3R3ZWVuLmVhc2luZ10ocGVyY2VudCwgdHdlZW4uZWxhc3RpY2l0eSk7XG4gICAgICB2YXIgdmFsID0gdHdlZW4ucGF0aCA/IHNuYXBQcm9ncmVzc1RvUGF0aCh0d2VlbiwgZWFzZWQpIDogc3RhcnQgKyBlYXNlZCAqIChudW1iZXIgLSBzdGFydCk7XG4gICAgICB2YWwgPSB0d2Vlbi5yb3VuZCA/IE1hdGgucm91bmQodmFsICogdHdlZW4ucm91bmQpIC8gdHdlZW4ucm91bmQgOiB2YWw7XG4gICAgICByZXR1cm4gdmFsO1xuICAgIH0pO1xuICAgIHJldHVybiByZWNvbXBvc2VWYWx1ZShwcm9ncmVzcywgdHdlZW4udG8uc3RyaW5ncywgdHdlZW4uZnJvbS5zdHJpbmdzKTtcbiAgfVxuXG4gIHZhciBzZXRBbmltYXRpb25Qcm9ncmVzcyA9IGZ1bmN0aW9uKGFuaW0sIHRpbWUpIHtcbiAgICB2YXIgdHJhbnNmb3JtcyA9IHVuZGVmaW5lZDtcbiAgICBhbmltLnRpbWUgPSBNYXRoLm1pbih0aW1lLCBhbmltLmR1cmF0aW9uKTtcbiAgICBhbmltLnByb2dyZXNzID0gKGFuaW0udGltZSAvIGFuaW0uZHVyYXRpb24pICogMTAwO1xuICAgIGFuaW0udHdlZW5zLmZvckVhY2goZnVuY3Rpb24odHdlZW4pIHtcbiAgICAgIHR3ZWVuLmN1cnJlbnRWYWx1ZSA9IGdldFR3ZWVuUHJvZ3Jlc3ModHdlZW4sIHRpbWUpO1xuICAgICAgdmFyIHByb2dyZXNzID0gdHdlZW4uY3VycmVudFZhbHVlO1xuICAgICAgdHdlZW4uYW5pbWF0YWJsZXMuZm9yRWFjaChmdW5jdGlvbihhbmltYXRhYmxlKSB7XG4gICAgICAgIHZhciBpZCA9IGFuaW1hdGFibGUuaWQ7XG4gICAgICAgIHN3aXRjaCAodHdlZW4udHlwZSkge1xuICAgICAgICAgIGNhc2UgJ2Nzcyc6IGFuaW1hdGFibGUudGFyZ2V0LnN0eWxlW3R3ZWVuLm5hbWVdID0gcHJvZ3Jlc3M7IGJyZWFrO1xuICAgICAgICAgIGNhc2UgJ2F0dHJpYnV0ZSc6IGFuaW1hdGFibGUudGFyZ2V0LnNldEF0dHJpYnV0ZSh0d2Vlbi5uYW1lLCBwcm9ncmVzcyk7IGJyZWFrO1xuICAgICAgICAgIGNhc2UgJ29iamVjdCc6IGFuaW1hdGFibGUudGFyZ2V0W3R3ZWVuLm5hbWVdID0gcHJvZ3Jlc3M7IGJyZWFrO1xuICAgICAgICAgIGNhc2UgJ3RyYW5zZm9ybSc6XG4gICAgICAgICAgaWYgKCF0cmFuc2Zvcm1zKSB0cmFuc2Zvcm1zID0ge307XG4gICAgICAgICAgaWYgKCF0cmFuc2Zvcm1zW2lkXSkgdHJhbnNmb3Jtc1tpZF0gPSBbXTtcbiAgICAgICAgICB0cmFuc2Zvcm1zW2lkXS5wdXNoKHByb2dyZXNzKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG4gICAgaWYgKHRyYW5zZm9ybXMpIGZvciAodmFyIHQgaW4gdHJhbnNmb3Jtcykge1xuICAgICAgdmFyIHRyYW5zZm9ybSA9IHRyYW5zZm9ybXNbdF0uam9pbignICcpO1xuICAgICAgYW5pbS5hbmltYXRhYmxlc1t0XS50YXJnZXQuc3R5bGVbJy13ZWJraXQtdHJhbnNmb3JtJ10gPSB0cmFuc2Zvcm07XG4gICAgfVxuICAgIGlmIChhbmltLnNldHRpbmdzLnVwZGF0ZSkgYW5pbS5zZXR0aW5ncy51cGRhdGUoYW5pbSk7XG4gIH1cblxuICAvLyBBbmltYXRpb25cblxuICB2YXIgY3JlYXRlQW5pbWF0aW9uID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgdmFyIGFuaW0gPSB7fTtcbiAgICBhbmltLmFuaW1hdGFibGVzID0gZ2V0QW5pbWF0YWJsZXMocGFyYW1zLnRhcmdldHMpO1xuICAgIGFuaW0uc2V0dGluZ3MgPSBtZXJnZU9iamVjdHMocGFyYW1zLCBkZWZhdWx0U2V0dGluZ3MpO1xuICAgIGFuaW0ucHJvcGVydGllcyA9IGdldFByb3BlcnRpZXMocGFyYW1zLCBhbmltLnNldHRpbmdzKTtcbiAgICBhbmltLnR3ZWVucyA9IGdldFR3ZWVucyhhbmltLmFuaW1hdGFibGVzLCBhbmltLnByb3BlcnRpZXMpO1xuICAgIGFuaW0uZHVyYXRpb24gPSBhbmltLnR3ZWVucy5sZW5ndGggPyBNYXRoLm1heC5hcHBseShNYXRoLCBhbmltLnR3ZWVucy5tYXAoZnVuY3Rpb24odHdlZW4peyByZXR1cm4gdHdlZW4udG90YWxEdXJhdGlvbjsgfSkpIDogcGFyYW1zLmR1cmF0aW9uIC8gYW5pbWF0aW9uLnNwZWVkO1xuICAgIGFuaW0udGltZSA9IDA7XG4gICAgYW5pbS5wcm9ncmVzcyA9IDA7XG4gICAgYW5pbS5ydW5uaW5nID0gZmFsc2U7XG4gICAgYW5pbS5lbmRlZCA9IGZhbHNlO1xuICAgIHJldHVybiBhbmltO1xuICB9XG5cbiAgLy8gUHVibGljXG5cbiAgdmFyIGFuaW1hdGlvbnMgPSBbXTtcblxuICB2YXIgYW5pbWF0aW9uID0gZnVuY3Rpb24ocGFyYW1zKSB7XG5cbiAgICB2YXIgYW5pbSA9IGNyZWF0ZUFuaW1hdGlvbihwYXJhbXMpO1xuICAgIHZhciB0aW1lID0ge307XG5cbiAgICB0aW1lLnRpY2sgPSBmdW5jdGlvbigpIHtcbiAgICAgIGlmIChhbmltLnJ1bm5pbmcpIHtcbiAgICAgICAgYW5pbS5lbmRlZCA9IGZhbHNlO1xuICAgICAgICB0aW1lLm5vdyA9ICtuZXcgRGF0ZSgpO1xuICAgICAgICB0aW1lLmN1cnJlbnQgPSB0aW1lLmxhc3QgKyB0aW1lLm5vdyAtIHRpbWUuc3RhcnQ7XG4gICAgICAgIHNldEFuaW1hdGlvblByb2dyZXNzKGFuaW0sIHRpbWUuY3VycmVudCk7XG4gICAgICAgIHZhciBzID0gYW5pbS5zZXR0aW5ncztcbiAgICAgICAgaWYgKHMuYmVnaW4gJiYgdGltZS5jdXJyZW50ID49IHMuZGVsYXkpIHsgcy5iZWdpbihhbmltKTsgcy5iZWdpbiA9IHVuZGVmaW5lZDsgfTtcbiAgICAgICAgaWYgKHRpbWUuY3VycmVudCA+PSBhbmltLmR1cmF0aW9uKSB7XG4gICAgICAgICAgaWYgKHMubG9vcCkge1xuICAgICAgICAgICAgdGltZS5zdGFydCA9ICtuZXcgRGF0ZSgpO1xuICAgICAgICAgICAgaWYgKHMuZGlyZWN0aW9uID09PSAnYWx0ZXJuYXRlJykgcmV2ZXJzZVR3ZWVucyhhbmltLCB0cnVlKTtcbiAgICAgICAgICAgIGlmIChpcy5udW1iZXIocy5sb29wKSkgcy5sb29wLS07XG4gICAgICAgICAgICB0aW1lLnJhZiA9IHJlcXVlc3RBbmltYXRpb25GcmFtZSh0aW1lLnRpY2spO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBhbmltLmVuZGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIGlmIChzLmNvbXBsZXRlKSBzLmNvbXBsZXRlKGFuaW0pO1xuICAgICAgICAgICAgYW5pbS5wYXVzZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgICB0aW1lLmxhc3QgPSAwO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRpbWUucmFmID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKHRpbWUudGljayk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBhbmltLnNlZWsgPSBmdW5jdGlvbihwcm9ncmVzcykge1xuICAgICAgdmFyIHRpbWUgPSAocHJvZ3Jlc3MgLyAxMDApICogYW5pbS5kdXJhdGlvbjtcbiAgICAgIHNldEFuaW1hdGlvblByb2dyZXNzKGFuaW0sIHRpbWUpO1xuICAgIH1cblxuICAgIGFuaW0ucGF1c2UgPSBmdW5jdGlvbigpIHtcbiAgICAgIGFuaW0ucnVubmluZyA9IGZhbHNlO1xuICAgICAgY2FuY2VsQW5pbWF0aW9uRnJhbWUodGltZS5yYWYpO1xuICAgICAgcmVtb3ZlV2lsbENoYW5nZShhbmltKTtcbiAgICAgIHZhciBpID0gYW5pbWF0aW9ucy5pbmRleE9mKGFuaW0pO1xuICAgICAgaWYgKGkgPiAtMSkgYW5pbWF0aW9ucy5zcGxpY2UoaSwgMSk7XG4gICAgfVxuXG4gICAgYW5pbS5wbGF5ID0gZnVuY3Rpb24ocGFyYW1zKSB7XG4gICAgICBpZiAocGFyYW1zKSBhbmltID0gbWVyZ2VPYmplY3RzKGNyZWF0ZUFuaW1hdGlvbihtZXJnZU9iamVjdHMocGFyYW1zLCBhbmltLnNldHRpbmdzKSksIGFuaW0pO1xuICAgICAgYW5pbS5wYXVzZSgpO1xuICAgICAgYW5pbS5ydW5uaW5nID0gdHJ1ZTtcbiAgICAgIHRpbWUuc3RhcnQgPSArbmV3IERhdGUoKTtcbiAgICAgIHRpbWUubGFzdCA9IGFuaW0uZW5kZWQgPyAwIDogYW5pbS50aW1lO1xuICAgICAgdmFyIHMgPSBhbmltLnNldHRpbmdzO1xuICAgICAgaWYgKHMuZGlyZWN0aW9uID09PSAncmV2ZXJzZScpIHJldmVyc2VUd2VlbnMoYW5pbSk7XG4gICAgICBpZiAocy5kaXJlY3Rpb24gPT09ICdhbHRlcm5hdGUnICYmICFzLmxvb3ApIHMubG9vcCA9IDE7XG4gICAgICBzZXRXaWxsQ2hhbmdlKGFuaW0pO1xuICAgICAgYW5pbWF0aW9ucy5wdXNoKGFuaW0pO1xuICAgICAgdGltZS5yYWYgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGltZS50aWNrKTtcbiAgICB9XG5cbiAgICBhbmltLnJlc3RhcnQgPSBmdW5jdGlvbigpIHtcbiAgICAgIGlmIChhbmltLnJldmVyc2VkKSByZXZlcnNlVHdlZW5zKGFuaW0pO1xuICAgICAgYW5pbS5wYXVzZSgpO1xuICAgICAgYW5pbS5zZWVrKDApO1xuICAgICAgYW5pbS5wbGF5KCk7XG4gICAgfVxuXG4gICAgaWYgKGFuaW0uc2V0dGluZ3MuYXV0b3BsYXkpIGFuaW0ucGxheSgpO1xuXG4gICAgcmV0dXJuIGFuaW07XG5cbiAgfVxuXG4gIC8vIFJlbW92ZSBvbiBvbmUgb3IgbXVsdGlwbGUgdGFyZ2V0cyBmcm9tIGFsbCBhY3RpdmUgYW5pbWF0aW9ucy5cblxuICB2YXIgcmVtb3ZlID0gZnVuY3Rpb24oZWxlbWVudHMpIHtcbiAgICB2YXIgdGFyZ2V0cyA9IGZsYXR0ZW5BcnJheShpcy5hcnJheShlbGVtZW50cykgPyBlbGVtZW50cy5tYXAodG9BcnJheSkgOiB0b0FycmF5KGVsZW1lbnRzKSk7XG4gICAgZm9yICh2YXIgaSA9IGFuaW1hdGlvbnMubGVuZ3RoLTE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICB2YXIgYW5pbWF0aW9uID0gYW5pbWF0aW9uc1tpXTtcbiAgICAgIGZvciAodmFyIHQgPSBhbmltYXRpb24udHdlZW5zLmxlbmd0aC0xOyB0ID49IDA7IHQtLSkge1xuICAgICAgICB2YXIgdHdlZW4gPSBhbmltYXRpb24udHdlZW5zW3RdO1xuICAgICAgICBmb3IgKHZhciBhID0gdHdlZW4uYW5pbWF0YWJsZXMubGVuZ3RoLTE7IGEgPj0gMDsgYS0tKSB7XG4gICAgICAgICAgaWYgKGFycmF5Q29udGFpbnModGFyZ2V0cywgdHdlZW4uYW5pbWF0YWJsZXNbYV0udGFyZ2V0KSkge1xuICAgICAgICAgICAgdHdlZW4uYW5pbWF0YWJsZXMuc3BsaWNlKGEsIDEpO1xuICAgICAgICAgICAgaWYgKCF0d2Vlbi5hbmltYXRhYmxlcy5sZW5ndGgpIGFuaW1hdGlvbi50d2VlbnMuc3BsaWNlKHQsIDEpO1xuICAgICAgICAgICAgaWYgKCFhbmltYXRpb24udHdlZW5zLmxlbmd0aCkgYW5pbWF0aW9uLnBhdXNlKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgYW5pbWF0aW9uLnNwZWVkID0gMTtcbiAgYW5pbWF0aW9uLmxpc3QgPSBhbmltYXRpb25zO1xuICBhbmltYXRpb24ucmVtb3ZlID0gcmVtb3ZlO1xuICBhbmltYXRpb24uZWFzaW5ncyA9IGVhc2luZ3M7XG4gIGFuaW1hdGlvbi5nZXRWYWx1ZSA9IGdldEluaXRpYWxUYXJnZXRWYWx1ZTtcbiAgYW5pbWF0aW9uLnBhdGggPSBnZXRQYXRoUHJvcHM7XG4gIGFuaW1hdGlvbi5yYW5kb20gPSByYW5kb207XG5cbiAgcmV0dXJuIGFuaW1hdGlvbjtcblxufSkpO1xuIiwiLy8gSW9uaWMgU3RhcnRlciBBcHBcblxuLy8gYW5ndWxhci5tb2R1bGUgaXMgYSBnbG9iYWwgcGxhY2UgZm9yIGNyZWF0aW5nLCByZWdpc3RlcmluZyBhbmQgcmV0cmlldmluZyBBbmd1bGFyIG1vZHVsZXNcbi8vICdzdGFydGVyJyBpcyB0aGUgbmFtZSBvZiB0aGlzIGFuZ3VsYXIgbW9kdWxlIGV4YW1wbGUgKGFsc28gc2V0IGluIGEgPGJvZHk+IGF0dHJpYnV0ZSBpbiBpbmRleC5odG1sKVxuLy8gdGhlIDJuZCBwYXJhbWV0ZXIgaXMgYW4gYXJyYXkgb2YgJ3JlcXVpcmVzJ1xuLy8gJ3N0YXJ0ZXIuc2VydmljZXMnIGlzIGZvdW5kIGluIHNlcnZpY2VzLmpzXG4vLyAnc3RhcnRlci5jb250cm9sbGVycycgaXMgZm91bmQgaW4gY29udHJvbGxlcnMuanNcblxuYW5ndWxhci5tb2R1bGUoJ2FwcCcsIFsnaW9uaWMnLCAnaW9uLXBsYWNlLXRvb2xzJywgJ2FwcC5yb3V0ZXMnLCAnbmdDb3Jkb3ZhJ10pXG4uY29uc3RhbnQoJ0ZpcmViYXNlVXJsJywgJ2h0dHBzOi8vaW9uaWNsZS5maXJlYmFzZWlvLmNvbS8nKVxuXG4ucnVuKGZ1bmN0aW9uKCRpb25pY1BsYXRmb3JtLCBjb25maWcpIHtcbiAgJGlvbmljUGxhdGZvcm0ucmVhZHkoZnVuY3Rpb24oKSB7XG4gICAgLy8gSGlkZSB0aGUgYWNjZXNzb3J5IGJhciBieSBkZWZhdWx0IChyZW1vdmUgdGhpcyB0byBzaG93IHRoZSBhY2Nlc3NvcnkgYmFyIGFib3ZlIHRoZSBrZXlib2FyZFxuICAgIC8vIGZvciBmb3JtIGlucHV0cylcbiAgICBpZiAod2luZG93LmNvcmRvdmEgJiYgd2luZG93LmNvcmRvdmEucGx1Z2lucyAmJiB3aW5kb3cuY29yZG92YS5wbHVnaW5zLktleWJvYXJkKSB7XG4gICAgICBjb3Jkb3ZhLnBsdWdpbnMuS2V5Ym9hcmQuaGlkZUtleWJvYXJkQWNjZXNzb3J5QmFyKHRydWUpO1xuICAgICAgY29yZG92YS5wbHVnaW5zLktleWJvYXJkLmRpc2FibGVTY3JvbGwodHJ1ZSk7XG4gICAgfVxuICAgIGlmICh3aW5kb3cuU3RhdHVzQmFyKSB7XG4gICAgICAvLyBvcmcuYXBhY2hlLmNvcmRvdmEuc3RhdHVzYmFyIHJlcXVpcmVkXG4gICAgICBTdGF0dXNCYXIuc3R5bGVEZWZhdWx0KCk7XG4gICAgfVxuICB9KTtcbn0pXG4uY29uZmlnKFsnJGlvbmljQ29uZmlnUHJvdmlkZXInLCBmdW5jdGlvbigkaW9uaWNDb25maWdQcm92aWRlcikge1xuXG4gICAgJGlvbmljQ29uZmlnUHJvdmlkZXIudGFicy5wb3NpdGlvbignYm90dG9tJyk7IC8vIG90aGVyIHZhbHVlczogdG9wXG5cbn1dKTtcbiIsIndpbmRvdy5wbGFjZVRvb2xzID0gYW5ndWxhci5tb2R1bGUoJ2lvbi1wbGFjZS10b29scycsIFtdKTtcbnBsYWNlVG9vbHMuZGlyZWN0aXZlKCdpb25Hb29nbGVQbGFjZScsIFtcbiAgICAgICAgJyRpb25pY1RlbXBsYXRlTG9hZGVyJyxcbiAgICAgICAgJyRpb25pY1BsYXRmb3JtJyxcbiAgICAgICAgJyRxJyxcbiAgICAgICAgJyR0aW1lb3V0JyxcbiAgICAgICAgJyRyb290U2NvcGUnLFxuICAgICAgICAnJGRvY3VtZW50JyxcbiAgICAgICAgZnVuY3Rpb24oJGlvbmljVGVtcGxhdGVMb2FkZXIsICRpb25pY1BsYXRmb3JtLCAkcSwgJHRpbWVvdXQsICRyb290U2NvcGUsICRkb2N1bWVudCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICByZXF1aXJlOiBbJz9uZ01vZGVsJywgJz9zdWJtaXQnXSxcbiAgICAgICAgICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL2F1dG9jb21wbGV0ZS5odG1sJyxcbiAgICAgICAgICAgICAgICByZXBsYWNlOiB0cnVlLFxuICAgICAgICAgICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICAgICAgICAgIHNlYXJjaFF1ZXJ5OiAnPW5nTW9kZWwnLFxuICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbkNoYW5nZWQ6ICcmJyxcbiAgICAgICAgICAgICAgICAgICAgcmFkaXVzOiAnPScsXG4gICAgICAgICAgICAgICAgICAgIHN1cGVyOiAnPXN1Ym1pdCcsXG4gICAgICAgICAgICAgICAgICAgIHN1Ym1pdHRlZDogJz1zdWJtaXR0ZWQnXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiBmdW5jdGlvbigkc2NvcGUsICRodHRwLCBMb2NhdGlvblNlcnZpY2UpIHtcbiAgICAgICAgICAgICAgICAgICRzY29wZS5jdXJyZW50ID0gTG9jYXRpb25TZXJ2aWNlKFwiY3VycmVudCBsb2NhdGlvblwiKTtcblxuICAgICAgICAgICAgICAgICAgJHNjb3BlLnN1Ym1pdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3VibWl0dGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnN1cGVyKCRzY29wZS5jdXJyZW50KTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLiRhcHBseSgpO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAkc2NvcGUuc2VydmljZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgZ2V0UXVlcnlQcmVkaWN0aW9uczogZnVuY3Rpb24ocmVxLCBjYWxsYmFjaykge1xuXG4gICAgICAgICAgICAgICAgICAgICAgJC5hamF4KHtcbiAgICAgICAgICAgICAgICAgICAgICB1cmw6XCJodHRwOi8vYXV0b2NvbXBsZXRlLnd1bmRlcmdyb3VuZC5jb20vYXE/Y2I9Y2FsbD0/XCIsXG4gICAgICAgICAgICAgICAgICAgICAgZGF0YVR5cGU6IFwianNvbnBcIixcbiAgICAgICAgICAgICAgICAgICAgICBkYXRhOntcbiAgICAgICAgICAgICAgICAgICAgICBcInF1ZXJ5XCI6cmVxLmlucHV0XG4gICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICBjcm9zc0RvbWFpbjogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAoanNvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxvY2F0aW9ucyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAganNvbi5SRVNVTFRTLmZvckVhY2goZnVuY3Rpb24oaXRlbSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGl0ZW0udHlwZSAhPSBcImNpdHlcIikgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbG9jYXRpb24gPSBpdGVtLmxsLnNwbGl0KFwiIFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb25zLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBpdGVtLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb246IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhdDogbG9jYXRpb25bMF0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsbmc6IGxvY2F0aW9uWzFdXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKGxvY2F0aW9ucywgMjAwKTtcbiAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IGVycjtcbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAgICAgY29tcGlsZTogZnVuY3Rpb24oZWxlbWVudCwgYXR0cnMpIHtcbiAgICAgICAgICAgICAgICAgIHZhciBpbnB1dCA9IGVsZW1lbnQuZmluZCgnaW5wdXQnKTtcbiAgICAgICAgICAgICAgICAgIHZhciBidXR0b24gPSBlbGVtZW50LmZpbmQoJ2J1dHRvbicpO1xuICAgICAgICAgICAgICAgICAgYnV0dG9uLmh0bWwoYXR0cnMudGl0bGUpO1xuICAgICAgICAgICAgICAgICAgYnV0dG9uLmF0dHIoXCJuZy1oaWRlXCIsIFwic3VibWl0dGVkXCIpO1xuXG4gICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBwcmU6IGZ1bmN0aW9uKHNjb3BlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgc2NvcGUuc3VibWl0dGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICBzY29wZS5kcm9wRG93bkFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgdmFyIHNlYXJjaEV2ZW50VGltZW91dCA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICAgICAgICB2YXIgbGF0TG5nID0gbnVsbDtcblxuICAgICAgICAgICAgICAgICAgICAgIG5hdmlnYXRvci5nZW9sb2NhdGlvbi5nZXRDdXJyZW50UG9zaXRpb24oZnVuY3Rpb24gKHBvc2l0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGxhdExuZyA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcocG9zaXRpb24uY29vcmRzLmxhdGl0dWRlLCBwb3NpdGlvbi5jb29yZHMubG9uZ2l0dWRlKTtcbiAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgIHZhciBzZWFyY2hJbnB1dEVsZW1lbnQgPSBhbmd1bGFyLmVsZW1lbnQoZWxlbWVudC5maW5kKCdpbnB1dCcpKTtcblxuICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLnNlbGVjdExvY2F0aW9uID0gZnVuY3Rpb24obG9jYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuZHJvcERvd25BY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuc2VhcmNoUXVlcnkgPSBsb2NhdGlvbi5kZXNjcmlwdGlvbjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuY3VycmVudCA9IGxvY2F0aW9uO1xuICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgaWYgKCFzY29wZS5yYWRpdXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUucmFkaXVzID0gMTUwMDAwMDtcbiAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICBzY29wZS5sb2NhdGlvbnMgPSBbXVxuXG4gICAgICAgICAgICAgICAgICAgICAgc2NvcGUuJHdhdGNoKCdzZWFyY2hRdWVyeScsIGZ1bmN0aW9uKHF1ZXJ5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcXVlcnkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5ID0gJyc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuZHJvcERvd25BY3RpdmUgPSAocXVlcnkubGVuZ3RoID49IDMgJiYgc2NvcGUubG9jYXRpb25zLmxlbmd0aCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZWFyY2hFdmVudFRpbWVvdXQpICR0aW1lb3V0LmNhbmNlbChzZWFyY2hFdmVudFRpbWVvdXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICBzZWFyY2hFdmVudFRpbWVvdXQgPSAkdGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLiRhcHBseSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoIXF1ZXJ5KSByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocXVlcnkubGVuZ3RoIDwgMykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmxvY2F0aW9ucyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5zdWJtaXR0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXEgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcS5pbnB1dCA9IHF1ZXJ5O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxhdExuZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcS5sb2NhdGlvbiA9IGxhdExuZztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXEucmFkaXVzID0gc2NvcGUucmFkaXVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuc2VydmljZS5nZXRRdWVyeVByZWRpY3Rpb25zKHJlcSwgZnVuY3Rpb24gKHByZWRpY3Rpb25zLCBzdGF0dXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdHVzID09IDIwMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5sb2NhdGlvbnMgPSBwcmVkaWN0aW9ucztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuZHJvcERvd25BY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5zdWJtaXR0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuJGRpZ2VzdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICB9LCAzNTApOyAvLyB3ZSdyZSB0aHJvdHRsaW5nIHRoZSBpbnB1dCBieSAzNTBtcyB0byBiZSBuaWNlIHRvIGdvb2dsZSdzIEFQSVxuICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgdmFyIG9uQ2xpY2sgPSBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuZHJvcERvd25BY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5zdWJtaXR0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuJGRpZ2VzdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICBzZWFyY2hJbnB1dEVsZW1lbnRbMF0uZm9jdXMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VhcmNoSW5wdXRFbGVtZW50WzBdLmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIH0sMCk7XG4gICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgIHZhciBvbkNhbmNlbCA9IGZ1bmN0aW9uKGUpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmRyb3BEb3duQWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS4kZGlnZXN0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIH0sIDIwMCk7XG4gICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgIGlucHV0LmJpbmQoJ2NsaWNrJywgb25DbGljayk7XG4gICAgICAgICAgICAgICAgICAgICAgaW5wdXQuYmluZCgnYmx1cicsIG9uQ2FuY2VsKTtcbiAgICAgICAgICAgICAgICAgICAgICBpbnB1dC5iaW5kKCd0b3VjaGVuZCcsIG9uQ2xpY2spO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgICBpZihhdHRycy5wbGFjZWhvbGRlcil7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0LmF0dHIoJ3BsYWNlaG9sZGVyJywgYXR0cnMucGxhY2Vob2xkZXIpO1xuICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIF0pO1xuIiwicGxhY2VUb29sc1xuICAuZGlyZWN0aXZlKCdpb25Hb29nbGVQbGFjZU1hcCcsIFsnJHRpbWVvdXQnLCBmdW5jdGlvbiAoJHRpbWVvdXQpIHtcbiAgXHRyZXR1cm4ge1xuICBcdFx0cmVzdHJpY3Q6ICdFJyxcbiAgXHRcdHRlbXBsYXRlOiBbXG4gIFx0XHRcdCc8ZGl2IGNsYXNzPVwiaW9uLXBsYWNlLXRvb2xzLW1hcC1ob2xkZXJcIiBuZy1jbGFzcz1cInsgXFwndmlzaWJsZVxcJzogdmlzaWJsZSB9XCI+JyxcbiAgXHRcdFx0XHQnPGRpdiBjbGFzcz1cImlvbi1wbGFjZS10b29scy1tYXAtd3JhcHBlclwiPicsXG5cdCAgXHRcdFx0XHQnPGRpdiBjbGFzcz1cImlvbi1wbGFjZS10b29scy1tYXBcIj48L2Rpdj4nLFxuXHQgIFx0XHRcdFx0JzxkaXYgY2xhc3M9XCJhdXRvY29tcGxldGUtd3JhcFwiPicsXG5cdCAgXHRcdFx0XHRcdCc8aW9uLWdvb2dsZS1wbGFjZSByYWRpdXM9XCJvcHRpb25zLnJhZGl1c1wiIHBsYWNlaG9sZGVyPVwiWW91ciBhZGRyZXNzXCIgbG9jYXRpb24tY2hhbmdlZD1cImxvY2F0aW9uQ2hhbmdlZFwiIG5nLW1vZGVsPVwiZGF0YS5hZGRyZXNzXCIgcmVxdWlyZWQgbmFtZT1cImFkZHJlc3NcIi8+Jyxcblx0ICBcdFx0XHRcdCc8L2Rpdj4nLFxuXHQgIFx0XHRcdFx0JzxkaXYgY2xhc3M9XCJjb250cm9sc1wiPicsXG5cdCAgXHRcdFx0XHRcdCc8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cImJ1dHRvbiBidXR0b24tc3RhYmxlXCIgbmctY2xpY2s9XCJoaWRlTW9kYWwoKVwiPkNhbmNlbDwvYnV0dG9uPicsXG5cdCAgXHRcdFx0XHRcdCcmbmJzcDsnLFxuXHQgIFx0XHRcdFx0XHQnPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJidXR0b24gYnV0dG9uLXBvc2l0aXZlXCIgbmctY2xpY2s9XCJjYWxsU3VjY2VzcygpXCI+T0s8L2J1dHRvbj4nLFxuXHQgIFx0XHRcdFx0JzwvZGl2PicsXG5cdCAgXHRcdFx0JzwvZGl2PicsXG4gIFx0XHRcdCc8L2Rpdj4nXG4gIFx0XHRdLmpvaW4oJycpLFxuICBcdFx0c2NvcGU6IHtcbiAgICAgICAgdmlzaWJsZTogJz0nLFxuICAgICAgICBkYXRhOiAnPScsXG4gICAgICAgIG9wdGlvbnM6ICc9JyxcbiAgICAgICAgb25TdWNjZXNzOiAnJidcbiAgICAgIH0sXG4gIFx0XHRyZXBsYWNlOiB0cnVlLFxuICBcdFx0bGluazogZnVuY3Rpb24gKHNjb3BlLCBlbGVtZW50LCBhdHRycykge1xuICBcdFx0XHRvcHRpb25zID0gYW5ndWxhci5leHRlbmQoe1xuICBcdFx0XHRcdHJhZGl1czogMTUwMDAsXG4gIFx0XHRcdFx0Zml0Qm91bmRzOiB0cnVlLFxuICBcdFx0XHRcdG1hcmtlcjogdHJ1ZVxuICBcdFx0XHR9LCBzY29wZS5vcHRpb25zKTtcblxuICBcdFx0XHR2YXIgbWFwRWwgPSBlbGVtZW50LmZpbmQoJ2RpdicpWzBdLmNoaWxkcmVuWzBdLFxuICBcdFx0XHRcdG1hcFByb3AgPSB7XG5cdFx0XHRcdCAgICBjZW50ZXI6IG5ldyBnb29nbGUubWFwcy5MYXRMbmcoNTEuNTA4NzQyLC0wLjEyMDg1MCksXG5cdFx0XHRcdCAgICB6b29tOiA1LFxuXHRcdFx0XHQgICAgbWFwVHlwZUlkOiBnb29nbGUubWFwcy5NYXBUeXBlSWQuUk9BRE1BUFxuXHRcdFx0XHQgIH0sXG5cdFx0XHQgIFx0bWFwID0gbmV3IGdvb2dsZS5tYXBzLk1hcChtYXBFbCwgbWFwUHJvcCksXG5cdFx0XHQgIFx0Z2VvY29kZXIgPSBuZXcgZ29vZ2xlLm1hcHMuR2VvY29kZXIoKSxcblx0XHRcdCAgXHRtYXJrZXIgPSBuZXcgZ29vZ2xlLm1hcHMuTWFya2VyKHtcblx0XHRcdCAgXHRcdHBvc2l0aW9uOiBtYXBQcm9wLmNlbnRlcixcblx0XHRcdCAgXHRcdG1hcDogbWFwLFxuXHRcdFx0ICBcdFx0ZHJhZ2dhYmxlOiB0cnVlXG5cdFx0XHQgIFx0fSk7XG5cblx0XHRcdCAgaWYgKCFvcHRpb25zLm1hcmtlcikge1xuXHRcdFx0ICBcdG1hcmtlci5zZXRWaXNpYmxlKGZhbHNlKTtcblx0XHRcdCAgfVxuXG5cdFx0XHQgIHNjb3BlLmhpZGVNb2RhbCA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdCAgXHRzY29wZS52aXNpYmxlID0gZmFsc2U7XG5cdFx0XHQgIH07XG5cblx0XHRcdCAgc2NvcGUuY2FsbFN1Y2Nlc3MgPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHQgIFx0c2NvcGUuaGlkZU1vZGFsKCk7XG5cdFx0XHQgIFx0aWYgKHNjb3BlLm9uU3VjY2Vzcykge1xuICAgICAgICAgICAgc2NvcGUub25TdWNjZXNzKCkoKTtcbiAgICAgICAgICB9XG5cdFx0XHQgIH07XG5cblx0XHRcdCAgc2NvcGUubG9jYXRpb25DaGFuZ2VkID0gZnVuY3Rpb24gKGFkZHJlc3MpIHtcblx0XHRcdFx0XHRnZW9jb2Rlci5nZW9jb2RlKHtcblx0XHRcdFx0XHQgIGFkZHJlc3M6IGFkZHJlc3Ncblx0XHRcdFx0XHR9LCBmdW5jdGlvbihyZXN1bHRzLCBzdGF0dXMpIHtcblx0XHRcdFx0XHQgIGlmIChzdGF0dXMgPT0gZ29vZ2xlLm1hcHMuR2VvY29kZXJTdGF0dXMuT0spIHtcblx0XHRcdFx0XHQgIFx0c2NvcGUuZGF0YS5sYXRpdHVkZSA9IHJlc3VsdHNbMF0uZ2VvbWV0cnkubG9jYXRpb24ubGF0KCk7XG5cdFx0XHQgIFx0XHRcdHNjb3BlLmRhdGEubG9uZ2l0dWRlID0gcmVzdWx0c1swXS5nZW9tZXRyeS5sb2NhdGlvbi5sbmcoKTtcblx0XHRcdFx0XHQgICAgbWFwLnNldENlbnRlcihyZXN1bHRzWzBdLmdlb21ldHJ5LmxvY2F0aW9uKTtcblx0XHRcdFx0XHQgICAgbWFya2VyLnNldFBvc2l0aW9uKHJlc3VsdHNbMF0uZ2VvbWV0cnkubG9jYXRpb24pO1xuXHRcdFx0XHRcdCAgICBpZiAob3B0aW9ucy5maXRCb3VuZHMpIHtcblx0XHRcdFx0XHQgICAgXHRtYXAuZml0Qm91bmRzKHJlc3VsdHNbMF0uZ2VvbWV0cnkudmlld3BvcnQpO1xuXHRcdFx0XHRcdCAgICB9XG5cdFx0XHRcdFx0ICB9XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHQgIH07XG5cblx0XHRcdCAgdmFyIGdlb0NvZGVCeUNvb3JkcyA9IGZ1bmN0aW9uIChsYXRMbmcpIHtcblx0XHRcdCAgXHRnZW9jb2Rlci5nZW9jb2RlKHtcblx0XHRcdCAgXHRcdGxhdExuZzogbGF0TG5nXG5cdFx0XHQgIFx0fSwgZnVuY3Rpb24gKHJlc3VsdHMsIHN0YXR1cykge1xuXHRcdFx0ICBcdFx0aWYgKHN0YXR1cyA9PSBnb29nbGUubWFwcy5HZW9jb2RlclN0YXR1cy5PSykge1xuXHRcdFx0ICBcdFx0XHRzY29wZS5kYXRhLmFkZHJlc3MgPSByZXN1bHRzWzBdLmZvcm1hdHRlZF9hZGRyZXNzO1xuXHRcdFx0ICBcdFx0XHRzY29wZS5kYXRhLmxhdGl0dWRlID0gcmVzdWx0c1swXS5nZW9tZXRyeS5sb2NhdGlvbi5sYXQoKTtcblx0XHRcdCAgXHRcdFx0c2NvcGUuZGF0YS5sb25naXR1ZGUgPSByZXN1bHRzWzBdLmdlb21ldHJ5LmxvY2F0aW9uLmxuZygpO1xuXHRcdFx0ICBcdFx0XHRzY29wZS4kYXBwbHkoKTtcblx0XHRcdCAgXHRcdFx0bWFwLnNldENlbnRlcihyZXN1bHRzWzBdLmdlb21ldHJ5LmxvY2F0aW9uKTtcblx0XHRcdCAgXHRcdFx0bWFya2VyLnNldFBvc2l0aW9uKHJlc3VsdHNbMF0uZ2VvbWV0cnkubG9jYXRpb24pO1xuXHRcdFx0ICBcdFx0XHRpZiAob3B0aW9ucy5maXRCb3VuZHMpIHtcblx0XHRcdFx0XHQgICAgXHRtYXAuZml0Qm91bmRzKHJlc3VsdHNbMF0uZ2VvbWV0cnkudmlld3BvcnQpO1xuXHRcdFx0XHRcdCAgICB9XG5cdFx0XHQgIFx0XHR9XG5cdFx0XHQgIFx0fSk7XG5cdFx0XHQgIH07XG5cblx0XHRcdCAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFwLCAnZHJhZ2VuZCcsIGZ1bmN0aW9uKCkge1xuXHRcdFx0ICBcdGdlb0NvZGVCeUNvb3JkcyhtYXAuZ2V0Q2VudGVyKCkpO1xuXHRcdFx0ICB9KTtcblxuXHRcdFx0ICB2YXIgaW5mb1dpbmRvdyA9IG51bGw7XG5cblx0XHRcdCAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFwLCAnY2xpY2snLCBmdW5jdGlvbiAoZXYpIHtcblx0XHRcdCAgXHRnZW9jb2Rlci5nZW9jb2RlKHtcblx0XHRcdCAgXHRcdGxhdExuZzogZXYubGF0TG5nXG5cdFx0XHQgIFx0fSwgZnVuY3Rpb24gKHJlc3VsdHMsIHN0YXR1cykge1xuXHRcdFx0ICBcdFx0aWYgKHN0YXR1cyA9PSBnb29nbGUubWFwcy5HZW9jb2RlclN0YXR1cy5PSykge1xuXHRcdFx0ICBcdFx0XHRpZiAoaW5mb1dpbmRvdykge1xuXHRcdFx0ICBcdFx0XHRcdGluZm9XaW5kb3cuY2xvc2UoKTtcblx0XHRcdCAgXHRcdFx0fVxuXHRcdFx0XHQgIFx0XHRpbmZvV2luZG93ID0gbmV3IGdvb2dsZS5tYXBzLkluZm9XaW5kb3coe1xuXHRcdCAgICAgICAgICAgIGNvbnRlbnQ6IHJlc3VsdHNbMF0uZm9ybWF0dGVkX2FkZHJlc3MsXG5cdFx0ICAgICAgICAgICAgcG9zaXRpb246IGV2LmxhdExuZ1xuXHRcdCAgICAgICAgICB9KTtcblx0XHQgICAgICAgICAgaW5mb1dpbmRvdy5vcGVuKG1hcCk7XG5cdFx0XHRcdCAgXHR9XG5cdFx0XHQgIFx0fSk7XG5cdFx0XHQgIH0pO1xuXG5cdFx0XHQgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcmtlciwgJ2RyYWdlbmQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICBcdFx0Z2VvQ29kZUJ5Q29vcmRzKG1hcmtlci5nZXRQb3NpdGlvbigpKTtcbiAgICAgIFx0fSk7XG5cblx0XHRcdCAgbmF2aWdhdG9yLmdlb2xvY2F0aW9uLmdldEN1cnJlbnRQb3NpdGlvbihmdW5jdGlvbiAocG9zaXRpb24pIHtcbiAgICAgICAgICBsYXRMbmcgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKHBvc2l0aW9uLmNvb3Jkcy5sYXRpdHVkZSwgcG9zaXRpb24uY29vcmRzLmxvbmdpdHVkZSk7XG4gICAgICAgICAgZ2VvQ29kZUJ5Q29vcmRzKGxhdExuZyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHNjb3BlLiR3YXRjaCgnb3B0aW9ucy5tYXJrZXInLCBmdW5jdGlvbih2YWwpIHtcblx0XHRcdCAgXHRvcHRpb25zLm1hcmtlciA9IHZhbDtcblx0XHRcdCAgXHRtYXJrZXIuc2V0VmlzaWJsZShvcHRpb25zLm1hcmtlcik7XG5cdFx0XHQgIH0pO1xuICBcdFx0fVxuICBcdH07XG4gIH1dKTsiLCJhbmd1bGFyLm1vZHVsZSgnYXBwLnJvdXRlcycsIFtdKVxuXG4uY29uZmlnKGZ1bmN0aW9uKCRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIpIHtcblxuICAvLyBJb25pYyB1c2VzIEFuZ3VsYXJVSSBSb3V0ZXIgd2hpY2ggdXNlcyB0aGUgY29uY2VwdCBvZiBzdGF0ZXNcbiAgLy8gTGVhcm4gbW9yZSBoZXJlOiBodHRwczovL2dpdGh1Yi5jb20vYW5ndWxhci11aS91aS1yb3V0ZXJcbiAgLy8gU2V0IHVwIHRoZSB2YXJpb3VzIHN0YXRlcyB3aGljaCB0aGUgYXBwIGNhbiBiZSBpbi5cbiAgLy8gRWFjaCBzdGF0ZSdzIGNvbnRyb2xsZXIgY2FuIGJlIGZvdW5kIGluIGNvbnRyb2xsZXJzLmpzXG4gICRzdGF0ZVByb3ZpZGVyXG5cblxuLnN0YXRlKCdnZXRTdGFydGVkJywge1xuICAgICAgdXJsOiAnL2dldFN0YXJ0ZWQnLFxuICAgICAgY29udHJvbGxlcjogJ0dldFN0YXJ0ZWRDdHJsJ1xuICAgIH0pXG4uc3RhdGUoJ3dlbGNvbWUnLCB7XG4gICAgICB1cmw6ICcvd2VsY29tZScsXG4gICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy9nZXRTdGFydGVkLmh0bWwnLFxuICAgICAgY29udHJvbGxlcjogJ1dlbGNvbWVQYWdlQ3RybCdcbiAgICB9KVxuICAuc3RhdGUoJ3NpZ25JbicsIHtcbiAgICAgIHVybDogJy9zaWduSW4nLFxuICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvc2lnbkluLmh0bWwnLFxuICAgICAgY29udHJvbGxlcjogJ1NpZ25JbkN0cmwnXG4gIH0pXG5cbiAgLnN0YXRlKCdzaWduVXAnLCB7XG4gICAgICB1cmw6ICcvc2lnblVwJyxcbiAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL3NpZ25VcC5odG1sJyxcbiAgICAgIGNvbnRyb2xsZXI6ICdTaW5nVXBDdHJsJ1xuICB9KVxuICAuc3RhdGUoJ2FwcCcsIHtcbiAgICAgIHVybDogJy9hcHAnLFxuICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvc2lkZU1lbnUuaHRtbCcsXG4gICAgICBjb250cm9sbGVyOiAnQXBwTmF2aWdhdGlvbkN0cmwnXG4gIH0pXG5cbiAgLnN0YXRlKCdhcHAuZm9yZWNhc3QnLCB7XG4gICAgICB1cmw6ICcvZm9yZWNhc3QnLFxuICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy9mb3JlY2FzdC5odG1sJyxcbiAgICAgIGNvbnRyb2xsZXI6ICdBcHBOYXZpZ2F0aW9uQ3RybCdcbiAgfSlcbiAgLnN0YXRlKCdhcHAuZm9yZWNhc3QuY3VycmVudCcsIHtcbiAgICAgIHVybDogJy9mb3JlY2FzdC9jdXJyZW50JyxcbiAgICAgIHZpZXdzOiB7XG4gICAgICAgICdjdXJyZW50Jzoge1xuICAgICAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL21haW4uaHRtbCcsXG4gICAgICAgICAgY29udHJvbGxlcjogJ21haW5DdHJsJ1xuICAgICAgICB9XG4gICAgICB9XG4gIH0pXG5cbiAgICAuc3RhdGUoJ2FwcC5mb3JlY2FzdC53ZWVrbHknLCB7XG4gICAgICB1cmw6ICcvd2Vla2x5JyxcbiAgICAgIHZpZXdzOiB7XG4gICAgICAgICd3ZWVrbHknOiB7XG4gICAgICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvd2Vla2x5Rm9yZWNhc3QuaHRtbCcsXG4gICAgICAgICAgY29udHJvbGxlcjogJ1dlZWtseUZvcmVjYXN0Q3RybCdcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pXG5cbiAgICAuc3RhdGUoJ2FwcC5mb3JlY2FzdC5ob3VybHknLCB7XG4gICAgICB1cmw6ICcvaG91cmx5JyxcbiAgICAgIHZpZXdzOiB7XG4gICAgICAgICdob3VybHknOiB7XG4gICAgICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvaG91cmx5Rm9yZWNhc3QuaHRtbCcsXG4gICAgICAgICAgY29udHJvbGxlcjogJ0hvdXJseUZvcmVjYXN0Q3RybCdcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pXG5cbiAgLnN0YXRlKCdhcHAuc2V0dGluZ3MnLCB7XG4gICAgICB1cmw6ICcvc2V0dGluZ3MnLFxuICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvc2V0dGluZ3MuaHRtbCcsXG4gICAgICBjb250cm9sbGVyOiAnQXBwTmF2aWdhdGlvbkN0cmwnXG4gIH0pXG4gIC5zdGF0ZSgnYXBwLnByb2ZpbGUnLCB7XG4gICAgICB1cmw6ICcvcHJvZmlsZScsXG4gICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy9wcm9maWxlLmh0bWwnLFxuICAgICAgY29udHJvbGxlcjogJ1Byb2ZpbGVDdHJsJ1xuICB9KVxuICAuc3RhdGUoJ2FwcC5jaGFuZ2VMb2NhdGlvbicsIHtcbiAgICAgIHVybDogJy9sb2NhdGlvbicsXG4gICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy9jaGFuZ2VMb2NhdGlvbi5odG1sJyxcbiAgICAgIGNvbnRyb2xsZXI6ICdFbnRlckxvY2F0aW9uQ3RybCdcbiAgfSlcblxuICAuc3RhdGUoJ2FwcC5jaGFuZ2VCYWNrcm91bmQnLCB7XG4gICAgICB1cmw6ICcvYmFja2dyb3VuZCcsXG4gICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy9iYWNrZ3JvdW5kU2VsZWN0aW9uLmh0bWwnLFxuICAgICAgY29udHJvbGxlcjogJ2JhY2tncm91bmRTZWxlY3Rpb25DdHJsJ1xuICB9KVxuXG4gIC5zdGF0ZSgnYXBwLmNoYW5nZVN0aWNrZXJzJywge1xuICAgICAgdXJsOiAnL3N0aWNrZXJzJyxcbiAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL3N0aWNrZXJzLmh0bWwnLFxuICAgICAgY29udHJvbGxlcjogJ1N0aWNrZXJzU2VsZWN0aW9uQ3RybCdcbiAgfSlcblxuICAuc3RhdGUoJ2FwcC5tYXAnLCB7XG4gICAgdXJsOiAnL21hcCcsXG4gICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvbWFwLmh0bWwnLFxuICAgIGNvbnRyb2xsZXI6ICdtYXBDdHJsJ1xuICB9KVxuXG4gIC5zdGF0ZSgnYWRkRW1vamlzJywge1xuICAgIHVybDogJy9hZGRfZW1vamlzJyxcbiAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy9hZGRFbW9qaXMuaHRtbCcsXG4gICAgY29udHJvbGxlcjogJ2FkZEVtb2ppc0N0cmwnXG4gIH0pXG5cblxuICAuc3RhdGUoJ2JhY2tncm91bmRTZWxlY3Rpb24nLCB7XG4gICAgdXJsOiAnL3BhZ2UxMicsXG4gICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvYmFja2dyb3VuZFNlbGVjdGlvbi5odG1sJyxcbiAgICBjb250cm9sbGVyOiAnYmFja2dyb3VuZFNlbGVjdGlvbkN0cmwnXG4gIH0pXG5cbiAgLnN0YXRlKCdhcHAuc3RvcmUnLCB7XG4gICAgICB1cmw6ICcvc3RvcmUnLFxuICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy9zdG9yZS5odG1sJyxcbiAgICAgIGNvbnRyb2xsZXI6ICdBcHBOYXZpZ2F0aW9uQ3RybCdcbiAgfSlcbiAgLnN0YXRlKCdhcHAuc3RvcmUuc3RpY2tlcnMnLCB7XG4gICAgICB1cmw6ICcvc3RpY2tlcnMnLFxuICAgICAgdmlld3M6IHtcbiAgICAgICAgJ3N0aWNrZXJzJzoge1xuICAgICAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL3N0aWNrZXJzU3RvcmUuaHRtbCcsXG4gICAgICAgICAgY29udHJvbGxlcjogJ1N0aWNrZXJzU3RvcmVDdHJsJ1xuICAgICAgICB9XG4gICAgICB9XG4gIH0pXG5cbiAgICAuc3RhdGUoJ2FwcC5zdG9yZS5iYWNrZ3JvdW5kcycsIHtcbiAgICAgIHVybDogJy9iYWNrZ3JvdW5kJyxcbiAgICAgIHZpZXdzOiB7XG4gICAgICAgICdiYWNrZ3JvdW5kcyc6IHtcbiAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy9iYWNrZ3JvdW5kU3RvcmUuaHRtbCcsXG4gICAgICAgICAgY29udHJvbGxlcjogJ2JhY2tncm91bmRTdG9yZUN0cmwnXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KVxuXG4gICAgLnN0YXRlKCdhcHAuc3RvcmUuYWRzJywge1xuICAgICAgdXJsOiAnL2FkcycsXG4gICAgICB2aWV3czoge1xuICAgICAgICAnYWRzJzoge1xuICAgICAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL2Fkcy5odG1sJyxcbiAgICAgICAgICBjb250cm9sbGVyOiAncHVyY2hhc2VBZHNDdHJsJ1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSlcbiAgICAuc3RhdGUoJ2FwcC5hYm91dCcsIHtcbiAgICAgICAgdXJsOiAnL2Fib3V0JyxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvYWJvdXQuaHRtbCdcbiAgICB9KVxuJHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZSgnL2dldFN0YXJ0ZWQnKVxuXG5cblxufSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcblxuLmRpcmVjdGl2ZSgnYWRzJywgZnVuY3Rpb24oKSB7XG4gIHJldHVybiB7XG4gICAgcmVzdHJpY3Q6ICdBJyxcbiAgICBjb250cm9sbGVyOiBmdW5jdGlvbigkc2NvcGUsICRzY2UsIEFkcykge1xuICAgICAgZ2V0QWRzKCk7XG4gICAgICB2YXIgcmVmcmVzaGVyID0gc2V0SW50ZXJ2YWwoZ2V0QWRzLCA0NSoxMDAwKTtcbiAgICAgICRzY29wZS5zY2UgPSBmdW5jdGlvbihodG1sKSB7XG4gICAgICAgIHJldHVybiAkc2NlLnRydXN0QXNIdG1sKGh0bWwpO1xuICAgICAgfVxuICAgICAgQWRzLnN1YnNjcmliZShmdW5jdGlvbigpIHtcbiAgICAgICAgJHNjb3BlLmh0bWwgPSBcIlwiO1xuICAgICAgICAkc2NvcGUuJGFwcGx5KCk7XG4gICAgICAgIGNsZWFySW50ZXJ2YWwocmVmcmVzaGVyKTtcblxuICAgICAgfSk7XG4gICAgICBmdW5jdGlvbiBnZXRBZHMoKSB7XG4gICAgICAgIGlmKEFkcy5wdXJjaGFzZWQoKSkge1xuICAgICAgICAgICQoJy5oYXMtYWRzJykucmVtb3ZlQ2xhc3MoJ2hhcy1hZHMnKTtcbiAgICAgICAgfVxuICAgICAgICBBZHMuZ2V0KCkudGhlbihmdW5jdGlvbihodG1sKSB7XG4gICAgICAgICAgJHNjb3BlLmh0bWwgPSBodG1sO1xuICAgICAgICAgICRzY29wZS4kYXBwbHkoKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSxcbiAgICBjb21waWxlOiBmdW5jdGlvbigkZWxlbWVudCwgJGF0dHJzKSB7XG4gICAgICAkZWxlbWVudC5odG1sKFxuICAgICAgICAnPGRpdiBjbGFzcyA9IFwiYWRzXCIgbmctYmluZC1odG1sID0gXCJzY2UoaHRtbClcIj48L2Rpdj4nXG4gICAgICApO1xuICAgIH1cbiAgfVxufSlcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuXG4uZGlyZWN0aXZlKCdiYWNrZ3JvdW5kJywgZnVuY3Rpb24oKSB7XG4gIHJldHVybiB7XG4gICAgcmVzdHJpY3Q6ICdBJyxcbiAgICBjb250cm9sbGVyOiBmdW5jdGlvbigkc2NvcGUsIEJhY2tncm91bmRzLCBFbmRQb2ludHMsIFVzZXIsICRodHRwKSB7XG4gICAgICAgICRzY29wZS5iYWNrZ3JvdW5kID0gXCJpbWcvYmFja2dyb3VuZC5wbmdcIjtcbiAgICAgICAgJHNjb3BlLiRvbihcIiRpb25pY1ZpZXcuZW50ZXJcIiwgdXBkYXRlKTtcbiAgICAgICAgdmFyIHN1YnNjcmliZWQ7XG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZSgpIHtcbiAgICAgICAgICAgIHZhciB0aW1lb3V0O1xuICAgICAgICAgICAgZ2V0UGFjaygpO1xuICAgICAgICAgICAgaWYoIXN1YnNjcmliZWQpIHtcbiAgICAgICAgICAgICAgQmFja2dyb3VuZHMuc3Vic2NyaWJlKGdldFBhY2spO1xuICAgICAgICAgICAgICBzdWJzY3JpYmUgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZnVuY3Rpb24gZ2V0UGFjaygpIHtcbiAgICAgICAgICAgICAgQmFja2dyb3VuZHMuY3VycmVudCgpLnRoZW4oc3VjY2VzcywgZXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZnVuY3Rpb24gc3VjY2VzcyhwYWNrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGJhY2tncm91bmQgPSAgQmFja2dyb3VuZHMuaW1hZ2UocGFjayk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmJhY2tncm91bmQgPSBiYWNrZ3JvdW5kO1xuICAgICAgICAgICAgICAgIGFwcGx5KCk7XG5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBhcHBseSgpIHtcbiAgICAgICAgICAgICAgICAgIGlmKHRpbWVvdXQpIGNsZWFyVGltZW91dCh0aW1lb3V0KTtcbiAgICAgICAgICAgICAgICAgIHRpbWVvdXQgPSBzZXRUaW1lb3V0KHVwZGF0ZSwgNjAqNjAqMTAwMCk7XG4gICAgICAgICAgICAgICAgICAkc2NvcGUuJGFwcGx5KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZnVuY3Rpb24gZXJyb3IoZXJyKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH07XG4gICAgfSxcbiAgICBjb21waWxlOiBmdW5jdGlvbigkZWxlbWVudCwgJGF0dHJzKSB7XG4gICAgICAkZWxlbWVudC5odG1sKFxuICAgICAgICAnPGRpdiBuZy1pZiA9IFwiYmFja2dyb3VuZFwiIGNsYXNzID0gXCJiYWNrZ3JvdW5kXCIgc3R5bGUgPSBcImJhY2tncm91bmQtaW1hZ2U6IHVybCh7e2JhY2tncm91bmR9fSk7XCI+PC9kaXY+J1xuICAgICAgKTtcbiAgICB9XG4gIH1cbn0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcblxuLmRpcmVjdGl2ZSgnYW5pbWF0ZWRVaVNyZWYnLCBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIHtcbiAgICByZXN0cmljdDogJ0EnLFxuICAgIHNjb3BlOiB0cnVlLFxuICAgIGNvbnRyb2xsZXI6IGZ1bmN0aW9uKCRzY29wZSwgJHN0YXRlKSB7XG4gICAgICAkc2NvcGUuZ28gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgJHN0YXRlLmdvKCRzY29wZS5yZWYpO1xuICAgICAgfVxuICAgIH0sXG4gICAgbGluazogZnVuY3Rpb24gKCRzY29wZSwgJGVsZW1lbnQsICRhdHRycykge1xuICAgICAgJGVsZW1lbnQgPSAkKCRlbGVtZW50KTtcbiAgICAgICRzY29wZS5yZWYgPSAkYXR0cnMuYW5pbWF0ZWRVaVNyZWY7XG4gICAgXHRhbmltYXRlQWN0aW9uKCRlbGVtZW50LCAkc2NvcGUuZ28pO1xuICAgIH1cbiAgfVxufSlcbi5kaXJlY3RpdmUoJ2FuaW1hdGVkQ2xpY2snLCBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIHtcbiAgICByZXN0cmljdDogJ0EnLFxuICAgIHNjb3BlOiB0cnVlLFxuICAgIGxpbms6IGZ1bmN0aW9uICgkc2NvcGUsICRlbGVtZW50LCAkYXR0cnMpIHtcbiAgICAgICRlbGVtZW50ID0gJCgkZWxlbWVudCk7XG4gICAgICB2YXIgbWFpblNjb3BlID0gJHNjb3BlO1xuICAgICAgYW5pbWF0ZUFjdGlvbigkZWxlbWVudCwgZ2V0QWN0aW9uKCkpO1xuXG4gICAgICBmdW5jdGlvbiBnZXRBY3Rpb24oKSB7XG4gICAgICAgIHZhciBhbmltYXRlZENsaWNrID0gJGF0dHJzLmFuaW1hdGVkQ2xpY2s7XG4gICAgICAgIHZhciBwYXJzZWRDbGljayA9IGFuaW1hdGVkQ2xpY2suc3BsaXQoL1xcKHxcXCkvKTtcblxuICAgICAgICB2YXIgbWV0aG9kID0gZ2V0TWV0aG9kKCk7XG4gICAgICAgIHZhciBhdHRycyA9IGdldEF0dHJzKCk7XG5cbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgICAgIG1ldGhvZC5hcHBseShtZXRob2QsIGF0dHJzKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBnZXRNZXRob2QoKSB7XG4gICAgICAgICAgdmFyIG5hbWUgPSBwYXJzZWRDbGlja1swXTtcbiAgICAgICAgICByZXR1cm4gbWFpblNjb3BlW25hbWVdO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0QXR0cnMoKSB7XG4gICAgICAgICAgdmFyIGF0dHJzID0gW107XG4gICAgICAgICAgcGFyc2VkQ2xpY2tbMV0uc3BsaXQoLywvKS5mb3JFYWNoKFxuICAgICAgICAgICAgZnVuY3Rpb24oZWxlbWVudCkge1xuICAgICAgICAgICAgICBhdHRycy5wdXNoKG1haW5TY29wZVtlbGVtZW50XSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgKTtcbiAgICAgICAgICByZXR1cm4gYXR0cnM7XG4gICAgICAgIH1cblxuICAgICAgfVxuICAgIH1cbiAgfVxufSlcblxuZnVuY3Rpb24gYW5pbWF0ZUFjdGlvbigkZWxlbWVudCwgYWN0aW9uKSB7XG5cbiAgJGVsZW1lbnQuY2xpY2soZnVuY3Rpb24oKXtcbiAgICB2YXIgbWFya2VyID0gJCgnPGRpdiBjbGFzcyA9IFwiYWN0aXZlLWJ1dHRvbi1tYXJrZXJcIj48L2Rpdj4nKTtcbiAgICAkZWxlbWVudC5hcHBlbmQobWFya2VyKTtcbiAgICB2YXIgZHVyYXRpb24gPSA3MDA7XG4gICAgc2V0VGltZW91dChmdW5jdGlvbigpe21hcmtlci5yZW1vdmUoKTsgYWN0aW9uKCl9LCBkdXJhdGlvbilcbiAgfSk7XG5cbn1cbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbnRyb2xsZXIoJ09uYm9hcmRpbmdDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkZWxlbWVudCwgJGF0dHJzLCBzdHJpbmdzKXtcbiAgdmFyIHBhcmFtcyA9ICAkYXR0cnMub25ib2FyZGluZy5zcGxpdCgnICcpO1xuICB2YXIgc2VsZWN0b3IgPSBwYXJhbXNbMF07XG4gIHZhciBkZWxheSA9IDAgfHwgcGFyYW1zWzFdKjEwMDA7XG4gIHZhciBkdXJhdGlvbiA9IDMwMDAgfHwgcGFyYW1zWzJdKjEwMDA7XG5cbiAgdmFyIHJlZmVyZW5jZSA9ICQoc2VsZWN0b3IpO1xuICB2YXIgZWxlbWVudCA9ICQoJGVsZW1lbnQpO1xuICB2YXIgcmVmZXJlbmNlT2Zmc2V0ID0gcmVmZXJlbmNlLm9mZnNldCgpO1xuICB2YXIgcmVmZXJlbmNlSENlbnRlciA9IHJlZmVyZW5jZU9mZnNldC5sZWZ0ICsgcmVmZXJlbmNlLndpZHRoKCkvMjtcbiAgdmFyIHJlZmVyZW5jZVZDZW50ZXIgPSByZWZlcmVuY2VPZmZzZXQudG9wICsgcmVmZXJlbmNlLmhlaWdodCgpLzI7XG4gIHZhciB2TG9jID0gXCJib3R0b21cIlxuICB2YXIgdk9mZnNldCA9IDA7XG4gIHNldHVwQ29udGVudCgpO1xuICBzZXR1cFBvaW50ZXIoKTtcbiAgaWYocmVmZXJlbmNlVkNlbnRlciA+ICQoJ2lvbi1jb250ZW50JykuaGVpZ2h0KCkvMikge1xuICAgIHZMb2MgPSBcInRvcFwiO1xuICAgICAgdk9mZnNldCA9IC0yKmVsZW1lbnQuaGVpZ2h0KCk7XG4gIH1cbiAgZWxlbWVudC5vZmZzZXQoe3RvcDogKHJlZmVyZW5jZVZDZW50ZXIgLSA0NCArIHZPZmZzZXQpLCBsZWZ0OiAyMH0pO1xuXG4gIHNldFRpbWVvdXQoYXBwZWFyLCBkZWxheSk7XG5cbiAgZnVuY3Rpb24gZGVmaW5lSXNVbmRlclJlZmVyZW5jZSgpIHtcbiAgICB2YXIgc2NyZWVuQ2VudGVyID0gJCgnaW9uLWNvbnRlbnQnKS5oZWlnaHQoKS8yO1xuICAgIHJldHVybiAodkNlbnRlciA8IHNjcmVlbkNlbnRlcik7XG4gIH1cbiAgZnVuY3Rpb24gc2V0dXBDb250ZW50KCkge1xuICAgIHZhciBvbmJvYXJkaW5nQ29udGVudCA9IGVsZW1lbnQuZmluZCgnLm9uYm9hcmRpbmctY29udGVudCcpO1xuICAgIG9uYm9hcmRpbmdDb250ZW50Lmh0bWwoc3RyaW5ncyhzZWxlY3RvcikpO1xuICB9XG4gIGZ1bmN0aW9uIHNldHVwUG9pbnRlcigpIHtcbiAgICB2YXIgcG9pbnRlciA9IGVsZW1lbnQuZmluZCgnLm9uYm9hcmRpbmctcG9pbnRlcicpO1xuICAgICAgdmFyIG9mZnNldCA9IHtsZWZ0OiByZWZlcmVuY2VIQ2VudGVyfTtcbiAgICAgIG9mZnNldFt2TG9jXSA9IDA7XG4gICAgICBwb2ludGVyLm9mZnNldChvZmZzZXQpO1xuICB9XG4gIGZ1bmN0aW9uIGFwcGVhcigpIHtcbiAgICBmYWRlKCk7XG4gICAgc2V0VGltZW91dChyZW1vdmUsIGR1cmF0aW9uKTtcbiAgICBlbGVtZW50LmNsaWNrKHJlbW92ZSk7XG5cbiAgICBmdW5jdGlvbiBmYWRlKCkge1xuICAgICAgZWxlbWVudC5mYWRlVG8oMTAwMCwgMSk7XG4gICAgfVxuICB9XG4gIHZhciBkZXN0cm95ID0gZnVuY3Rpb24oKSB7XG4gICAgZWxlbWVudC5yZW1vdmUoKVxuICB9O1xuICBmdW5jdGlvbiByZW1vdmUoKSB7XG4gICAgICBmYWRlKCk7XG4gICAgICBzZXRUaW1lb3V0KGRlc3Ryb3ksIDEwMDApO1xuICAgICAgZnVuY3Rpb24gZmFkZSgpIHtcbiAgICAgICAgZWxlbWVudC5mYWRlVG8oMTAwMCwgMCk7XG4gICAgICB9XG4gIH1cblxufSlcbi5kaXJlY3RpdmUoJ29uYm9hcmRpbmcnLCBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIHtcbiAgICByZXN0cmljdDogJ0EnLFxuICAgIGNvbXBpbGU6IGZ1bmN0aW9uKCRlbGVtZW50LCAkYXR0cnMpIHtcbiAgICAgICRlbGVtZW50LmFkZENsYXNzKCdvbmJvYXJkaW5nJyk7XG4gICAgICAkZWxlbWVudC5odG1sKFxuICAgICAgICBcIjxkaXYgY2xhc3MgPSAnb25ib2FyZGluZy1jb250ZW50Jz48L2Rpdj5cIitcbiAgICAgICAgXCI8ZGl2IGNsYXNzID0gJ29uYm9hcmRpbmctcG9pbnRlcic+PC9kaXY+XCJcbiAgICAgICk7XG4gICAgfSxcbiAgICBjb250cm9sbGVyOiAnT25ib2FyZGluZ0N0cmwnXG4gIH1cbn0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcblxuXG4uY29udHJvbGxlcignYWRkRW1vamlzQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgJHN0YXRlKSB7XG5cbn0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcblxuXG4uY29udHJvbGxlcignQXBwTmF2aWdhdGlvbkN0cmwnLCBmdW5jdGlvbigkc2NvcGUsICRyb290U2NvcGUsICRzdGF0ZSwgJGlvbmljU2lkZU1lbnVEZWxlZ2F0ZSwgVXNlciApIHtcbiAgJHJvb3RTY29wZS5tYWluUGFnZSA9IHRydWU7XG4gICRyb290U2NvcGUubW9tZW50ID0gbW9tZW50O1xuICByZWxvYWQoKTtcbiAgVXNlci5tZShcInN1YnNjcmliZVwiLCByZWxvYWQpO1xuICBmdW5jdGlvbiByZWxvYWQoKSB7XG4gICAgJHNjb3BlLnVzZXIgPSBVc2VyLm1lKCk7XG4gIH1cbiAgJHNjb3BlLiBnZXRNZW51QnV0dG9uQ2xhc3MgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gKCRpb25pY1NpZGVNZW51RGVsZWdhdGUuaXNPcGVuKCkpPyBcImlvbi1hbmRyb2lkLWNsb3NlXCIgOiBcImlvbi1uYXZpY29uXCI7XG4gIH1cbiAgJHNjb3BlLmxvZ091dCA9IGZ1bmN0aW9uKCkge1xuICAgIFVzZXIubG9nT3V0KCkudGhlbihcbiAgICAgIGZ1bmN0aW9uKCkge1xuICAgICAgICAkc3RhdGUuZ28oXCJ3ZWxjb21lXCIpO1xuICAgICAgfSxcbiAgICAgIGZ1bmN0aW9uKCBlcnIgKSB7XG4gICAgICAgIHRocm93IGVycjtcbiAgICAgIH0pO1xuICB9XG59KVxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG5cblxuLmNvbnRyb2xsZXIoJ2JhY2tncm91bmRTZWxlY3Rpb25DdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkc3RhdGUsIEJhY2tncm91bmRzLCBzdHJpbmdzLCBVc2VyKSB7XG4gICRzY29wZS5zdHJpbmdzID0gc3RyaW5ncztcbiAgdmFyIGJhY2tncm91bmQgPSB7aWQ6IC0xfTtcbiAgdXBkYXRlKCk7XG4gIFVzZXIubWUoXCJzdWJzY3JpYmVcIiwgdXBkYXRlKTtcbiAgQmFja2dyb3VuZHMuc3Vic2NyaWJlKHVwZGF0ZSk7XG4gIGZ1bmN0aW9uIHVwZGF0ZSgpIHtcbiAgICAgIEJhY2tncm91bmRzLmN1cnJlbnQoKS50aGVuKGZ1bmN0aW9uKHBhY2spIHtcbiAgICAgICAgYmFja2dyb3VuZCA9IHBhY2s7XG4gICAgICAgICRzY29wZS4kYXBwbHkoKTtcbiAgICAgIH0pO1xuICAgICAgQmFja2dyb3VuZHMuYXZhaWxhYmxlKCkudGhlbihmdW5jdGlvbihsaXN0KSB7XG4gICAgICAgICRzY29wZS5iYWNrZ3JvdW5kcyA9IGxpc3Q7XG4gICAgICAgICRzY29wZS4kYXBwbHkoKTtcbiAgICAgIH0pO1xuICB9XG5cdCRzY29wZS5zZWxlY3QgPSBmdW5jdGlvbihpdGVtKSB7XG5cdFx0QmFja2dyb3VuZHMuY3VycmVudChpdGVtKTtcbiAgICBiYWNrZ3JvdW5kID0gaXRlbTtcblx0fVxuXHQkc2NvcGUuaXNTZWxlY3RlZCA9IGZ1bmN0aW9uKCBpdGVtICkge1xuXHRcdHJldHVybiAoaXRlbS5pZCA9PSBiYWNrZ3JvdW5kLmlkKT8gXCJpdGVtLXNlbGVjdGVkXCI6IFwiXCI7XG5cdH1cblxufSlcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuXG5cbi5jb250cm9sbGVyKCdiYWNrZ3JvdW5kU3RvcmVDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkc3RhdGUsIEJhY2tncm91bmRzLCBzdHJpbmdzLCAkaW9uaWNQb3B1cCwgJGlvbmljTG9hZGluZywgVXNlcikge1xuICAkc2NvcGUuc3RyaW5ncyA9IHN0cmluZ3M7XG4gIHZhciBiYWNrZ3JvdW5kID0ge2lkOiAtMX07XG4gIFVzZXIubWUoXCJzdWJzY3JpYmVcIiwgdXBkYXRlKTtcbiAgdXBkYXRlKCk7XG4gIGZ1bmN0aW9uIHVwZGF0ZSgpIHtcbiAgICAgIEJhY2tncm91bmRzLmN1cnJlbnQoKS50aGVuKGZ1bmN0aW9uKHBhY2spIHtcbiAgICAgICAgYmFja2dyb3VuZCA9IHBhY2s7XG4gICAgICAgICRzY29wZS4kYXBwbHkoKTtcbiAgICAgIH0pO1xuICAgICAgQmFja2dyb3VuZHMuYWxsKCkudGhlbihmdW5jdGlvbihsaXN0KSB7XG4gICAgICAgICRzY29wZS5iYWNrZ3JvdW5kcyA9IGxpc3Q7XG4gICAgICAgICRzY29wZS4kYXBwbHkoKTtcbiAgICAgIH0pO1xuICB9XG5cdCRzY29wZS5zZWxlY3QgPSBmdW5jdGlvbihpdGVtKSB7XG4gICAgJGlvbmljTG9hZGluZy5zaG93KCk7XG5cdFx0QmFja2dyb3VuZHMucHVyY2hhc2UoaXRlbSkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICB1cGRhdGUoKTtcbiAgICAgICRpb25pY0xvYWRpbmcuaGlkZSgpO1xuICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICRpb25pY0xvYWRpbmcuaGlkZSgpO1xuICAgIH0pO1xuXHR9XG5cdCRzY29wZS5pc1NlbGVjdGVkID0gZnVuY3Rpb24oIGl0ZW0gKSB7XG5cdFx0cmV0dXJuIChpdGVtLmlkID09IGJhY2tncm91bmQuaWQpPyBcIml0ZW0tc2VsZWN0ZWRcIjogXCJcIjtcblx0fVxuXG59KVxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG5cblxuLmNvbnRyb2xsZXIoJ0VudGVyTG9jYXRpb25DdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkc3RhdGUsIExvY2F0aW9uU2VydmljZSwgR2VvY29kZSApIHtcbiAgJHNjb3BlLmxvY2F0aW9uID0gXCJcIjtcbiAgJHNjb3BlLmFsbG93R2VvbG9jYXRpb24gPSBMb2NhdGlvblNlcnZpY2UoXCJhbGxvd2VkIGF1dG8gZGVmaW5lXCIpO1xuICAkc2NvcGUudXNlckxvY2F0aW9ucyA9IExvY2F0aW9uU2VydmljZShcInVzZXIgbG9jYXRpb25zXCIpO1xuICAkc2NvcGUuYWRkTG9jYXRpb24gPSBmdW5jdGlvbihsb2MpIHtcbiAgICBHZW9jb2RlKGxvYykudGhlbihcbiAgICAgIGZ1bmN0aW9uIChsb2NhdGlvbikge1xuICAgICAgICAkc2NvcGUudXNlckxvY2F0aW9ucyA9IExvY2F0aW9uU2VydmljZShcInVzZXIgbG9jYXRpb25zXCIsIGxvY2F0aW9uKTtcbiAgICAgICAgJHNjb3BlLiRhcHBseSgpO1xuICAgICAgfSxcbiAgICAgIGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICB0aHJvdyBlcnI7XG4gICAgICB9XG4gICAgKTtcbiAgfVxuICAkc2NvcGUuaXNTZWxlY3RlZCA9IGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICByZXR1cm4gTG9jYXRpb25TZXJ2aWNlKFwiaXMgY3VycmVudFwiLCBpdGVtKT8gXCJpdGVtLXNlbGVjdGVkXCI6IFwiXCI7XG4gIH1cbiAgJHNjb3BlLnJlbW92ZSA9IGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAkc2NvcGUudXNlckxvY2F0aW9ucyA9IExvY2F0aW9uU2VydmljZShcInJlbW92ZSB1c2VyIGxvY2F0aW9uXCIsIGl0ZW0pO1xuICB9XG4gICRzY29wZS5zZWxlY3QgPSBmdW5jdGlvbihpdGVtKSB7XG4gICAgTG9jYXRpb25TZXJ2aWNlKFwiY3VycmVudCBsb2NhdGlvblwiLCBpdGVtKTtcbiAgfVxufSlcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuXG4gICBcbi5jb250cm9sbGVyKCdlcnJvckN0cmwnLCBmdW5jdGlvbigkc2NvcGUpIHtcblxufSlcbiAgICIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuXG4uY29udHJvbGxlcignR2V0U3RhcnRlZEN0cmwnLCBmdW5jdGlvbigkc2NvcGUsICRzdGF0ZSwgVXNlckRhdGEsICRpb25pY0xvYWRpbmcpIHtcbiAgJHNjb3BlLiRvbihcIiRpb25pY1ZpZXcuZW50ZXJcIiwgZnVuY3Rpb24oKSB7XG4gICAgdmFyIHRhcmdldCA9IChVc2VyRGF0YSgpKT8gXCJhcHAuZm9yZWNhc3QuY3VycmVudFwiIDogXCJ3ZWxjb21lXCI7XG4gICAgJHN0YXRlLmdvKHRhcmdldCk7XG4gIH0pXG59KVxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG5cbi5jb250cm9sbGVyKCdIb3VybHlGb3JlY2FzdEN0cmwnLCBmdW5jdGlvbigkc2NvcGUsICRyb290U2NvcGUsICRzdGF0ZSwgJGlvbmljTG9hZGluZywgJGlvbmljUG9wdXAsIFdlYXRoZXIsIExvY2F0aW9uU2VydmljZSwgRW1vankpIHtcblx0JGlvbmljTG9hZGluZy5zaG93KCk7XG5cdEVtb2p5LnN1YnNjcmliZShsb2FkKTtcblx0TG9jYXRpb25TZXJ2aWNlKFwic3Vic2NyaWJlXCIsIGxvYWQpO1xuXHRMb2NhdGlvblNlcnZpY2UoXCJkZWZpbmUgbG9jYXRpb25cIikudGhlbihzdWNjZXNzTG9jYXRpb25SZXF1ZXN0LCBlcnJvckxvY2F0aW9uUmVxdWVzdCk7XG5cdCRzY29wZS4kb24oJyRzdGF0ZUNoYW5nZVN1Y2Nlc3MnLCBmdW5jdGlvbihldmVudCwgdG9TdGF0ZSwgdG9QYXJhbXMsIGZyb21TdGF0ZSwgZnJvbVBhcmFtcykge1xuXHRcdGlmKHRvU3RhdGUubmFtZSA9PSBcImFwcC5mb3JlY2FzdC5ob3VybHlcIikge1xuXHRcdFx0JHJvb3RTY29wZS5tYWluUGFnZSA9IHRydWU7XG5cdFx0XHQkaW9uaWNMb2FkaW5nLnNob3coKTtcblx0XHRcdGxvYWQoKTtcblx0XHRcdHNldFRpbWVvdXQobG9hZCwgNjAqNjAqMTAwMCk7XG5cdFx0fVxuXHR9KTtcblx0ZnVuY3Rpb24gbG9hZCgpIHtcblx0XHRzdWNjZXNzTG9jYXRpb25SZXF1ZXN0KExvY2F0aW9uU2VydmljZShcImN1cnJlbnQgbG9jYXRpb25cIikpO1xuXHR9XG5cdGZ1bmN0aW9uIHN1Y2Nlc3NMb2NhdGlvblJlcXVlc3QobG9jYXRpb24pIHtcblx0XHRXZWF0aGVyKGxvY2F0aW9uLCBcImhvdXJseVwiKS50aGVuKHN1Y2Nlc3NXZWF0aGVyUmVxdWVzdCwgZXJyb3JXZWF0aGVyUmVxdWVzdCk7XG5cdH1cblx0ZnVuY3Rpb24gZXJyb3JMb2NhdGlvblJlcXVlc3QoZXJyb3IpIHtcblx0XHQkaW9uaWNMb2FkaW5nLmhpZGUoKTtcblx0XHR0aHJvdyBlcnJvcjtcblx0fVxuXG5cdGZ1bmN0aW9uIHN1Y2Nlc3NXZWF0aGVyUmVxdWVzdCh3ZWF0aGVyKSB7XG5cdFx0JGlvbmljTG9hZGluZy5oaWRlKCk7XG5cdFx0JHNjb3BlLmhvdXJseUZvcmVjYXN0ID0gc29ydEJ5RGF5cyh3ZWF0aGVyKTtcblx0fVxuXHRmdW5jdGlvbiBzb3J0QnlEYXlzKHdlYXRoZXIpIHtcblx0XHR2YXIgc29ydGVkID0ge307XG5cdFx0Zm9yKHZhciBpID0gMDsgaSA8IHdlYXRoZXIubGVuZ3RoOyBpKyspIHtcblx0XHRcdGlmKGkgPT0gMjQpIGJyZWFrO1xuXHRcdFx0dmFyIHZhbHVlID0gd2VhdGhlcltpXTtcblx0XHRcdHZhciBrZXkgPSBtb21lbnQodmFsdWUuZGF0ZSkuZm9ybWF0KFwiZGRkZFwiKTtcblx0XHRcdHNvcnRlZFtrZXldID0gc29ydGVkW2tleV0gfHwgW107XG5cdFx0XHRzb3J0ZWRba2V5XS5wdXNoKHZhbHVlKTtcblx0XHR9XG5cdFx0cmV0dXJuIHNvcnRlZDtcblx0fVxuXHRmdW5jdGlvbiBlcnJvcldlYXRoZXJSZXF1ZXN0KGVycm9yKSB7XG5cdFx0JGlvbmljUG9wdXAuYWxlcnQoe3RpdGxlOiBcIkVycm9yXCIsIHRlbXBsYXRlOiBcIkNhbm5vdCBnZXQgd2VhdGhlci4gXCIgKyBlcnJvcn0pO1xuXHRcdCRpb25pY0xvYWRpbmcuaGlkZSgpO1xuXHR9XG5cbn0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcblxuXG4uY29udHJvbGxlcignbG9naW5DdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkc3RhdGUsIEJhY2tncm91bmQsIFVzZXJEYXRhVmVyaWZ5LCBzdHJpbmdzLCAkaW9uaWNQb3B1cCwgVXNlckRhdGEpIHtcblx0JHNjb3BlLnN0cmluZ3MgPSBzdHJpbmdzO1xuXHRCYWNrZ3JvdW5kLnNldHVwKCRzY29wZSwgJHN0YXRlKTtcblx0JHNjb3BlLnVzZXIgPSB7XG5cdFx0bmFtZTogXCJcIixcbiAgICB1c2VybmFtZTogXCJcIixcbiAgICBwYXNzd29yZDogXCJcIixcbiAgICBjb25maXJtUGFzc3dvcmQ6IFwiXCIsXG5cblx0XHRsb2NhdGlvbjoge1xuXHRcdFx0c3RhdGU6IFwiXCIsXG5cdFx0XHRjb3VudHJ5OiBcIlwiLFxuXHRcdFx0Y2l0eTogXCJcIlxuXHRcdH1cblx0fVxuXHQkc2NvcGUuc3VibWl0ID0gZnVuY3Rpb24oKSB7XG4gICAgVXNlckRhdGFWZXJpZnkoJHNjb3BlLnVzZXIpLnRoZW4oc3VjY2VzcywgZXJyb3IpO1xuXHRcdGZ1bmN0aW9uIHN1Y2Nlc3MoKSB7XG5cdFx0XHRVc2VyRGF0YSgkc2NvcGUudXNlcik7XG5cdFx0XHQkc3RhdGUuZ28oXCJwcmV2aWV3XCIpO1xuXHRcdH1cblx0XHRmdW5jdGlvbiBlcnJvcihlKSB7XG5cdFx0XHQkaW9uaWNQb3B1cC5hbGVydCh7dGl0bGU6IFwiV2FybmluZ1wiLCB0ZW1wbGF0ZTogZX0pXG5cdFx0fVxuXHR9XG59KVxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG5cbi5jb250cm9sbGVyKCdtYWluQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgJHJvb3RTY29wZSwgJHN0YXRlLCAkaW9uaWNMb2FkaW5nLCBMb2NhdGlvblNlcnZpY2UsIFdlYXRoZXIsICRpb25pY1BvcHVwLCBFbW9qeSkge1xuXHRcdHZhciB1cGRhdGVyO1xuXHRcdHZhciBuZWVkQ2hlY2tMb2NhdGlvbiA9IHRydWU7XG5cdFx0JHNjb3BlLiRvbihcIiRpb25pY1ZpZXcuZW50ZXJcIiwgbG9jYXRpb25SZXF1ZXN0KTtcblx0XHRMb2NhdGlvblNlcnZpY2UoXCJzdWJzY3JpYmVcIiwgbG9hZCk7XG5cdFx0RW1vankuc3Vic2NyaWJlKGxvYWQpO1xuXHRcdGZ1bmN0aW9uIGxvYWQoKSB7XG5cdFx0XHRzdWNjZXNzTG9jYXRpb25SZXF1ZXN0KExvY2F0aW9uU2VydmljZShcImN1cnJlbnQgbG9jYXRpb25cIikpO1xuXHRcdH1cblx0XHRmdW5jdGlvbiBsb2NhdGlvblJlcXVlc3QoKSB7XG5cdFx0XHRcdGlmKCFuZWVkQ2hlY2tMb2NhdGlvbikgcmV0dXJuO1xuXHRcdFx0XHQkaW9uaWNMb2FkaW5nLnNob3coKTtcblx0XHRcdFx0dmFyIGxvY2F0aW9uID0gTG9jYXRpb25TZXJ2aWNlKFwiY3VycmVudCBsb2NhdGlvblwiKVxuXHRcdFx0XHRpZihsb2NhdGlvbikge1xuXHRcdFx0XHRcdHN1Y2Nlc3NMb2NhdGlvblJlcXVlc3QobG9jYXRpb24pXG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0TG9jYXRpb25TZXJ2aWNlKFwiZGVmaW5lIGxvY2F0aW9uXCIpLnRoZW4oXG5cdFx0XHRcdFx0XHRmdW5jdGlvbihsb2NhdGlvbikge1xuXHRcdFx0XHRcdFx0XHRzdWNjZXNzTG9jYXRpb25SZXF1ZXN0KGxvY2F0aW9uKTtcblx0XHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0XHRmdW5jdGlvbihlcnIpIHtcblx0XHRcdFx0XHRcdFx0JGlvbmljTG9hZGluZy5oaWRlKCk7XG5cdFx0XHRcdFx0XHRcdCRpb25pY1BvcHVwLmFsZXJ0KHt0aXRsZTogXCJXYXJuaW5nIVwiLCB0ZW1wbGF0ZTogXCJUaGVyZSBpcyBub3Qgc29tZSB1c2VyIGxvY2F0aW9uIGluZm9cIn0pO1xuXHRcdFx0XHRcdFx0XHQkc3RhdGUuZ28oJ2FwcC5jaGFuZ2VMb2NhdGlvbicpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdCk7XG5cdFx0XHRcdH1cblx0XHR9XG5cdFx0ZnVuY3Rpb24gc3VjY2Vzc0xvY2F0aW9uUmVxdWVzdChsb2NhdGlvbikge1xuXHRcdFx0bmVlZENoZWNrTG9jYXRpb24gPSBmYWxzZTtcblx0XHRcdFdlYXRoZXIobG9jYXRpb24sIFwiaG91cmx5XCIpLnRoZW4oc3VjY2Vzc1dlYXRoZXJSZXF1ZXN0LCBlcnJvcldlYXRoZXJSZXF1ZXN0KTtcblx0XHRcdGlmKHVwZGF0ZXIpIGNsZWFyVGltZW91dCh1cGRhdGVyKTtcblx0XHRcdHVwZGF0ZXIgPSBzZXRUaW1lb3V0KGxvYWQsIDYwKjYwKjEwMDApO1xuXHRcdH1cblxuXHRcdGZ1bmN0aW9uIHJlcXVpcmVMb2NhdGlvbihlcnIpIHtcblx0XHRcdHZhciB0aXRsZSA9IFwiRXJyb3IhXCI7XG5cdFx0XHR2YXIgdGVtcGxhdGUgPSBcIkNhbm5vdCBkZWZpbmUgeW91ciBnZW9wb3NpdGlvbi4gXCIgKyBlcnI7XG5cdFx0XHQkaW9uaWNQb3B1cC5hbGVydCh7dGl0bGU6IHRpdGxlLCB0ZW1wbGF0ZTogdGVtcGxhdGV9KTtcblx0XHR9XG5cblx0XHRmdW5jdGlvbiBzdWNjZXNzV2VhdGhlclJlcXVlc3Qod2VhdGhlcikge1xuXHRcdFx0JHJvb3RTY29wZS5sb2NhdGlvbiA9IExvY2F0aW9uU2VydmljZShcImN1cnJlbnQgbG9jYXRpb25cIik7XG5cdFx0XHQkc2NvcGUud2VhdGhlciA9IHdlYXRoZXI7XG5cdFx0XHQkc2NvcGUuJGFwcGx5KCk7XG5cdFx0XHQkaW9uaWNMb2FkaW5nLmhpZGUoKTtcblx0XHR9XG5cblx0XHRmdW5jdGlvbiBlcnJvcldlYXRoZXJSZXF1ZXN0KGVycm9yKSB7XG5cdFx0XHRjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeShlcnJvcikpO1xuXHRcdFx0JGlvbmljUG9wdXAuYWxlcnQoe3RpdGxlOiBcIkVycm9yXCIsIHRlbXBsYXRlOiBcIkNhbm5vdCBnZXQgd2VhdGhlci4gXCIgKyBlcnJvcn0pO1xuXHRcdFx0JGlvbmljTG9hZGluZy5oaWRlKCk7XG5cdFx0fVxufSlcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuXG5cbi5jb250cm9sbGVyKCdQcm9maWxlQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgJHN0YXRlLCBVc2VyRGF0YVZlcmlmeSwgJGlvbmljUG9wdXAsIFVzZXIsIHN0cmluZ3MsICRpb25pY0xvYWRpbmcpIHtcblx0cmVsb2FkKCk7XG5cdFVzZXIubWUoXCJzdWJzY3JpYmVcIiwgcmVsb2FkKTtcblx0ZnVuY3Rpb24gcmVsb2FkKCkge1xuXHRcdFx0dmFyIHVzZXIgPSBVc2VyLm1lKCk7XG5cdFx0XHRpZih1c2VyKSB7XG5cdFx0XHRcdCRzY29wZS51c2VyID0ge1xuXHRcdFx0ICAgIG5hbWU6IHVzZXIubmFtZSxcblx0XHRcdCAgICBlbWFpbDogdXNlci5lbWFpbCxcblx0XHRcdFx0XHRhdmF0YXI6IHVzZXIuYXZhdGFyLFxuXHRcdFx0ICAgIHBhc3N3b3JkOiBcIlwiLFxuXHRcdFx0ICAgIGNvbmZpcm1QYXNzd29yZDogXCJcIixcblx0XHRcdFx0XHRPQXV0aDogdXNlci5PQXV0aCB8fCBmYWxzZVxuXHRcdFx0ICB9O1xuXHRcdFx0fVxuXHR9XG5cdCRzY29wZS5nZXRBdmF0YXIgPSBmdW5jdGlvbigpIHtcblx0XHQkaW9uaWNMb2FkaW5nLnNob3coKTtcblx0XHRVc2VyLm1lKFwic2VsZWN0IGF2YXRhclwiKS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG5cdFx0XHQkaW9uaWNMb2FkaW5nLmhpZGUoKTtcblx0XHR9LCBmdW5jdGlvbiAoZXJyKSB7XG5cdFx0XHQkaW9uaWNMb2FkaW5nLmhpZGUoKTtcblx0XHRcdCRpb25pY1BvcHVwLmFsZXJ0KHtcblx0XHRcdFx0dGl0bGU6IFwiRXJyb3JcIiwgdGVtcGxhdGU6IFwiQ291bGQgbm9kIHVwbG9hZCBpbWFnZVwiXG5cdFx0XHR9KTtcblx0XHRcdGNvbnNvbGUuZXJyb3IoZXJyKTtcblx0XHR9KTtcblx0fVxuICAkc2NvcGUuc2F2ZSA9IGZ1bmN0aW9uKCkge1xuXHRcdCRpb25pY0xvYWRpbmcuc2hvdygpO1xuICAgIHZhciB1c2VyRGF0YSA9ICRzY29wZS51c2VyO1xuXHRcdFVzZXIubWUoXCJlZGl0XCIsIHVzZXJEYXRhKS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG5cdFx0XHQkaW9uaWNMb2FkaW5nLmhpZGUoKTtcblx0XHR9LCBmdW5jdGlvbiAoZXJyKSB7XG5cdFx0XHQkaW9uaWNMb2FkaW5nLmhpZGUoKTtcblx0XHRcdCRpb25pY1BvcHVwLmFsZXJ0KHtcblx0XHRcdFx0dGl0bGU6IFwiRXJyb3JcIiwgdGVtcGxhdGU6IGVyci5qb2luKFwiLFwiKVxuXHRcdFx0fSk7XG5cdFx0fSk7XG4gIH1cblxufSlcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuXG4uY29udHJvbGxlcignU2lnbkluQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgJHN0YXRlLCBVc2VyLCBFbW9qeSwgQmFja2dyb3VuZHMsICRpb25pY0xvYWRpbmcsICRpb25pY1BvcHVwKSB7XG4gICRzY29wZS51c2VyRGF0YSA9IHtcbiAgICBlbWFpbDogXCJhZG1pbkBhZG1pbi5jb21cIixcbiAgICBwYXNzd29yZDogXCJhZG1pblwiXG4gIH1cblx0JHNjb3BlLnNvbWVQYXJhbSA9IFwicGFyYW0xXCI7XG4gICRzY29wZS5zaWduSW4gPSBmdW5jdGlvbigpIHtcbiAgICAkaW9uaWNMb2FkaW5nLnNob3coKTtcbiAgICBVc2VyLnNpZ25Jbigkc2NvcGUudXNlckRhdGEpLnRoZW4oXG4gICAgICBmdW5jdGlvbigpIHtcbiAgICAgICAgJHN0YXRlLmdvKFwiYXBwLmZvcmVjYXN0LmN1cnJlbnRcIik7XG4gICAgICAgICRpb25pY0xvYWRpbmcuaGlkZSgpO1xuICAgICAgfSxcbiAgICAgIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAkaW9uaWNMb2FkaW5nLmhpZGUoKTtcbiAgICAgICAgJGlvbmljUG9wdXAuYWxlcnQoe3RpdGxlOiBcIkVycm9yXCIsIHRlbXBsYXRlOiBlcnJ9KTtcbiAgICAgIH1cbiAgICApO1xuICB9XG59KTtcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuXG4uY29udHJvbGxlcignU2luZ1VwQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgJHN0YXRlLCAkaW9uaWNQb3B1cCwgJGlvbmljTG9hZGluZywgTG9jYXRpb25TZXJ2aWNlLCBHZW9jb2RlLCBTaWduVXApIHtcbiAgJGlvbmljTG9hZGluZy5zaG93KCk7XG5cbiAgJHNjb3BlLnVzZXJEYXRhID0ge1xuICAgIG5hbWU6IFwiXCIsXG4gICAgZW1haWw6IFwiXCIsXG4gICAgcGFzc3dvcmQ6IFwiXCIsXG4gICAgY29uZmlybVBhc3N3b3JkOiBcIlwiXG4gIH07XG5cbiAgTG9jYXRpb25TZXJ2aWNlKFwiZGVmaW5lIGxvY2F0aW9uXCIpLnRoZW4oXG4gICAgZnVuY3Rpb24obG9jKSB7XG4gICAgICAkaW9uaWNMb2FkaW5nLmhpZGUoKTtcbiAgICAgICRzY29wZS5sb2NhdGlvbiA9IGxvYy5jaXR5ICsgXCIsIFwiICsgbG9jLnN0YXRlICsgXCIsIFwiICsgbG9jLmNvdW50cnk7XG4gICAgfSxcbiAgICBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAkaW9uaWNMb2FkaW5nLmhpZGUoKTtcbiAgICAgICRpb25pY1BvcHVwLmFsZXJ0KHt0aXRsZTogXCJXYXJuaW5nXCIsIHRlbXBsYXRlOiBcIkNhbm5vdCBkaWZpbmUgeW91ciBsb2NhdGlvblwifSk7XG4gICAgfVxuICApO1xuXG5cbiAgJHNjb3BlLnNldExvY2F0aW9uID0gZnVuY3Rpb24obG9jKSB7XG4gICAgR2VvY29kZShsb2MpLnRoZW4oXG4gICAgICBmdW5jdGlvbiAobG9jYXRpb24pIHtcbiAgICAgICAgTG9jYXRpb25TZXJ2aWNlKFwidXNlciBsb2NhdGlvbnNcIiwgbG9jYXRpb24pO1xuICAgICAgfSxcbiAgICAgIGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAkaW9uaWNQb3B1cC5hbGVydCh7dGl0bGU6IFwiRXJyb3JcIiwgdGVtcGxhdGU6IFwiTG9jYXRpb24gaXMgcmVxdWlyZWRcIn0pO1xuICAgICAgfVxuICAgICk7XG4gIH1cblxuXG5cbiAgJHNjb3BlLnNpZ25VcCA9IGZ1bmN0aW9uKCkge1xuICAgIFNpZ25VcChcImVtYWlsXCIsICRzY29wZS51c2VyRGF0YSkudGhlbihcbiAgICAgIGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAkc3RhdGUuZ28oXCJzaWduSW5cIik7XG4gICAgICB9LFxuICAgICAgZnVuY3Rpb24gKGVycikge1xuICAgICAgICAkaW9uaWNQb3B1cC5hbGVydCh7dGl0bGU6IFwiRXJyb3JcIiwgdGVtcGxhdGU6IGVycn0pO1xuICAgICAgfVxuICAgICk7XG4gIH1cbn0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcblxuXG4uY29udHJvbGxlcignU3RpY2tlcnNTZWxlY3Rpb25DdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkc3RhdGUsIHN0cmluZ3MsIEVtb2p5LCBVc2VyKSB7XG5cdHZhciBlbW9qeTtcblx0dXBkYXRlKCk7XG4gIFVzZXIubWUoXCJzdWJzY3JpYmVcIiwgdXBkYXRlKTtcblx0ZnVuY3Rpb24gdXBkYXRlKCkge1xuXHRcdFx0RW1vankuYXZhaWxhYmxlKCkudGhlbihmdW5jdGlvbihsaXN0KSB7XG5cdFx0XHRcdCRzY29wZS5zdGlja2VycyA9IGxpc3Q7XG5cdFx0XHRcdCRzY29wZS4kYXBwbHkoKTtcblx0XHRcdH0pXG5cdFx0XHRFbW9qeS5jdXJyZW50KCkudGhlbihmdW5jdGlvbihwYWNrKSB7XG5cdFx0XHRcdGVtb2p5ID0gcGFjaztcblx0XHRcdFx0JHNjb3BlLiRhcHBseSgpO1xuXHRcdFx0fSk7XG5cdH1cblx0RW1vankuc3Vic2NyaWJlKHVwZGF0ZSk7XG5cdCRzY29wZS5zZWxlY3QgPSBmdW5jdGlvbihpdGVtKSB7XG5cdFx0ZW1vankgPSBpdGVtO1xuXHRcdEVtb2p5LmN1cnJlbnQoaXRlbSk7XG5cdH1cblx0JHNjb3BlLmlzU2VsZWN0ZWQgPSBmdW5jdGlvbiggaXRlbSApIHtcblx0XHRpZighZW1vankgfHwgaXRlbS5pZCAhPSBlbW9qeS5pZCkgcmV0dXJuIFwiXCI7XG5cdFx0cmV0dXJuIFwiaXRlbS1zZWxlY3RlZFwiO1xuXHR9XG5cbn0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcblxuXG4uY29udHJvbGxlcignU3RpY2tlcnNTdG9yZUN0cmwnLCBmdW5jdGlvbigkc2NvcGUsICRzdGF0ZSwgc3RyaW5ncywgRW1vanksICRpb25pY1BvcHVwLCAkaW9uaWNMb2FkaW5nLCBVc2VyKSB7XG5cdHZhciBlbW9qeTtcblx0dXBkYXRlKCk7XG4gIFVzZXIubWUoXCJzdWJzY3JpYmVcIiwgdXBkYXRlKTtcblx0ZnVuY3Rpb24gdXBkYXRlKCkge1xuXHRcdEVtb2p5LmFsbCgpLnRoZW4oZnVuY3Rpb24obGlzdCkge1xuXHRcdFx0JHNjb3BlLnN0aWNrZXJzID0gbGlzdDtcblx0XHRcdCRzY29wZS4kYXBwbHkoKTtcblx0XHR9KVxuXHRcdEVtb2p5LmN1cnJlbnQoKS50aGVuKGZ1bmN0aW9uKHBhY2spIHtcblx0XHRcdGVtb2p5ID0gcGFjaztcblx0XHRcdCRzY29wZS4kYXBwbHkoKTtcblx0XHR9KTtcblx0fVxuXHQkc2NvcGUuc2VsZWN0ID0gZnVuY3Rpb24oaXRlbSkge1xuXHRcdCRpb25pY0xvYWRpbmcuc2hvdygpO1xuXHRcdEVtb2p5LnB1cmNoYXNlKGl0ZW0pLnRoZW4oZnVuY3Rpb24oKSB7XG5cdFx0XHR1cGRhdGUoKTtcblx0XHRcdCRpb25pY0xvYWRpbmcuaGlkZSgpO1xuXHRcdH0sIGZ1bmN0aW9uICgpIHtcblx0XHRcdCRpb25pY0xvYWRpbmcuaGlkZSgpO1xuXHRcdH0pO1xuXHR9XG5cbn0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcblxuLmNvbnRyb2xsZXIoJ1dlZWtseUZvcmVjYXN0Q3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgJHJvb3RTY29wZSwgJHN0YXRlLCAkaW9uaWNMb2FkaW5nLCAkaW9uaWNQb3B1cCwgTG9jYXRpb25TZXJ2aWNlLCBXZWF0aGVyLCBFbW9qeSkge1xuXG5cdCRpb25pY0xvYWRpbmcuc2hvdygpO1xuXHRFbW9qeS5zdWJzY3JpYmUobG9hZCk7XG5cdExvY2F0aW9uU2VydmljZShcInN1YnNjcmliZVwiLCBsb2FkKTtcblx0TG9jYXRpb25TZXJ2aWNlKFwiZGVmaW5lIGxvY2F0aW9uXCIpLnRoZW4oc3VjY2Vzc0xvY2F0aW9uUmVxdWVzdCwgZXJyb3JMb2NhdGlvblJlcXVlc3QpO1xuXHQkc2NvcGUuJG9uKCckc3RhdGVDaGFuZ2VTdWNjZXNzJywgZnVuY3Rpb24oZXZlbnQsIHRvU3RhdGUsIHRvUGFyYW1zLCBmcm9tU3RhdGUsIGZyb21QYXJhbXMpIHtcblx0XHRpZih0b1N0YXRlLm5hbWUgPT0gXCJhcHAuZm9yZWNhc3Qud2Vla2x5XCIpIHtcblx0XHRcdCRpb25pY0xvYWRpbmcuc2hvdygpO1xuXHRcdFx0bG9hZCgpO1xuXHRcdFx0c2V0VGltZW91dChsb2FkLCA2MCo2MCoxMDAwKTtcblx0XHR9XG5cdH0pO1xuXG5cdGZ1bmN0aW9uIGxvYWQoKSB7XG5cdFx0XHRzdWNjZXNzTG9jYXRpb25SZXF1ZXN0KExvY2F0aW9uU2VydmljZShcImN1cnJlbnQgbG9jYXRpb25cIikpO1xuXHR9XG5cdGZ1bmN0aW9uIHN1Y2Nlc3NMb2NhdGlvblJlcXVlc3QobG9jYXRpb24pIHtcblx0XHRXZWF0aGVyKGxvY2F0aW9uLCBcImZvcmVjYXN0MTBkYXlcIikudGhlbihzdWNjZXNzV2VhdGhlclJlcXVlc3QsIGVycm9yV2VhdGhlclJlcXVlc3QpO1xuXHR9XG5cdGZ1bmN0aW9uIGVycm9yTG9jYXRpb25SZXF1ZXN0KGVycm9yKSB7XG5cdFx0JGlvbmljTG9hZGluZy5oaWRlKCk7XG5cdFx0dGhyb3cgZXJyb3I7XG5cdH1cblxuXHRmdW5jdGlvbiBzdWNjZXNzV2VhdGhlclJlcXVlc3Qod2VhdGhlcikge1xuXHRcdCRpb25pY0xvYWRpbmcuaGlkZSgpO1xuXHRcdCRzY29wZS5mb3JlY2FzdCA9IHdlYXRoZXI7XG5cdFx0JHNjb3BlLm1vbWVudCA9IG1vbWVudDtcblx0fVxuXG5cdGZ1bmN0aW9uIGVycm9yV2VhdGhlclJlcXVlc3QoZXJyb3IpIHtcblx0XHQkaW9uaWNQb3B1cC5hbGVydCh7dGl0bGU6IFwiRXJyb3JcIiwgdGVtcGxhdGU6IFwiQ2Fubm90IGdldCB3ZWF0aGVyLiBcIiArIGVycm9yfSk7XG5cdFx0JGlvbmljTG9hZGluZy5oaWRlKCk7XG5cdH1cblxufSlcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuXG4uY29udHJvbGxlcignV2VsY29tZVBhZ2VDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkc3RhdGUsIFVzZXIsICRpb25pY1BvcHVwKSB7XG4gICRzY29wZS5sb2dJbldpdGggPSBmdW5jdGlvbihzZXJ2aWNlKSB7XG4gICAgVXNlci5zaWduSW4oc2VydmljZSkudGhlbihcbiAgICAgIGZ1bmN0aW9uKCByZXNwb25zZSApIHtcbiAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICAkc3RhdGUuZ28oXCJhcHAuZm9yZWNhc3QuY3VycmVudFwiKTtcbiAgICAgIH0sXG4gICAgICBmdW5jdGlvbiAoIGVyciApIHtcbiAgICAgICAgJGlvbmljUG9wdXAuYWxlcnQoe1xuICAgICAgICAgIHRpdGxlOiBcIldhcm5pbmdcIixcbiAgICAgICAgICB0ZW1wbGF0ZTogSlNPTi5zdHJpbmdpZnkoZXJyKVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICApO1xuICB9XG59KVxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG5cblxuLmNvbnRyb2xsZXIoJ21hcEN0cmwnLCBmdW5jdGlvbigkc2NvcGUsICRzdGF0ZSwgTWFwLCBMb2NhdGlvblNlcnZpY2UsIEVtb2p5LCAkaW9uaWNMb2FkaW5nLCAkaW9uaWNQb3B1cCkge1xuICB2YXIgbmVlZENoZWNrTG9jYXRpb24gPSB0cnVlO1xuICB2YXIgbWFwO1xuICAkc2NvcGUuZmluZExvY2F0aW9uID0gZnVuY3Rpb24obG9jYXRpb24pIHtcbiAgICBhZGRyZXNzID0gbG9jYXRpb247XG4gICAgbWFwID0gTWFwKCdtYXAtY2FudmFzJywgYWRkcmVzcyk7XG4gIH1cbiAgJHNjb3BlLmxvY2F0aW9uID0gXCJcIjtcbiAgJHNjb3BlLiRvbihcIiRpb25pY1ZpZXcuZW50ZXJcIiwgZnVuY3Rpb24gKCkge1xuICAgIGlmKCFuZWVkQ2hlY2tMb2NhdGlvbikgcmV0dXJuO1xuICAgIHZhciBsb2NhdGlvbiA9IExvY2F0aW9uU2VydmljZShcImN1cnJlbnQgbG9jYXRpb25cIik7XG4gICAgaWYobG9jYXRpb24pICRzY29wZS5maW5kTG9jYXRpb24gKGxvY2F0aW9uKTtcbiAgICBlbHNlIHtcbiAgICAgICRpb25pY0xvYWRpbmcuc2hvdygpO1xuICAgICAgTG9jYXRpb25TZXJ2aWNlKFwiZGVmaW5lIGxvY2F0aW9uXCIpLnRoZW4oJHNjb3BlLmZpbmRMb2NhdGlvbixcbiAgICAgICAgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgJGlvbmljTG9hZGluZy5oaWRlKCk7XG4gICAgICAgICAgJGlvbmljUG9wdXAuYWxlcnQoe3RpdGxlOiBcIldhcm5pbmchXCIsIHRlbXBsYXRlOiBcIlRoZXJlIGlzIG5vdCBzb21lIHVzZXIgbG9jYXRpb24gaW5mb1wifSk7XG4gICAgICAgICAgJHN0YXRlLmdvKCdhcHAuY2hhbmdlTG9jYXRpb24nKTtcbiAgICAgICAgfVxuICAgICAgKTtcbiAgICB9XG5cbiAgfSk7XG4gIEVtb2p5LnN1YnNjcmliZShmdW5jdGlvbiAoKSB7XG4gICAgbWFwLnJlc2V0KCk7XG4gIH0pO1xuICBmdW5jdGlvbiBnZXRBZHJlc3MobG9jYXRpb24pIHtcbiAgXHRcdHZhciBhZGRyZXNzID0gW2xvY2F0aW9uLmNvdW50cnksIGxvY2F0aW9uLnN0YXRlLCBsb2NhdGlvbi5jaXR5XS5qb2luKFwiLCBcIik7XG4gIFx0XHRyZXR1cm4gYWRkcmVzcztcbiAgfVxufSlcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuXG5cbi5jb250cm9sbGVyKCdwdXJjaGFzZUFkc0N0cmwnLCBmdW5jdGlvbigkc2NvcGUsICRzdGF0ZSwgQWRzLCAkaW9uaWNMb2FkaW5nKSB7XG4gICRzY29wZS5wdXJjaGFzZWQgPSBBZHMucHVyY2hhc2VkKCk7XG4gICRzY29wZS5wdXJjaGFzZSA9IGZ1bmN0aW9uKCkge1xuICAgICRpb25pY0xvYWRpbmcuc2hvdygpO1xuICAgIEFkcy5wdXJjaGFzZSgpLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAkaW9uaWNMb2FkaW5nLmhpZGUoKTtcbiAgICAgICRzY29wZS5wdXJjaGFzZWQgPSBBZHMucHVyY2hhc2VkKCk7XG4gICAgfSwgZnVuY3Rpb24gKCkge1xuICAgICAgJGlvbmljTG9hZGluZy5oaWRlKCk7XG4gICAgfSk7XG4gIH1cbn0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcblxuLnNlcnZpY2UoJ0FkcycsIGZ1bmN0aW9uKEF1dGhvcml6ZWRSZXF1ZXN0LCBQdXJjaGFzZSwgRW5kUG9pbnRzKSB7XG4gIHZhciBpZDtcbiAgdmFyIHN1YnNjcmliZXJzID0gW107XG5cblx0cmV0dXJuIHtcbiAgICBnZXQ6IGdldCxcbiAgICBwdXJjaGFzZTogcHVyY2hhc2UsXG4gICAgc3Vic2NyaWJlOiBzdWJzY3JpYmUsXG4gICAgcHVyY2hhc2VkOiBwdXJjaGFzZWRcbiAgfVxuICBmdW5jdGlvbiBzdWJzY3JpYmUoc3Vic2NyaWJlcikge1xuICAgIHN1YnNjcmliZXJzLnB1c2goc3Vic2NyaWJlcik7XG4gIH1cbiAgZnVuY3Rpb24gcHVyY2hhc2VkICgpIHtcbiAgICByZXR1cm4gbG9jYWxTdG9yYWdlLmV3X2Fkc19wdXJjaGFzZWQ7XG4gIH1cbiAgZnVuY3Rpb24gcHVyY2hhc2UoKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBQdXJjaGFzZSgnY29tLnJoaW5vZGEud2VhdGhlcndpZ2d5LnJlbW92ZWFkcycpLnRoZW4oXG4gICAgICAgICAgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2UuZXdfYWRzX3B1cmNoYXNlZCA9IFwieWVzXCI7XG4gICAgICAgICAgICBhcHBseSgpO1xuICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICAgICAgICByZWplY3QoKTtcbiAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgfSk7XG4gIH1cbiAgZnVuY3Rpb24gYXBwbHkoKSB7XG4gICAgc3Vic2NyaWJlcnMuZm9yRWFjaChmdW5jdGlvbihzdWJzY3JpYmVyKSB7ICBzdWJzY3JpYmVyKCkgIH0pO1xuICB9XG4gIGZ1bmN0aW9uIGdldCgpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGlmKGxvY2FsU3RvcmFnZS5ld19hZHNfcHVyY2hhc2VkKSB7XG4gICAgICAgICAgYXBwbHkoKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgQXV0aG9yaXplZFJlcXVlc3QoXCJHRVRcIiwgRW5kUG9pbnRzLmFjdGlvbignZ2V0LWFkdmVydGlzaW5nJykgKyBnZXRQYXJhbXMoKSkudGhlbihzdWNjZXNzLCByZWplY3QpO1xuXG4gICAgICAgIGZ1bmN0aW9uIGdldFBhcmFtcygpIHtcbiAgICAgICAgICByZXR1cm4gKGlkKT8gXCI/Y3VycmVudF9hZF9pZD1cIiArIGlkIDogXCJcIjtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHN1Y2Nlc3MocmVzcG9uc2UpIHtcbiAgICAgICAgICBpZCA9IHJlc3BvbnNlLmlkO1xuICAgICAgICAgIHJlc29sdmUocmVzcG9uc2UuaHRtbCk7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgfVxufSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcblxuLnNlcnZpY2UoJ0JhY2tncm91bmRzJywgZnVuY3Rpb24oUGFjaywgVXNlciwgRW5kUG9pbnRzKSB7XG5cbiAgdmFyIGJhY2tncm91bmRzID0gUGFjayhcbiAgICB7XG4gICAgICBhdmFpbGFibGU6ICdnZXQtYm91Z2h0LWJhY2tncm91bmQtcGFja3MnLFxuICAgICAgbmFtZTogJ2JhY2tyb3VuZHMtcGFjaycsXG4gICAgICBhbGw6ICdnZXQtYWxsLWJhY2tncm91bmQtcGFja3MnLFxuICAgICAgcHVyY2hhc2U6ICdwdXJjaGFzZS1iYWNrZ3JvdW5kLXBhY2snXG4gICAgfSk7XG5cbiAgYmFja2dyb3VuZHMuaW1hZ2UgPSBmdW5jdGlvbiAocGFjaykge1xuICAgIHZhciB0b2tlbiA9IFVzZXIubWUoKS50b2tlbjtcbiAgICByZXR1cm4gRW5kUG9pbnRzLmFjdGlvbignZ2V0LWJhY2tncm91bmQnKSArIGdldFF1ZXJ5UGFyYW1zKCk7XG5cbiAgICBmdW5jdGlvbiBnZXRRdWVyeVBhcmFtcygpIHtcbiAgICBcdHZhciB0aW1lcyA9IFtcIm5pZ2h0XCIsIFwibW9ybmluZ1wiLCBcImRheVwiLCBcImV2ZW5pbmdcIl07XG4gICAgXHR2YXIgaG91ciA9IG5ldyBEYXRlKCkuZ2V0SG91cnMoKSAtIDI7XG4gICAgXHR2YXIgZGV2aWRlciA9IDI0IC8gdGltZXMubGVuZ3RoO1xuICAgIFx0dmFyIGluZGV4ID0gTWF0aC5mbG9vcihob3VyIC8gZGV2aWRlcik7XG4gICAgICB0cnkge1xuICAgICAgICAgIHJldHVybiBcIj9iYWNrZ3JvdW5kX3BhY2tfaWQ9XCIrcGFjay5pZCtcIiZ0aW1lX29mX2RheT1cIit0aW1lc1tpbmRleF0rXCImdG9rZW49XCIrdG9rZW47XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICByZXR1cm4gXCJcIjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICByZXR1cm4gYmFja2dyb3VuZHM7XG59KTtcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuXG4uc2VydmljZSgnRW1vanknLCBmdW5jdGlvbihQYWNrLCBVc2VyLCBFbmRQb2ludHMpIHtcbiAgdmFyIGVtb2p5ID0gUGFjayh7XG4gICAgICBhdmFpbGFibGU6ICdnZXQtYm91Z2h0LWljb24tcGFja3MnLFxuICAgICAgYWxsOiAnZ2V0LWFsbC1pY29uLXBhY2tzJyxcbiAgICAgIG5hbWU6ICdpY29ucy1wYWNrJyxcbiAgICAgIHB1cmNoYXNlOiAncHVyY2hhc2UtaWNvbi1wYWNrJ1xuICAgIH0pO1xuXG4gIGVtb2p5LmltYWdlID0gZnVuY3Rpb24gKHBhY2ssIHdlYXRoZXIsIHR5cGUpIHtcbiAgXHRcdHZhciB0b2tlbiA9IFVzZXIubWUoKS50b2tlbjtcbiAgICAgIHR5cGUgPSB0eXBlIHx8IFwid3VuZGVyZ3JvdW5kXCI7XG4gIFx0XHRyZXR1cm4gRW5kUG9pbnRzLmFjdGlvbih0eXBlKycvZ2V0LWljb25zJykgKyBnZXRRdWVyeVBhcmFtcygpO1xuXG4gIFx0XHRmdW5jdGlvbiBnZXRRdWVyeVBhcmFtcygpIHtcbiAgICAgICAgdmFyIHBhcmFtcyA9IHtcbiAgICAgICAgICBcInd1bmRlcmdyb3VuZFwiIDogd3VuZGVyZ3JvdW5kQU1QTSxcbiAgICAgICAgICBcIm9wZW4td2VhdGhlci1tYXBcIiA6IG9wZW5XZWF0aGVyTWFwQU1QTVxuICAgICAgICB9XG4gICAgICAgIHRyeSB7XG4gIFx0XHRcdCAgICAgcmV0dXJuIFwiP2NvbmRpdGlvbj1cIiArICh3ZWF0aGVyLmNvbmRpdGlvbiB8fCB3ZWF0aGVyLmNvbmRpdGlvbnMpLnNwbGl0KCcgJykuam9pbignXycpICtcbiAgICAgICAgICAgICBcIiZpY29uX3BhY2tfaWQ9XCIrcGFjay5pZCArXCImYW1wbT1cIitwYXJhbXNbdHlwZV0oKStcIiZ0b2tlbj1cIit0b2tlbjtcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgIHJldHVybiBcIlwiO1xuICAgICAgICB9XG5cbiAgICAgICAgICBmdW5jdGlvbiBvcGVuV2VhdGhlck1hcEFNUE0oKSB7XG4gICAgICAgICAgICByZXR1cm4gd2VhdGhlci5hbXBtO1xuICAgICAgICAgIH1cbiAgICAgICAgICBmdW5jdGlvbiB3dW5kZXJncm91bmRBTVBNKCkge1xuICAgICAgICAgICAgdmFyIGRhdGUgPSBuZXcgRGF0ZSh3ZWF0aGVyLmRhdGUpO1xuICAgICAgICAgICAgZGF0ZS5zZXRIb3VycyhkYXRlLmdldEhvdXJzKCkgKyAyKTtcbiAgICAgICAgICAgIHJldHVybiBtb21lbnQoZGF0ZSkuZm9ybWF0KCdBJyk7XG4gICAgICAgICAgfVxuICBcdFx0fVxuXHR9XG4gIHJldHVybiBlbW9qeTtcbn0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG5cbi5zZXJ2aWNlKCdFbmRQb2ludHMnLCBmdW5jdGlvbihjb25maWcpIHtcblx0dmFyIEVuZFBvaW50cyA9IHtcblx0XHRhY3Rpb246IGFjdGlvbixcblx0XHR1cmw6IHVybFxuXHR9XG5cdHJldHVybiBFbmRQb2ludHM7XG5cdGZ1bmN0aW9uIHVybCh1cmwpIHtcblx0XHRyZXR1cm4gY29uZmlnLnNlcnZlciArIHVybDtcblx0fVxuXHRmdW5jdGlvbiBhY3Rpb24gKHBvaW50KSB7XG5cdFx0cmV0dXJuIGNvbmZpZy5zZXJ2ZXIgKyAnYXBpLycgKyBwb2ludDtcblx0fVxuXG5cbn0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcblxuLnNlcnZpY2UoJ0dlb2NvZGUnLCBmdW5jdGlvbigpIHtcblx0dmFyIHJlcXVpcmVkRmllbGRzID0ge1xuXHRcdFwiY291bnRyeVwiIDogXCJjb3VudHJ5XCIsXG5cdFx0XCJhZG1pbmlzdHJhdGl2ZV9hcmVhX2xldmVsXzFcIjogXCJzdGF0ZVwiLFxuXHRcdFwibG9jYWxpdHlcIjogXCJjaXR5XCIsXG5cdFx0XCJhZG1pbmlzdHJhdGl2ZV9hcmVhX2xldmVsXzJcIjogXCJkaXN0cmljdFwiXG5cdH07XG5cblx0cmV0dXJuIGZ1bmN0aW9uKGF0dHIpIHtcblx0XHRyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdFx0XHRcdHZhciBsb2NhdGlvbiA9IHt9O1xuXHRcdFx0XHRjb25maWd1cmVBdHRyKCk7XG5cdFx0XHRcdHZhciBnZW9jb2RlciA9IG5ldyBnb29nbGUubWFwcy5HZW9jb2RlcigpO1xuXHRcdFx0XHRnZW9jb2Rlci5nZW9jb2RlKGF0dHIsIHVzZUdlb2NvZGUpO1xuXG5cdFx0XHRcdGZ1bmN0aW9uIHVzZUdlb2NvZGUocmVzdWx0cywgc3RhdHVzKSB7XG5cdFx0XHRcdFx0IGlmIChzdGF0dXMgPT09IGdvb2dsZS5tYXBzLkdlb2NvZGVyU3RhdHVzLk9LKSB7XG5cdFx0XHRcdFx0XHQgZ2V0SW5mb0Zyb21HZW9jb2RlcyhyZXN1bHRzKTtcblx0XHRcdFx0XHRcdCBpZighbG9jYXRpb24uY2l0eSkgbG9jYXRpb24uY2l0eSA9IGxvY2F0aW9uLmRpc3RyaWN0O1xuXHQgXHRcdFx0XHRcdCByZXNvbHZlKGxvY2F0aW9uKTtcblx0XHRcdFx0XHQgfSBlbHNlIHtcblx0XHRcdFx0XHRcdCByZWplY3QoJ0dlb2NvZGUgd2FzIG5vdCBzdWNjZXNzZnVsIGZvciB0aGUgZm9sbG93aW5nIHJlYXNvbjogJyArIHN0YXR1cylcblx0XHRcdFx0XHQgfVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0ZnVuY3Rpb24gZ2V0SW5mb0Zyb21HZW9jb2RlcyhyZXN1bHRzKSB7XG5cdFx0XHRcdFx0Zm9yKHZhciBpID0gMDsgaSA8IHJlc3VsdHMubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRcdGdldEluZm9Gcm9tR2VvY29kZShyZXN1bHRzW2ldKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRmdW5jdGlvbiBnZXRJbmZvRnJvbUdlb2NvZGUoY29kZSkge1xuXHRcdFx0XHRcdGlmKCFsb2NhdGlvbi5sb2NhdGlvbiAmJiBjb2RlLmdlb21ldHJ5KSBsb2NhdGlvbi5sb2NhdGlvbiA9IGNvZGUuZ2VvbWV0cnkubG9jYXRpb247XG5cdFx0XHRcdFx0Zm9yKHZhciBqID0gMDsgaiA8IGNvZGUudHlwZXMubGVuZ3RoOyBqKyspIHtcblx0XHRcdFx0XHRcdHZhciB0eXBlID0gY29kZS50eXBlc1tqXTtcblx0XHRcdFx0XHRcdGlmKGNvZGUuYWRkcmVzc19jb21wb25lbnRzKSB7XG5cdFx0XHRcdFx0XHRcdGdldEluZm9Gcm9tR2VvY29kZXMoY29kZS5hZGRyZXNzX2NvbXBvbmVudHMpO1xuXHRcdFx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRpZiAoIXJlcXVpcmVkRmllbGRzW3R5cGVdKSBjb250aW51ZTtcblx0XHRcdFx0XHRcdHZhciB2YWx1ZSA9IGNvZGU7XG5cdFx0XHRcdFx0XHRzZXRMb2NhdGlvbkluZm8odHlwZSwgdmFsdWUpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdGZ1bmN0aW9uIHNldExvY2F0aW9uSW5mbyh0eXBlLCB2YWx1ZSkge1xuXHRcdFx0XHRcdHZhciBsb2NhdGlvbkluZm9UeXBlID0gcmVxdWlyZWRGaWVsZHNbdHlwZV07XG5cdFx0XHRcdFx0bG9jYXRpb25bbG9jYXRpb25JbmZvVHlwZV0gPSB2YWx1ZS5sb25nX25hbWU7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRmdW5jdGlvbiBjb25maWd1cmVBdHRyKCkge1xuXHRcdFx0XHRcdGlmKCFhdHRyKSByZXR1cm47XG5cdFx0XHRcdFx0aWYodHlwZW9mIGF0dHIgPT0gXCJzdHJpbmdcIikge1xuXHRcdFx0XHRcdFx0YXR0ciA9IHtcblx0XHRcdFx0XHRcdFx0YWRkcmVzczogYXR0clxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRpZihhdHRyLmxvY2F0aW9uKSB7XG5cdFx0XHRcdFx0XHRpZih0eXBlb2YgYXR0ci5sb2NhdGlvbiA9PSBcIm9iamVjdFwiKSB7XG5cdFx0XHRcdFx0XHRcdHZhciBsYXQgPSArYXR0ci5sb2NhdGlvbi5sYXQ7XG5cdFx0XHRcdFx0XHRcdHZhciBsbmcgPSArYXR0ci5sb2NhdGlvbi5sbmc7XG5cdFx0XHRcdFx0XHRcdGF0dHIgPSB7XG5cdFx0XHRcdFx0XHRcdFx0bG9jYXRpb246IG5ldyBnb29nbGUubWFwcy5MYXRMbmcobGF0LCBsbmcpXG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0aWYoYXR0ci5kZXNjcmlwdGlvbikge1xuXHRcdFx0XHRcdFx0XHRhdHRyID0ge1xuXHRcdFx0XHRcdFx0XHRcdGFkZHJlc3M6IGF0dHIuZGVzY3JpcHRpb25cblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHR9KTtcblx0XHR9XG59KVxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG5cbi5zZXJ2aWNlKCdMYW5ndWFnZScsIGZ1bmN0aW9uKCkge1xuICAgIHZhciBfbGFuZ3VhZ2UgPSBsb2NhbFN0b3JhZ2UuZXdfbGFuZ3VhZ2UgfHwgJ2VuJztcbiAgICByZXR1cm4gZnVuY3Rpb24obGFuZ3VhZ2UpIHtcbiAgICAgIGlmKCFsYW5ndWFnZSkge1xuICAgICAgICByZXR1cm4gX2xhbmd1YWdlO1xuICAgICAgfVxuICAgICAgX2xhbmd1YWdlID0gbGFuZ3VhZ2UudG9Mb3dlckNhc2UoKTtcbiAgICAgIGxvY2FsU3RvcmFnZS5ld19sYW5ndWFnZSA9IF9sYW5ndWFnZTtcbiAgICB9XG59KTtcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuXG4uc2VydmljZSgnTG9jYXRpb25TZXJ2aWNlJywgZnVuY3Rpb24oTG9jYXRpb25BdXRvRGVmaW5lKSB7XG5cblxuXHR2YXIgcmVxdWlyZWRGaWVsZHMgPSB7XG5cdFx0XCJjb3VudHJ5XCIgOiBcImNvdW50cnlcIixcblx0XHRcImFkbWluaXN0cmF0aXZlX2FyZWFfbGV2ZWxfMVwiOiBcInN0YXRlXCIsXG5cdFx0XCJzdWJsb2NhbGl0eVwiOiBcImNpdHlcIlxuXHR9O1xuXHR2YXIgc3Vic2NyaWJlcnMgPSBbXTtcblx0dmFyIHNlcnZpY2VzID0ge1xuXHRcdFwiYWxsb3dlZCBhdXRvIGRlZmluZVwiOiBhbGxvd2VkQXV0b0RlZmluZVNlcnZpY2UsXG5cdFx0XCJkZWZpbmUgbG9jYXRpb25cIjogZGVmaW5lTG9jYXRpb25TZXJ2aWNlLFxuXHRcdFwiY3VycmVudCBsb2NhdGlvblwiOiBteUxvY2F0aW9uU2VydmljZSxcblx0XHRcInVzZXIgbG9jYXRpb25zXCI6IHVzZXJMb2NhdGlvbnNTZXJ2aWNlLFxuXHRcdFwicmVtb3ZlIHVzZXIgbG9jYXRpb25cIjogcmVtb3ZlVXNlckxvY2F0aW9uU2VydmljZSxcblx0XHRcImlzIGN1cnJlbnRcIjogaXNDdXJyZW50LFxuXHRcdFwic3Vic2NyaWJlXCI6IHN1YnNjcmliZVxuXHR9XG5cdGZ1bmN0aW9uIHN1YnNjcmliZShzdWJzY3JpYmVyKSB7XG5cdFx0c3Vic2NyaWJlcnMucHVzaChzdWJzY3JpYmVyKTtcblx0fVxuXHRyZXR1cm4gZnVuY3Rpb24obmFtZSwgdmFsdWUpIHtcblx0XHR2YXIgc2VydmljZSA9IGdldFNlcnZpY2UobmFtZSk7XG5cdFx0cmV0dXJuIHNlcnZpY2UodmFsdWUpO1xuXHR9XG5cblx0ZnVuY3Rpb24gZ2V0U2VydmljZShuYW1lKSB7XG5cdFx0dmFyIHNlcnZpY2UgPSBzZXJ2aWNlc1tuYW1lXTtcblx0XHRpZighc2VydmljZSkgdGhyb3cgXCJUaGVyZSBpcyBub3QgcmVxdWVzdGVkIHNlcnZpY2VcIjtcblx0XHRyZXR1cm4gc2VydmljZTtcblx0fVxuXHRmdW5jdGlvbiBkZWZpbmVMb2NhdGlvblNlcnZpY2UodmFsdWUpIHtcblx0XHRyZXR1cm4gZGVmaW5lTG9jYXRpb24oKTtcblx0fVxuXHRmdW5jdGlvbiBhbGxvd2VkQXV0b0RlZmluZVNlcnZpY2UodmFsdWUpIHtcblx0XHRpZihsb2NhbFN0b3JhZ2UuZXdfYXV0b2RlZmluZSA9PT0gdW5kZWZpbmVkKSBsb2NhbFN0b3JhZ2UuZXdfYXV0b2RlZmluZSA9IHRydWU7XG5cdFx0cmV0dXJuIGFwcGx5KGxvY2FsU3RvcmFnZSwgXCJld19hdXRvZGVmaW5lXCIsIHZhbHVlKTtcblx0fVxuXG5cdGZ1bmN0aW9uIG15TG9jYXRpb25TZXJ2aWNlKHZhbHVlKSB7XG5cdFx0aWYodmFsdWUpIHJldHVybiBzZXRVc2VyTG9jYXRpb24odmFsdWUpO1xuXHRcdHJldHVybiBnZXRVc2VyTG9jYXRpb24oKTtcblx0fVxuXG5cdGZ1bmN0aW9uIGFwcGx5KHNvdXJjZSwga2V5LCB2YWx1ZSkge1xuXHRcdGlmKHZhbHVlICE9PSB1bmRlZmluZWQpIHtcblx0XHRcdHNvdXJjZVtrZXldID0gdmFsdWU7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHJldHVybiBzb3VyY2Vba2V5XTtcblx0XHR9XG5cdH1cblxuXHRmdW5jdGlvbiBkZWZpbmVMb2NhdGlvbigpIHtcblx0XHRyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdFx0XHRcdHZhciBsb2NhdGlvbiA9IGdldFVzZXJMb2NhdGlvbigpO1xuXHRcdFx0XHRpZihsb2NhdGlvbikge1xuXHRcdFx0XHRcdHJlc29sdmUobG9jYXRpb24pO1xuXHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0fVxuXHRcdFx0XHRMb2NhdGlvbkF1dG9EZWZpbmUoKS50aGVuKHN1Y2Nlc3NMb2NhdGlvbkRlZmluZSwgZXJyb3JMb2NhdGlvbkRlZmluZSk7XG5cdFx0XHRcdHZhciByZWplY3RlZDtcblx0XHRcdFx0dmFyIHRpbWVPdXQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG5cdFx0XHRcdFx0ZXJyb3JMb2NhdGlvbkRlZmluZShcIkxvY2F0aW9uIHNlcnZpY2UgZG8gbm90IHJlc3BvbmNlXCIpO1xuXHRcdFx0XHR9LCAzMDAwMClcblx0XHRcdFx0ZnVuY3Rpb24gc3VjY2Vzc0xvY2F0aW9uRGVmaW5lKGxvY2F0aW9uKSB7XG5cdFx0XHRcdFx0XHRzZXRVc2VyTG9jYXRpb24obG9jYXRpb24pO1xuXHRcdFx0XHRcdFx0cmVzb2x2ZShsb2NhdGlvbik7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRmdW5jdGlvbiBlcnJvckxvY2F0aW9uRGVmaW5lKGVycm9yKSB7XG5cdFx0XHRcdFx0XHRyZWplY3QoZXJyb3IpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0KTtcblx0fVxuXG5cdGZ1bmN0aW9uIHVzZXJMb2NhdGlvbnNTZXJ2aWNlKHZhbHVlKSB7XG5cdFx0aWYodmFsdWUpIHtcblx0XHRcdHJldHVybiBzZXRVc2VyTG9jYXRpb24odmFsdWUpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRyZXR1cm4gZ2V0VXNlckxvY2F0aW9ucygpO1xuXHRcdH1cblx0fVxuXHRmdW5jdGlvbiBzZXRVc2VyTG9jYXRpb24odmFsdWUpIHtcblx0XHRsb2NhbFN0b3JhZ2UuZXdfY3VycmVudF9sb2NhdGlvbiA9IEpTT04uc3RyaW5naWZ5KHZhbHVlKTtcblx0XHR2YXIgbG9jYXRpb25zID0gZ2V0VXNlckxvY2F0aW9ucygpO1xuXHRcdHN1YnNjcmliZXJzLmZvckVhY2goZnVuY3Rpb24oc3Vic2NyaWJlcikge1xuXHRcdFx0c3Vic2NyaWJlcigpO1xuXHRcdH0pO1xuXHRcdGlmKH5pbmRleE9mKGxvY2F0aW9ucywgdmFsdWUpKSByZXR1cm4gbG9jYXRpb25zO1xuXHRcdGxvY2F0aW9ucy5wdXNoKHZhbHVlKTtcblx0XHRsb2NhbFN0b3JhZ2UuZXdfdXNlcl9sb2NhdGlvbnMgPSBKU09OLnN0cmluZ2lmeShsb2NhdGlvbnMpO1xuXHRcdHJldHVybiBsb2NhdGlvbnM7XG5cdH1cblx0ZnVuY3Rpb24gZ2V0VXNlckxvY2F0aW9uKCkge1xuXHRcdHZhciB2YWx1ZSA9IGxvY2FsU3RvcmFnZS5ld19jdXJyZW50X2xvY2F0aW9uO1xuXHRcdGlmKHZhbHVlKVx0cmV0dXJuIEpTT04ucGFyc2UodmFsdWUpO1xuXHR9XG5cdGZ1bmN0aW9uIHJlbW92ZVVzZXJMb2NhdGlvblNlcnZpY2UodmFsdWUpIHtcblx0XHR2YXIgbG9jYXRpb25zID0gZ2V0VXNlckxvY2F0aW9ucygpO1xuXHRcdHZhciBpbmRleCA9IGluZGV4T2YobG9jYXRpb25zLCB2YWx1ZSk7XG5cdFx0aWYoaW5kZXggPCAwKSByZXR1cm4gbG9jYXRpb25zO1xuXHRcdGxvY2F0aW9ucy5zcGxpY2UoaW5kZXgsIDEpO1xuXHRcdGxvY2FsU3RvcmFnZS5ld191c2VyX2xvY2F0aW9ucyA9IEpTT04uc3RyaW5naWZ5KGxvY2F0aW9ucyk7XG5cdFx0cmV0dXJuIGxvY2F0aW9ucztcblx0fVxuXHRmdW5jdGlvbiBpbmRleE9mKGxvY2F0aW9ucywgdmFsdWUpIHtcblx0XHR2YXIgcmVzdWx0ID0gLTE7XG5cdFx0bG9jYXRpb25zLmZvckVhY2goZnVuY3Rpb24oZWxlbWVudCwgaW5kZXgpIHtcblx0XHRcdGlmIChpc0VxdWFsKGVsZW1lbnQsIHZhbHVlKSkgcmVzdWx0ID0gaW5kZXg7XG5cdFx0fSk7XG5cdFx0cmV0dXJuIHJlc3VsdDtcblx0fVxuXHRmdW5jdGlvbiBnZXRVc2VyTG9jYXRpb25zKCkge1xuXHRcdHZhciBsb2NhdGlvbnMgPSBsb2NhbFN0b3JhZ2UuZXdfdXNlcl9sb2NhdGlvbnM7XG5cdFx0aWYoIWxvY2F0aW9ucykgcmV0dXJuIFtdO1xuXHRcdHJldHVybiBKU09OLnBhcnNlKGxvY2F0aW9ucyk7XG5cdH1cblxuXHRmdW5jdGlvbiBpc0N1cnJlbnQodmFsdWUpIHtcblx0XHR2YXIgc3RvcmVkID0gbG9jYWxTdG9yYWdlLmV3X2N1cnJlbnRfbG9jYXRpb247XG5cdFx0aWYoIXN0b3JlZCkgcmV0dXJuIGZhbHNlO1xuXHRcdHZhciBsb2NhdGlvbiA9IEpTT04ucGFyc2Uoc3RvcmVkKTtcblx0XHRyZXR1cm4gaXNFcXVhbCh2YWx1ZSwgbG9jYXRpb24pO1xuXHR9XG5cblx0ZnVuY3Rpb24gaXNFcXVhbChhLCBiKSB7XG5cdFx0aWYoIWEgfHwgIWIpIHJldHVybiBmYWxzZTtcblx0XHR2YXIgcmVzdWx0ID0gdHJ1ZTtcblx0XHRbXCJjaXR5XCIsIFwiY291bnRyeVwiLCBcInN0YXRlXCJdLmZvckVhY2goZnVuY3Rpb24oZWxlbWVudCl7XG5cdFx0XHRpZihhW2VsZW1lbnRdICE9IGJbZWxlbWVudF0pIHJlc3VsdCA9IGZhbHNlO1xuXHRcdH0pO1xuXHRcdHJldHVybiByZXN1bHQ7XG5cdH1cbn0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcblxuLnNlcnZpY2UoJ0xvY2F0aW9uQXV0b0RlZmluZScsIGZ1bmN0aW9uKCRjb3Jkb3ZhR2VvbG9jYXRpb24sIEdlb2NvZGUpIHtcblx0dmFyIHJlcXVpcmVkRmllbGRzID0ge1xuXHRcdFwiY291bnRyeVwiIDogXCJjb3VudHJ5XCIsXG5cdFx0XCJhZG1pbmlzdHJhdGl2ZV9hcmVhX2xldmVsXzFcIjogXCJzdGF0ZVwiLFxuXHRcdFwic3VibG9jYWxpdHlcIjogXCJjaXR5XCJcblx0fTtcblxuXHRyZXR1cm4gZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXHRcdFx0dHJ5IHtcblx0XHRcdFx0YXV0b0RlZmluZUxvY2F0aW9uKCk7XG5cblx0XHRcdFx0ZnVuY3Rpb24gYXV0b0RlZmluZUxvY2F0aW9uKCkge1xuXHRcdFx0XHRcdCRjb3Jkb3ZhR2VvbG9jYXRpb24uZ2V0Q3VycmVudFBvc2l0aW9uKCkudGhlbihkZWZpbmVMb2NhdGlvbkJ5Q29vcmRzLCBnZW9sb2NhdGlvbkVycm9yKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGZ1bmN0aW9uIGRlZmluZUxvY2F0aW9uQnlDb29yZHMocG9zaXRpb24pIHtcblx0XHRcdFx0XHR2YXIgbGF0TG5nID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhwb3NpdGlvbi5jb29yZHMubGF0aXR1ZGUsIHBvc2l0aW9uLmNvb3Jkcy5sb25naXR1ZGUpO1xuXHRcdFx0XHRcdHZhciBnZW9jb2RlciA9IG5ldyBnb29nbGUubWFwcy5HZW9jb2RlcigpO1xuXHRcdFx0XHRcdEdlb2NvZGUoeydsb2NhdGlvbic6IGxhdExuZ30pLnRoZW4oXG5cdFx0XHRcdFx0XHRmdW5jdGlvbihsb2NhdGlvbikge1xuXHRcdFx0XHRcdFx0XHRyZXNvbHZlKGxvY2F0aW9uKTtcblx0XHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0IFx0ZnVuY3Rpb24oZXJyKXtcblx0XHRcdFx0XHRcdFx0cmVqZWN0KGVycik7XG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGZ1bmN0aW9uIGdlb2xvY2F0aW9uRXJyb3IoZXJyKSB7XG5cdFx0XHRcdFx0cmVqZWN0KGVyci5tZXNzYWdlKTtcblx0XHRcdFx0fVxuXG5cdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdHJlamVjdChlKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXG5cbn0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcblxuLnNlcnZpY2UoJ1NpZ25JbicsIGZ1bmN0aW9uKFVzZXJEYXRhVmVyaWZ5LCBVc2VyRGF0YSwgTG9jYXRpb24pIHtcblxuICAgIHJldHVybiBmdW5jdGlvbih1c2VySW5mbykge1xuICAgICAgICBpZih0eXBlb2YgdXNlckluZm8gPT0gXCJzdHJpbmdcIikge1xuXG4gICAgICAgIH0gZWxzZVxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICBVc2VyRGF0YSh1c2VySW5mbyk7XG4gICAgICAgICAgICBMb2NhdGlvbih1c2VySW5mby5sb2NhdGlvbik7XG4gICAgICAgICAgICByZXNvbHZlKCk7XG5cbiAgICAgICAgICBmdW5jdGlvbiBlcnJvcihlKSB7XG4gICAgICAgICAgICByZWplY3QoZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgIH1cbn0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uc2VydmljZSgnTWFwJywgZnVuY3Rpb24oJGh0dHAsIGNvbmZpZywgR2VvY29kZSwgRW5kUG9pbnRzLCBBdXRob3JpemVkUmVxdWVzdCwgRW1vankpIHtcblx0dmFyIHJlcXVlc3RUaW1lb3V0O1xuXHRyZXR1cm4gZnVuY3Rpb24oY2FudmFzLCBhZGRyZXNzKSB7XG5cdFx0XHR2YXIgbWFwO1xuXHRcdFx0R2VvY29kZShhZGRyZXNzKS50aGVuKHVzZUdlb2NvZGUpXG5cdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRyZXNldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0bWFwLnJlc2V0KCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdGZ1bmN0aW9uIHVzZUdlb2NvZGUoZ2VvY29kZSkge1xuXHRcdFx0XHRwb3NpdGlvbiA9IGdlb2NvZGUubG9jYXRpb247XG5cdFx0XHRcdGlmKG1hcCkge1xuXHRcdFx0XHRcdG1hcC5jZW50ZXIgPSBwb3NpdGlvbjtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRpbml0aWFsaXplKHBvc2l0aW9uKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHQgIFx0ZnVuY3Rpb24gaW5pdGlhbGl6ZShwb3NpdGlvbikge1xuXHRcdCAgXHR2YXIgZ2VvSlNPTjtcblx0XHQgIFx0dmFyIHJlcXVlc3Q7XG5cdFx0ICBcdHZhciBnZXR0aW5nRGF0YSA9IGZhbHNlO1xuXHRcdCAgXHR2YXIgb3BlbldlYXRoZXJNYXBLZXkgPSBjb25maWcub3BlbldlYXRoZXJBcGlLZXk7XG5cdFx0ICAgIGNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGNhbnZhcyk7XG5cblx0XHRcdFx0Y3JlYXRlTmF0aXZlTWFwKCk7XG5cblx0XHRcdFx0ZnVuY3Rpb24gY3JlYXRlTmF0aXZlTWFwKCkge1xuXHRcdFx0XHRcdFx0bWFwID0gbmV3IGdvb2dsZS5tYXBzLk1hcChjYW52YXMsICB7XG5cdFx0XHRcdFx0XHRcdHpvb206IDgsXG5cdFx0XHRcdFx0XHRcdGNlbnRlcjogcG9zaXRpb25cblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0Z29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFwLCAnaWRsZScsIGNoZWNrSWZEYXRhUmVxdWVzdGVkKTtcblx0XHRcdFx0XHRcdG1hcC5yZXNldCA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0XHRyZXNldCgpO1xuXHRcdFx0XHRcdFx0XHRnZXRDb29yZHMoKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0ICAgIGZ1bmN0aW9uIGNoZWNrSWZEYXRhUmVxdWVzdGVkKCkge1xuXHRcdFx0XHRcdGlmKHJlcXVlc3RUaW1lb3V0KSByZXR1cm47XG5cdFx0XHRcdHdoaWxlIChnZXR0aW5nRGF0YSA9PT0gdHJ1ZSkge1xuICAgICAgXHRcdFx0XHRnZXR0aW5nRGF0YSA9IGZhbHNlO1xuICAgIFx0XHRcdH1cbiAgICBcdFx0XHRnZXRDb29yZHMoKTtcbiAgXHRcdFx0fTtcblxuICBcdFx0XHRmdW5jdGlvbiBnZXRDb29yZHMoKSB7XG5cdFx0XHQgICAgdmFyIGJvdW5kcyA9IG1hcC5nZXRCb3VuZHMoKTtcblx0XHRcdCAgICB2YXIgTkUgPSBib3VuZHMuZ2V0Tm9ydGhFYXN0KCk7XG5cdFx0XHQgICAgdmFyIFNXID0gYm91bmRzLmdldFNvdXRoV2VzdCgpO1xuXHRcdFx0XHRcdGdldFdlYXRoZXIoTkUubGF0KCksIE5FLmxuZygpLCBTVy5sYXQoKSwgU1cubG5nKCkpO1xuICBcdFx0XHR9O1xuXG4gIFx0XHRcdGZ1bmN0aW9uIGdldFdlYXRoZXIobm9ydGhMYXQsIGVhc3RMbmcsIHNvdXRoTGF0LCB3ZXN0TG5nKSB7XG5cdFx0XHQgICAgZ2V0dGluZ0RhdGEgPSB0cnVlO1xuXHRcdFx0XHRcdHZhciByZXF1ZXN0U3RyaW5nID0gRW5kUG9pbnRzLmFjdGlvbihcImdldC1mb3JlY2FzdC1jaXRpZXMtd2l0aGluLXJlY3RhbmdsZS16b25lXCIpICtcblx0XHRcdFx0XHRcdFwiP2xvbl9sZWZ0PVwiICsgd2VzdExuZyArXG5cdFx0XHRcdFx0XHRcIiZsYXRfYm90dG9tPVwiICsgc291dGhMYXQgK1xuXHRcdFx0XHRcdFx0XCImbG9uX3JpZ2h0PVwiKyBlYXN0TG5nK1xuXHRcdFx0XHRcdFx0XCImbGF0X3RvcD1cIisgbm9ydGhMYXQgK1xuXHRcdFx0XHRcdFx0XCImem9vbT1cIiArIG1hcC5nZXRab29tKCk7XG5cdFx0XHRcdFx0XHRBdXRob3JpemVkUmVxdWVzdChcIkdFVFwiLCByZXF1ZXN0U3RyaW5nKS50aGVuKHN1Y2Nlc3MsIGVycm9yKTtcblxuXHRcdFx0ICAgIGZ1bmN0aW9uIHN1Y2Nlc3MocmVzcG9uc2UpIHtcblx0XHRcdFx0XHRcdGNvbnNvbGUubG9nKEpTT04uc3RyaW5naWZ5KHJlc3BvbnNlKSk7XG5cdFx0XHRcdFx0XHRFbW9qeS5jdXJyZW50KCkudGhlbihcblx0XHRcdFx0XHRcdFx0ZnVuY3Rpb24gKHBhY2spIHtcblx0XHRcdFx0XHRcdCAgICBcdHZhciByZXN1bHRzID0gcmVzcG9uc2U7XG5cdFx0XHRcdFx0XHRcdFx0XHRyZXNldCgpO1xuXHRcdFx0XHRcdFx0XHQgICAgaWYgKHJlc3VsdHMubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRcdFx0XHQgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVzdWx0cy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdFx0XHQgICAgICAgICAganNvblRvR2VvSnNvbihyZXN1bHRzW2ldLCBwYWNrKVxuXHRcdFx0XHRcdFx0XHQgICAgICAgIH1cblx0XHRcdFx0XHRcdFx0ICAgIH1cblx0XHRcdFx0XHRcdFx0fSxcblx0XHRcdFx0XHRcdFx0ZnVuY3Rpb24gKGVycikge1xuXHRcdFx0XHRcdFx0XHRcdHRocm93IGVycjtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0KTtcblxuXHRcdFx0ICAgIH1cblxuXHRcdFx0ICAgIGZ1bmN0aW9uIGVycm9yKCkge1xuXG5cdFx0XHQgICAgfVxuICBcdFx0XHR9O1xuXHRcdFx0XHR2YXIgbWFya2VycyA9IFtdO1xuICBcdFx0XHRmdW5jdGlvbiBqc29uVG9HZW9Kc29uKHdlYXRoZXJJdGVtLCBwYWNrKSB7XG5cdFx0XHRcdFx0dmFyIGljb24gPSB3ZWF0aGVySXRlbS53ZWF0aGVyWzBdLmljb247XG5cdFx0XHRcdFx0dmFyIGFtcG0gPSB7XCJkXCI6XCJQTVwiLCBcIm5cIjpcIkFNXCJ9W2ljb24uc3Vic3RyKGljb24ubGVuZ3RoIC0gMSwgMSldO1xuXHRcdFx0XHRcdHZhciBpbWFnZSA9IHtcblx0XHRcdFx0XHRcdCAgdXJsOiBFbW9qeS5pbWFnZShcblx0XHRcdFx0XHRcdFx0XHRwYWNrLFxuXHRcdFx0XHRcdFx0XHRcdHtcblx0XHRcdFx0XHRcdFx0XHRcdGFtcG06IGFtcG0sXG5cdFx0XHRcdFx0XHRcdFx0XHRjb25kaXRpb246IHdlYXRoZXJJdGVtLndlYXRoZXJbMF0ubWFpblxuXHRcdFx0XHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0XHRcdFx0J29wZW4td2VhdGhlci1tYXAnXG5cdFx0XHRcdFx0XHRcdCksXG5cdFx0XHRcdFx0XHQgIHNpemU6IG5ldyBnb29nbGUubWFwcy5TaXplKDYwLCA2MCksXG5cdFx0XHRcdFx0XHQgIG9yaWdpbjogbmV3IGdvb2dsZS5tYXBzLlBvaW50KDAsIDApLFxuXHRcdFx0XHRcdFx0ICBhbmNob3I6IG5ldyBnb29nbGUubWFwcy5Qb2ludCgzMCwgMzApLFxuXHRcdFx0XHRcdFx0ICBzY2FsZWRTaXplOiBuZXcgZ29vZ2xlLm1hcHMuU2l6ZSg2MCwgNjApXG5cdFx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0dmFyIG1hcmtlciA9IG5ldyBnb29nbGUubWFwcy5NYXJrZXIoe1xuICAgICAgICAgICAgcG9zaXRpb246IHtsYXQ6IHdlYXRoZXJJdGVtLmNvb3JkLmxhdCwgbG5nOiB3ZWF0aGVySXRlbS5jb29yZC5sb259LFxuICAgICAgICAgICAgbWFwOiBtYXAsXG4gICAgICAgICAgICBpY29uOiBpbWFnZSxcblx0XHRcdFx0XHRcdG9wdGltaXplZDogZmFsc2VcbiAgICAgICAgICB9KTtcblx0XHRcdFx0XHRtYXJrZXJzLnB1c2gobWFya2VyKTtcblx0XHRcdFx0XHRlbGVtZW50ID0gXCI8ZGl2IGNsYXNzID0gJ2NpdHktd2VhdGhlciBibGFuayc+XCJcblx0XHRcdFx0XHQkKGNhbnZhcykuYXBwZW5kKGVsZW1lbnQpO1xuXHRcdFx0XHRcdHZhciBmZWF0dXJlID0gZXZlbnQuZmVhdHVyZTtcblx0XHRcdFx0XHRbXG5cdFx0XHRcdFx0XHR7bmFtZTogXCJDaXR5XCIsIHZhbHVlOiB3ZWF0aGVySXRlbS5uYW1lfSxcblx0XHRcdFx0XHRcdHtuYW1lOiBcIldlYXRoZXJcIiwgdmFsdWU6IHdlYXRoZXJJdGVtLndlYXRoZXJbMF0ubWFpbn0sXG5cdFx0XHRcdFx0XHR7bmFtZTogXCJUZW1wZXJhdHVyZVwiLCB2YWx1ZTogd2VhdGhlckl0ZW0ubWFpbi50ZW1wICsgXCImZGVnO0NcIn0sXG5cdFx0XHRcdFx0XHR7bmFtZTogXCJQcmVzc3VyZVwiLCB2YWx1ZTogd2VhdGhlckl0ZW0ubWFpbi5wcmVzc3VyZSsgXCJoYlwifSxcblx0XHRcdFx0XHRcdHtuYW1lOiBcIkh1bWlkaXR5XCIsIHZhbHVlOiB3ZWF0aGVySXRlbS5tYWluLmh1bWlkaXR5K1wiJVwifSxcblx0XHRcdFx0XHRcdHtuYW1lOiBcIldpbmQgU3BlZWRcIiwgdmFsdWU6IHdlYXRoZXJJdGVtLndpbmQuc3BlZWQrXCJtL3NcIn0sXG5cdFx0XHRcdFx0XHR7bmFtZTogXCJXaW5kIERlZ3JlZVwiLCB2YWx1ZTogd2VhdGhlckl0ZW0ud2luZC5kZWcgKyBcIiZkZWc7XCJ9LFxuXHRcdFx0XHRcdF0uZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7XG5cdFx0XHRcdFx0XHRlbGVtZW50ICs9IFwiPGRpdj5cIitpdGVtLm5hbWUgK1wiIDogXCIraXRlbS52YWx1ZStcIjwvZGl2PlwiO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdGVsZW1lbnQgKz0gXCI8L2Rpdj5cIlxuXG5cdFx0XHRcdFx0dmFyIGluZm93aW5kb3cgPSBuZXcgZ29vZ2xlLm1hcHMuSW5mb1dpbmRvdyh7XG5cdFx0XHRcdFx0XHRjb250ZW50OiBlbGVtZW50XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0Z29vZ2xlLm1hcHMuZXZlbnQuYWRkRG9tTGlzdGVuZXIobWFya2VyLCBcIm1vdXNlZG93blwiLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdGNsZWFyVGltZW91dChyZXF1ZXN0VGltZW91dCk7XG5cdFx0XHRcdFx0XHRyZXF1ZXN0VGltZW91dCA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRcdHJlcXVlc3RUaW1lb3V0ID0gbnVsbDtcblx0XHRcdFx0XHRcdH0sIDEwKjEwMDApO1xuXHQgICAgICAgICAgaW5mb3dpbmRvdy5vcGVuKG1hcCwgbWFya2VyKTtcblx0XHRcdFx0XHR9KTtcblxuXHRcdFx0fVxuXG5cdFx0XHRmdW5jdGlvbiByZXNldCgpIHtcblx0XHRcdFx0bWFya2Vycy5mb3JFYWNoKGZ1bmN0aW9uKG1hcmtlcikge1xuXHRcdFx0XHRcdG1hcmtlci5zZXRNYXAobnVsbCk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRtYXJrZXJzID0gW107XG5cdFx0XHR9XG5cblx0XHR9XG5cdH1cbn0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG5cbi5zZXJ2aWNlKCdQYWNrJywgZnVuY3Rpb24oRW5kUG9pbnRzLCBBdXRob3JpemVkUmVxdWVzdCwgU2luZ2xlUmVxdWVzdCwgUHVyY2hhc2UsIFVzZXIpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgICB2YXIgcGFjaztcbiAgICB2YXIgc3Vic2NyaWJlcnMgPSBbXTtcbiAgICB2YXIgcmVxdWlyZWQgPSBbXG4gICAgICB7bmFtZTogJ2F2YWlsYWJsZScsIG1lc3NhZ2U6IFwiQXZhaWxhYmxlIHBhY2tzIGFjdGlvbiByZXF1aXJlZFwifSxcbiAgICAgIHtuYW1lOiAnYWxsJywgbWVzc2FnZTogXCJBbGwgcGFja3MgYWN0aW9uIHJlcXVpcmVkXCJ9LFxuICAgICAge25hbWU6ICduYW1lJywgbWVzc2FnZTogXCJOYW1lIHJlcXVpcmVkXCJ9LFxuICAgICAge25hbWU6ICdwdXJjaGFzZScsIG1lc3NhZ2U6IFwiUHVyY2hhc2UgYWN0aW9uIHJlcXVpcmVkXCJ9XTtcblxuICAgIHJlcXVpcmVkLmZvckVhY2goZnVuY3Rpb24ocmVxdWlyZW1lbnQpIHtcbiAgICAgIGlmKCFvcHRpb25zW3JlcXVpcmVtZW50Lm5hbWVdKSB0aHJvdyByZXF1aXJlbWVudC5tZXNzYWdlO1xuICAgIH0pXG4gICAgdmFyIGxpc3RzID0ge307XG4gICAgVXNlci5tZShcInN1YnNjcmliZVwiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICBwYWNrID0gbnVsbDtcbiAgICAgICAgICBsaXN0cyA9IHt9O1xuICAgIH0pO1xuICAgIHZhciByZXF1ZXN0ID0gbmV3IFNpbmdsZVJlcXVlc3QoKTtcbiAgICByZXR1cm4ge1xuICAgICAgYWxsOiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIGxpc3Qob3B0aW9ucy5hbGwpO1xuICAgICAgfSxcbiAgICAgIGF2YWlsYWJsZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBsaXN0KG9wdGlvbnMuYXZhaWxhYmxlKTtcbiAgICAgIH0sXG4gICAgICBjdXJyZW50OiBjdXJyZW50LFxuICAgICAgc3Vic2NyaWJlOiBzdWJzY3JpYmUsXG4gICAgICBwdXJjaGFzZTogcHVyY2hhc2VcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzdWJzY3JpYmUoc3Vic2NyaWJlcikge1xuICAgICAgc3Vic2NyaWJlcnMucHVzaChzdWJzY3JpYmVyKTtcbiAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGxpc3QoYWN0aW9uKSB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShcbiAgICAgICAgICBmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICAgICAgaWYobGlzdHNbYWN0aW9uXSkge1xuICAgICAgICAgICAgICByZXNvbHZlKGxpc3RzW2FjdGlvbl0pO1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgdXJsID0gRW5kUG9pbnRzLmFjdGlvbihhY3Rpb24pO1xuICAgICAgICAgICAgICAgIEF1dGhvcml6ZWRSZXF1ZXN0KFwiR0VUXCIsIHVybCkudGhlbihcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICB2YXIgcGFja3NMaXN0ID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgZm9yKHZhciBmaWVsZCBpbiByZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW0gPSByZXNwb25zZVtmaWVsZF07XG4gICAgICAgICAgICAgICAgICAgICAgICBpZihBcnJheS5pc0FycmF5KGl0ZW0pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYWNrID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBpdGVtLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBpdGVtLmlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwaWN0dXJlOiBFbmRQb2ludHMudXJsKGl0ZW0ucHJldmlld19pbWcpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYodHlwZW9mIGl0ZW0uY29zdCAhPSBcInVuZGVmaW5lZFwiKSBwYWNrLmNvc3QgPSBpdGVtLmNvc3Q7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih0eXBlb2YgaXRlbS5hdmFpbGFibGUgIT0gXCJ1bmRlZmluZWRcIikgcGFjay5hdmFpbGFibGUgPSAraXRlbS5hdmFpbGFibGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih0eXBlb2YgaXRlbS5za3UgIT0gXCJ1bmRlZmluZWRcIikgcGFjay5za3UgPSBpdGVtLnNrdTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhY2tzTGlzdC5wdXNoKHBhY2spO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICBsaXN0c1thY3Rpb25dID0gcGFja3NMaXN0O1xuICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocGFja3NMaXN0KTtcbiAgICAgICAgICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgdmFyIGN1cnJlbnRQYWNrO1xuICAgICAgZnVuY3Rpb24gY3VycmVudCggZGF0YSApIHtcbiAgICAgICAgaWYodHlwZW9mIGRhdGEgPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgIHJldHVybiBnZXRDdXJyZW50UGFjaygpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHNldEN1cnJlbnRQYWNrKGRhdGEpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0Q3VycmVudFBhY2soKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICAgIGlmKGN1cnJlbnRQYWNrKSB7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShjdXJyZW50UGFjayk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgbGlzdChvcHRpb25zLmF2YWlsYWJsZSkudGhlbihcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiggbGlzdCApIHtcbiAgICAgICAgICAgICAgICAgIHZhciBwYWNrTmFtZSA9IGxvY2FsU3RvcmFnZVtvcHRpb25zLm5hbWVdIHx8IFwiRGVmYXVsdFwiO1xuXG4gICAgICAgICAgICAgICAgICBsaXN0LmZvckVhY2goZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICAgICAgICAgICAgICAgIGlmKHBhY2tOYW1lID09IGl0ZW0ubmFtZSkgcGFjayA9IGl0ZW07XG4gICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgc2V0Q3VycmVudFBhY2socGFjayk7XG4gICAgICAgICAgICAgICAgICByZXNvbHZlKHBhY2spO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgcmVqZWN0XG4gICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBmdW5jdGlvbiBzZXRDdXJyZW50UGFjayhwYWNrKSB7XG4gICAgICAgICAgICBpZighcGFjaykgcmV0dXJuO1xuICAgICAgICAgICAgY3VycmVudFBhY2sgPSBwYWNrO1xuICAgICAgICAgICAgbG9jYWxTdG9yYWdlW29wdGlvbnMubmFtZV0gPSBwYWNrLm5hbWU7XG4gICAgICAgICAgICBhcHBseSgpO1xuICAgICAgICAgIH1cblxuXG4gICAgICB9XG4gICAgICBmdW5jdGlvbiBhcHBseSgpIHtcbiAgICAgICAgICBzdWJzY3JpYmVycy5mb3JFYWNoKGZ1bmN0aW9uKHN1YnNjcmliZXIpIHtcbiAgICAgICAgICAgIHN1YnNjcmliZXIoKTtcbiAgICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGZ1bmN0aW9uIHB1cmNoYXNlKCBpdGVtICkge1xuICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgICAgICBQdXJjaGFzZShpdGVtLnNrdSkudGhlbiggc2VuZEFib3V0UHVyY2hhc2UsIHJlamVjdCk7XG5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBzZW5kQWJvdXRQdXJjaGFzZSgpIHtcbiAgICAgICAgICAgICAgICAgICAgQXV0aG9yaXplZFJlcXVlc3QoXCJQT1NUXCIsIHVybCgpLCB7c2t1OiBpdGVtLnNrdX0pLnRoZW4obWFuYWdlUHVyY2hhc2VkLCByZWplY3QpO1xuXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHVybCgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBFbmRQb2ludHMuYWN0aW9uKG9wdGlvbnMucHVyY2hhc2UpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gbWFuYWdlUHVyY2hhc2VkKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgYWxsID0gbGlzdHNbb3B0aW9ucy5hbGxdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSBhbGwuaW5kZXhPZihpdGVtKTtcbiAgICAgICAgICAgICAgICAgICAgYWxsLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICAgICAgICAgIGxpc3RzW29wdGlvbnMuYXZhaWxhYmxlXS5wdXNoKGl0ZW0pO1xuICAgICAgICAgICAgICAgICAgICBhcHBseSgpO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuXG5cbiAgICAgIH1cbiAgfVxufSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcblxuLnNlcnZpY2UoJ1BpY2tJbWFnZScsIGZ1bmN0aW9uKCRjb3Jkb3ZhQ2FtZXJhLCBBdXRoRGF0YSwgJGNvcmRvdmFJbWFnZVBpY2tlcikge1xuXHRyZXR1cm4gZnVuY3Rpb24oc3VjY2VzcywgZXJyb3IpIHtcblx0XHR2YXIgb3B0aW9ucyA9IHtcblx0XHQgbWF4aW11bUltYWdlc0NvdW50OiAxLFxuXHRcdCB3aWR0aDogNDAwLFxuXHRcdCBoZWlnaHQ6IDQwMCxcblx0XHQgcXVhbGl0eTogMzBcblx0XHR9O1xuXG5cdFx0JGNvcmRvdmFJbWFnZVBpY2tlci5nZXRQaWN0dXJlcyhvcHRpb25zKVxuXHRcdFx0LnRoZW4oXG5cdFx0XHRcdGZ1bmN0aW9uIChyZXN1bHRzKSB7XG5cdFx0XHRcdFx0c3VjY2VzcyhyZXN1bHRzWzBdKVxuXHRcdFx0XHR9LFxuXHRcdFx0XHRmdW5jdGlvbihlcnIpe1xuXHRcdFx0XHRcdGVycm9yKFwiQ2Fubm90IGxvYWQgaW1hZ2VcIilcblx0XHRcdFx0fSk7XG5cdFx0fVxufSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcblxuLnNlcnZpY2UoJ1NpbmdsZVJlcXVlc3QnLCBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgIHZhciB3YWl0aW5nID0gW107XG4gICAgdmFyIHByb2Nlc3NvcjtcblxuICAgIHRoaXMuc2VuZCA9IGZ1bmN0aW9uKHJlcXVlc3QpIHtcbiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIHdhaXRpbmcucHVzaCh7cmVzb2x2ZTogcmVzb2x2ZSwgcmVqZWN0OiByZWplY3R9KTtcbiAgICAgICAgaWYocHJvY2Vzc29yKSByZXR1cm47XG4gICAgICAgIHByb2Nlc3NvciA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmVxdWVzdCgpLnRoZW4oXG4gICAgICAgICAgICBmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgYXBwbHkoJ3Jlc29sdmUnLCByZXNwb25zZSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgICBhcHBseSgncmVqZWN0JywgZXJyKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuXG4gICAgICBmdW5jdGlvbiBhcHBseShhY3Rpb24sIHJlc3BvbnNlKSB7XG4gICAgICAgIHByb2Nlc3NvciA9IG51bGw7XG4gICAgICAgIHZhciBwcm9jZXNzaW5nID0gd2FpdGluZztcbiAgICAgICAgd2FpdGluZyA9IFtdO1xuXG4gICAgICAgIHByb2Nlc3NpbmcuZm9yRWFjaChcbiAgICAgICAgICBmdW5jdGlvbihoYW5kbGVyKSB7XG4gICAgICAgICAgICBoYW5kbGVyW2FjdGlvbl0ocmVzcG9uc2UpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9KTtcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuXG4uc2VydmljZSgnU3RpY2tlcnMnLCBmdW5jdGlvbigpIHtcblx0dmFyIF9zdGlja2Vycztcblx0dmFyIF9zdGlja2VyO1xuICBsb2FkKCk7XG5cblx0cmV0dXJuIHtcblx0XHRsaXN0OiBsaXN0LFxuXHRcdGlzU2VsZWN0ZWQ6IGlzU2VsZWN0ZWQsXG4gICAgc2VsZWN0OiBzZWxlY3Rcblx0fVxuICBmdW5jdGlvbiBzZWxlY3QoaXRlbSkge1xuICAgIF9zdGlja2VyID0gaXRlbTtcbiAgfVxuXHRmdW5jdGlvbiBsaXN0KCkge1xuXHRcdHJldHVybiBfc3RpY2tlcnM7XG5cdH1cblx0ZnVuY3Rpb24gbG9hZChzdWNjZXNzLCBlcnJvcikge1xuICAgIHZhciB1cmwgPSBcImh0dHBzOi8vZW5jcnlwdGVkLXRibjEuZ3N0YXRpYy5jb20vaW1hZ2VzP3E9dGJuOkFOZDlHY1NSU1l1Q3UyaFpTUVRqV2RXM0JZUTQzdVpQWW92S05WY3VHN3lRYUlVbEZ2dWR2cGJSXCI7XG4gIFx0dmFyIHBhY2sxID0ge25hbWU6IFwibWFnaWMgc3RyaWNrZXIgcGFja1wiLCBwcmljZTogMC45OSwgaW1hZ2U6IHVybH07XG4gIFx0dmFyIHBhY2syID0ge25hbWU6IFwibWFnaWMgc3RyaWNrZXIgcGFja1wiLCBwcmljZTogMC45OSwgaW1hZ2U6IHVybH07XG4gIFx0dmFyIHBhY2szID0ge25hbWU6IFwibWFnaWMgc3RyaWNrZXIgcGFja1wiLCBwcmljZTogMC45OSwgaW1hZ2U6IHVybH07XG4gIFx0dmFyIHBhY2s0ID0ge25hbWU6IFwibWFnaWMgc3RyaWNrZXIgcGFja1wiLCBwcmljZTogMC45OSwgaW1hZ2U6IHVybH07XG4gIFx0dmFyIHBhY2s1ID0ge25hbWU6IFwibWFnaWMgc3RyaWNrZXIgcGFja1wiLCBwcmljZTogMC45OSwgaW1hZ2U6IHVybH07XG4gIFx0dmFyIHBhY2s2ID0ge25hbWU6IFwibWFnaWMgc3RyaWNrZXIgcGFja1wiLCBwcmljZTogMC45OSwgaW1hZ2U6IHVybH07XG4gICAgX3N0aWNrZXJzID0gW3BhY2sxLCBwYWNrMiwgcGFjazMsIHBhY2s0LCBwYWNrNSwgcGFjazZdO1xuICAgIF9zdGlja2VyID0gcGFjazE7XG5cdH1cblxuXHRmdW5jdGlvbiBpc1NlbGVjdGVkIChpdGVtKSB7XG5cdFx0cmV0dXJuIF9zdGlja2VyID09PSBpdGVtO1xuXHR9XG59KTtcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuXG4uc2VydmljZSgnU3Vic2NyaXB0aW9uJywgZnVuY3Rpb24oICkge1xuICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIG5ldyBTdWJzY3JpcHRpb24oKTtcblxuICAgIGZ1bmN0aW9uIFN1YnNjcmlwdGlvbigpIHtcbiAgICAgIHRoaXMuc3Vic2NyaWJlcnMgPSBbXTtcbiAgICAgIHRoaXMuc3Vic2NyaWJlID0gZnVuY3Rpb24oc3Vic2NyaWJlcikge1xuICAgICAgICB0aGlzLnN1YnNjcmliZXJzLnB1c2goc3Vic2NyaWJlcik7XG4gICAgICB9XG4gICAgICB0aGlzLnNlbmQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5zdWJzY3JpYmVycy5mb3JFYWNoKGZ1bmN0aW9uKHN1YnNjcmliZXIpIHtcbiAgICAgICAgICBzdWJzY3JpYmVyKCk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgfVxufSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcblxuLnNlcnZpY2UoJ1VwbG9hZEltYWdlJywgZnVuY3Rpb24oJGNvcmRvdmFJbWFnZVBpY2tlciwgJGNvcmRvdmFGaWxlVHJhbnNmZXIsIEVuZFBvaW50cywgJGlvbmljTG9hZGluZywgY29uZmlnLCAgJHRpbWVvdXQpIHtcblx0cmV0dXJuIGZ1bmN0aW9uKGN1c3RvbU9wdGlvbnMpIHtcblx0XHRyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdFx0XHRcdGlmKCFkZXZpY2UpIHtcblx0XHRcdFx0XHRyZWplY3Qoe3RleHQ6IFwiZXJyXCJ9KTtcblx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdH1cblx0XHRcdFx0JGNvcmRvdmFJbWFnZVBpY2tlci5nZXRQaWN0dXJlcyhjb25maWcucGlja2VkSW1hZ2UpLnRoZW4oXG5cdFx0XHRcdFx0ZnVuY3Rpb24odXJpKSB7XG5cdFx0XHRcdFx0XHR1cmkgPSB1cmlbMF07XG5cdFx0XHRcdFx0XHR2YXIgb3B0aW9ucyA9IG5ldyBGaWxlVXBsb2FkT3B0aW9ucygpO1xuXHRcdFx0XHRcdFx0b3B0aW9ucy5maWxlS2V5ID0gJ2ZpbGUnO1xuXHRcdFx0XHRcdFx0b3B0aW9ucy5maWxlTmFtZSA9IGdldEZpbGVOYW1lKHVyaSk7XG5cdFx0XHRcdFx0XHRvcHRpb25zLm1pbWVUeXBlID0gJ2ltYWdlL2pwZWcnO1xuXHRcdFx0XHRcdFx0aWYoY3VzdG9tT3B0aW9ucykge1xuXHRcdFx0XHRcdFx0XHRcdGZvciAodmFyIHZhcmlhYmxlIGluIGN1c3RvbU9wdGlvbnMpIHtcblx0XHRcdFx0XHRcdFx0XHRcdGlmIChjdXN0b21PcHRpb25zLmhhc093blByb3BlcnR5KHZhcmlhYmxlKSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRvcHRpb25zW3ZhcmlhYmxlXSA9IGN1c3RvbU9wdGlvbnNbdmFyaWFibGVdO1xuXHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdH1cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR2YXIgdHJhbnNmZXIgPSBuZXcgRmlsZVRyYW5zZmVyKCk7XG5cblxuXG5cdFx0XHRcdFx0XHQkaW9uaWNMb2FkaW5nLnNob3coKTtcblx0XHRcdFx0XHRcdFx0dHJhbnNmZXIudXBsb2FkKHVyaSwgRW5kUG9pbnRzLmFjdGlvbigndXBsb2FkLWF2YXRhcicpLCBzdWNjZXNzLCBlcnJvciwgb3B0aW9ucyk7XG5cdFx0XHRcdFx0XHRmdW5jdGlvbiBzdWNjZXNzKHJlc3BvbnNlKSB7XG5cdFx0XHRcdFx0XHRcdCRpb25pY0xvYWRpbmcuaGlkZSgpO1xuXHRcdFx0XHRcdFx0XHRpZihyZXNwb25zZS5yZXNwb25zZUNvZGUgIT0gMjAwKSB7XG5cdFx0XHRcdFx0XHRcdFx0ZXJyb3IocmVzcG9uc2UpO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdHZhciB1cmkgPSBKU09OLnBhcnNlKHJlc3BvbnNlLnJlc3BvbnNlKS5hdmF0YXJfdXJsO1xuXHRcdFx0XHRcdFx0XHRpZih1cmlbMF0gPT0gJy8nKSB1cmkgPSB1cmkuc3Vic3RyKDEsIHVyaS5sZW5ndGgpO1xuXHRcdFx0XHRcdFx0XHRyZXNvbHZlKHVyaSk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRmdW5jdGlvbiBlcnJvcihlcnIpIHtcblx0XHRcdFx0XHRcdFx0JGlvbmljTG9hZGluZy5oaWRlKCk7XG5cdFx0XHRcdFx0XHRcdGFsZXJ0KEpTT04uc3RyaW5naWZ5KGVycikpO1xuXHRcdFx0XHRcdFx0XHRyZWplY3QoZXJyKVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0ZnVuY3Rpb24gcHJvZ3Jlc3MocHJvZ3Jlc3MpIHtcbiAgICAgICAgXHRcdFx0JHRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgIFx0XHRcdGFsZXJ0KHByb2dyZXNzLmxvYWRlZCAvIHByb2dyZXNzLnRvdGFsKSAqIDEwMDtcbiAgICAgICAgXHRcdFx0fSk7XG4gICAgICBcdFx0XHR9XG5cblx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdGZ1bmN0aW9uKGVycikge1xuXHRcdFx0XHRcdFx0cmVqZWN0KGVycik7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHQpXG5cdFx0XHR9KTtcblxuXHRcdFx0ZnVuY3Rpb24gZ2V0RmlsZU5hbWUodXJpKSB7XG5cdFx0XHRcdHZhciBzdGFydCA9IHVyaS5sYXN0SW5kZXhPZignLycpICsgMTtcblx0XHRcdFx0dmFyIGxlbmd0aCA9IHVyaS5sZW5ndGggLSBzdGFydDtcblx0XHRcdFx0cmV0dXJuIHVyaS5zdWJzdHIoc3RhcnQsIGxlbmd0aCk7XG5cdFx0XHR9XG5cdH1cbn0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcblxuLnNlcnZpY2UoJ1VzZXJEYXRhVmVyaWZ5JywgZnVuY3Rpb24oc3RyaW5ncykge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZGF0YSwgcmVxdWlyZWQpIHtcbiAgICAgICAgdmFyIGFsZXJ0cyA9IFtleGlzdHMsIGVtcHR5LCBwYXNzd29yZF07XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgYWxlcnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYWxlcnQgPSBhbGVydHNbaV0oKTtcbiAgICAgICAgICAgIGlmIChhbGVydCkge1xuICAgICAgICAgICAgICByZWplY3QoYWxlcnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGZ1bmN0aW9uIGV4aXN0cygpIHtcbiAgICAgICAgICBpZighZGF0YSkge1xuICAgICAgICAgICAgcmV0dXJuIHN0cmluZ3MoXCJuZWVkc1VzZXJJbmZvXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBlbXB0eSgpIHtcbiAgICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgcmVxdWlyZWQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBmaWVsZCA9IHJlcXVpcmVkW2ldO1xuICAgICAgICAgICAgdmFyIHZhbHVlID0gZGF0YVtmaWVsZF07XG4gICAgICAgICAgICBpZighdmFsdWUgfHwgIXZhbHVlLmxlbmd0aCkge1xuICAgICAgICAgICAgICByZXR1cm4gc3RyaW5ncyhmaWVsZCkrc3RyaW5ncygnaXNSZXF1aXJlZCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHBhc3N3b3JkKCkge1xuICAgICAgICAgIGlmKCFkYXRhLnBhc3N3b3JkIHx8IGRhdGEucGFzc3dvcmQgIT09IGRhdGEuY29uZmlybVBhc3N3b3JkKSB7XG4gICAgICAgICAgICByZXR1cm4gXCJQYXNzd29yZCBub3QgY29uZmlybWVkXCI7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcblxuLnNlcnZpY2UoJ2NvbmZpZycsIGZ1bmN0aW9uKCRpb25pY1BsYXRmb3JtKSB7XG4gIHZhciBwbGF0Zm9ybSA9IFwiYnJvd3NlclwiO1xuICBpZih3aW5kb3cuY29yZG92YSkge1xuICBcdFtcImlvc1wiLCBcImFuZHJvaWRcIiwgXCJicm93c2VyXCJdLmZvckVhY2goZnVuY3Rpb24oaXRlbSkge1xuICAgICAgaWYoJGlvbmljUGxhdGZvcm0uaXMoaXRlbSkpIHBsYXRmb3JtID0gaXRlbTtcbiAgXHR9KTtcbiAgfVxuXHRyZXR1cm4ge1xuXHRcdG9wZW5XZWF0aGVyQXBpS2V5OiBcIjdkNzgxNWNkNTcyMWI3NzhjNzlkOTdkZmY5MmVhNTMzXCIsXG5cdFx0d3VuZGVyZ3JvdW5kQXBpS2V5OiBcImE3ZjNlNDRlOWRmZDQwMzZcIixcblx0XHRzZXJ2ZXI6IFwiaHR0cDovL3dlYXRoZXIucmhpbm9kYS5ydS9cIixcblx0XHRmYWNlYm9va0FwcElkOiAnOTk4OTUzNDEwMjI0OTY3Jyxcblx0XHRmYWNib29rQXBwU2VjcmV0OiAnNzg2NWQ0YzQ2ZWJlZjRhOGJiZWEzZWY4ZGQyNDUyNzInLFxuXHRcdGdvb2dsZUFwcEtleSA6IHtcbiAgICAgIFwiaW9zXCI6ICczMDI4OTI2ODMzMTctNDYwOHQ3MTFxa2dvaGxnMjBxYTg5ZWdkYWwxZ3ZnbXAuYXBwcy5nb29nbGV1c2VyY29udGVudC5jb20nLFxuICAgICAgXCJhbmRyb2lkXCI6ICczMDI4OTI2ODMzMTctazJvdXBtNGE2YnBiamFoYTJqNHJxZHM3dHMxNGxnYWUuYXBwcy5nb29nbGV1c2VyY29udGVudC5jb20nLFxuICAgICAgXCJicm93c2VyXCI6ICczMDI4OTI2ODMzMTctN2Fia2FyMzA3NXQ4ZzloaWllMDZsMGZnbXI2dTZzdHQuYXBwcy5nb29nbGV1c2VyY29udGVudC5jb20nXG4gICAgfVtcImJyb3dzZXJcIl0sXG5cdFx0dHdpdHRlckFwcElkOiBcIjl3ZzFPTG8yalhuajlZNmZvT3N4S0FRV1RcIixcblx0XHR0d2l0dGVyQXBwU2VjcmV0OiBcIlZaYUlkMERwUGxhMG9MU3lhQUxLblc3SzdKNVdHWW5LN2hIb2VhalkyczY0Skh2V3laXCIsXG5cdFx0dHdpdHRlckFjY2Vzc1Rva2VuOiBcIjc1NjA5NDMyODkwOTQ3MTc0NC12RDAxMVhyUFRVZUdsVEt4aW8yRkdnUWt6ejh2RWlnXCIsXG5cdFx0dHdpdHRlckFjY2Vzc1Rva2VuU2VjcmV0OiBcIlx0YnhMMjBtdXpPQlFFWkY2SHFhbjBES09pQjNZenUxWm9ubVFKMjVXcnJ0SFN6XCIsXG5cdFx0b2F1dGhSZWRpcmVjdFVSTDogJ2h0dHA6Ly9sb2NhbGhvc3Q6ODEwMC9vYXV0aGNhbGxiYWNrLmh0bWwnLFxuXHRcdG9hdXRoUHJveHk6ICdodHRwczovL2F1dGgtc2VydmVyLmhlcm9rdWFwcC5jb20vcHJveHknLFxuXHRcdHBpY2tlZEltYWdlOiB7XG5cdFx0IG1heGltdW1JbWFnZXNDb3VudDogMSxcblx0XHQgd2lkdGg6IDQwMCxcblx0XHQgaGVpZ2h0OiA0MDAsXG5cdFx0IHF1YWxpdHk6IDMwXG5cdFx0fVxuXHR9XG59KVxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG5cbi5zZXJ2aWNlKCdzdHJpbmdzJywgZnVuY3Rpb24oTGFuZ3VhZ2UpIHtcbiAgdmFyIGxhbmd1YWdlcyA9IHtcbiAgICBlbjoge1xuICAgICAgXCJvd2Vydmlld1wiOiBcIk92ZXJ2aWV3XCIsXG4gICAgICBcInN1bW1hcnlcIjogXCJfX19fX19fX19fX19fX19fX19fX19cXG4gX19fX19fX19fX19fX19fX19fX19fX19fXFxuICBTdW1tYXJ5XFxuIF9fX19fX19fX19fX19fX19fX19fX1xcbiBfX19fX19fX19fX19fX19fX19fX19fX19cXG4gXCIsXG4gICAgICBcImZlYXR1cmVzLXRpdGxlXCI6IFwiRmVhdHVyZXNcIixcbiAgICAgIFwiZmVhdHVyZXNcIjogW1xuICAgICAgICBcIkFuaW1hdGVkIFdlYXRoZXIgZ2FkZ2V0IGNoYW5nZXMgd2l0aCB3ZWF0aGVyIGNvbmRpdGlvbnMsVXAgdG8gZGF0ZSB3ZWF0aGVyIGZvcmVjYXN0XCIsXG4gICAgICAgIFwiRGF0ZS9UaW1lXCIsXG4gICAgICAgIFwiSG91cmx5L1dlZWtseSBmb3JlY2FzdFwiLFxuICAgICAgICBcIldlYXRoZXIgdHJhY2tpbmdcIixcbiAgICAgICAgXCJBdG1vc3BoZXJpYyBwcmVzc3VyZVwiLFxuICAgICAgICBcIkFkZCB5b3VyIGxvY2F0aW9uXCIsXG4gICAgICAgIFwiU2VhcmNoIHdlYXRoZXIgaWYgZGlmZmVyZW50IGxvY2F0aW9uc1wiXSxcbiAgICAgIFwidXNlci1zdGF0ZS1wbGFjZWhvbGRlclwiOiBcIlN0YXRlXCIsXG4gICAgICBcInVzZXItY291bnRyeS1wbGFjZWhvbGRlclwiOiBcIkNvdW50cnlcIixcbiAgICAgIFwidXNlci1jaXR5LXBsYWNlaG9sZGVyXCI6IFwiQ2l0eVwiLFxuICAgICAgXCJuZWVkc1VzZXJJbmZvXCI6IFwiU29tZSB1c2VyaW5mbyBpcyByZXF1aXJlZFwiLFxuICAgICAgXCJpc1JlcXVpcmVkXCI6IFwiIGlzIHJlcXVpcmVkXCIsXG4gICAgICBcInVzZXJuYW1lXCI6IFwiVXNlcm5hbWVcIixcblxuICAgICAgXCJuYW1lXCI6IFwiTmFtZVwiLFxuICAgICAgXCJlbWFpbFwiOiBcImVtYWlsXCIsXG4gICAgICBcImNvbmZpcm0tcGFzc3dvcmRcIjogXCJDb25maXJtIHBhc3N3b3JkXCIsXG4gICAgICBcInBhc3N3b3JkXCI6IFwiUGFzc3dvcmRcIixcbiAgICAgIFwibG9jYXRpb25cIjogXCJMb2NhdGlvblwiLFxuICAgICAgXCJzdWJtaXRcIjogXCJTdWJtaXRcIixcbiAgICAgIFwiZWRpdFwiOiBcIkVkaXRcIixcbiAgICAgIFwicHJldmlld1wiOiBcIlByZXZpZXdcIixcbiAgICAgIFwiLm92ZXJ2aWV3XCI6IFwiVG91Y2ggc2NyZWVuIHRvIHN0YXJ0IHVzaW5nXCIsXG4gICAgICBcIi5sb2dpbi1kYXRhXCI6IFwiRW50ZXIgZGF0YSB0byBwcmVzZW50YXRpb25cIixcbiAgICAgIFwiI3ByZXZpZXctYnV0dG9uXCI6IFwiVG91Y2ggdG8gcHJldmlld1wiLFxuICAgICAgXCIjbG9naW4tYnV0dG9uXCI6IFwiUmVnaXN0ZXIgdGhpcyBkYXRhXCIsXG4gICAgICBcIiNlZGl0LWJ1dHRvblwiOiBcIllvdSBjYW4gY2hhbmdlIHRoaXMgZGF0YVwiLFxuICAgICAgXCIjbWVudS1idXR0b25cIjogXCJUbyBnZXQgbW9yZSBvcHRpb25zIGdvIHRvIG1lbnVcIixcbiAgICAgIFwiLmxpbmVhci1ob3VybHktZm9yZWNhc3RcIjogXCJIb3VyeSBmb3JlY2FzdFwiLFxuICAgICAgXCJoZWxsb1wiOiBcIkhlbGxvXCIsXG4gICAgICBcIndlbGxjb21lXCI6IFwiV2VsbGNvbWVcIixcbiAgICAgIFwibWVudVwiOiBcIk1lbnVcIixcbiAgICAgIFwic2VhcmNoXCI6IFwiU2VhcmNoXCIsXG4gICAgICBcIndlZWtseSBmb3JlY2FzdFwiOiBcIldlZWtseSBmb3JlY2FzdFwiLFxuICAgICAgXCJob3VybHkgZm9yZWNhc3RcIjogXCJIb3VybHkgZm9yZWNhc3RcIixcbiAgICAgIFwibWFwXCI6IFwiTWFwXCIsXG4gICAgICBcImJhY2tncm91bmRcIjogXCJCYWNrZ3JvdW5kXCIsXG4gICAgICBcInNlYXJjaCBsb2NhdGlvblwiOiBcIlNlYXJjaCBsb2NhdGlvblwiLFxuICAgICAgXCJNb25kYXlcIjogXCJNb25kYXlcIixcbiAgICAgIFwiVHVlc2RheVwiOiBcIlR1ZXNkYXlcIixcbiAgICAgIFwiV2VkbmVzZGF5XCI6IFwiV2VkbmVzZGF5XCIsXG4gICAgICBcIlRodXJzZGF5XCI6IFwiVGh1cnNkYXlcIixcbiAgICAgIFwiRnJpZGF5XCI6IFwiRnJpZGF5XCIsXG4gICAgICBcIlNhdHVyZGF5XCI6IFwiU2F0dXJkYXlcIixcbiAgICAgIFwiU3VuZGF5XCI6IFwiU3VuZGF5XCIsXG4gICAgICBcInVwbG9hZCBiYWNrZ3JvdW5kXCI6IFwiVXBsb2FkIHlvdXIgYmFja2dyb3VuZFwiXG5cbiAgICB9LFxuICAgIHJ1OiB7XG4gICAgICBcIm93ZXJ2aWV3XCI6IFwi0J7QsdC30L7RgFwiLFxuICAgICAgXCJzdW1tYXJ5XCI6IFwiX19fX19fX19fX19fX19fX19fX19fXFxuIF9fX19fX19fX19fX19fX19fX19fX19fX1xcbiAg0KHQstC+0LTQutCwXFxuIF9fX19fX19fX19fX19fX19fX19fX1xcbiBfX19fX19fX19fX19fX19fX19fX19fX19cXG4gXCIsXG4gICAgICBcImZlYXR1cmVzLXRpdGxlXCI6IFwi0J7RgdC+0LHQtdC90L3QvtGB0YLQuFwiLFxuICAgICAgXCJmZWF0dXJlc1wiOiBbXG4gICAgICAgIFwi0JDQvdC40LzQuNGA0L7QstC10L3QvdC+0LUg0L/RgNC40LvQvtC20LXQvdC40LUsINC+0YLRgdC70LXQttC40LLQsNGO0YnQtdC1INC40LfQvNC10L3QtdC90LjQtSDQv9C+0LPQvtC00YtcIixcbiAgICAgICAgXCLQlNCw0YLQsC/QktGA0LXQvNGPXCIsXG4gICAgICAgIFwi0J/QvtC90LXQtNC10LvRjNC90YvQuS/Qv9C+0YfQsNGB0L7QstC+0Lkg0L/RgNC+0LPQvdC+0LdcIixcbiAgICAgICAgXCLQntGC0YHQu9C10LbQuNCy0LDQvdC40LUg0L/QvtCz0L7QtNGLXCIsXG4gICAgICAgIFwi0JDRgtC80L7RgdGE0LXRgNC90L7QtSDQtNCw0LLQu9C10L3QuNC1XCIsXG4gICAgICAgIFwi0JTQvtCx0LDQstC70LXQvdC40LUg0LLQsNGI0LXQuSDQu9C+0LrQsNGG0LjQuFwiLFxuICAgICAgICBcItCf0L7QuNGB0Log0L/QvtCz0L7QtNGLINCyINC00YDRg9Cz0L7QuSDQu9C+0LrQsNGG0LjQuFwiXSxcbiAgICAgIFwidXNlci1zdGF0ZS1wbGFjZWhvbGRlclwiOiBcItCo0YLQsNGCXCIsXG4gICAgICBcInVzZXItY291bnRyeS1wbGFjZWhvbGRlclwiOiBcItCh0YLRgNCw0L3QsFwiLFxuICAgICAgXCJ1c2VyLWNpdHktcGxhY2Vob2xkZXJcIjogXCLQk9C+0YDQvtC0XCIsXG4gICAgICBcIm5lZWRzVXNlckluZm9cIjogXCLQndC10LDQsdGF0L7QtNC40LzQviDQsdC+0LvRjNGI0LUg0LjQvdGE0L7RgNC80LDRhtC40LhcIixcbiAgICAgIFwiaXNSZXF1aXJlZFwiOiBcIiDRgtGA0LXQsdGD0LXRgtGB0Y9cIixcbiAgICAgIFwidXNlcm5hbWVcIjogXCLQmNC80Y8g0L/QvtC70YzQt9C+0LLQsNGC0LXQu9GPXCIsXG4gICAgICBcIm5hbWVcIjogXCLQmNC80Y9cIixcbiAgICAgIFwiY29uZmlybS1wYXNzd29yZFwiOiBcItCf0L7QtNGC0LLQtdGA0LTQuNGC0LUg0L/QsNGA0L7Qu9GMXCIsXG4gICAgICBcInBhc3N3b3JkXCI6IFwi0J/QsNGA0L7Qu9GMXCIsXG4gICAgICBcInN1Ym1pdFwiOiBcItCf0L7QtNGC0LLQtdGA0LTQuNGC0YxcIixcbiAgICAgIFwiZWRpdFwiOiBcItCg0LXQtNCw0LrRgtC40YDQvtCy0LDRgtGMXCIsXG4gICAgICBcInByZXZpZXdcIjogXCLQn9GA0LXQtNC/0YDQvtGB0LzQvtGC0YBcIixcbiAgICAgIFwiLm92ZXJ2aWV3XCI6IFwi0J3QsNC20LzQuNGC0LUg0Y3QutGA0LDQvSDRh9GC0L7QsdGLINC90LDRh9Cw0YLRjCDQuNGB0L/QvtC70YzQt9C+0LLQsNC90LjQtSDQv9GA0LjQu9C+0LbQtdC90LjRj1wiLFxuICAgICAgXCIubG9naW4tZGF0YVwiOiBcItCS0LLQtdC00LjRgtC1INC00LDQvdC90YvQtSwg0LrQvtGC0L7RgNGL0LUg0LHRg9C00YPRgiDQv9GA0LXQtNGB0YLQsNCy0LvQtdC90Ysg0L3QsCDQs9C70LDQstC90L7QuSDRgdGC0YDQsNC90LjRhtC1XCIsXG4gICAgICBcIiNwcmV2aWV3LWJ1dHRvblwiOiBcItCd0LDQttC80LjRgtC1INC00LvRjyDQv9GA0LXQtNC/0YDQvtGB0LzQvtGC0YDQsFwiLFxuICAgICAgXCIjbG9naW4tYnV0dG9uXCI6IFwi0JfQsNGA0LXQs9C10YHRgtGA0LjRgNC+0LLQsNGC0Ywg0Y3RgtC4INC00LDQvdC90YvQtVwiLFxuICAgICAgXCIjZWRpdC1idXR0b25cIjogXCLQmNC30LzQtdC90LjRgtGMINGN0YLQuCDQtNCw0L3QvdGL0LVcIixcbiAgICAgIFwiI21lbnUtYnV0dG9uXCI6IFwi0J/QtdGA0LXQudC00LjRgtC1INCyINC80LXQvdGOINC00LvRjyDQv9C+0LvRg9GH0LXQvdC40Y8g0LTQvtC/0L7Qu9C90LjRgtC10LvRjNC90YvRhSDQstC+0LfQvNC+0LbQvdC+0YHRgtC10LlcIixcbiAgICAgIFwiLmxpbmVhci1ob3VybHktZm9yZWNhc3RcIjogXCLQn9C+0YfQsNGB0L7QstC+0Lkg0L/RgNC+0LPQvdC+0LdcIixcbiAgICAgIFwiaGVsbG9cIjogXCLQn9GA0LjQstC10YJcIixcbiAgICAgIFwid2VsbGNvbWVcIjogXCLQlNC+0LHRgNC+INC/0L7QttCw0LvQvtCy0LDRgtGMXCIsXG4gICAgICBcIm1lbnVcIjogXCLQnNC10L3RjlwiLFxuICAgICAgXCJzZWFyY2hcIjogXCLQn9C+0LjRgdC6XCIsXG4gICAgICBcIndlZWtseSBmb3JlY2FzdFwiOiBcItCd0LXQtNC10LvRjNC90YvQuSDQv9GA0L7Qs9C90L7Qt1wiLFxuICAgICAgXCJob3VybHkgZm9yZWNhc3RcIjogXCLQn9C+0YfQsNGB0L7QstC+0Lkg0L/RgNC+0LPQvdC+0LdcIixcbiAgICAgIFwibWFwXCI6IFwi0JrQsNGA0YLQsFwiLFxuICAgICAgXCJiYWNrZ3JvdW5kXCI6IFwi0KTQvtC9XCIsXG4gICAgICBcInNlYXJjaCBsb2NhdGlvblwiOiBcItCf0L7QuNGB0Log0LIg0LvQvtC60LDRhtC40LhcIixcbiAgICAgIFwiTW9uZGF5XCI6IFwi0J/QvtC90LXQtNC10LvRjNC90LjQulwiLFxuICAgICAgXCJUdWVzZGF5XCI6IFwi0JLRgtC+0YDQvdC40LpcIixcbiAgICAgIFwiV2VkbmVzZGF5XCI6IFwi0KHRgNC10LTQsFwiLFxuICAgICAgXCJUaHVyc2RheVwiOiBcItCn0LXRgtCy0LXRgNCzXCIsXG4gICAgICBcIkZyaWRheVwiOiBcItCf0Y/RgtC90LjRhtCwXCIsXG4gICAgICBcIlNhdHVyZGF5XCI6IFwi0KHRg9Cx0LHQvtGC0LBcIixcbiAgICAgIFwiU3VuZGF5XCI6IFwi0JLQvtGB0LrRgNC10YHQtdC90YzQtVwiLFxuICAgICAgXCJ1cGxvYWQgYmFja2dyb3VuZFwiOiBcItCX0LDQs9GA0YPQt9C40YLQtSDRhNC+0L0g0YEg0JLQsNGI0LXQs9C+INGD0YHRgtGA0L7QudGB0YLQstCwXCJcblxuICAgIH1cbiAgfVxuICByZXR1cm4gZnVuY3Rpb24oc3RyaW5nKSB7XG4gICAgaWYoc3RyaW5nKSB7XG4gICAgICB2YXIgc3RyaW5ncyA9IGxhbmd1YWdlc1tMYW5ndWFnZSgpXTtcbiAgICAgIHJldHVybiBzdHJpbmdzW3N0cmluZ107XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBsYW5ndWFnZXM7XG4gICAgfVxuICB9XG59KTtcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuXG4uc2VydmljZSgnQW5kcm9pZEJpbGxpbmcnLCBmdW5jdGlvbigpIHtcbiAgdmFyIHB1cmNoYXNlcztcblxuICBpZigoaXNQbHVnaW5BdmFpbGFiZWwoKSkpIHtcbiAgICAgIGluaXQoKTtcbiAgfSBlbHNlIHtcbiAgICBjb25zb2xlLmVycm9yKFwicGx1Z2luIG5vdCBhdmFpbGFiZWxcIik7XG4gICAgcmV0dXJuO1xuICB9XG4gIHJldHVybiB7XG4gICAgYnV5OiBidXksXG4gICAgcHVyY2hhc2VzOiBwdXJjaGFzZXNcbiAgfVxuICBmdW5jdGlvbiBpc1BsdWdpbkF2YWlsYWJlbCgpIHtcbiAgICByZXR1cm4gd2luZG93LmRldmljZSAmJiBkZXZpY2UucGxhdGZvcm0gPT0gXCJBbmRyb2lkXCIgJiYgdHlwZW9mIGluYXBwYmlsbGluZyAhPT0gXCJ1bmRlZmluZWRcIjtcbiAgfVxuICBmdW5jdGlvbiBpbml0KCkge1xuICAgICAgaW5hcHBiaWxsaW5nLmluaXQoc3VjY2VzcywgZXJyb3IpO1xuXG4gICAgICBmdW5jdGlvbiBzdWNjZXNzKCByZXNwb25zZSApIHtcbiAgICAgICAgcHVyY2hhc2VzKCkudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgIGNvbnNvbGUubG9nKFwiQW5kcm9pZCBpbi1hcHAgYmlsbGluZyBpbml0aWFsaXplZCBzdWNjZXNzXCIpO1xuICAgICAgICB9LCBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coXCJBbmRyb2lkIGluLWFwcCBiaWxsaW5nIGluaXRpYWxpemUgZmFpbCBvY2N1cmVkXCIpO1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gZXJyb3IoZXJyKSB7XG4gICAgICAgIGFsZXJ0KEpTT04uc3RyaW5naWZ5KGVycikpXG4gICAgICB9XG4gIH1cbiAgZnVuY3Rpb24gcHVyY2hhc2VzKCkge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgaWYocHVyY2hhc2VzKSB7XG4gICAgICAgICAgcmVzb2x2ZShwdXJjaGFzZXMpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpbmFwcGJpbGxpbmcuZ2V0UHVyY2hhc2VzKHN1Y2Nlc3MsIGVycm9yKTtcblxuICAgICAgICBmdW5jdGlvbiBzdWNjZXNzKHJlc3BvbnNlKSB7XG4gICAgICAgICAgcmVzb2x2ZShyZXNwb25zZSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBlcnJvcihlcnIpIHtcbiAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgfVxuXG4gICAgfSk7XG4gIH1cbiAgZnVuY3Rpb24gZ2V0UHVyY2hhc2VzKCkge1xuXG5cbiAgICBmdW5jdGlvbiBzdWNjZXNzKHJlc3BvbnNlKSB7XG4gICAgICBhbGVydChcIlBVUkNIQVNFUyBcIiArIEpTT04uc3RyaW5naWZ5KHJlc3BvbnNlKSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZXJyb3IoZXJyKSB7XG4gICAgICBhbGVydChKU09OLnN0cmluZ2lmeShlcnIpKVxuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGJ1eShza3UpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBpbmFwcGJpbGxpbmcuY29uc3VtZVB1cmNoYXNlKGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGluYXBwYmlsbGluZy5idXkoc3VjY2VzcywgZmFpbCwgc2t1KTtcbiAgICAgICAgfSwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgaW5hcHBiaWxsaW5nLmJ1eShzdWNjZXNzLCBmYWlsLCBza3UpO1xuICAgICAgICB9LCBza3UpXG5cbiAgICAgICAgZnVuY3Rpb24gc3VjY2VzcyhyZXNwb25zZSkge1xuICAgICAgICAgIHJlc29sdmUocmVzcG9uc2UpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGZhaWwoZXJyKSB7XG4gICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG5cbn0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG5cbi5zZXJ2aWNlKCdQdXJjaGFzZScsIGZ1bmN0aW9uKEF1dGhvcml6ZWRSZXF1ZXN0LCBFbmRQb2ludHMsIEFuZHJvaWRCaWxsaW5nLCBTdHJvcmVLaXQsICRpb25pY1BsYXRmb3JtKSB7XG4gIHZhciBuYXRpdmU7XG4gIHJldHVybiBmdW5jdGlvbihpZCkge1xuICAgIGlmKCF3aW5kb3cuZGV2aWNlKSB7XG4gICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICByZXNvbHZlKFwic3VjY2Vzc1wiKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfSk7XG5cbiAgICB9XG5cblxuICAgICAgaWYoJGlvbmljUGxhdGZvcm0uaXMoJ0FuZHJvaWQnKSkge1xuICAgICAgICBuYXRpdmUgPSBBbmRyb2lkQmlsbGluZztcbiAgICAgIH1cbiAgICAgIGlmKCRpb25pY1BsYXRmb3JtLmlzKCdpT1MnKSkge1xuICAgICAgICBuYXRpdmUgPSBTdG9yZUtpdDtcbiAgICAgIH1cblxuICAgIHJldHVybiBuYXRpdmUuYnV5KGlkKTtcblxuICB9XG5cbn0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG5cbi5zZXJ2aWNlKCdTdHJvcmVLaXQnLCBmdW5jdGlvbigpIHtcbiAgdmFyIHB1cmNoYXNlUHJvY2VzcztcbiAgaWYoKGlzUGx1Z2luQXZhaWxhYmVsKCkpKSB7XG4gICAgICBpbml0KCk7XG4gIH0gZWxzZSB7XG4gICAgY29uc29sZS5lcnJvcihcInBsdWdpbiBub3QgYXZhaWxhYmVsXCIpO1xuICAgIHJldHVybjtcbiAgfVxuICB2YXIgc3VjY2VzcztcbiAgdmFyIGVycm9yO1xuXG4gIHJldHVybiB7XG4gICAgYnV5OiBidXlcbiAgfVxuXG4gIGZ1bmN0aW9uIGlzUGx1Z2luQXZhaWxhYmVsKCkge1xuICAgIHJldHVybiB3aW5kb3cuZGV2aWNlICYmIGRldmljZS5wbGF0Zm9ybSA9PSBcImlPU1wiICYmIHR5cGVvZiBzdG9yZWtpdCAhPT0gXCJ1bmRlZmluZWRcIjtcbiAgfVxuICBmdW5jdGlvbiBpbml0KCkge1xuICAgIHN0b3Jla2l0LmluaXQoe1xuICAgICAgICBkZWJ1ZzogICAgdHJ1ZSxcbiAgICAgICAgcmVhZHk6ICAgIGZ1bmN0aW9uKCkge1xuICAgICAgICB9LFxuICAgICAgICBwdXJjaGFzZTogZnVuY3Rpb24odHJhbnNhY3Rpb25JZCwgcHJvZHVjdElkLCByZWNlaXB0KSB7XG4gICAgICAgICAgY29uc29sZS5sb2coXCJQdXJjaGFzZWQgcHJvZHVjdCBpZCBcIiArIHByb2R1Y3RJZCk7XG4gICAgICAgICAgc3VjY2Vzcyhwcm9kdWN0SWQpO1xuICAgICAgICB9LFxuICAgICAgICByZXN0b3JlOiAgZnVuY3Rpb24odHJhbnNhY3Rpb25JZCwgcHJvZHVjdElkLCB0cmFuc2FjdGlvblJlY2VpcHQpIHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhcIlJlc3RvcmVkIHByb2R1Y3QgaWRcIiArcHJvZHVjdElkKyBcInB1cmNoYXNlXCIpXG4gICAgICAgIH0sXG4gICAgICAgIGVycm9yOiAgICBmdW5jdGlvbihlcnJvckNvZGUsIGVycm9yTWVzc2FnZSkge1xuICAgICAgICAgIGNvbnNvbGUubG9nKFwiRVJST1I6IFwiICsgZXJyb3JNZXNzYWdlKTtcbiAgICAgICAgICBlcnJvcihlcnJvck1lc3NhZ2UpO1xuICAgICAgICB9XG4gICAgICB9KVxuICAgIH1cblxuXG4gIGZ1bmN0aW9uIGJ1eSgpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIHN0b3Jla2l0LnB1cmNoYXNlKCdkZWZhdWx0X2JhY2tncm91bmRfcGFjaycpO1xuICAgICAgICBzdWNjZXNzID0gcmVzb2x2ZTtcbiAgICAgICAgZXJyb3IgPSByZWplY3Q7XG4gICAgfSk7XG4gIH1cblxufSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcblxuLnNlcnZpY2UoJ1NpZ25JbicsIGZ1bmN0aW9uKEVtYWlsTG9nSW4sICBPQXV0aCkge1xuICByZXR1cm4gZnVuY3Rpb24oIGRhdGEpIHtcbiAgICByZXR1cm4gKHR5cGVvZiBkYXRhID09IFwic3RyaW5nXCIpPyBPQXV0aChkYXRhKSA6IEVtYWlsTG9nSW4oZGF0YSk7XG4gIH1cbn0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG5cbi5zZXJ2aWNlKCdTaWduVXAnLCBmdW5jdGlvbiggRW1haWxTaWduVXAgKSB7XG4gIHJldHVybiBmdW5jdGlvbih0eXBlLCBkYXRhKSB7XG4gICAgdmFyIHNlcnZpY2VzID0ge1xuICAgICAgZW1haWw6IEVtYWlsU2lnblVwXG4gICAgfVxuICAgIHJldHVybiBuZXcgUHJvbWlzZShzZXJ2aWNlc1t0eXBlXShkYXRhKSk7XG4gIH1cbn0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG5cbi5zZXJ2aWNlKCdVc2VyJywgZnVuY3Rpb24oU2lnbkluLCBTaWduVXAsIFVzZXJEYXRhLCBFbmRQb2ludHMpIHtcbiAgcmV0dXJuIHtcbiAgICBzaWduSW46IHNpZ25JbixcbiAgICBzaWduVXA6IHNpZ25VcCxcbiAgICBsb2dPdXQ6IGxvZ091dCxcbiAgICBtZTogVXNlckRhdGFcbiAgfVxuXG4gIGZ1bmN0aW9uIHNpZ25JbihkYXRhKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKFxuICAgICAgZnVuY3Rpb24oIHJlc29sdmUsIHJlamVjdCApIHtcbiAgICAgICAgU2lnbkluKGRhdGEpLnRoZW4oXG4gICAgICAgICAgZnVuY3Rpb24oIHJlc3BvbnNlICkge1xuICAgICAgICAgICAgVXNlckRhdGEocmVzcG9uc2UpO1xuICAgICAgICAgICAgcmVzb2x2ZShyZXNwb25zZSk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBmdW5jdGlvbiAoZXJyb3IgKSB7XG4gICAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICApO1xuICB9XG5cbiAgZnVuY3Rpb24gc2lnblVwKCkge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShcbiAgICAgIGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBTaWduVXAoKVxuICAgICAgfVxuICAgICk7XG4gIH1cbiAgZnVuY3Rpb24gbG9nT3V0KCkge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICBVc2VyRGF0YShcInJlc2V0XCIpO1xuICAgICAgcmVzb2x2ZSgpO1xuICAgIH0pO1xuICB9XG5cbn0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG5cbi5zZXJ2aWNlKCdVc2VyRGF0YScsIGZ1bmN0aW9uKFVwbG9hZEltYWdlLCBFbmRQb2ludHMsIGNvbmZpZykge1xuICB2YXIgc3Vic2NyaWJlcnMgPSBbXTtcblx0dmFyIGNvbW1hbmRzID0ge1xuXHRcdFwicmVzZXRcIjogcmVzZXQsXG5cdFx0XCJzZWxlY3QgYXZhdGFyXCI6IHNlbGVjdEF2YXRhcixcblx0XHRcInN1YnNjcmliZVwiOiBzdWJzY3JpYmUsXG5cdFx0XCJlZGl0XCI6IGVkaXRcblx0fVxuXHRyZXR1cm4gZnVuY3Rpb24oZGF0YSkge1xuXHRcdGlmKGRhdGEpIHtcblx0XHRcdGlmKHR5cGVvZiBkYXRhID09PSBcInN0cmluZ1wiKSB7XG5cdFx0XHRcdHJldHVybiBjb21tYW5kLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRzZXREYXRhKGRhdGEpO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHR1c2VyID0gZ2V0RGF0YSgpO1xuXHRcdFx0cmV0dXJuIHVzZXI7XG5cdFx0fVxuXHR9XG5cblx0ZnVuY3Rpb24gZ2V0RGF0YSgpIHtcblx0XHR2YXIgdXNlckluZm8gPSBsb2NhbFN0b3JhZ2UuZXdfdXNlcjtcblx0XHRpZih1c2VySW5mbyAmJiB1c2VySW5mbyAhPSBcInVuZGVmaW5lZFwiKSB7XG5cdFx0XHRyZXR1cm4gSlNPTi5wYXJzZSh1c2VySW5mbyk7XG5cdFx0fVxuXHR9XG5cdGZ1bmN0aW9uIHNldERhdGEoZGF0YSkge1xuXHRcdGxvY2FsU3RvcmFnZS5ld191c2VyID0gSlNPTi5zdHJpbmdpZnkoZGF0YSk7XG5cdFx0YXBwbHkoKTtcblx0fVxuXG5cdGZ1bmN0aW9uIGNvbW1hbmQoY29tbWFuZE5hbWUpIHtcblx0XHR2YXIgYWN0aW9uID0gY29tbWFuZHNbY29tbWFuZE5hbWVdO1xuXHRcdGlmKGFjdGlvbikge1xuXHRcdFx0dmFyIGFyZ3MgPSBbXTtcblx0XHRcdGZvcih2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIGFyZ3MucHVzaChhcmd1bWVudHNbaV0pO1xuXHRcdFx0cmV0dXJuIGFjdGlvbi5hcHBseSh0aGlzLCBhcmdzKTtcblx0XHR9XG5cdH1cblxuXHRmdW5jdGlvbiByZXNldCgpIHtcblx0XHRsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShcImV3X3VzZXJcIik7XG5cdH1cblx0ZnVuY3Rpb24gZWRpdChuZXdVc2VyRGF0YSkge1xuXHRcdHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblx0XHRcdFx0JC5hamF4KHtcblx0XHRcdFx0XHRcdG1ldGhvZDogXCJQT1NUXCIsXG5cdFx0XHRcdFx0XHR1cmw6IEVuZFBvaW50cy5hY3Rpb24oJ2VkaXQtcHJvZmlsZScpLFxuXHRcdFx0XHRcdFx0c3VjY2VzczogZnVuY3Rpb24ocmVzcG9uc2UpIHtcblx0XHRcdFx0XHRcdFx0aWYocmVzcG9uc2Uuc3RhdHVzICE9IFwic3VjY2Vzc1wiKSB7XG5cdFx0XHRcdFx0XHRcdFx0dmFyIGVycm9ycyA9IFtdO1xuXHRcdFx0XHRcdFx0XHRcdGZvcih2YXIgZmllbGQgaW4gcmVzcG9uc2UuZXJyb3JzICkge1xuXHRcdFx0XHRcdFx0XHRcdFx0cmVzcG9uc2UuZXJyb3JzW2ZpZWxkXS5mb3JFYWNoKGZ1bmN0aW9uKGVycm9yKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0c3dpdGNoKGVycm9yKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGNhc2UgXCJlbWFpbF9pZF9yZXF1aXJlZFwiOiB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0ZXJyb3JzLnB1c2goXCJQbGVhc2UgdHlwZSB2YWxpZCBlbWFpbFwiKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0fTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Y2FzZSBcImVtYWlsX2lzX25vdF92YWxpZFwiIDoge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGVycm9ycy5wdXNoKFwiUGxlYXNlIHR5cGUgdmFsaWQgZW1haWxcIik7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Y2FzZSBcInBhc3N3b3Jkc19kb19ub3RfbWF0Y2hcIjpcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRlcnJvcnMucHVzaChcIlBhc3N3b3JkcyBkbyBub3QgbWF0Y2hcIik7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHRcdFx0fTtcblx0XHRcdFx0XHRcdFx0XHRyZWplY3QoZXJyb3JzKTtcblx0XHRcdFx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0Zm9yKHZhciBmaWVsZCBpbiB7bmFtZTogbmV3VXNlckRhdGEubmFtZSwgZW1haWw6IG5ld1VzZXJEYXRhLmVtYWlsLCBwYXNzd29yZDogbmV3VXNlckRhdGEucGFzc3dvcmR9KSB7XG5cdFx0XHRcdFx0XHRcdFx0aWYobmV3VXNlckRhdGFbZmllbGRdICYmIHVzZXJbZmllbGRdICE9IG5ld1VzZXJEYXRhW2ZpZWxkXSkgdXNlcltmaWVsZF0gPSBuZXdVc2VyRGF0YVtmaWVsZF07XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0c2V0RGF0YSh1c2VyKTtcblx0XHRcdFx0XHRcdFx0cmVzb2x2ZShcInN1Y2Nlc3NcIik7XG5cdFx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdFx0ZGF0YToge1xuXHRcdFx0XHRcdFx0XHRuYW1lOiBuZXdVc2VyRGF0YS5uYW1lLFxuXHRcdFx0XHRcdFx0XHRlbWFpbDogbmV3VXNlckRhdGEuZW1haWwsXG5cdFx0XHRcdFx0XHRcdG5ld19wYXNzd29yZDogbmV3VXNlckRhdGEucGFzc3dvcmQsXG5cdFx0XHRcdFx0XHRcdGNvbmZpcm1fcGFzc3dvcmQ6IG5ld1VzZXJEYXRhLmNvbmZpcm1QYXNzd29yZFxuXHRcdFx0XHRcdFx0fSxcblx0XHRcdFx0XHRcdGVycm9yOiBmdW5jdGlvbihlcnIpIHtcblx0XHRcdFx0XHRcdFx0Y29uc29sZS5lcnJvcihlcnIpO1xuXHRcdFx0XHRcdFx0XHRyZWplY3QoW1wiSW50ZXJuYWwgU2VydmVyIEVycm9yXCJdKVxuXHRcdFx0XHRcdFx0fSxcblx0XHRcdFx0XHRcdGJlZm9yZVNlbmQ6IGZ1bmN0aW9uKHhocikge1xuXHRcdFx0XHRcdFx0XHRcdHhoci5zZXRSZXF1ZXN0SGVhZGVyIChcIkF1dGhvcml6YXRpb25cIiwgXCJCZWFyZXIgXCIrIHVzZXIudG9rZW4pO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pO1xuXHRcdH0pO1xuXHR9XG5cdGZ1bmN0aW9uIHN1YnNjcmliZShzdWJzY3JpYmVyKSB7XG5cdFx0c3Vic2NyaWJlcnMucHVzaChzdWJzY3JpYmVyKTtcblx0fVxuXHRmdW5jdGlvbiBhcHBseSgpIHtcblx0XHRzdWJzY3JpYmVycy5mb3JFYWNoKGZ1bmN0aW9uKHN1YnNjcmliZXIpIHtcblx0XHRcdHN1YnNjcmliZXIoKTtcblx0XHR9KTtcblx0fVxuICBmdW5jdGlvbiBzZWxlY3RBdmF0YXIoKSB7XG5cdFx0cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXHRcdFx0XHRVcGxvYWRJbWFnZSgge2hlYWRlcnMgOiB7XG5cdFx0XHRcdFx0XCJBdXRob3JpemF0aW9uXCI6IFwiQmVhcmVyIFwiKyB1c2VyLnRva2VuXG5cdFx0XHRcdH19KS50aGVuKFxuXHRcdFx0XHRcdGZ1bmN0aW9uKHVyaSkge1xuXHRcdFx0XHRcdFx0dXNlci5hdmF0YXIgID0gY29uZmlnLnNlcnZlciArIHVyaTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHVzZXIuYXZhdGFyKTtcbiAgICAgICAgICAgIHNldERhdGEodXNlcik7XG5cdFx0ICAgICAgICBzdWJzY3JpYmVycy5mb3JFYWNoKGZ1bmN0aW9uKHN1YnNjcmliZXIpIHtcblx0XHQgICAgICAgICAgc3Vic2NyaWJlcigpO1xuXHRcdCAgICAgICAgfSk7XG5cdFx0XHRcdFx0XHRyZXNvbHZlKFwic3VjY2Vzc1wiKTtcblx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdHJlamVjdFxuXHRcdFx0XHQpO1xuXG5cdFx0fSk7XG4gIH1cbn0pXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5zZXJ2aWNlKCdBdXRob3JpemVkUmVxdWVzdCcsIGZ1bmN0aW9uKFVzZXIsIEVuZFBvaW50cywgU2luZ2xlUmVxdWVzdCwgJHdpbmRvdywgJHN0YXRlLCAkaW9uaWNMb2FkaW5nKSB7XG5cbiAgdmFyIHJlcXVlc3QgPSBuZXcgU2luZ2xlUmVxdWVzdCgpO1xuICB2YXIgd2FpdGluZ3MgPSBbXTtcbiAgdmFyIHByb2Nlc3NvcjtcblxuICByZXR1cm4gZnVuY3Rpb24obWV0aG9kLCB1cmwsIGRhdGEpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgIHNlbmRSZXF1ZXN0KHJlc29sdmUsIGFuYWxpemUpO1xuXG4gICAgICBmdW5jdGlvbiBzZW5kUmVxdWVzdChzdWNjZXNzLCBlcnJvcikge1xuICAgICAgICBcdCQuYWpheCh7XG4gICAgICAgICAgICAgIG1ldGhvZDogbWV0aG9kLFxuICAgICAgICBcdFx0ICB1cmw6IHVybCxcbiAgICAgICAgXHRcdFx0c3VjY2Vzczogc3VjY2VzcyxcbiAgICAgICAgICAgICAgZGF0YTogZGF0YSxcbiAgICAgICAgXHRcdFx0ZXJyb3I6IGVycm9yLFxuICAgICAgICBcdFx0XHRiZWZvcmVTZW5kOiBmdW5jdGlvbih4aHIpIHtcbiAgICAgICAgXHRcdFx0XHRcdHhoci5zZXRSZXF1ZXN0SGVhZGVyIChcIkF1dGhvcml6YXRpb25cIiwgXCJCZWFyZXIgXCIrIFVzZXIubWUoKS50b2tlbik7XG4gICAgICAgIFx0XHRcdH1cbiAgICAgICAgICBcdH0pO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBhbmFsaXplKGVycikge1xuXG4gICAgICAgIGlmKGVyci5zdGF0dXMgIT0gNDAxKSB7XG4gICAgICAgICAgYXBwbHkoXCJyZWplY3RcIiwgZXJyKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgd2FpdGluZ3MucHVzaChmdW5jdGlvbigpIHtcbiAgICAgICAgICBzZW5kUmVxdWVzdChyZXNvbHZlLCByZWplY3QpO1xuICAgICAgICB9KTtcbiAgICAgICAgaWYocHJvY2Vzc29yKSByZXR1cm47XG4gICAgICAgIHJlZnJlc2goKTtcblxuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBhcHBseSgpIHtcbiAgICAgICAgdmFyIHByb2Nlc3NpbmcgPSB3YWl0aW5ncztcbiAgICAgICAgcHJvY2Vzc29yID0gZmFsc2U7XG4gICAgICAgIHdhaXRpbmdzID0gW107XG4gICAgICAgIHByb2Nlc3NpbmcuZm9yRWFjaChmdW5jdGlvbihoYW5kbGVyKSB7XG4gICAgICAgICAgaGFuZGxlcigpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGZ1bmN0aW9uIHJlZnJlc2goKSB7XG4gICAgICAgICAgICBwcm9jZXNzb3IgPSB0cnVlO1xuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgcHJvY2Vzc29yID0gZmFsc2U7XG4gICAgICAgICAgICB9LCA2MCoxMDAwKTtcbiAgICAgICAgICAgIHZhciB1c2VyID0gVXNlci5tZSgpO1xuICAgICAgICAgICAgJC5hamF4KHtcbiAgICAgICAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICAgICAgICAgIHVybDogRW5kUG9pbnRzLmFjdGlvbigncmVmcmVzaCcpICsgXCI/dG9rZW49XCIrVXNlci5tZSgpLnRva2VuLFxuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICB1c2VyLnRva2VuID0gcmVzcG9uc2UudG9rZW47XG4gICAgICAgICAgICAgICAgICBVc2VyLm1lKHVzZXIpO1xuICAgICAgICAgICAgICAgICAgYXBwbHkoKTtcblxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgcHJvY2Vzc29yID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAkaW9uaWNMb2FkaW5nLmhpZGUoKTtcbiAgICAgICAgICAgICAgICAgIFVzZXIuc2lnbkluKHVzZXIpLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIGFwcGx5KCk7XG4gICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICRzdGF0ZS5nbyhcInNpZ25JblwiKTtcbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgYmVmb3JlU2VuZDogZnVuY3Rpb24oeGhyKSB7XG4gICAgICAgICAgICAgICAgICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyIChcIkF1dGhvcml6YXRpb25cIiwgXCJCZWFyZXIgXCIrIFVzZXIubWUoKS50b2tlbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgLy8kd2luZG93LmxvY2F0aW9uLnJlbG9hZCh0cnVlKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufSk7XG4iLCJhbmd1bGFyLm1vZHVsZShcImFwcFwiKVxuXG4uc2VydmljZSgnSG91cmx5JywgZnVuY3Rpb24oKSB7XG4gIHJldHVybiB7XG4gICAgYWRhcHRlcjogYWRhcHRlclxuICB9XG5cbiAgZnVuY3Rpb24gYWRhcHRlcihwYWNrLCByZXNwb25zZSApIHtcblxuICAgICAgICAgIHZhciBpdGVtcyA9IHJlc3BvbnNlID0gSlNPTi5wYXJzZShyZXNwb25zZSk7XG4gICAgICAgICAgdmFyIHJlc3VsdCA9IFtdO1xuICAgICAgICAgIGlmKCFpdGVtcykge1xuICAgICAgICAgICAgICByZWplY3QocmVzcG9uc2UpO1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIGl0ZW1zLmZvckVhY2goZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICAgICAgICB2YXIgZm9yZWNhc3QgPSBnZXRGb3JlY2FzdEl0ZW0oaXRlbSk7XG4gICAgICAgICAgICAgIHJlc3VsdC5wdXNoKGZvcmVjYXN0KTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuXG4gICAgICBmdW5jdGlvbiBnZXRGb3JlY2FzdEl0ZW0oaXRlbSkge1xuICAgICAgICBpdGVtID0ge1xuICAgICAgICAgIHRlbXA6ICtpdGVtLnRlbXAsXG4gICAgICAgICAgY29uZGl0aW9uOiBpdGVtLmNvbmRpdGlvbi5yZXBsYWNlKC9fL2csICcgJyksXG4gICAgICAgICAgZGF0ZTogbmV3IERhdGUoIGl0ZW0uZGF0ZS5yZXBsYWNlKCcgJywgJ1QnKSApLFxuICAgICAgICAgIGZlZWxzTGlrZTogK2l0ZW0uZmVlbHNsaWtlLFxuICAgICAgICAgIGh1bWlkaXR5OiBpdGVtLmh1bWlkaXR5LFxuICAgICAgICAgIHdpbmQ6IHtcbiAgICAgICAgICAgIHNwZWVkOiBpdGVtLndpbmQuc3BlZWQsXG4gICAgICAgICAgICBkaXJlY3Rpb246IGdldFdpbmREaXJlY3Rpb24oKVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaXRlbTtcbiAgICAgICAgZnVuY3Rpb24gZ2V0V2luZERpcmVjdGlvbigpIHtcbiAgICAgICAgICB2YXIgZGlyZWN0aW9ucyA9IHtcbiAgICAgICAgICAgICdOJzogJ05vcmQnLFxuICAgICAgICAgICAgJ1cnOiAnV2VzdCcsXG4gICAgICAgICAgICAnUyc6ICdTb3V0aCcsXG4gICAgICAgICAgICAnRSc6ICdFYXN0J1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgcmVzID0gXCJcIjtcbiAgICAgICAgICB2YXIgZGlyID0gaXRlbS53aW5kLmRpcmVjdGlvbi5kaXI7XG4gICAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IGRpci5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgcmVzICs9IGRpcmVjdGlvbnNbZGlyW2ldXSArICcgJztcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGRlZ3JlZXM6IGl0ZW0ud2luZC5kaXJlY3Rpb24uZGVnLFxuICAgICAgICAgICAgbmFtZTogcmVzLnRyaW0oKVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICB9XG59KTtcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLnNlcnZpY2UoJ1dlYXRoZXInLCBmdW5jdGlvbihBdXRob3JpemVkUmVxdWVzdCwgRW5kUG9pbnRzLCBIb3VybHksIFdlZWtseSwgRW1vankpIHtcblx0dmFyIGFkYXB0ZXJzID0ge1xuXHRcdFwiaG91cmx5MTBkYXlcIjogSG91cmx5LmFkYXB0ZXIsXG5cdFx0XCJob3VybHlcIjogSG91cmx5LmFkYXB0ZXIsXG5cdFx0XCJmb3JlY2FzdDEwZGF5XCI6IFdlZWtseS5hZGFwdGVyXG5cdH1cblx0dmFyIGNhY2hlID0ge307XG5cdHJldHVybiBmdW5jdGlvbiB3ZWF0aGVyKGxvY2F0aW9uLCBxdWVyeSkge1xuXHRcdHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblx0XHRcdEVtb2p5LmN1cnJlbnQoKS50aGVuKGZ1bmN0aW9uKGVtb2p5UGFjaykge1xuXHRcdFx0XHR2YXIgdXJsID0gd2VhdGhlclF1ZXJ5KGxvY2F0aW9uLCBxdWVyeSk7XG5cdFx0XHRcdHZhciByZWNvcmQgPSBjYWNoZVtxdWVyeV07XG5cdFx0XHRcdGlmKHJlY29yZCAmJiB1cmwgPT09IHJlY29yZC51cmwpIHN1Y2Nlc3MocmVjb3JkLnJlc3BvbnNlKTtcblx0XHRcdFx0QXV0aG9yaXplZFJlcXVlc3QoXCJHRVRcIiwgdXJsICkudGhlbihcblx0XHRcdFx0XHRmdW5jdGlvbiAocmVzcG9uc2UpIHtcblx0XHRcdFx0XHRcdGlmKH5yZXNwb25zZS5pbmRleE9mKFwiZXJyb3JcIikpIHtcblx0XHRcdFx0XHRcdFx0cmVqZWN0KFwiSW52YWxpZCBsb2NhdGlvblwiKTtcblx0XHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0dmFyIHJlc3VsdCA9IGFkYXB0ZXJzW3F1ZXJ5XShlbW9qeVBhY2ssIHJlc3BvbnNlKTtcblx0XHRcdFx0XHRcdFx0Y2FjaGVbcXVlcnldID0ge1xuXHRcdFx0XHRcdFx0XHRcdHVybDogdXJsLFxuXHRcdFx0XHRcdFx0XHRcdHJlc3BvbnNlOiByZXN1bHRcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0XHRcdGNhY2hlID0gW107XG5cdFx0XHRcdFx0XHRcdH0sIDYwKjYwKjEwMDApO1xuXHRcdFx0XHRcdFx0c3VjY2VzcyhyZXN1bHQpO1xuXHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0ZnVuY3Rpb24oZSkge1xuXHRcdFx0XHRcdFx0aWYoZS5lcnJvcikge1xuXHRcdFx0XHRcdFx0XHRyZWplY3QoZS5lcnJvci5kZXNjcmlwdGlvbilcblx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdHJlamVjdChcIkdlbyBpbmZvIGlzIG5vdCBlbm91Z2hcIik7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0ZnVuY3Rpb24gc3VjY2VzcyhyZXN1bHQpe1xuXHRcdFx0XHRcdFx0cmVzdWx0LmZvckVhY2goZnVuY3Rpb24od2VhdGhlcikge1xuXHRcdFx0XHRcdFx0XHR3ZWF0aGVyLmljb24gPSBFbW9qeS5pbWFnZShlbW9qeVBhY2ssIHdlYXRoZXIpO1xuXHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHRyZXNvbHZlKHJlc3VsdCk7XG5cdFx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0fSk7XG5cblxuXHRcdGZ1bmN0aW9uIHdlYXRoZXJRdWVyeShsb2NhdGlvbiwgcXVlcnkpIHtcblxuXHRcdFx0XHR2YXIgcXVlcnlQYXJhbXMgPSBnZXRRdWVyeVBhcmFtcygpO1xuXHRcdFx0XHR2YXIgdXJsID0gRW5kUG9pbnRzLmFjdGlvbihxdWVyeSkrcXVlcnlQYXJhbXM7XG5cdFx0XHRcdFx0cmV0dXJuIHVybDtcblxuXHRcdFx0XHRcdGZ1bmN0aW9uIGdldFF1ZXJ5UGFyYW1zKCkge1xuXHRcdFx0XHRcdFx0bG9jYXRpb24gPSBsb2NhdGlvbi5sb2NhdGlvbjtcblx0XHRcdFx0XHRcdHZhciByZXN1bHQgPSBcIj9sYXQ9XCIrbG9jYXRpb24ubGF0K1wiJmxuZz1cIitsb2NhdGlvbi5sbmc7XG5cdFx0XHRcdFx0XHRyZXR1cm4gZW5jb2RlVVJJKHJlc3VsdCk7XG5cdFx0XHRcdH1cblx0XHR9XG5cdH1cbn0pXG4iLCJhbmd1bGFyLm1vZHVsZShcImFwcFwiKVxuXG4uc2VydmljZSgnV2Vla2x5JywgZnVuY3Rpb24oRW5kUG9pbnRzLCBVc2VyKSB7XG4gIHJldHVybiB7XG4gICAgYWRhcHRlcjogYWRhcHRlclxuICB9XG5cbiAgZnVuY3Rpb24gYWRhcHRlciggcGFjaywgcmVzcG9uc2UgKSB7XG5cbiAgICB2YXIgcmVzdWx0ID0gW107XG4gICAgdmFyIGZvcmVjYXN0ID0gSlNPTi5wYXJzZShyZXNwb25zZSk7XG4gICAgZm9yKHZhciBpID0gMDsgaSA8IGZvcmVjYXN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgaXRlbSA9IGZvcmVjYXN0W2ldO1xuICAgICAgcmVzdWx0W2ldID0gZ2V0Rm9yZWNhc3RJdGVtKGl0ZW0pO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuXG5cbiAgICAgIGZ1bmN0aW9uIGdldEZvcmVjYXN0SXRlbShpdGVtKSB7XG4gICAgICAgIGl0ZW0gPSB7XG4gICAgICAgICAgdGVtcDoge1xuICAgICAgICAgICAgaGlnaDogK2l0ZW0udGVtcC5oaWdoLFxuICAgICAgICAgICAgbG93OiAraXRlbS50ZW1wLmxvd1xuICAgICAgICAgIH0sXG4gICAgICAgICAgY29uZGl0aW9uOiBpdGVtLmNvbmRpdGlvbnMucmVwbGFjZSgvXy9nLCAnICcpLFxuICAgICAgICAgIGRhdGU6IG5ldyBEYXRlKCBpdGVtLmRhdGUgKyAnVDEyOjAwOjAwJylcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaXRlbTtcbiAgICAgIH1cbiAgfVxufSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcblxuLnNlcnZpY2UoJ0VtYWlsTG9nSW4nLCBmdW5jdGlvbigkaHR0cCwgRW5kUG9pbnRzLCBjb25maWcpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgJC5hamF4KHtcbiAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICAgIGRhdGFUeXBlOiBcImpzb25cIixcbiAgICAgICAgICBkYXRhOiBkYXRhLFxuICAgICAgICAgIGNyb3NzRG9tYWluOiB0cnVlLFxuICAgICAgICAgIHVybDogRW5kUG9pbnRzLmFjdGlvbignYXV0aGVudGljYXRlJyksXG4gICAgICAgICAgc3VjY2Vzczogc3VjY2VzcyxcbiAgICAgICAgICBlcnJvcjogZXJyb3JcbiAgICAgIH0pO1xuICAgICAgZnVuY3Rpb24gc3VjY2VzcyAoIHJlc3BvbnNlICkge1xuICAgICAgICB2YXIgdXNlciA9IHJlc3BvbnNlLnVzZXI7XG4gICAgICAgIHJlc29sdmUgKHtcbiAgICAgICAgICBlbWFpbDogZGF0YS5lbWFpbCxcbiAgICAgICAgICBwYXNzd29yZDogZGF0YS5wYXNzd29yZCxcbiAgICAgICAgICBhdmF0YXI6IGNvbmZpZy5zZXJ2ZXIgKyB1c2VyLmF2YXRhcl91cmwsXG4gICAgICAgICAgbmFtZTogdXNlci5uYW1lLFxuICAgICAgICAgIHRva2VuOiByZXNwb25zZS50b2tlblxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGZ1bmN0aW9uIGVycm9yICggZXJyICkge1xuICAgICAgICB2YXIgbWVzc2FnZTtcbiAgICAgICAgbWVzc2FnZSA9IChlcnIuc3RhdHVzID09IDQwMSk/XG4gICAgICAgICAgXCJJbnZhbGlkIHVzZXJuYW1lIG9yIHBhc3N3b3JkXCIgOlxuICAgICAgICAgIFwiSW52YWxpZCByZXF1ZXN0XCI7XG4gICAgICAgIHJlamVjdCggbWVzc2FnZSApO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59KTtcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuXG4uc2VydmljZSgnRW1haWxTaWduVXAnLCBmdW5jdGlvbigkaHR0cCwgRW5kUG9pbnRzLCBVc2VyRGF0YVZlcmlmeSkge1xuICByZXR1cm4gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICBVc2VyRGF0YVZlcmlmeShkYXRhLCBbXCJuYW1lXCIsIFwiZW1haWxcIiwgXCJwYXNzd29yZFwiXSkudGhlbihzaWduVXAsIHJlamVjdCk7XG5cbiAgICAgIGZ1bmN0aW9uIHNpZ25VcCgpIHtcbiAgICAgICAgJC5hamF4KHtcbiAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICAgIGRhdGE6IGRhdGEsXG4gICAgICAgICAgY3Jvc3NEb21haW46IHRydWUsXG4gICAgICAgICAgdXJsOiBFbmRQb2ludHMuYWN0aW9uKCdyZWdpc3RlcicpLFxuICAgICAgICAgIHN1Y2Nlc3M6IHN1Y2Nlc3MsXG4gICAgICAgICAgZXJyb3I6ICBlcnJvclxuICAgICAgICB9KTtcblxuICAgICAgICBmdW5jdGlvbiBzdWNjZXNzKCByZXNwb25zZSApIHtcbiAgICAgICAgICAgIGlmKHJlc3BvbnNlICYmIHJlc3BvbnNlLmVycm9yKSB7XG4gICAgICAgICAgICAgIGVycm9yKHJlc3BvbnNlLmVycm9yKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGVycm9yKCBlcnIgKSB7XG4gICAgICAgICAgICB2YXIgbWVzc2FnZSA9IGdldEVycm9yTWVzc2FnZSgpO1xuICAgICAgICAgICAgcmVqZWN0KCBtZXNzYWdlICk7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGdldEVycm9yTWVzc2FnZSgpIHtcbiAgICAgICAgICAgICAgICB2YXIgbWVzc2FnZSA9IFwiXCI7XG4gICAgICAgICAgICAgICAgZm9yKHZhciBrZXkgaW4gZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpc3N1ZSA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpc3N1ZXMgPSBlcnJba2V5XTtcbiAgICAgICAgICAgICAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IGlzc3Vlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaXNzdWUgKz0gaXNzdWVzW2ldICsgXCJcXG5cIjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlICs9IGlzc3VlICsgXCJcXG5cIjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIG1lc3NhZ2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbn0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG5cbi5ydW4oZnVuY3Rpb24oJGlvbmljUGxhdGZvcm0sIGNvbmZpZykge1xuICAgIGhlbGxvLmluaXQoe1xuICAgIFx0J3R3aXR0ZXInIDogY29uZmlnLnR3aXR0ZXJBcHBJZCxcbiAgICAgICdmYWNlYm9vayc6IGNvbmZpZy5mYWNlYm9va0FwcElkLFxuICAgICAgJ2dvb2dsZSc6IGNvbmZpZy5nb29nbGVBcHBLZXlcbiAgICB9LFxuICAgIHtcbiAgICAgIG9hdXRoX3Byb3h5IDogY29uZmlnLm9hdXRoUHJveHksXG4gICAgICByZXNwb25zZV90eXBlOiAndG9rZW4nLFxuICAgICAgb2F1dGhfdmVyc2lvbjogJzIuMGEnLFxuICAgICAgcmVkaXJlY3RfdXJpOiBcImh0dHA6Ly9hZG9kc29uLmNvbS9oZWxsby5qcy9yZWRpcmVjdC5odG1sXCJcbiAgICB9KTtcbn0pXG5cbi5zZXJ2aWNlKCdPQXV0aCcsIGZ1bmN0aW9uKGNvbmZpZywgRW5kUG9pbnRzKSB7XG4gIHJldHVybiBmdW5jdGlvbiAoIG5ldHdvcmsgKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKFxuICAgICAgZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgIHZhciBzZXJ2aWNlID0gaGVsbG8obmV0d29yayk7XG4gICAgICAgICAgc2VydmljZS5sb2dpbih7c2NvcGU6IFwiZW1haWxcIn0pLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgcmVzcG9uc2UgPSByZXNwb25zZS5hdXRoUmVzcG9uc2U7XG4gICAgICAgICAgICAgIHZhciBhY2Nlc3NfdG9rZW4gPSByZXNwb25zZS5hY2Nlc3NfdG9rZW47XG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKEpTT04uc3RyaW5naWZ5KHJlc3BvbnNlKSk7XG4gICAgICAgICAgICAgICQuYWpheCh7XG4gICAgICAgICAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICAgICAgICAgICAgdXJsOiBFbmRQb2ludHMuYWN0aW9uKG5ldHdvcmsrJy1hdXRoZW50aWNhdGlvbicpLFxuICAgICAgICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgICAgICBcImFjY2Vzc190b2tlblwiOiBhY2Nlc3NfdG9rZW5cbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgdmFyIHVzZXIgPSByZXNwb25zZS51c2VyO1xuICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUgKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZW1haWw6IHVzZXIuZW1haWwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGF2YXRhcjogY29uZmlnLnNlcnZlciArIHVzZXIuYXZhdGFyX3VybCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogdXNlci5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICB0b2tlbjogcmVzcG9uc2UudG9rZW4sXG4gICAgICAgICAgICAgICAgICAgICAgICAgIE9BdXRoOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiByZWplY3RcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSk7XG5cbiAgICAgIH1cbiAgICApO1xuICB9XG59KTtcbiIsIi8qISBoZWxsb2pzIHYxLjEzLjMgfCAoYykgMjAxMi0yMDE2IEFuZHJldyBEb2Rzb24gfCBNSVQgaHR0cHM6Ly9hZG9kc29uLmNvbS9oZWxsby5qcy9MSUNFTlNFICovXG4vLyBFUzUgT2JqZWN0LmNyZWF0ZVxuaWYgKCFPYmplY3QuY3JlYXRlKSB7XG5cblx0Ly8gU2hpbSwgT2JqZWN0IGNyZWF0ZVxuXHQvLyBBIHNoaW0gZm9yIE9iamVjdC5jcmVhdGUoKSwgaXQgYWRkcyBhIHByb3RvdHlwZSB0byBhIG5ldyBvYmplY3Rcblx0T2JqZWN0LmNyZWF0ZSA9IChmdW5jdGlvbigpIHtcblxuXHRcdGZ1bmN0aW9uIEYoKSB7fVxuXG5cdFx0cmV0dXJuIGZ1bmN0aW9uKG8pIHtcblxuXHRcdFx0aWYgKGFyZ3VtZW50cy5sZW5ndGggIT0gMSkge1xuXHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ09iamVjdC5jcmVhdGUgaW1wbGVtZW50YXRpb24gb25seSBhY2NlcHRzIG9uZSBwYXJhbWV0ZXIuJyk7XG5cdFx0XHR9XG5cblx0XHRcdEYucHJvdG90eXBlID0gbztcblx0XHRcdHJldHVybiBuZXcgRigpO1xuXHRcdH07XG5cblx0fSkoKTtcblxufVxuXG4vLyBFUzUgT2JqZWN0LmtleXNcbmlmICghT2JqZWN0LmtleXMpIHtcblx0T2JqZWN0LmtleXMgPSBmdW5jdGlvbihvLCBrLCByKSB7XG5cdFx0ciA9IFtdO1xuXHRcdGZvciAoayBpbiBvKSB7XG5cdFx0XHRpZiAoci5oYXNPd25Qcm9wZXJ0eS5jYWxsKG8sIGspKVxuXHRcdFx0XHRyLnB1c2goayk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHI7XG5cdH07XG59XG5cbi8vIEVTNSBbXS5pbmRleE9mXG5pZiAoIUFycmF5LnByb3RvdHlwZS5pbmRleE9mKSB7XG5cdEFycmF5LnByb3RvdHlwZS5pbmRleE9mID0gZnVuY3Rpb24ocykge1xuXG5cdFx0Zm9yICh2YXIgaiA9IDA7IGogPCB0aGlzLmxlbmd0aDsgaisrKSB7XG5cdFx0XHRpZiAodGhpc1tqXSA9PT0gcykge1xuXHRcdFx0XHRyZXR1cm4gajtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4gLTE7XG5cdH07XG59XG5cbi8vIEVTNSBbXS5mb3JFYWNoXG5pZiAoIUFycmF5LnByb3RvdHlwZS5mb3JFYWNoKSB7XG5cdEFycmF5LnByb3RvdHlwZS5mb3JFYWNoID0gZnVuY3Rpb24oZnVuLyosIHRoaXNBcmcqLykge1xuXG5cdFx0aWYgKHRoaXMgPT09IHZvaWQgMCB8fCB0aGlzID09PSBudWxsKSB7XG5cdFx0XHR0aHJvdyBuZXcgVHlwZUVycm9yKCk7XG5cdFx0fVxuXG5cdFx0dmFyIHQgPSBPYmplY3QodGhpcyk7XG5cdFx0dmFyIGxlbiA9IHQubGVuZ3RoID4+PiAwO1xuXHRcdGlmICh0eXBlb2YgZnVuICE9PSAnZnVuY3Rpb24nKSB7XG5cdFx0XHR0aHJvdyBuZXcgVHlwZUVycm9yKCk7XG5cdFx0fVxuXG5cdFx0dmFyIHRoaXNBcmcgPSBhcmd1bWVudHMubGVuZ3RoID49IDIgPyBhcmd1bWVudHNbMV0gOiB2b2lkIDA7XG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykge1xuXHRcdFx0aWYgKGkgaW4gdCkge1xuXHRcdFx0XHRmdW4uY2FsbCh0aGlzQXJnLCB0W2ldLCBpLCB0KTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4gdGhpcztcblx0fTtcbn1cblxuLy8gRVM1IFtdLmZpbHRlclxuaWYgKCFBcnJheS5wcm90b3R5cGUuZmlsdGVyKSB7XG5cdEFycmF5LnByb3RvdHlwZS5maWx0ZXIgPSBmdW5jdGlvbihmdW4sIHRoaXNBcmcpIHtcblxuXHRcdHZhciBhID0gW107XG5cdFx0dGhpcy5mb3JFYWNoKGZ1bmN0aW9uKHZhbCwgaSwgdCkge1xuXHRcdFx0aWYgKGZ1bi5jYWxsKHRoaXNBcmcgfHwgdm9pZCAwLCB2YWwsIGksIHQpKSB7XG5cdFx0XHRcdGEucHVzaCh2YWwpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0cmV0dXJuIGE7XG5cdH07XG59XG5cbi8vIFByb2R1Y3Rpb24gc3RlcHMgb2YgRUNNQS0yNjIsIEVkaXRpb24gNSwgMTUuNC40LjE5XG4vLyBSZWZlcmVuY2U6IGh0dHA6Ly9lczUuZ2l0aHViLmlvLyN4MTUuNC40LjE5XG5pZiAoIUFycmF5LnByb3RvdHlwZS5tYXApIHtcblxuXHRBcnJheS5wcm90b3R5cGUubWFwID0gZnVuY3Rpb24oZnVuLCB0aGlzQXJnKSB7XG5cblx0XHR2YXIgYSA9IFtdO1xuXHRcdHRoaXMuZm9yRWFjaChmdW5jdGlvbih2YWwsIGksIHQpIHtcblx0XHRcdGEucHVzaChmdW4uY2FsbCh0aGlzQXJnIHx8IHZvaWQgMCwgdmFsLCBpLCB0KSk7XG5cdFx0fSk7XG5cblx0XHRyZXR1cm4gYTtcblx0fTtcbn1cblxuLy8gRVM1IGlzQXJyYXlcbmlmICghQXJyYXkuaXNBcnJheSkge1xuXG5cdC8vIEZ1bmN0aW9uIEFycmF5LmlzQXJyYXlcblx0QXJyYXkuaXNBcnJheSA9IGZ1bmN0aW9uKG8pIHtcblx0XHRyZXR1cm4gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG8pID09PSAnW29iamVjdCBBcnJheV0nO1xuXHR9O1xuXG59XG5cbi8vIFRlc3QgZm9yIGxvY2F0aW9uLmFzc2lnblxuaWYgKHR5cGVvZiB3aW5kb3cgPT09ICdvYmplY3QnICYmIHR5cGVvZiB3aW5kb3cubG9jYXRpb24gPT09ICdvYmplY3QnICYmICF3aW5kb3cubG9jYXRpb24uYXNzaWduKSB7XG5cblx0d2luZG93LmxvY2F0aW9uLmFzc2lnbiA9IGZ1bmN0aW9uKHVybCkge1xuXHRcdHdpbmRvdy5sb2NhdGlvbiA9IHVybDtcblx0fTtcblxufVxuXG4vLyBUZXN0IGZvciBGdW5jdGlvbi5iaW5kXG5pZiAoIUZ1bmN0aW9uLnByb3RvdHlwZS5iaW5kKSB7XG5cblx0Ly8gTUROXG5cdC8vIFBvbHlmaWxsIElFOCwgZG9lcyBub3Qgc3VwcG9ydCBuYXRpdmUgRnVuY3Rpb24uYmluZFxuXHRGdW5jdGlvbi5wcm90b3R5cGUuYmluZCA9IGZ1bmN0aW9uKGIpIHtcblxuXHRcdGlmICh0eXBlb2YgdGhpcyAhPT0gJ2Z1bmN0aW9uJykge1xuXHRcdFx0dGhyb3cgbmV3IFR5cGVFcnJvcignRnVuY3Rpb24ucHJvdG90eXBlLmJpbmQgLSB3aGF0IGlzIHRyeWluZyB0byBiZSBib3VuZCBpcyBub3QgY2FsbGFibGUnKTtcblx0XHR9XG5cblx0XHRmdW5jdGlvbiBDKCkge31cblxuXHRcdHZhciBhID0gW10uc2xpY2U7XG5cdFx0dmFyIGYgPSBhLmNhbGwoYXJndW1lbnRzLCAxKTtcblx0XHR2YXIgX3RoaXMgPSB0aGlzO1xuXHRcdHZhciBEID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRyZXR1cm4gX3RoaXMuYXBwbHkodGhpcyBpbnN0YW5jZW9mIEMgPyB0aGlzIDogYiB8fCB3aW5kb3csIGYuY29uY2F0KGEuY2FsbChhcmd1bWVudHMpKSk7XG5cdFx0fTtcblxuXHRcdEMucHJvdG90eXBlID0gdGhpcy5wcm90b3R5cGU7XG5cdFx0RC5wcm90b3R5cGUgPSBuZXcgQygpO1xuXG5cdFx0cmV0dXJuIEQ7XG5cdH07XG5cbn1cblxuLyoqXG4gKiBAaGVsbG8uanNcbiAqXG4gKiBIZWxsb0pTIGlzIGEgY2xpZW50IHNpZGUgSmF2YXNjcmlwdCBTREsgZm9yIG1ha2luZyBPQXV0aDIgbG9naW5zIGFuZCBzdWJzZXF1ZW50IFJFU1QgY2FsbHMuXG4gKlxuICogQGF1dGhvciBBbmRyZXcgRG9kc29uXG4gKiBAd2Vic2l0ZSBodHRwczovL2Fkb2Rzb24uY29tL2hlbGxvLmpzL1xuICpcbiAqIEBjb3B5cmlnaHQgQW5kcmV3IERvZHNvbiwgMjAxMiAtIDIwMTVcbiAqIEBsaWNlbnNlIE1JVDogWW91IGFyZSBmcmVlIHRvIHVzZSBhbmQgbW9kaWZ5IHRoaXMgY29kZSBmb3IgYW55IHVzZSwgb24gdGhlIGNvbmRpdGlvbiB0aGF0IHRoaXMgY29weXJpZ2h0IG5vdGljZSByZW1haW5zLlxuICovXG5cbnZhciBoZWxsbyA9IGZ1bmN0aW9uKG5hbWUpIHtcblx0cmV0dXJuIGhlbGxvLnVzZShuYW1lKTtcbn07XG5cbmhlbGxvLnV0aWxzID0ge1xuXG5cdC8vIEV4dGVuZCB0aGUgZmlyc3Qgb2JqZWN0IHdpdGggdGhlIHByb3BlcnRpZXMgYW5kIG1ldGhvZHMgb2YgdGhlIHNlY29uZFxuXHRleHRlbmQ6IGZ1bmN0aW9uKHIgLyosIGFbLCBiWywgLi4uXV0gKi8pIHtcblxuXHRcdC8vIEdldCB0aGUgYXJndW1lbnRzIGFzIGFuIGFycmF5IGJ1dCBvbW1pdCB0aGUgaW5pdGlhbCBpdGVtXG5cdFx0QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKS5mb3JFYWNoKGZ1bmN0aW9uKGEpIHtcblx0XHRcdGlmIChBcnJheS5pc0FycmF5KHIpICYmIEFycmF5LmlzQXJyYXkoYSkpIHtcblx0XHRcdFx0QXJyYXkucHJvdG90eXBlLnB1c2guYXBwbHkociwgYSk7XG5cdFx0XHR9XG5cdFx0XHRlbHNlIGlmIChyIGluc3RhbmNlb2YgT2JqZWN0ICYmIGEgaW5zdGFuY2VvZiBPYmplY3QgJiYgciAhPT0gYSkge1xuXHRcdFx0XHRmb3IgKHZhciB4IGluIGEpIHtcblx0XHRcdFx0XHRyW3hdID0gaGVsbG8udXRpbHMuZXh0ZW5kKHJbeF0sIGFbeF0pO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRlbHNlIHtcblxuXHRcdFx0XHRpZiAoQXJyYXkuaXNBcnJheShhKSkge1xuXHRcdFx0XHRcdC8vIENsb25lIGl0XG5cdFx0XHRcdFx0YSA9IGEuc2xpY2UoMCk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRyID0gYTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdHJldHVybiByO1xuXHR9XG59O1xuXG4vLyBDb3JlIGxpYnJhcnlcbmhlbGxvLnV0aWxzLmV4dGVuZChoZWxsbywge1xuXG5cdHNldHRpbmdzOiB7XG5cblx0XHQvLyBPQXV0aDIgYXV0aGVudGljYXRpb24gZGVmYXVsdHNcblx0XHRyZWRpcmVjdF91cmk6IHdpbmRvdy5sb2NhdGlvbi5ocmVmLnNwbGl0KCcjJylbMF0sXG5cdFx0cmVzcG9uc2VfdHlwZTogJ3Rva2VuJyxcblx0XHRkaXNwbGF5OiAncG9wdXAnLFxuXHRcdHN0YXRlOiAnJyxcblxuXHRcdC8vIE9BdXRoMSBzaGltXG5cdFx0Ly8gVGhlIHBhdGggdG8gdGhlIE9BdXRoMSBzZXJ2ZXIgZm9yIHNpZ25pbmcgdXNlciByZXF1ZXN0c1xuXHRcdC8vIFdhbnQgdG8gcmVjcmVhdGUgeW91ciBvd24/IENoZWNrb3V0IGh0dHBzOi8vZ2l0aHViLmNvbS9NclN3aXRjaC9ub2RlLW9hdXRoLXNoaW1cblx0XHRvYXV0aF9wcm94eTogJ2h0dHBzOi8vYXV0aC1zZXJ2ZXIuaGVyb2t1YXBwLmNvbS9wcm94eScsXG5cblx0XHQvLyBBUEkgdGltZW91dCBpbiBtaWxsaXNlY29uZHNcblx0XHR0aW1lb3V0OiAyMDAwMCxcblxuXHRcdC8vIFBvcHVwIE9wdGlvbnNcblx0XHRwb3B1cDoge1xuXHRcdFx0cmVzaXphYmxlOiAxLFxuXHRcdFx0c2Nyb2xsYmFyczogMSxcblx0XHRcdHdpZHRoOiA1MDAsXG5cdFx0XHRoZWlnaHQ6IDU1MFxuXHRcdH0sXG5cblx0XHQvLyBEZWZhdWx0IHNjb3BlXG5cdFx0Ly8gTWFueSBzZXJ2aWNlcyByZXF1aXJlIGF0bGVhc3QgYSBwcm9maWxlIHNjb3BlLFxuXHRcdC8vIEhlbGxvSlMgYXV0b21hdGlhbGx5IGluY2x1ZGVzIHRoZSB2YWx1ZSBvZiBwcm92aWRlci5zY29wZV9tYXAuYmFzaWNcblx0XHQvLyBJZiB0aGF0J3Mgbm90IHJlcXVpcmVkIGl0IGNhbiBiZSByZW1vdmVkIHZpYSBoZWxsby5zZXR0aW5ncy5zY29wZS5sZW5ndGggPSAwO1xuXHRcdHNjb3BlOiBbJ2Jhc2ljJ10sXG5cblx0XHQvLyBTY29wZSBNYXBzXG5cdFx0Ly8gVGhpcyBpcyB0aGUgZGVmYXVsdCBtb2R1bGUgc2NvcGUsIHRoZXNlIGFyZSB0aGUgZGVmYXVsdHMgd2hpY2ggZWFjaCBzZXJ2aWNlIGlzIG1hcHBlZCB0b28uXG5cdFx0Ly8gQnkgaW5jbHVkaW5nIHRoZW0gaGVyZSBpdCBwcmV2ZW50cyB0aGUgc2NvcGUgZnJvbSBiZWluZyBhcHBsaWVkIGFjY2lkZW50YWxseVxuXHRcdHNjb3BlX21hcDoge1xuXHRcdFx0YmFzaWM6ICcnXG5cdFx0fSxcblxuXHRcdC8vIERlZmF1bHQgc2VydmljZSAvIG5ldHdvcmtcblx0XHRkZWZhdWx0X3NlcnZpY2U6IG51bGwsXG5cblx0XHQvLyBGb3JjZSBhdXRoZW50aWNhdGlvblxuXHRcdC8vIFdoZW4gaGVsbG8ubG9naW4gaXMgZmlyZWQuXG5cdFx0Ly8gKG51bGwpOiBpZ25vcmUgY3VycmVudCBzZXNzaW9uIGV4cGlyeSBhbmQgY29udGludWUgd2l0aCBsb2dpblxuXHRcdC8vICh0cnVlKTogaWdub3JlIGN1cnJlbnQgc2Vzc2lvbiBleHBpcnkgYW5kIGNvbnRpbnVlIHdpdGggbG9naW4sIGFzayBmb3IgdXNlciB0byByZWF1dGhlbnRpY2F0ZVxuXHRcdC8vIChmYWxzZSk6IGlmIHRoZSBjdXJyZW50IHNlc3Npb24gbG9va3MgZ29vZCBmb3IgdGhlIHJlcXVlc3Qgc2NvcGVzIHJldHVybiB0aGUgY3VycmVudCBzZXNzaW9uLlxuXHRcdGZvcmNlOiBudWxsLFxuXG5cdFx0Ly8gUGFnZSBVUkxcblx0XHQvLyBXaGVuICdkaXNwbGF5PXBhZ2UnIHRoaXMgcHJvcGVydHkgZGVmaW5lcyB3aGVyZSB0aGUgdXNlcnMgcGFnZSBzaG91bGQgZW5kIHVwIGFmdGVyIHJlZGlyZWN0X3VyaVxuXHRcdC8vIFRocyBjb3VsZCBiZSBwcm9ibGVtYXRpYyBpZiB0aGUgcmVkaXJlY3RfdXJpIGlzIGluZGVlZCB0aGUgZmluYWwgcGxhY2UsXG5cdFx0Ly8gVHlwaWNhbGx5IHRoaXMgY2lyY3VtdmVudHMgdGhlIHByb2JsZW0gb2YgdGhlIHJlZGlyZWN0X3VybCBiZWluZyBhIGR1bWIgcmVsYXkgcGFnZS5cblx0XHRwYWdlX3VyaTogd2luZG93LmxvY2F0aW9uLmhyZWZcblx0fSxcblxuXHQvLyBTZXJ2aWNlIGNvbmZpZ3VyYXRpb24gb2JqZWN0c1xuXHRzZXJ2aWNlczoge30sXG5cblx0Ly8gVXNlXG5cdC8vIERlZmluZSBhIG5ldyBpbnN0YW5jZSBvZiB0aGUgSGVsbG9KUyBsaWJyYXJ5IHdpdGggYSBkZWZhdWx0IHNlcnZpY2Vcblx0dXNlOiBmdW5jdGlvbihzZXJ2aWNlKSB7XG5cblx0XHQvLyBDcmVhdGUgc2VsZiwgd2hpY2ggaW5oZXJpdHMgZnJvbSBpdHMgcGFyZW50XG5cdFx0dmFyIHNlbGYgPSBPYmplY3QuY3JlYXRlKHRoaXMpO1xuXG5cdFx0Ly8gSW5oZXJpdCB0aGUgcHJvdG90eXBlIGZyb20gaXRzIHBhcmVudFxuXHRcdHNlbGYuc2V0dGluZ3MgPSBPYmplY3QuY3JlYXRlKHRoaXMuc2V0dGluZ3MpO1xuXG5cdFx0Ly8gRGVmaW5lIHRoZSBkZWZhdWx0IHNlcnZpY2Vcblx0XHRpZiAoc2VydmljZSkge1xuXHRcdFx0c2VsZi5zZXR0aW5ncy5kZWZhdWx0X3NlcnZpY2UgPSBzZXJ2aWNlO1xuXHRcdH1cblxuXHRcdC8vIENyZWF0ZSBhbiBpbnN0YW5jZSBvZiBFdmVudHNcblx0XHRzZWxmLnV0aWxzLkV2ZW50LmNhbGwoc2VsZik7XG5cblx0XHRyZXR1cm4gc2VsZjtcblx0fSxcblxuXHQvLyBJbml0aWFsaXplXG5cdC8vIERlZmluZSB0aGUgY2xpZW50X2lkcyBmb3IgdGhlIGVuZHBvaW50IHNlcnZpY2VzXG5cdC8vIEBwYXJhbSBvYmplY3QgbywgY29udGFpbnMgYSBrZXkgdmFsdWUgcGFpciwgc2VydmljZSA9PiBjbGllbnRJZFxuXHQvLyBAcGFyYW0gb2JqZWN0IG9wdHMsIGNvbnRhaW5zIGEga2V5IHZhbHVlIHBhaXIgb2Ygb3B0aW9ucyB1c2VkIGZvciBkZWZpbmluZyB0aGUgYXV0aGVudGljYXRpb24gZGVmYXVsdHNcblx0Ly8gQHBhcmFtIG51bWJlciB0aW1lb3V0LCB0aW1lb3V0IGluIHNlY29uZHNcblx0aW5pdDogZnVuY3Rpb24oc2VydmljZXMsIG9wdGlvbnMpIHtcblxuXHRcdHZhciB1dGlscyA9IHRoaXMudXRpbHM7XG5cblx0XHRpZiAoIXNlcnZpY2VzKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5zZXJ2aWNlcztcblx0XHR9XG5cblx0XHQvLyBEZWZpbmUgcHJvdmlkZXIgY3JlZGVudGlhbHNcblx0XHQvLyBSZWZvcm1hdCB0aGUgSUQgZmllbGRcblx0XHRmb3IgKHZhciB4IGluIHNlcnZpY2VzKSB7aWYgKHNlcnZpY2VzLmhhc093blByb3BlcnR5KHgpKSB7XG5cdFx0XHRpZiAodHlwZW9mIChzZXJ2aWNlc1t4XSkgIT09ICdvYmplY3QnKSB7XG5cdFx0XHRcdHNlcnZpY2VzW3hdID0ge2lkOiBzZXJ2aWNlc1t4XX07XG5cdFx0XHR9XG5cdFx0fX1cblxuXHRcdC8vIE1lcmdlIHNlcnZpY2VzIGlmIHRoZXJlIGFscmVhZHkgZXhpc3RzIHNvbWVcblx0XHR1dGlscy5leHRlbmQodGhpcy5zZXJ2aWNlcywgc2VydmljZXMpO1xuXG5cdFx0Ly8gVXBkYXRlIHRoZSBkZWZhdWx0IHNldHRpbmdzIHdpdGggdGhpcyBvbmUuXG5cdFx0aWYgKG9wdGlvbnMpIHtcblx0XHRcdHV0aWxzLmV4dGVuZCh0aGlzLnNldHRpbmdzLCBvcHRpb25zKTtcblxuXHRcdFx0Ly8gRG8gdGhpcyBpbW1lZGlhdGx5IGluY2FzZSB0aGUgYnJvd3NlciBjaGFuZ2VzIHRoZSBjdXJyZW50IHBhdGguXG5cdFx0XHRpZiAoJ3JlZGlyZWN0X3VyaScgaW4gb3B0aW9ucykge1xuXHRcdFx0XHR0aGlzLnNldHRpbmdzLnJlZGlyZWN0X3VyaSA9IHV0aWxzLnVybChvcHRpb25zLnJlZGlyZWN0X3VyaSkuaHJlZjtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblxuXHQvLyBMb2dpblxuXHQvLyBVc2luZyB0aGUgZW5kcG9pbnRcblx0Ly8gQHBhcmFtIG5ldHdvcmsgc3RyaW5naWZ5ICAgICAgIG5hbWUgdG8gY29ubmVjdCB0b1xuXHQvLyBAcGFyYW0gb3B0aW9ucyBvYmplY3QgICAgKG9wdGlvbmFsKSAge2Rpc3BsYXkgbW9kZSwgaXMgZWl0aGVyIG5vbmV8cG9wdXAoZGVmYXVsdCl8cGFnZSwgc2NvcGU6IGVtYWlsLGJpcnRoZGF5LHB1Ymxpc2gsIC4uIH1cblx0Ly8gQHBhcmFtIGNhbGxiYWNrICBmdW5jdGlvbiAgKG9wdGlvbmFsKSAgZmlyZWQgb24gc2lnbmluXG5cdGxvZ2luOiBmdW5jdGlvbigpIHtcblxuXHRcdC8vIENyZWF0ZSBhbiBvYmplY3Qgd2hpY2ggaW5oZXJpdHMgaXRzIHBhcmVudCBhcyB0aGUgcHJvdG90eXBlIGFuZCBjb25zdHJ1Y3RzIGEgbmV3IGV2ZW50IGNoYWluLlxuXHRcdHZhciBfdGhpcyA9IHRoaXM7XG5cdFx0dmFyIHV0aWxzID0gX3RoaXMudXRpbHM7XG5cdFx0dmFyIGVycm9yID0gdXRpbHMuZXJyb3I7XG5cdFx0dmFyIHByb21pc2UgPSB1dGlscy5Qcm9taXNlKCk7XG5cblx0XHQvLyBHZXQgcGFyYW1ldGVyc1xuXHRcdHZhciBwID0gdXRpbHMuYXJncyh7bmV0d29yazogJ3MnLCBvcHRpb25zOiAnbycsIGNhbGxiYWNrOiAnZid9LCBhcmd1bWVudHMpO1xuXG5cdFx0Ly8gTG9jYWwgdmFyc1xuXHRcdHZhciB1cmw7XG5cblx0XHQvLyBHZXQgYWxsIHRoZSBjdXN0b20gb3B0aW9ucyBhbmQgc3RvcmUgdG8gYmUgYXBwZW5kZWQgdG8gdGhlIHF1ZXJ5c3RyaW5nXG5cdFx0dmFyIHFzID0gdXRpbHMuZGlmZktleShwLm9wdGlvbnMsIF90aGlzLnNldHRpbmdzKTtcblxuXHRcdC8vIE1lcmdlL292ZXJyaWRlIG9wdGlvbnMgd2l0aCBhcHAgZGVmYXVsdHNcblx0XHR2YXIgb3B0cyA9IHAub3B0aW9ucyA9IHV0aWxzLm1lcmdlKF90aGlzLnNldHRpbmdzLCBwLm9wdGlvbnMgfHwge30pO1xuXG5cdFx0Ly8gTWVyZ2Uvb3ZlcnJpZGUgb3B0aW9ucyB3aXRoIGFwcCBkZWZhdWx0c1xuXHRcdG9wdHMucG9wdXAgPSB1dGlscy5tZXJnZShfdGhpcy5zZXR0aW5ncy5wb3B1cCwgcC5vcHRpb25zLnBvcHVwIHx8IHt9KTtcblxuXHRcdC8vIE5ldHdvcmtcblx0XHRwLm5ldHdvcmsgPSBwLm5ldHdvcmsgfHwgX3RoaXMuc2V0dGluZ3MuZGVmYXVsdF9zZXJ2aWNlO1xuXG5cdFx0Ly8gQmluZCBjYWxsYmFjayB0byBib3RoIHJlamVjdCBhbmQgZnVsZmlsbCBzdGF0ZXNcblx0XHRwcm9taXNlLnByb3h5LnRoZW4ocC5jYWxsYmFjaywgcC5jYWxsYmFjayk7XG5cblx0XHQvLyBUcmlnZ2VyIGFuIGV2ZW50IG9uIHRoZSBnbG9iYWwgbGlzdGVuZXJcblx0XHRmdW5jdGlvbiBlbWl0KHMsIHZhbHVlKSB7XG5cdFx0XHRoZWxsby5lbWl0KHMsIHZhbHVlKTtcblx0XHR9XG5cblx0XHRwcm9taXNlLnByb3h5LnRoZW4oZW1pdC5iaW5kKHRoaXMsICdhdXRoLmxvZ2luIGF1dGgnKSwgZW1pdC5iaW5kKHRoaXMsICdhdXRoLmZhaWxlZCBhdXRoJykpO1xuXG5cdFx0Ly8gSXMgb3VyIHNlcnZpY2UgdmFsaWQ/XG5cdFx0aWYgKHR5cGVvZiAocC5uZXR3b3JrKSAhPT0gJ3N0cmluZycgfHwgIShwLm5ldHdvcmsgaW4gX3RoaXMuc2VydmljZXMpKSB7XG5cdFx0XHQvLyBUcmlnZ2VyIHRoZSBkZWZhdWx0IGxvZ2luLlxuXHRcdFx0Ly8gQWhoIHdlIGRvbnQgaGF2ZSBvbmUuXG5cdFx0XHRyZXR1cm4gcHJvbWlzZS5yZWplY3QoZXJyb3IoJ2ludmFsaWRfbmV0d29yaycsICdUaGUgcHJvdmlkZWQgbmV0d29yayB3YXMgbm90IHJlY29nbml6ZWQnKSk7XG5cdFx0fVxuXG5cdFx0dmFyIHByb3ZpZGVyID0gX3RoaXMuc2VydmljZXNbcC5uZXR3b3JrXTtcblxuXHRcdC8vIENyZWF0ZSBhIGdsb2JhbCBsaXN0ZW5lciB0byBjYXB0dXJlIGV2ZW50cyB0cmlnZ2VyZWQgb3V0IG9mIHNjb3BlXG5cdFx0dmFyIGNhbGxiYWNrSWQgPSB1dGlscy5nbG9iYWxFdmVudChmdW5jdGlvbihzdHIpIHtcblxuXHRcdFx0Ly8gVGhlIHJlc3BvbnNlSGFuZGxlciByZXR1cm5zIGEgc3RyaW5nLCBsZXRzIHNhdmUgdGhpcyBsb2NhbGx5XG5cdFx0XHR2YXIgb2JqO1xuXG5cdFx0XHRpZiAoc3RyKSB7XG5cdFx0XHRcdG9iaiA9IEpTT04ucGFyc2Uoc3RyKTtcblx0XHRcdH1cblx0XHRcdGVsc2Uge1xuXHRcdFx0XHRvYmogPSBlcnJvcignY2FuY2VsbGVkJywgJ1RoZSBhdXRoZW50aWNhdGlvbiB3YXMgbm90IGNvbXBsZXRlZCcpO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBIYW5kbGUgdGhlc2UgcmVzcG9uc2UgdXNpbmcgdGhlIGxvY2FsXG5cdFx0XHQvLyBUcmlnZ2VyIG9uIHRoZSBwYXJlbnRcblx0XHRcdGlmICghb2JqLmVycm9yKSB7XG5cblx0XHRcdFx0Ly8gU2F2ZSBvbiB0aGUgcGFyZW50IHdpbmRvdyB0aGUgbmV3IGNyZWRlbnRpYWxzXG5cdFx0XHRcdC8vIFRoaXMgZml4ZXMgYW4gSUUxMCBidWcgaSB0aGluay4uLiBhdGxlYXN0IGl0IGRvZXMgZm9yIG1lLlxuXHRcdFx0XHR1dGlscy5zdG9yZShvYmoubmV0d29yaywgb2JqKTtcblxuXHRcdFx0XHQvLyBGdWxmaWxsIGEgc3VjY2Vzc2Z1bCBsb2dpblxuXHRcdFx0XHRwcm9taXNlLmZ1bGZpbGwoe1xuXHRcdFx0XHRcdG5ldHdvcms6IG9iai5uZXR3b3JrLFxuXHRcdFx0XHRcdGF1dGhSZXNwb25zZTogb2JqXG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdFx0ZWxzZSB7XG5cdFx0XHRcdC8vIFJlamVjdCBhIHN1Y2Nlc3NmdWwgbG9naW5cblx0XHRcdFx0cHJvbWlzZS5yZWplY3Qob2JqKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdHZhciByZWRpcmVjdFVyaSA9IHV0aWxzLnVybChvcHRzLnJlZGlyZWN0X3VyaSkuaHJlZjtcblxuXHRcdC8vIE1heSBiZSBhIHNwYWNlLWRlbGltaXRlZCBsaXN0IG9mIG11bHRpcGxlLCBjb21wbGVtZW50YXJ5IHR5cGVzXG5cdFx0dmFyIHJlc3BvbnNlVHlwZSA9IHByb3ZpZGVyLm9hdXRoLnJlc3BvbnNlX3R5cGUgfHwgb3B0cy5yZXNwb25zZV90eXBlO1xuXG5cdFx0Ly8gRmFsbGJhY2sgdG8gdG9rZW4gaWYgdGhlIG1vZHVsZSBoYXNuJ3QgZGVmaW5lZCBhIGdyYW50IHVybFxuXHRcdGlmICgvXFxiY29kZVxcYi8udGVzdChyZXNwb25zZVR5cGUpICYmICFwcm92aWRlci5vYXV0aC5ncmFudCkge1xuXHRcdFx0cmVzcG9uc2VUeXBlID0gcmVzcG9uc2VUeXBlLnJlcGxhY2UoL1xcYmNvZGVcXGIvLCAndG9rZW4nKTtcblx0XHR9XG5cblx0XHQvLyBRdWVyeSBzdHJpbmcgcGFyYW1ldGVycywgd2UgbWF5IHBhc3Mgb3VyIG93biBhcmd1bWVudHMgdG8gZm9ybSB0aGUgcXVlcnlzdHJpbmdcblx0XHRwLnFzID0gdXRpbHMubWVyZ2UocXMsIHtcblx0XHRcdGNsaWVudF9pZDogZW5jb2RlVVJJQ29tcG9uZW50KHByb3ZpZGVyLmlkKSxcblx0XHRcdHJlc3BvbnNlX3R5cGU6IGVuY29kZVVSSUNvbXBvbmVudChyZXNwb25zZVR5cGUpLFxuXHRcdFx0cmVkaXJlY3RfdXJpOiBlbmNvZGVVUklDb21wb25lbnQocmVkaXJlY3RVcmkpLFxuXHRcdFx0c3RhdGU6IHtcblx0XHRcdFx0Y2xpZW50X2lkOiBwcm92aWRlci5pZCxcblx0XHRcdFx0bmV0d29yazogcC5uZXR3b3JrLFxuXHRcdFx0XHRkaXNwbGF5OiBvcHRzLmRpc3BsYXksXG5cdFx0XHRcdGNhbGxiYWNrOiBjYWxsYmFja0lkLFxuXHRcdFx0XHRzdGF0ZTogb3B0cy5zdGF0ZSxcblx0XHRcdFx0cmVkaXJlY3RfdXJpOiByZWRpcmVjdFVyaVxuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0Ly8gR2V0IGN1cnJlbnQgc2Vzc2lvbiBmb3IgbWVyZ2luZyBzY29wZXMsIGFuZCBmb3IgcXVpY2sgYXV0aCByZXNwb25zZVxuXHRcdHZhciBzZXNzaW9uID0gdXRpbHMuc3RvcmUocC5uZXR3b3JrKTtcblxuXHRcdC8vIFNjb3BlcyAoYXV0aGVudGljYXRpb24gcGVybWlzaW9ucylcblx0XHQvLyBFbnN1cmUgdGhpcyBpcyBhIHN0cmluZyAtIElFIGhhcyBhIHByb2JsZW0gbW92aW5nIEFycmF5cyBiZXR3ZWVuIHdpbmRvd3Ncblx0XHQvLyBBcHBlbmQgdGhlIHNldHVwIHNjb3BlXG5cdFx0dmFyIFNDT1BFX1NQTElUID0gL1ssXFxzXSsvO1xuXG5cdFx0Ly8gSW5jbHVkZSBkZWZhdWx0IHNjb3BlIHNldHRpbmdzIChjbG9uZWQpLlxuXHRcdHZhciBzY29wZSA9IF90aGlzLnNldHRpbmdzLnNjb3BlID8gW190aGlzLnNldHRpbmdzLnNjb3BlLnRvU3RyaW5nKCldIDogW107XG5cblx0XHQvLyBFeHRlbmQgdGhlIHByb3ZpZGVycyBzY29wZSBsaXN0IHdpdGggdGhlIGRlZmF1bHRcblx0XHR2YXIgc2NvcGVNYXAgPSB1dGlscy5tZXJnZShfdGhpcy5zZXR0aW5ncy5zY29wZV9tYXAsIHByb3ZpZGVyLnNjb3BlIHx8IHt9KTtcblxuXHRcdC8vIEFkZCB1c2VyIGRlZmluZWQgc2NvcGVzLi4uXG5cdFx0aWYgKG9wdHMuc2NvcGUpIHtcblx0XHRcdHNjb3BlLnB1c2gob3B0cy5zY29wZS50b1N0cmluZygpKTtcblx0XHR9XG5cblx0XHQvLyBBcHBlbmQgc2NvcGVzIGZyb20gYSBwcmV2aW91cyBzZXNzaW9uLlxuXHRcdC8vIFRoaXMgaGVscHMga2VlcCBhcHAgY3JlZGVudGlhbHMgY29uc3RhbnQsXG5cdFx0Ly8gQXZvaWRpbmcgaGF2aW5nIHRvIGtlZXAgdGFicyBvbiB3aGF0IHNjb3BlcyBhcmUgYXV0aG9yaXplZFxuXHRcdGlmIChzZXNzaW9uICYmICdzY29wZScgaW4gc2Vzc2lvbiAmJiBzZXNzaW9uLnNjb3BlIGluc3RhbmNlb2YgU3RyaW5nKSB7XG5cdFx0XHRzY29wZS5wdXNoKHNlc3Npb24uc2NvcGUpO1xuXHRcdH1cblxuXHRcdC8vIEpvaW4gYW5kIFNwbGl0IGFnYWluXG5cdFx0c2NvcGUgPSBzY29wZS5qb2luKCcsJykuc3BsaXQoU0NPUEVfU1BMSVQpO1xuXG5cdFx0Ly8gRm9ybWF0IHJlbW92ZSBkdXBsaWNhdGVzIGFuZCBlbXB0eSB2YWx1ZXNcblx0XHRzY29wZSA9IHV0aWxzLnVuaXF1ZShzY29wZSkuZmlsdGVyKGZpbHRlckVtcHR5KTtcblxuXHRcdC8vIFNhdmUgdGhlIHRoZSBzY29wZXMgdG8gdGhlIHN0YXRlIHdpdGggdGhlIG5hbWVzIHRoYXQgdGhleSB3ZXJlIHJlcXVlc3RlZCB3aXRoLlxuXHRcdHAucXMuc3RhdGUuc2NvcGUgPSBzY29wZS5qb2luKCcsJyk7XG5cblx0XHQvLyBNYXAgc2NvcGVzIHRvIHRoZSBwcm92aWRlcnMgbmFtaW5nIGNvbnZlbnRpb25cblx0XHRzY29wZSA9IHNjb3BlLm1hcChmdW5jdGlvbihpdGVtKSB7XG5cdFx0XHQvLyBEb2VzIHRoaXMgaGF2ZSBhIG1hcHBpbmc/XG5cdFx0XHRyZXR1cm4gKGl0ZW0gaW4gc2NvcGVNYXApID8gc2NvcGVNYXBbaXRlbV0gOiBpdGVtO1xuXHRcdH0pO1xuXG5cdFx0Ly8gU3RyaW5naWZ5IGFuZCBBcnJheWlmeSBzbyB0aGF0IGRvdWJsZSBtYXBwZWQgc2NvcGVzIGFyZSBnaXZlbiB0aGUgY2hhbmNlIHRvIGJlIGZvcm1hdHRlZFxuXHRcdHNjb3BlID0gc2NvcGUuam9pbignLCcpLnNwbGl0KFNDT1BFX1NQTElUKTtcblxuXHRcdC8vIEFnYWluLi4uXG5cdFx0Ly8gRm9ybWF0IHJlbW92ZSBkdXBsaWNhdGVzIGFuZCBlbXB0eSB2YWx1ZXNcblx0XHRzY29wZSA9IHV0aWxzLnVuaXF1ZShzY29wZSkuZmlsdGVyKGZpbHRlckVtcHR5KTtcblxuXHRcdC8vIEpvaW4gd2l0aCB0aGUgZXhwZWN0ZWQgc2NvcGUgZGVsaW1pdGVyIGludG8gYSBzdHJpbmdcblx0XHRwLnFzLnNjb3BlID0gc2NvcGUuam9pbihwcm92aWRlci5zY29wZV9kZWxpbSB8fCAnLCcpO1xuXG5cdFx0Ly8gSXMgdGhlIHVzZXIgYWxyZWFkeSBzaWduZWQgaW4gd2l0aCB0aGUgYXBwcm9wcmlhdGUgc2NvcGVzLCB2YWxpZCBhY2Nlc3NfdG9rZW4/XG5cdFx0aWYgKG9wdHMuZm9yY2UgPT09IGZhbHNlKSB7XG5cblx0XHRcdGlmIChzZXNzaW9uICYmICdhY2Nlc3NfdG9rZW4nIGluIHNlc3Npb24gJiYgc2Vzc2lvbi5hY2Nlc3NfdG9rZW4gJiYgJ2V4cGlyZXMnIGluIHNlc3Npb24gJiYgc2Vzc2lvbi5leHBpcmVzID4gKChuZXcgRGF0ZSgpKS5nZXRUaW1lKCkgLyAxZTMpKSB7XG5cdFx0XHRcdC8vIFdoYXQgaXMgZGlmZmVyZW50IGFib3V0IHRoZSBzY29wZXMgaW4gdGhlIHNlc3Npb24gdnMgdGhlIHNjb3BlcyBpbiB0aGUgbmV3IGxvZ2luP1xuXHRcdFx0XHR2YXIgZGlmZiA9IHV0aWxzLmRpZmYoKHNlc3Npb24uc2NvcGUgfHwgJycpLnNwbGl0KFNDT1BFX1NQTElUKSwgKHAucXMuc3RhdGUuc2NvcGUgfHwgJycpLnNwbGl0KFNDT1BFX1NQTElUKSk7XG5cdFx0XHRcdGlmIChkaWZmLmxlbmd0aCA9PT0gMCkge1xuXG5cdFx0XHRcdFx0Ly8gT0sgdHJpZ2dlciB0aGUgY2FsbGJhY2tcblx0XHRcdFx0XHRwcm9taXNlLmZ1bGZpbGwoe1xuXHRcdFx0XHRcdFx0dW5jaGFuZ2VkOiB0cnVlLFxuXHRcdFx0XHRcdFx0bmV0d29yazogcC5uZXR3b3JrLFxuXHRcdFx0XHRcdFx0YXV0aFJlc3BvbnNlOiBzZXNzaW9uXG5cdFx0XHRcdFx0fSk7XG5cblx0XHRcdFx0XHQvLyBOb3RoaW5nIGhhcyBjaGFuZ2VkXG5cdFx0XHRcdFx0cmV0dXJuIHByb21pc2U7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBQYWdlIFVSTFxuXHRcdGlmIChvcHRzLmRpc3BsYXkgPT09ICdwYWdlJyAmJiBvcHRzLnBhZ2VfdXJpKSB7XG5cdFx0XHQvLyBBZGQgYSBwYWdlIGxvY2F0aW9uLCBwbGFjZSB0byBlbmR1cCBhZnRlciBzZXNzaW9uIGhhcyBhdXRoZW50aWNhdGVkXG5cdFx0XHRwLnFzLnN0YXRlLnBhZ2VfdXJpID0gdXRpbHMudXJsKG9wdHMucGFnZV91cmkpLmhyZWY7XG5cdFx0fVxuXG5cdFx0Ly8gQmVzcG9rZVxuXHRcdC8vIE92ZXJyaWRlIGxvZ2luIHF1ZXJ5c3RyaW5ncyBmcm9tIGF1dGhfb3B0aW9uc1xuXHRcdGlmICgnbG9naW4nIGluIHByb3ZpZGVyICYmIHR5cGVvZiAocHJvdmlkZXIubG9naW4pID09PSAnZnVuY3Rpb24nKSB7XG5cdFx0XHQvLyBGb3JtYXQgdGhlIHBhcmFtYXRlcnMgYWNjb3JkaW5nIHRvIHRoZSBwcm92aWRlcnMgZm9ybWF0dGluZyBmdW5jdGlvblxuXHRcdFx0cHJvdmlkZXIubG9naW4ocCk7XG5cdFx0fVxuXG5cdFx0Ly8gQWRkIE9BdXRoIHRvIHN0YXRlXG5cdFx0Ly8gV2hlcmUgdGhlIHNlcnZpY2UgaXMgZ29pbmcgdG8gdGFrZSBhZHZhbnRhZ2Ugb2YgdGhlIG9hdXRoX3Byb3h5XG5cdFx0aWYgKCEvXFxidG9rZW5cXGIvLnRlc3QocmVzcG9uc2VUeXBlKSB8fFxuXHRcdHBhcnNlSW50KHByb3ZpZGVyLm9hdXRoLnZlcnNpb24sIDEwKSA8IDIgfHxcblx0XHQob3B0cy5kaXNwbGF5ID09PSAnbm9uZScgJiYgcHJvdmlkZXIub2F1dGguZ3JhbnQgJiYgc2Vzc2lvbiAmJiBzZXNzaW9uLnJlZnJlc2hfdG9rZW4pKSB7XG5cblx0XHRcdC8vIEFkZCB0aGUgb2F1dGggZW5kcG9pbnRzXG5cdFx0XHRwLnFzLnN0YXRlLm9hdXRoID0gcHJvdmlkZXIub2F1dGg7XG5cblx0XHRcdC8vIEFkZCB0aGUgcHJveHkgdXJsXG5cdFx0XHRwLnFzLnN0YXRlLm9hdXRoX3Byb3h5ID0gb3B0cy5vYXV0aF9wcm94eTtcblxuXHRcdH1cblxuXHRcdC8vIENvbnZlcnQgc3RhdGUgdG8gYSBzdHJpbmdcblx0XHRwLnFzLnN0YXRlID0gZW5jb2RlVVJJQ29tcG9uZW50KEpTT04uc3RyaW5naWZ5KHAucXMuc3RhdGUpKTtcblxuXHRcdC8vIFVSTFxuXHRcdGlmIChwYXJzZUludChwcm92aWRlci5vYXV0aC52ZXJzaW9uLCAxMCkgPT09IDEpIHtcblxuXHRcdFx0Ly8gVHVybiB0aGUgcmVxdWVzdCB0byB0aGUgT0F1dGggUHJveHkgZm9yIDMtbGVnZ2VkIGF1dGhcblx0XHRcdHVybCA9IHV0aWxzLnFzKG9wdHMub2F1dGhfcHJveHksIHAucXMsIGVuY29kZUZ1bmN0aW9uKTtcblx0XHR9XG5cblx0XHQvLyBSZWZyZXNoIHRva2VuXG5cdFx0ZWxzZSBpZiAob3B0cy5kaXNwbGF5ID09PSAnbm9uZScgJiYgcHJvdmlkZXIub2F1dGguZ3JhbnQgJiYgc2Vzc2lvbiAmJiBzZXNzaW9uLnJlZnJlc2hfdG9rZW4pIHtcblxuXHRcdFx0Ly8gQWRkIHRoZSByZWZyZXNoX3Rva2VuIHRvIHRoZSByZXF1ZXN0XG5cdFx0XHRwLnFzLnJlZnJlc2hfdG9rZW4gPSBzZXNzaW9uLnJlZnJlc2hfdG9rZW47XG5cblx0XHRcdC8vIERlZmluZSB0aGUgcmVxdWVzdCBwYXRoXG5cdFx0XHR1cmwgPSB1dGlscy5xcyhvcHRzLm9hdXRoX3Byb3h5LCBwLnFzLCBlbmNvZGVGdW5jdGlvbik7XG5cdFx0fVxuXHRcdGVsc2Uge1xuXHRcdFx0dXJsID0gdXRpbHMucXMocHJvdmlkZXIub2F1dGguYXV0aCwgcC5xcywgZW5jb2RlRnVuY3Rpb24pO1xuXHRcdH1cblxuXHRcdC8vIEJyb2FkY2FzdCB0aGlzIGV2ZW50IGFzIGFuIGF1dGg6aW5pdFxuXHRcdGVtaXQoJ2F1dGguaW5pdCcsIHApO1xuXG5cdFx0Ly8gRXhlY3V0ZVxuXHRcdC8vIFRyaWdnZXIgaG93IHdlIHdhbnQgc2VsZiBkaXNwbGF5ZWRcblx0XHRpZiAob3B0cy5kaXNwbGF5ID09PSAnbm9uZScpIHtcblx0XHRcdC8vIFNpZ24taW4gaW4gdGhlIGJhY2tncm91bmQsIGlmcmFtZVxuXHRcdFx0dXRpbHMuaWZyYW1lKHVybCwgcmVkaXJlY3RVcmkpO1xuXHRcdH1cblxuXHRcdC8vIFRyaWdnZXJpbmcgcG9wdXA/XG5cdFx0ZWxzZSBpZiAob3B0cy5kaXNwbGF5ID09PSAncG9wdXAnKSB7XG5cblx0XHRcdHZhciBwb3B1cCA9IHV0aWxzLnBvcHVwKHVybCwgcmVkaXJlY3RVcmksIG9wdHMucG9wdXApO1xuXHRcdFx0dmFyIHRpbWVyID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGlmICghcG9wdXAgfHwgcG9wdXAuY2xvc2VkKSB7XG5cdFx0XHRcdFx0Y2xlYXJJbnRlcnZhbCh0aW1lcik7XG5cdFx0XHRcdFx0aWYgKCFwcm9taXNlLnN0YXRlKSB7XG5cblx0XHRcdFx0XHRcdHZhciByZXNwb25zZSA9IGVycm9yKCdjYW5jZWxsZWQnLCAnTG9naW4gaGFzIGJlZW4gY2FuY2VsbGVkJyk7XG5cblx0XHRcdFx0XHRcdGlmICghcG9wdXApIHtcblx0XHRcdFx0XHRcdFx0cmVzcG9uc2UgPSBlcnJvcignYmxvY2tlZCcsICdQb3B1cCB3YXMgYmxvY2tlZCcpO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRyZXNwb25zZS5uZXR3b3JrID0gcC5uZXR3b3JrO1xuXG5cdFx0XHRcdFx0XHRwcm9taXNlLnJlamVjdChyZXNwb25zZSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9LCAxMDApO1xuXHRcdH1cblxuXHRcdGVsc2Uge1xuXHRcdFx0d2luZG93LmxvY2F0aW9uID0gdXJsO1xuXHRcdH1cblxuXHRcdHJldHVybiBwcm9taXNlLnByb3h5O1xuXG5cdFx0ZnVuY3Rpb24gZW5jb2RlRnVuY3Rpb24ocykge3JldHVybiBzO31cblxuXHRcdGZ1bmN0aW9uIGZpbHRlckVtcHR5KHMpIHtyZXR1cm4gISFzO31cblx0fSxcblxuXHQvLyBSZW1vdmUgYW55IGRhdGEgYXNzb2NpYXRlZCB3aXRoIGEgZ2l2ZW4gc2VydmljZVxuXHQvLyBAcGFyYW0gc3RyaW5nIG5hbWUgb2YgdGhlIHNlcnZpY2Vcblx0Ly8gQHBhcmFtIGZ1bmN0aW9uIGNhbGxiYWNrXG5cdGxvZ291dDogZnVuY3Rpb24oKSB7XG5cblx0XHR2YXIgX3RoaXMgPSB0aGlzO1xuXHRcdHZhciB1dGlscyA9IF90aGlzLnV0aWxzO1xuXHRcdHZhciBlcnJvciA9IHV0aWxzLmVycm9yO1xuXG5cdFx0Ly8gQ3JlYXRlIGEgbmV3IHByb21pc2Vcblx0XHR2YXIgcHJvbWlzZSA9IHV0aWxzLlByb21pc2UoKTtcblxuXHRcdHZhciBwID0gdXRpbHMuYXJncyh7bmFtZToncycsIG9wdGlvbnM6ICdvJywgY2FsbGJhY2s6ICdmJ30sIGFyZ3VtZW50cyk7XG5cblx0XHRwLm9wdGlvbnMgPSBwLm9wdGlvbnMgfHwge307XG5cblx0XHQvLyBBZGQgY2FsbGJhY2sgdG8gZXZlbnRzXG5cdFx0cHJvbWlzZS5wcm94eS50aGVuKHAuY2FsbGJhY2ssIHAuY2FsbGJhY2spO1xuXG5cdFx0Ly8gVHJpZ2dlciBhbiBldmVudCBvbiB0aGUgZ2xvYmFsIGxpc3RlbmVyXG5cdFx0ZnVuY3Rpb24gZW1pdChzLCB2YWx1ZSkge1xuXHRcdFx0aGVsbG8uZW1pdChzLCB2YWx1ZSk7XG5cdFx0fVxuXG5cdFx0cHJvbWlzZS5wcm94eS50aGVuKGVtaXQuYmluZCh0aGlzLCAnYXV0aC5sb2dvdXQgYXV0aCcpLCBlbWl0LmJpbmQodGhpcywgJ2Vycm9yJykpO1xuXG5cdFx0Ly8gTmV0d29ya1xuXHRcdHAubmFtZSA9IHAubmFtZSB8fCB0aGlzLnNldHRpbmdzLmRlZmF1bHRfc2VydmljZTtcblx0XHRwLmF1dGhSZXNwb25zZSA9IHV0aWxzLnN0b3JlKHAubmFtZSk7XG5cblx0XHRpZiAocC5uYW1lICYmICEocC5uYW1lIGluIF90aGlzLnNlcnZpY2VzKSkge1xuXG5cdFx0XHRwcm9taXNlLnJlamVjdChlcnJvcignaW52YWxpZF9uZXR3b3JrJywgJ1RoZSBuZXR3b3JrIHdhcyB1bnJlY29nbml6ZWQnKSk7XG5cblx0XHR9XG5cdFx0ZWxzZSBpZiAocC5uYW1lICYmIHAuYXV0aFJlc3BvbnNlKSB7XG5cblx0XHRcdC8vIERlZmluZSB0aGUgY2FsbGJhY2tcblx0XHRcdHZhciBjYWxsYmFjayA9IGZ1bmN0aW9uKG9wdHMpIHtcblxuXHRcdFx0XHQvLyBSZW1vdmUgZnJvbSB0aGUgc3RvcmVcblx0XHRcdFx0dXRpbHMuc3RvcmUocC5uYW1lLCBudWxsKTtcblxuXHRcdFx0XHQvLyBFbWl0IGV2ZW50cyBieSBkZWZhdWx0XG5cdFx0XHRcdHByb21pc2UuZnVsZmlsbChoZWxsby51dGlscy5tZXJnZSh7bmV0d29yazpwLm5hbWV9LCBvcHRzIHx8IHt9KSk7XG5cdFx0XHR9O1xuXG5cdFx0XHQvLyBSdW4gYW4gYXN5bmMgb3BlcmF0aW9uIHRvIHJlbW92ZSB0aGUgdXNlcnMgc2Vzc2lvblxuXHRcdFx0dmFyIF9vcHRzID0ge307XG5cdFx0XHRpZiAocC5vcHRpb25zLmZvcmNlKSB7XG5cdFx0XHRcdHZhciBsb2dvdXQgPSBfdGhpcy5zZXJ2aWNlc1twLm5hbWVdLmxvZ291dDtcblx0XHRcdFx0aWYgKGxvZ291dCkge1xuXHRcdFx0XHRcdC8vIENvbnZlcnQgbG9nb3V0IHRvIFVSTCBzdHJpbmcsXG5cdFx0XHRcdFx0Ly8gSWYgbm8gc3RyaW5nIGlzIHJldHVybmVkLCB0aGVuIHRoaXMgZnVuY3Rpb24gd2lsbCBoYW5kbGUgdGhlIGxvZ291dCBhc3luYyBzdHlsZVxuXHRcdFx0XHRcdGlmICh0eXBlb2YgKGxvZ291dCkgPT09ICdmdW5jdGlvbicpIHtcblx0XHRcdFx0XHRcdGxvZ291dCA9IGxvZ291dChjYWxsYmFjaywgcCk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0Ly8gSWYgbG9nb3V0IGlzIGEgc3RyaW5nIHRoZW4gYXNzdW1lIFVSTCBhbmQgb3BlbiBpbiBpZnJhbWUuXG5cdFx0XHRcdFx0aWYgKHR5cGVvZiAobG9nb3V0KSA9PT0gJ3N0cmluZycpIHtcblx0XHRcdFx0XHRcdHV0aWxzLmlmcmFtZShsb2dvdXQpO1xuXHRcdFx0XHRcdFx0X29wdHMuZm9yY2UgPSBudWxsO1xuXHRcdFx0XHRcdFx0X29wdHMubWVzc2FnZSA9ICdMb2dvdXQgc3VjY2VzcyBvbiBwcm92aWRlcnMgc2l0ZSB3YXMgaW5kZXRlcm1pbmF0ZSc7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGVsc2UgaWYgKGxvZ291dCA9PT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRcdFx0XHQvLyBUaGUgY2FsbGJhY2sgZnVuY3Rpb24gd2lsbCBoYW5kbGUgdGhlIHJlc3BvbnNlLlxuXHRcdFx0XHRcdFx0cmV0dXJuIHByb21pc2UucHJveHk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdC8vIFJlbW92ZSBsb2NhbCBjcmVkZW50aWFsc1xuXHRcdFx0Y2FsbGJhY2soX29wdHMpO1xuXHRcdH1cblx0XHRlbHNlIHtcblx0XHRcdHByb21pc2UucmVqZWN0KGVycm9yKCdpbnZhbGlkX3Nlc3Npb24nLCAnVGhlcmUgd2FzIG5vIHNlc3Npb24gdG8gcmVtb3ZlJykpO1xuXHRcdH1cblxuXHRcdHJldHVybiBwcm9taXNlLnByb3h5O1xuXHR9LFxuXG5cdC8vIFJldHVybnMgYWxsIHRoZSBzZXNzaW9ucyB0aGF0IGFyZSBzdWJzY3JpYmVkIHRvb1xuXHQvLyBAcGFyYW0gc3RyaW5nIG9wdGlvbmFsLCBuYW1lIG9mIHRoZSBzZXJ2aWNlIHRvIGdldCBpbmZvcm1hdGlvbiBhYm91dC5cblx0Z2V0QXV0aFJlc3BvbnNlOiBmdW5jdGlvbihzZXJ2aWNlKSB7XG5cblx0XHQvLyBJZiB0aGUgc2VydmljZSBkb2Vzbid0IGV4aXN0XG5cdFx0c2VydmljZSA9IHNlcnZpY2UgfHwgdGhpcy5zZXR0aW5ncy5kZWZhdWx0X3NlcnZpY2U7XG5cblx0XHRpZiAoIXNlcnZpY2UgfHwgIShzZXJ2aWNlIGluIHRoaXMuc2VydmljZXMpKSB7XG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9XG5cblx0XHRyZXR1cm4gdGhpcy51dGlscy5zdG9yZShzZXJ2aWNlKSB8fCBudWxsO1xuXHR9LFxuXG5cdC8vIEV2ZW50czogcGxhY2Vob2xkZXIgZm9yIHRoZSBldmVudHNcblx0ZXZlbnRzOiB7fVxufSk7XG5cbi8vIENvcmUgdXRpbGl0aWVzXG5oZWxsby51dGlscy5leHRlbmQoaGVsbG8udXRpbHMsIHtcblxuXHQvLyBFcnJvclxuXHRlcnJvcjogZnVuY3Rpb24oY29kZSwgbWVzc2FnZSkge1xuXHRcdHJldHVybiB7XG5cdFx0XHRlcnJvcjoge1xuXHRcdFx0XHRjb2RlOiBjb2RlLFxuXHRcdFx0XHRtZXNzYWdlOiBtZXNzYWdlXG5cdFx0XHR9XG5cdFx0fTtcblx0fSxcblxuXHQvLyBBcHBlbmQgdGhlIHF1ZXJ5c3RyaW5nIHRvIGEgdXJsXG5cdC8vIEBwYXJhbSBzdHJpbmcgdXJsXG5cdC8vIEBwYXJhbSBvYmplY3QgcGFyYW1ldGVyc1xuXHRxczogZnVuY3Rpb24odXJsLCBwYXJhbXMsIGZvcm1hdEZ1bmN0aW9uKSB7XG5cblx0XHRpZiAocGFyYW1zKSB7XG5cblx0XHRcdC8vIFNldCBkZWZhdWx0IGZvcm1hdHRpbmcgZnVuY3Rpb25cblx0XHRcdGZvcm1hdEZ1bmN0aW9uID0gZm9ybWF0RnVuY3Rpb24gfHwgZW5jb2RlVVJJQ29tcG9uZW50O1xuXG5cdFx0XHQvLyBPdmVycmlkZSB0aGUgaXRlbXMgaW4gdGhlIFVSTCB3aGljaCBhbHJlYWR5IGV4aXN0XG5cdFx0XHRmb3IgKHZhciB4IGluIHBhcmFtcykge1xuXHRcdFx0XHR2YXIgc3RyID0gJyhbXFxcXD9cXFxcJl0pJyArIHggKyAnPVteXFxcXCZdKic7XG5cdFx0XHRcdHZhciByZWcgPSBuZXcgUmVnRXhwKHN0cik7XG5cdFx0XHRcdGlmICh1cmwubWF0Y2gocmVnKSkge1xuXHRcdFx0XHRcdHVybCA9IHVybC5yZXBsYWNlKHJlZywgJyQxJyArIHggKyAnPScgKyBmb3JtYXRGdW5jdGlvbihwYXJhbXNbeF0pKTtcblx0XHRcdFx0XHRkZWxldGUgcGFyYW1zW3hdO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0aWYgKCF0aGlzLmlzRW1wdHkocGFyYW1zKSkge1xuXHRcdFx0cmV0dXJuIHVybCArICh1cmwuaW5kZXhPZignPycpID4gLTEgPyAnJicgOiAnPycpICsgdGhpcy5wYXJhbShwYXJhbXMsIGZvcm1hdEZ1bmN0aW9uKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gdXJsO1xuXHR9LFxuXG5cdC8vIFBhcmFtXG5cdC8vIEV4cGxvZGUvZW5jb2RlIHRoZSBwYXJhbWV0ZXJzIG9mIGFuIFVSTCBzdHJpbmcvb2JqZWN0XG5cdC8vIEBwYXJhbSBzdHJpbmcgcywgc3RyaW5nIHRvIGRlY29kZVxuXHRwYXJhbTogZnVuY3Rpb24ocywgZm9ybWF0RnVuY3Rpb24pIHtcblx0XHR2YXIgYjtcblx0XHR2YXIgYSA9IHt9O1xuXHRcdHZhciBtO1xuXG5cdFx0aWYgKHR5cGVvZiAocykgPT09ICdzdHJpbmcnKSB7XG5cblx0XHRcdGZvcm1hdEZ1bmN0aW9uID0gZm9ybWF0RnVuY3Rpb24gfHwgZGVjb2RlVVJJQ29tcG9uZW50O1xuXG5cdFx0XHRtID0gcy5yZXBsYWNlKC9eW1xcI1xcP10vLCAnJykubWF0Y2goLyhbXj1cXC9cXCZdKyk9KFteXFwmXSspL2cpO1xuXHRcdFx0aWYgKG0pIHtcblx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBtLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0YiA9IG1baV0ubWF0Y2goLyhbXj1dKyk9KC4qKS8pO1xuXHRcdFx0XHRcdGFbYlsxXV0gPSBmb3JtYXRGdW5jdGlvbihiWzJdKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gYTtcblx0XHR9XG5cdFx0ZWxzZSB7XG5cblx0XHRcdGZvcm1hdEZ1bmN0aW9uID0gZm9ybWF0RnVuY3Rpb24gfHwgZW5jb2RlVVJJQ29tcG9uZW50O1xuXG5cdFx0XHR2YXIgbyA9IHM7XG5cblx0XHRcdGEgPSBbXTtcblxuXHRcdFx0Zm9yICh2YXIgeCBpbiBvKSB7aWYgKG8uaGFzT3duUHJvcGVydHkoeCkpIHtcblx0XHRcdFx0aWYgKG8uaGFzT3duUHJvcGVydHkoeCkpIHtcblx0XHRcdFx0XHRhLnB1c2goW3gsIG9beF0gPT09ICc/JyA/ICc/JyA6IGZvcm1hdEZ1bmN0aW9uKG9beF0pXS5qb2luKCc9JykpO1xuXHRcdFx0XHR9XG5cdFx0XHR9fVxuXG5cdFx0XHRyZXR1cm4gYS5qb2luKCcmJyk7XG5cdFx0fVxuXHR9LFxuXG5cdC8vIExvY2FsIHN0b3JhZ2UgZmFjYWRlXG5cdHN0b3JlOiAoZnVuY3Rpb24oKSB7XG5cblx0XHR2YXIgYSA9IFsnbG9jYWxTdG9yYWdlJywgJ3Nlc3Npb25TdG9yYWdlJ107XG5cdFx0dmFyIGkgPSAtMTtcblx0XHR2YXIgcHJlZml4ID0gJ3Rlc3QnO1xuXG5cdFx0Ly8gU2V0IExvY2FsU3RvcmFnZVxuXHRcdHZhciBsb2NhbFN0b3JhZ2U7XG5cblx0XHR3aGlsZSAoYVsrK2ldKSB7XG5cdFx0XHR0cnkge1xuXHRcdFx0XHQvLyBJbiBDaHJvbWUgd2l0aCBjb29raWVzIGJsb2NrZWQsIGNhbGxpbmcgbG9jYWxTdG9yYWdlIHRocm93cyBhbiBlcnJvclxuXHRcdFx0XHRsb2NhbFN0b3JhZ2UgPSB3aW5kb3dbYVtpXV07XG5cdFx0XHRcdGxvY2FsU3RvcmFnZS5zZXRJdGVtKHByZWZpeCArIGksIGkpO1xuXHRcdFx0XHRsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShwcmVmaXggKyBpKTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHR9XG5cdFx0XHRjYXRjaCAoZSkge1xuXHRcdFx0XHRsb2NhbFN0b3JhZ2UgPSBudWxsO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGlmICghbG9jYWxTdG9yYWdlKSB7XG5cblx0XHRcdHZhciBjYWNoZSA9IG51bGw7XG5cblx0XHRcdGxvY2FsU3RvcmFnZSA9IHtcblx0XHRcdFx0Z2V0SXRlbTogZnVuY3Rpb24ocHJvcCkge1xuXHRcdFx0XHRcdHByb3AgPSBwcm9wICsgJz0nO1xuXHRcdFx0XHRcdHZhciBtID0gZG9jdW1lbnQuY29va2llLnNwbGl0KCc7Jyk7XG5cdFx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBtLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0XHR2YXIgX20gPSBtW2ldLnJlcGxhY2UoLyheXFxzK3xcXHMrJCkvLCAnJyk7XG5cdFx0XHRcdFx0XHRpZiAoX20gJiYgX20uaW5kZXhPZihwcm9wKSA9PT0gMCkge1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gX20uc3Vic3RyKHByb3AubGVuZ3RoKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRyZXR1cm4gY2FjaGU7XG5cdFx0XHRcdH0sXG5cblx0XHRcdFx0c2V0SXRlbTogZnVuY3Rpb24ocHJvcCwgdmFsdWUpIHtcblx0XHRcdFx0XHRjYWNoZSA9IHZhbHVlO1xuXHRcdFx0XHRcdGRvY3VtZW50LmNvb2tpZSA9IHByb3AgKyAnPScgKyB2YWx1ZTtcblx0XHRcdFx0fVxuXHRcdFx0fTtcblxuXHRcdFx0Ly8gRmlsbCB0aGUgY2FjaGUgdXBcblx0XHRcdGNhY2hlID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2hlbGxvJyk7XG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gZ2V0KCkge1xuXHRcdFx0dmFyIGpzb24gPSB7fTtcblx0XHRcdHRyeSB7XG5cdFx0XHRcdGpzb24gPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdoZWxsbycpKSB8fCB7fTtcblx0XHRcdH1cblx0XHRcdGNhdGNoIChlKSB7fVxuXG5cdFx0XHRyZXR1cm4ganNvbjtcblx0XHR9XG5cblx0XHRmdW5jdGlvbiBzZXQoanNvbikge1xuXHRcdFx0bG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2hlbGxvJywgSlNPTi5zdHJpbmdpZnkoanNvbikpO1xuXHRcdH1cblxuXHRcdC8vIENoZWNrIGlmIHRoZSBicm93c2VyIHN1cHBvcnQgbG9jYWwgc3RvcmFnZVxuXHRcdHJldHVybiBmdW5jdGlvbihuYW1lLCB2YWx1ZSwgZGF5cykge1xuXG5cdFx0XHQvLyBMb2NhbCBzdG9yYWdlXG5cdFx0XHR2YXIganNvbiA9IGdldCgpO1xuXG5cdFx0XHRpZiAobmFtZSAmJiB2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRcdHJldHVybiBqc29uW25hbWVdIHx8IG51bGw7XG5cdFx0XHR9XG5cdFx0XHRlbHNlIGlmIChuYW1lICYmIHZhbHVlID09PSBudWxsKSB7XG5cdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0ZGVsZXRlIGpzb25bbmFtZV07XG5cdFx0XHRcdH1cblx0XHRcdFx0Y2F0Y2ggKGUpIHtcblx0XHRcdFx0XHRqc29uW25hbWVdID0gbnVsbDtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0ZWxzZSBpZiAobmFtZSkge1xuXHRcdFx0XHRqc29uW25hbWVdID0gdmFsdWU7XG5cdFx0XHR9XG5cdFx0XHRlbHNlIHtcblx0XHRcdFx0cmV0dXJuIGpzb247XG5cdFx0XHR9XG5cblx0XHRcdHNldChqc29uKTtcblxuXHRcdFx0cmV0dXJuIGpzb24gfHwgbnVsbDtcblx0XHR9O1xuXG5cdH0pKCksXG5cblx0Ly8gQ3JlYXRlIGFuZCBBcHBlbmQgbmV3IERPTSBlbGVtZW50c1xuXHQvLyBAcGFyYW0gbm9kZSBzdHJpbmdcblx0Ly8gQHBhcmFtIGF0dHIgb2JqZWN0IGxpdGVyYWxcblx0Ly8gQHBhcmFtIGRvbS9zdHJpbmdcblx0YXBwZW5kOiBmdW5jdGlvbihub2RlLCBhdHRyLCB0YXJnZXQpIHtcblxuXHRcdHZhciBuID0gdHlwZW9mIChub2RlKSA9PT0gJ3N0cmluZycgPyBkb2N1bWVudC5jcmVhdGVFbGVtZW50KG5vZGUpIDogbm9kZTtcblxuXHRcdGlmICh0eXBlb2YgKGF0dHIpID09PSAnb2JqZWN0Jykge1xuXHRcdFx0aWYgKCd0YWdOYW1lJyBpbiBhdHRyKSB7XG5cdFx0XHRcdHRhcmdldCA9IGF0dHI7XG5cdFx0XHR9XG5cdFx0XHRlbHNlIHtcblx0XHRcdFx0Zm9yICh2YXIgeCBpbiBhdHRyKSB7aWYgKGF0dHIuaGFzT3duUHJvcGVydHkoeCkpIHtcblx0XHRcdFx0XHRpZiAodHlwZW9mIChhdHRyW3hdKSA9PT0gJ29iamVjdCcpIHtcblx0XHRcdFx0XHRcdGZvciAodmFyIHkgaW4gYXR0clt4XSkge2lmIChhdHRyW3hdLmhhc093blByb3BlcnR5KHkpKSB7XG5cdFx0XHRcdFx0XHRcdG5beF1beV0gPSBhdHRyW3hdW3ldO1xuXHRcdFx0XHRcdFx0fX1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0ZWxzZSBpZiAoeCA9PT0gJ2h0bWwnKSB7XG5cdFx0XHRcdFx0XHRuLmlubmVySFRNTCA9IGF0dHJbeF07XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0Ly8gSUUgZG9lc24ndCBsaWtlIHVzIHNldHRpbmcgbWV0aG9kcyB3aXRoIHNldEF0dHJpYnV0ZVxuXHRcdFx0XHRcdGVsc2UgaWYgKCEvXm9uLy50ZXN0KHgpKSB7XG5cdFx0XHRcdFx0XHRuLnNldEF0dHJpYnV0ZSh4LCBhdHRyW3hdKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0ZWxzZSB7XG5cdFx0XHRcdFx0XHRuW3hdID0gYXR0clt4XTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH19XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0aWYgKHRhcmdldCA9PT0gJ2JvZHknKSB7XG5cdFx0XHQoZnVuY3Rpb24gc2VsZigpIHtcblx0XHRcdFx0aWYgKGRvY3VtZW50LmJvZHkpIHtcblx0XHRcdFx0XHRkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKG4pO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGVsc2Uge1xuXHRcdFx0XHRcdHNldFRpbWVvdXQoc2VsZiwgMTYpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KSgpO1xuXHRcdH1cblx0XHRlbHNlIGlmICh0eXBlb2YgKHRhcmdldCkgPT09ICdvYmplY3QnKSB7XG5cdFx0XHR0YXJnZXQuYXBwZW5kQ2hpbGQobik7XG5cdFx0fVxuXHRcdGVsc2UgaWYgKHR5cGVvZiAodGFyZ2V0KSA9PT0gJ3N0cmluZycpIHtcblx0XHRcdGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKHRhcmdldClbMF0uYXBwZW5kQ2hpbGQobik7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIG47XG5cdH0sXG5cblx0Ly8gQW4gZWFzeSB3YXkgdG8gY3JlYXRlIGEgaGlkZGVuIGlmcmFtZVxuXHQvLyBAcGFyYW0gc3RyaW5nIHNyY1xuXHRpZnJhbWU6IGZ1bmN0aW9uKHNyYykge1xuXHRcdHRoaXMuYXBwZW5kKCdpZnJhbWUnLCB7c3JjOiBzcmMsIHN0eWxlOiB7cG9zaXRpb246J2Fic29sdXRlJywgbGVmdDogJy0xMDAwcHgnLCBib3R0b206IDAsIGhlaWdodDogJzFweCcsIHdpZHRoOiAnMXB4J319LCAnYm9keScpO1xuXHR9LFxuXG5cdC8vIFJlY3Vyc2l2ZSBtZXJnZSB0d28gb2JqZWN0cyBpbnRvIG9uZSwgc2Vjb25kIHBhcmFtZXRlciBvdmVyaWRlcyB0aGUgZmlyc3Rcblx0Ly8gQHBhcmFtIGEgYXJyYXlcblx0bWVyZ2U6IGZ1bmN0aW9uKC8qIEFyZ3M6IGEsIGIsIGMsIC4uIG4gKi8pIHtcblx0XHR2YXIgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cyk7XG5cdFx0YXJncy51bnNoaWZ0KHt9KTtcblx0XHRyZXR1cm4gdGhpcy5leHRlbmQuYXBwbHkobnVsbCwgYXJncyk7XG5cdH0sXG5cblx0Ly8gTWFrZXMgaXQgZWFzaWVyIHRvIGFzc2lnbiBwYXJhbWV0ZXJzLCB3aGVyZSBzb21lIGFyZSBvcHRpb25hbFxuXHQvLyBAcGFyYW0gbyBvYmplY3Rcblx0Ly8gQHBhcmFtIGEgYXJndW1lbnRzXG5cdGFyZ3M6IGZ1bmN0aW9uKG8sIGFyZ3MpIHtcblxuXHRcdHZhciBwID0ge307XG5cdFx0dmFyIGkgPSAwO1xuXHRcdHZhciB0ID0gbnVsbDtcblx0XHR2YXIgeCA9IG51bGw7XG5cblx0XHQvLyAneCcgaXMgdGhlIGZpcnN0IGtleSBpbiB0aGUgbGlzdCBvZiBvYmplY3QgcGFyYW1ldGVyc1xuXHRcdGZvciAoeCBpbiBvKSB7aWYgKG8uaGFzT3duUHJvcGVydHkoeCkpIHtcblx0XHRcdGJyZWFrO1xuXHRcdH19XG5cblx0XHQvLyBQYXNzaW5nIGluIGhhc2ggb2JqZWN0IG9mIGFyZ3VtZW50cz9cblx0XHQvLyBXaGVyZSB0aGUgZmlyc3QgYXJndW1lbnQgY2FuJ3QgYmUgYW4gb2JqZWN0XG5cdFx0aWYgKChhcmdzLmxlbmd0aCA9PT0gMSkgJiYgKHR5cGVvZiAoYXJnc1swXSkgPT09ICdvYmplY3QnKSAmJiBvW3hdICE9ICdvIScpIHtcblxuXHRcdFx0Ly8gQ291bGQgdGhpcyBvYmplY3Qgc3RpbGwgYmVsb25nIHRvIGEgcHJvcGVydHk/XG5cdFx0XHQvLyBDaGVjayB0aGUgb2JqZWN0IGtleXMgaWYgdGhleSBtYXRjaCBhbnkgb2YgdGhlIHByb3BlcnR5IGtleXNcblx0XHRcdGZvciAoeCBpbiBhcmdzWzBdKSB7aWYgKG8uaGFzT3duUHJvcGVydHkoeCkpIHtcblx0XHRcdFx0Ly8gRG9lcyB0aGlzIGtleSBleGlzdCBpbiB0aGUgcHJvcGVydHkgbGlzdD9cblx0XHRcdFx0aWYgKHggaW4gbykge1xuXHRcdFx0XHRcdC8vIFllcyB0aGlzIGtleSBkb2VzIGV4aXN0IHNvIGl0cyBtb3N0IGxpa2VseSB0aGlzIGZ1bmN0aW9uIGhhcyBiZWVuIGludm9rZWQgd2l0aCBhbiBvYmplY3QgcGFyYW1ldGVyXG5cdFx0XHRcdFx0Ly8gUmV0dXJuIGZpcnN0IGFyZ3VtZW50IGFzIHRoZSBoYXNoIG9mIGFsbCBhcmd1bWVudHNcblx0XHRcdFx0XHRyZXR1cm4gYXJnc1swXTtcblx0XHRcdFx0fVxuXHRcdFx0fX1cblx0XHR9XG5cblx0XHQvLyBFbHNlIGxvb3AgdGhyb3VnaCBhbmQgYWNjb3VudCBmb3IgdGhlIG1pc3Npbmcgb25lcy5cblx0XHRmb3IgKHggaW4gbykge2lmIChvLmhhc093blByb3BlcnR5KHgpKSB7XG5cblx0XHRcdHQgPSB0eXBlb2YgKGFyZ3NbaV0pO1xuXG5cdFx0XHRpZiAoKHR5cGVvZiAob1t4XSkgPT09ICdmdW5jdGlvbicgJiYgb1t4XS50ZXN0KGFyZ3NbaV0pKSB8fCAodHlwZW9mIChvW3hdKSA9PT0gJ3N0cmluZycgJiYgKFxuXHRcdFx0KG9beF0uaW5kZXhPZigncycpID4gLTEgJiYgdCA9PT0gJ3N0cmluZycpIHx8XG5cdFx0XHQob1t4XS5pbmRleE9mKCdvJykgPiAtMSAmJiB0ID09PSAnb2JqZWN0JykgfHxcblx0XHRcdChvW3hdLmluZGV4T2YoJ2knKSA+IC0xICYmIHQgPT09ICdudW1iZXInKSB8fFxuXHRcdFx0KG9beF0uaW5kZXhPZignYScpID4gLTEgJiYgdCA9PT0gJ29iamVjdCcpIHx8XG5cdFx0XHQob1t4XS5pbmRleE9mKCdmJykgPiAtMSAmJiB0ID09PSAnZnVuY3Rpb24nKVxuXHRcdFx0KSlcblx0XHRcdCkge1xuXHRcdFx0XHRwW3hdID0gYXJnc1tpKytdO1xuXHRcdFx0fVxuXG5cdFx0XHRlbHNlIGlmICh0eXBlb2YgKG9beF0pID09PSAnc3RyaW5nJyAmJiBvW3hdLmluZGV4T2YoJyEnKSA+IC0xKSB7XG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdH1cblx0XHR9fVxuXG5cdFx0cmV0dXJuIHA7XG5cdH0sXG5cblx0Ly8gUmV0dXJucyBhIFVSTCBpbnN0YW5jZVxuXHR1cmw6IGZ1bmN0aW9uKHBhdGgpIHtcblxuXHRcdC8vIElmIHRoZSBwYXRoIGlzIGVtcHR5XG5cdFx0aWYgKCFwYXRoKSB7XG5cdFx0XHRyZXR1cm4gd2luZG93LmxvY2F0aW9uO1xuXHRcdH1cblxuXHRcdC8vIENocm9tZSBhbmQgRmlyZUZveCBzdXBwb3J0IG5ldyBVUkwoKSB0byBleHRyYWN0IFVSTCBvYmplY3RzXG5cdFx0ZWxzZSBpZiAod2luZG93LlVSTCAmJiBVUkwgaW5zdGFuY2VvZiBGdW5jdGlvbiAmJiBVUkwubGVuZ3RoICE9PSAwKSB7XG5cdFx0XHRyZXR1cm4gbmV3IFVSTChwYXRoLCB3aW5kb3cubG9jYXRpb24pO1xuXHRcdH1cblxuXHRcdC8vIFVnbHkgc2hpbSwgaXQgd29ya3MhXG5cdFx0ZWxzZSB7XG5cdFx0XHR2YXIgYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcblx0XHRcdGEuaHJlZiA9IHBhdGg7XG5cdFx0XHRyZXR1cm4gYS5jbG9uZU5vZGUoZmFsc2UpO1xuXHRcdH1cblx0fSxcblxuXHRkaWZmOiBmdW5jdGlvbihhLCBiKSB7XG5cdFx0cmV0dXJuIGIuZmlsdGVyKGZ1bmN0aW9uKGl0ZW0pIHtcblx0XHRcdHJldHVybiBhLmluZGV4T2YoaXRlbSkgPT09IC0xO1xuXHRcdH0pO1xuXHR9LFxuXG5cdC8vIEdldCB0aGUgZGlmZmVyZW50IGhhc2ggb2YgcHJvcGVydGllcyB1bmlxdWUgdG8gYGFgLCBhbmQgbm90IGluIGBiYFxuXHRkaWZmS2V5OiBmdW5jdGlvbihhLCBiKSB7XG5cdFx0aWYgKGEgfHwgIWIpIHtcblx0XHRcdHZhciByID0ge307XG5cdFx0XHRmb3IgKHZhciB4IGluIGEpIHtcblx0XHRcdFx0Ly8gRG9lcyB0aGUgcHJvcGVydHkgbm90IGV4aXN0P1xuXHRcdFx0XHRpZiAoISh4IGluIGIpKSB7XG5cdFx0XHRcdFx0clt4XSA9IGFbeF07XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIHI7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGE7XG5cdH0sXG5cblx0Ly8gVW5pcXVlXG5cdC8vIFJlbW92ZSBkdXBsaWNhdGUgYW5kIG51bGwgdmFsdWVzIGZyb20gYW4gYXJyYXlcblx0Ly8gQHBhcmFtIGEgYXJyYXlcblx0dW5pcXVlOiBmdW5jdGlvbihhKSB7XG5cdFx0aWYgKCFBcnJheS5pc0FycmF5KGEpKSB7IHJldHVybiBbXTsgfVxuXG5cdFx0cmV0dXJuIGEuZmlsdGVyKGZ1bmN0aW9uKGl0ZW0sIGluZGV4KSB7XG5cdFx0XHQvLyBJcyB0aGlzIHRoZSBmaXJzdCBsb2NhdGlvbiBvZiBpdGVtXG5cdFx0XHRyZXR1cm4gYS5pbmRleE9mKGl0ZW0pID09PSBpbmRleDtcblx0XHR9KTtcblx0fSxcblxuXHRpc0VtcHR5OiBmdW5jdGlvbihvYmopIHtcblxuXHRcdC8vIFNjYWxhclxuXHRcdGlmICghb2JqKVxuXHRcdFx0cmV0dXJuIHRydWU7XG5cblx0XHQvLyBBcnJheVxuXHRcdGlmIChBcnJheS5pc0FycmF5KG9iaikpIHtcblx0XHRcdHJldHVybiAhb2JqLmxlbmd0aDtcblx0XHR9XG5cdFx0ZWxzZSBpZiAodHlwZW9mIChvYmopID09PSAnb2JqZWN0Jykge1xuXHRcdFx0Ly8gT2JqZWN0XG5cdFx0XHRmb3IgKHZhciBrZXkgaW4gb2JqKSB7XG5cdFx0XHRcdGlmIChvYmouaGFzT3duUHJvcGVydHkoa2V5KSkge1xuXHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybiB0cnVlO1xuXHR9LFxuXG5cdC8vanNjczpkaXNhYmxlXG5cblx0LyohXG5cdCAqKiAgVGhlbmFibGUgLS0gRW1iZWRkYWJsZSBNaW5pbXVtIFN0cmljdGx5LUNvbXBsaWFudCBQcm9taXNlcy9BKyAxLjEuMSBUaGVuYWJsZVxuXHQgKiogIENvcHlyaWdodCAoYykgMjAxMy0yMDE0IFJhbGYgUy4gRW5nZWxzY2hhbGwgPGh0dHA6Ly9lbmdlbHNjaGFsbC5jb20+XG5cdCAqKiAgTGljZW5zZWQgdW5kZXIgVGhlIE1JVCBMaWNlbnNlIDxodHRwOi8vb3BlbnNvdXJjZS5vcmcvbGljZW5zZXMvTUlUPlxuXHQgKiogIFNvdXJjZS1Db2RlIGRpc3RyaWJ1dGVkIG9uIDxodHRwOi8vZ2l0aHViLmNvbS9yc2UvdGhlbmFibGU+XG5cdCAqL1xuXHRQcm9taXNlOiAoZnVuY3Rpb24oKXtcblx0XHQvKiAgcHJvbWlzZSBzdGF0ZXMgW1Byb21pc2VzL0ErIDIuMV0gICovXG5cdFx0dmFyIFNUQVRFX1BFTkRJTkcgICA9IDA7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKiAgW1Byb21pc2VzL0ErIDIuMS4xXSAgKi9cblx0XHR2YXIgU1RBVEVfRlVMRklMTEVEID0gMTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qICBbUHJvbWlzZXMvQSsgMi4xLjJdICAqL1xuXHRcdHZhciBTVEFURV9SRUpFQ1RFRCAgPSAyOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLyogIFtQcm9taXNlcy9BKyAyLjEuM10gICovXG5cblx0XHQvKiAgcHJvbWlzZSBvYmplY3QgY29uc3RydWN0b3IgICovXG5cdFx0dmFyIGFwaSA9IGZ1bmN0aW9uIChleGVjdXRvcikge1xuXHRcdFx0LyogIG9wdGlvbmFsbHkgc3VwcG9ydCBub24tY29uc3RydWN0b3IvcGxhaW4tZnVuY3Rpb24gY2FsbCAgKi9cblx0XHRcdGlmICghKHRoaXMgaW5zdGFuY2VvZiBhcGkpKVxuXHRcdFx0XHRyZXR1cm4gbmV3IGFwaShleGVjdXRvcik7XG5cblx0XHRcdC8qICBpbml0aWFsaXplIG9iamVjdCAgKi9cblx0XHRcdHRoaXMuaWQgICAgICAgICAgID0gXCJUaGVuYWJsZS8xLjAuNlwiO1xuXHRcdFx0dGhpcy5zdGF0ZSAgICAgICAgPSBTVEFURV9QRU5ESU5HOyAvKiAgaW5pdGlhbCBzdGF0ZSAgKi9cblx0XHRcdHRoaXMuZnVsZmlsbFZhbHVlID0gdW5kZWZpbmVkOyAgICAgLyogIGluaXRpYWwgdmFsdWUgICovICAgICAvKiAgW1Byb21pc2VzL0ErIDEuMywgMi4xLjIuMl0gICovXG5cdFx0XHR0aGlzLnJlamVjdFJlYXNvbiA9IHVuZGVmaW5lZDsgICAgIC8qICBpbml0aWFsIHJlYXNvbiAqLyAgICAgLyogIFtQcm9taXNlcy9BKyAxLjUsIDIuMS4zLjJdICAqL1xuXHRcdFx0dGhpcy5vbkZ1bGZpbGxlZCAgPSBbXTsgICAgICAgICAgICAvKiAgaW5pdGlhbCBoYW5kbGVycyAgKi9cblx0XHRcdHRoaXMub25SZWplY3RlZCAgID0gW107ICAgICAgICAgICAgLyogIGluaXRpYWwgaGFuZGxlcnMgICovXG5cblx0XHRcdC8qICBwcm92aWRlIG9wdGlvbmFsIGluZm9ybWF0aW9uLWhpZGluZyBwcm94eSAgKi9cblx0XHRcdHRoaXMucHJveHkgPSB7XG5cdFx0XHRcdHRoZW46IHRoaXMudGhlbi5iaW5kKHRoaXMpXG5cdFx0XHR9O1xuXG5cdFx0XHQvKiAgc3VwcG9ydCBvcHRpb25hbCBleGVjdXRvciBmdW5jdGlvbiAgKi9cblx0XHRcdGlmICh0eXBlb2YgZXhlY3V0b3IgPT09IFwiZnVuY3Rpb25cIilcblx0XHRcdFx0ZXhlY3V0b3IuY2FsbCh0aGlzLCB0aGlzLmZ1bGZpbGwuYmluZCh0aGlzKSwgdGhpcy5yZWplY3QuYmluZCh0aGlzKSk7XG5cdFx0fTtcblxuXHRcdC8qICBwcm9taXNlIEFQSSBtZXRob2RzICAqL1xuXHRcdGFwaS5wcm90b3R5cGUgPSB7XG5cdFx0XHQvKiAgcHJvbWlzZSByZXNvbHZpbmcgbWV0aG9kcyAgKi9cblx0XHRcdGZ1bGZpbGw6IGZ1bmN0aW9uICh2YWx1ZSkgeyByZXR1cm4gZGVsaXZlcih0aGlzLCBTVEFURV9GVUxGSUxMRUQsIFwiZnVsZmlsbFZhbHVlXCIsIHZhbHVlKTsgfSxcblx0XHRcdHJlamVjdDogIGZ1bmN0aW9uICh2YWx1ZSkgeyByZXR1cm4gZGVsaXZlcih0aGlzLCBTVEFURV9SRUpFQ1RFRCwgIFwicmVqZWN0UmVhc29uXCIsIHZhbHVlKTsgfSxcblxuXHRcdFx0LyogIFwiVGhlIHRoZW4gTWV0aG9kXCIgW1Byb21pc2VzL0ErIDEuMSwgMS4yLCAyLjJdICAqL1xuXHRcdFx0dGhlbjogZnVuY3Rpb24gKG9uRnVsZmlsbGVkLCBvblJlamVjdGVkKSB7XG5cdFx0XHRcdHZhciBjdXJyID0gdGhpcztcblx0XHRcdFx0dmFyIG5leHQgPSBuZXcgYXBpKCk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLyogIFtQcm9taXNlcy9BKyAyLjIuN10gICovXG5cdFx0XHRcdGN1cnIub25GdWxmaWxsZWQucHVzaChcblx0XHRcdFx0XHRyZXNvbHZlcihvbkZ1bGZpbGxlZCwgbmV4dCwgXCJmdWxmaWxsXCIpKTsgICAgICAgICAgICAgLyogIFtQcm9taXNlcy9BKyAyLjIuMi8yLjIuNl0gICovXG5cdFx0XHRcdGN1cnIub25SZWplY3RlZC5wdXNoKFxuXHRcdFx0XHRcdHJlc29sdmVyKG9uUmVqZWN0ZWQsICBuZXh0LCBcInJlamVjdFwiICkpOyAgICAgICAgICAgICAvKiAgW1Byb21pc2VzL0ErIDIuMi4zLzIuMi42XSAgKi9cblx0XHRcdFx0ZXhlY3V0ZShjdXJyKTtcblx0XHRcdFx0cmV0dXJuIG5leHQucHJveHk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLyogIFtQcm9taXNlcy9BKyAyLjIuNywgMy4zXSAgKi9cblx0XHRcdH1cblx0XHR9O1xuXG5cdFx0LyogIGRlbGl2ZXIgYW4gYWN0aW9uICAqL1xuXHRcdHZhciBkZWxpdmVyID0gZnVuY3Rpb24gKGN1cnIsIHN0YXRlLCBuYW1lLCB2YWx1ZSkge1xuXHRcdFx0aWYgKGN1cnIuc3RhdGUgPT09IFNUQVRFX1BFTkRJTkcpIHtcblx0XHRcdFx0Y3Vyci5zdGF0ZSA9IHN0YXRlOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLyogIFtQcm9taXNlcy9BKyAyLjEuMi4xLCAyLjEuMy4xXSAgKi9cblx0XHRcdFx0Y3VycltuYW1lXSA9IHZhbHVlOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLyogIFtQcm9taXNlcy9BKyAyLjEuMi4yLCAyLjEuMy4yXSAgKi9cblx0XHRcdFx0ZXhlY3V0ZShjdXJyKTtcblx0XHRcdH1cblx0XHRcdHJldHVybiBjdXJyO1xuXHRcdH07XG5cblx0XHQvKiAgZXhlY3V0ZSBhbGwgaGFuZGxlcnMgICovXG5cdFx0dmFyIGV4ZWN1dGUgPSBmdW5jdGlvbiAoY3Vycikge1xuXHRcdFx0aWYgKGN1cnIuc3RhdGUgPT09IFNUQVRFX0ZVTEZJTExFRClcblx0XHRcdFx0ZXhlY3V0ZV9oYW5kbGVycyhjdXJyLCBcIm9uRnVsZmlsbGVkXCIsIGN1cnIuZnVsZmlsbFZhbHVlKTtcblx0XHRcdGVsc2UgaWYgKGN1cnIuc3RhdGUgPT09IFNUQVRFX1JFSkVDVEVEKVxuXHRcdFx0XHRleGVjdXRlX2hhbmRsZXJzKGN1cnIsIFwib25SZWplY3RlZFwiLCAgY3Vyci5yZWplY3RSZWFzb24pO1xuXHRcdH07XG5cblx0XHQvKiAgZXhlY3V0ZSBwYXJ0aWN1bGFyIHNldCBvZiBoYW5kbGVycyAgKi9cblx0XHR2YXIgZXhlY3V0ZV9oYW5kbGVycyA9IGZ1bmN0aW9uIChjdXJyLCBuYW1lLCB2YWx1ZSkge1xuXHRcdFx0LyogZ2xvYmFsIHByb2Nlc3M6IHRydWUgKi9cblx0XHRcdC8qIGdsb2JhbCBzZXRJbW1lZGlhdGU6IHRydWUgKi9cblx0XHRcdC8qIGdsb2JhbCBzZXRUaW1lb3V0OiB0cnVlICovXG5cblx0XHRcdC8qICBzaG9ydC1jaXJjdWl0IHByb2Nlc3NpbmcgICovXG5cdFx0XHRpZiAoY3VycltuYW1lXS5sZW5ndGggPT09IDApXG5cdFx0XHRcdHJldHVybjtcblxuXHRcdFx0LyogIGl0ZXJhdGUgb3ZlciBhbGwgaGFuZGxlcnMsIGV4YWN0bHkgb25jZSAgKi9cblx0XHRcdHZhciBoYW5kbGVycyA9IGN1cnJbbmFtZV07XG5cdFx0XHRjdXJyW25hbWVdID0gW107ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLyogIFtQcm9taXNlcy9BKyAyLjIuMi4zLCAyLjIuMy4zXSAgKi9cblx0XHRcdHZhciBmdW5jID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGhhbmRsZXJzLmxlbmd0aDsgaSsrKVxuXHRcdFx0XHRcdGhhbmRsZXJzW2ldKHZhbHVlKTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLyogIFtQcm9taXNlcy9BKyAyLjIuNV0gICovXG5cdFx0XHR9O1xuXG5cdFx0XHQvKiAgZXhlY3V0ZSBwcm9jZWR1cmUgYXN5bmNocm9ub3VzbHkgICovICAgICAgICAgICAgICAgICAgICAgLyogIFtQcm9taXNlcy9BKyAyLjIuNCwgMy4xXSAgKi9cblx0XHRcdGlmICh0eXBlb2YgcHJvY2VzcyA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgcHJvY2Vzcy5uZXh0VGljayA9PT0gXCJmdW5jdGlvblwiKVxuXHRcdFx0XHRwcm9jZXNzLm5leHRUaWNrKGZ1bmMpO1xuXHRcdFx0ZWxzZSBpZiAodHlwZW9mIHNldEltbWVkaWF0ZSA9PT0gXCJmdW5jdGlvblwiKVxuXHRcdFx0XHRzZXRJbW1lZGlhdGUoZnVuYyk7XG5cdFx0XHRlbHNlXG5cdFx0XHRcdHNldFRpbWVvdXQoZnVuYywgMCk7XG5cdFx0fTtcblxuXHRcdC8qICBnZW5lcmF0ZSBhIHJlc29sdmVyIGZ1bmN0aW9uICAqL1xuXHRcdHZhciByZXNvbHZlciA9IGZ1bmN0aW9uIChjYiwgbmV4dCwgbWV0aG9kKSB7XG5cdFx0XHRyZXR1cm4gZnVuY3Rpb24gKHZhbHVlKSB7XG5cdFx0XHRcdGlmICh0eXBlb2YgY2IgIT09IFwiZnVuY3Rpb25cIikgICAgICAgICAgICAgICAgICAgICAgICAgICAgLyogIFtQcm9taXNlcy9BKyAyLjIuMSwgMi4yLjcuMywgMi4yLjcuNF0gICovXG5cdFx0XHRcdFx0bmV4dFttZXRob2RdLmNhbGwobmV4dCwgdmFsdWUpOyAgICAgICAgICAgICAgICAgICAgICAvKiAgW1Byb21pc2VzL0ErIDIuMi43LjMsIDIuMi43LjRdICAqL1xuXHRcdFx0XHRlbHNlIHtcblx0XHRcdFx0XHR2YXIgcmVzdWx0O1xuXHRcdFx0XHRcdHRyeSB7IHJlc3VsdCA9IGNiKHZhbHVlKTsgfSAgICAgICAgICAgICAgICAgICAgICAgICAgLyogIFtQcm9taXNlcy9BKyAyLjIuMi4xLCAyLjIuMy4xLCAyLjIuNSwgMy4yXSAgKi9cblx0XHRcdFx0XHRjYXRjaCAoZSkge1xuXHRcdFx0XHRcdFx0bmV4dC5yZWplY3QoZSk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qICBbUHJvbWlzZXMvQSsgMi4yLjcuMl0gICovXG5cdFx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHJlc29sdmUobmV4dCwgcmVzdWx0KTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLyogIFtQcm9taXNlcy9BKyAyLjIuNy4xXSAgKi9cblx0XHRcdFx0fVxuXHRcdFx0fTtcblx0XHR9O1xuXG5cdFx0LyogIFwiUHJvbWlzZSBSZXNvbHV0aW9uIFByb2NlZHVyZVwiICAqLyAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qICBbUHJvbWlzZXMvQSsgMi4zXSAgKi9cblx0XHR2YXIgcmVzb2x2ZSA9IGZ1bmN0aW9uIChwcm9taXNlLCB4KSB7XG5cdFx0XHQvKiAgc2FuaXR5IGNoZWNrIGFyZ3VtZW50cyAgKi8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLyogIFtQcm9taXNlcy9BKyAyLjMuMV0gICovXG5cdFx0XHRpZiAocHJvbWlzZSA9PT0geCB8fCBwcm9taXNlLnByb3h5ID09PSB4KSB7XG5cdFx0XHRcdHByb21pc2UucmVqZWN0KG5ldyBUeXBlRXJyb3IoXCJjYW5ub3QgcmVzb2x2ZSBwcm9taXNlIHdpdGggaXRzZWxmXCIpKTtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXG5cdFx0XHQvKiAgc3VyZ2ljYWxseSBjaGVjayBmb3IgYSBcInRoZW5cIiBtZXRob2Rcblx0XHRcdFx0KG1haW5seSB0byBqdXN0IGNhbGwgdGhlIFwiZ2V0dGVyXCIgb2YgXCJ0aGVuXCIgb25seSBvbmNlKSAgKi9cblx0XHRcdHZhciB0aGVuO1xuXHRcdFx0aWYgKCh0eXBlb2YgeCA9PT0gXCJvYmplY3RcIiAmJiB4ICE9PSBudWxsKSB8fCB0eXBlb2YgeCA9PT0gXCJmdW5jdGlvblwiKSB7XG5cdFx0XHRcdHRyeSB7IHRoZW4gPSB4LnRoZW47IH0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qICBbUHJvbWlzZXMvQSsgMi4zLjMuMSwgMy41XSAgKi9cblx0XHRcdFx0Y2F0Y2ggKGUpIHtcblx0XHRcdFx0XHRwcm9taXNlLnJlamVjdChlKTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qICBbUHJvbWlzZXMvQSsgMi4zLjMuMl0gICovXG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdC8qICBoYW5kbGUgb3duIFRoZW5hYmxlcyAgICBbUHJvbWlzZXMvQSsgMi4zLjJdXG5cdFx0XHRcdGFuZCBzaW1pbGFyIFwidGhlbmFibGVzXCIgW1Byb21pc2VzL0ErIDIuMy4zXSAgKi9cblx0XHRcdGlmICh0eXBlb2YgdGhlbiA9PT0gXCJmdW5jdGlvblwiKSB7XG5cdFx0XHRcdHZhciByZXNvbHZlZCA9IGZhbHNlO1xuXHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdC8qICBjYWxsIHJldHJpZXZlZCBcInRoZW5cIiBtZXRob2QgKi8gICAgICAgICAgICAgICAgICAvKiAgW1Byb21pc2VzL0ErIDIuMy4zLjNdICAqL1xuXHRcdFx0XHRcdHRoZW4uY2FsbCh4LFxuXHRcdFx0XHRcdFx0LyogIHJlc29sdmVQcm9taXNlICAqLyAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qICBbUHJvbWlzZXMvQSsgMi4zLjMuMy4xXSAgKi9cblx0XHRcdFx0XHRcdGZ1bmN0aW9uICh5KSB7XG5cdFx0XHRcdFx0XHRcdGlmIChyZXNvbHZlZCkgcmV0dXJuOyByZXNvbHZlZCA9IHRydWU7ICAgICAgIC8qICBbUHJvbWlzZXMvQSsgMi4zLjMuMy4zXSAgKi9cblx0XHRcdFx0XHRcdFx0aWYgKHkgPT09IHgpICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLyogIFtQcm9taXNlcy9BKyAzLjZdICAqL1xuXHRcdFx0XHRcdFx0XHRcdHByb21pc2UucmVqZWN0KG5ldyBUeXBlRXJyb3IoXCJjaXJjdWxhciB0aGVuYWJsZSBjaGFpblwiKSk7XG5cdFx0XHRcdFx0XHRcdGVsc2Vcblx0XHRcdFx0XHRcdFx0XHRyZXNvbHZlKHByb21pc2UsIHkpO1xuXHRcdFx0XHRcdFx0fSxcblxuXHRcdFx0XHRcdFx0LyogIHJlamVjdFByb21pc2UgICovICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qICBbUHJvbWlzZXMvQSsgMi4zLjMuMy4yXSAgKi9cblx0XHRcdFx0XHRcdGZ1bmN0aW9uIChyKSB7XG5cdFx0XHRcdFx0XHRcdGlmIChyZXNvbHZlZCkgcmV0dXJuOyByZXNvbHZlZCA9IHRydWU7ICAgICAgIC8qICBbUHJvbWlzZXMvQSsgMi4zLjMuMy4zXSAgKi9cblx0XHRcdFx0XHRcdFx0cHJvbWlzZS5yZWplY3Qocik7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0KTtcblx0XHRcdFx0fVxuXHRcdFx0XHRjYXRjaCAoZSkge1xuXHRcdFx0XHRcdGlmICghcmVzb2x2ZWQpICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLyogIFtQcm9taXNlcy9BKyAyLjMuMy4zLjNdICAqL1xuXHRcdFx0XHRcdFx0cHJvbWlzZS5yZWplY3QoZSk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qICBbUHJvbWlzZXMvQSsgMi4zLjMuMy40XSAgKi9cblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdC8qICBoYW5kbGUgb3RoZXIgdmFsdWVzICAqL1xuXHRcdFx0cHJvbWlzZS5mdWxmaWxsKHgpOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qICBbUHJvbWlzZXMvQSsgMi4zLjQsIDIuMy4zLjRdICAqL1xuXHRcdH07XG5cblx0XHQvKiAgZXhwb3J0IEFQSSAgKi9cblx0XHRyZXR1cm4gYXBpO1xuXHR9KSgpLFxuXG5cdC8vanNjczplbmFibGVcblxuXHQvLyBFdmVudFxuXHQvLyBBIGNvbnRydWN0b3Igc3VwZXJjbGFzcyBmb3IgYWRkaW5nIGV2ZW50IG1lbnRob2RzLCBvbiwgb2ZmLCBlbWl0LlxuXHRFdmVudDogZnVuY3Rpb24oKSB7XG5cblx0XHR2YXIgc2VwYXJhdG9yID0gL1tcXHNcXCxdKy87XG5cblx0XHQvLyBJZiB0aGlzIGRvZXNuJ3Qgc3VwcG9ydCBnZXRQcm90b3R5cGUgdGhlbiB3ZSBjYW4ndCBnZXQgcHJvdG90eXBlLmV2ZW50cyBvZiB0aGUgcGFyZW50XG5cdFx0Ly8gU28gbGV0cyBnZXQgdGhlIGN1cnJlbnQgaW5zdGFuY2UgZXZlbnRzLCBhbmQgYWRkIHRob3NlIHRvIGEgcGFyZW50IHByb3BlcnR5XG5cdFx0dGhpcy5wYXJlbnQgPSB7XG5cdFx0XHRldmVudHM6IHRoaXMuZXZlbnRzLFxuXHRcdFx0ZmluZEV2ZW50czogdGhpcy5maW5kRXZlbnRzLFxuXHRcdFx0cGFyZW50OiB0aGlzLnBhcmVudCxcblx0XHRcdHV0aWxzOiB0aGlzLnV0aWxzXG5cdFx0fTtcblxuXHRcdHRoaXMuZXZlbnRzID0ge307XG5cblx0XHQvLyBPbiwgc3Vic2NyaWJlIHRvIGV2ZW50c1xuXHRcdC8vIEBwYXJhbSBldnQgICBzdHJpbmdcblx0XHQvLyBAcGFyYW0gY2FsbGJhY2sgIGZ1bmN0aW9uXG5cdFx0dGhpcy5vbiA9IGZ1bmN0aW9uKGV2dCwgY2FsbGJhY2spIHtcblxuXHRcdFx0aWYgKGNhbGxiYWNrICYmIHR5cGVvZiAoY2FsbGJhY2spID09PSAnZnVuY3Rpb24nKSB7XG5cdFx0XHRcdHZhciBhID0gZXZ0LnNwbGl0KHNlcGFyYXRvcik7XG5cdFx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgYS5sZW5ndGg7IGkrKykge1xuXG5cdFx0XHRcdFx0Ly8gSGFzIHRoaXMgZXZlbnQgYWxyZWFkeSBiZWVuIGZpcmVkIG9uIHRoaXMgaW5zdGFuY2U/XG5cdFx0XHRcdFx0dGhpcy5ldmVudHNbYVtpXV0gPSBbY2FsbGJhY2tdLmNvbmNhdCh0aGlzLmV2ZW50c1thW2ldXSB8fCBbXSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0fTtcblxuXHRcdC8vIE9mZiwgdW5zdWJzY3JpYmUgdG8gZXZlbnRzXG5cdFx0Ly8gQHBhcmFtIGV2dCAgIHN0cmluZ1xuXHRcdC8vIEBwYXJhbSBjYWxsYmFjayAgZnVuY3Rpb25cblx0XHR0aGlzLm9mZiA9IGZ1bmN0aW9uKGV2dCwgY2FsbGJhY2spIHtcblxuXHRcdFx0dGhpcy5maW5kRXZlbnRzKGV2dCwgZnVuY3Rpb24obmFtZSwgaW5kZXgpIHtcblx0XHRcdFx0aWYgKCFjYWxsYmFjayB8fCB0aGlzLmV2ZW50c1tuYW1lXVtpbmRleF0gPT09IGNhbGxiYWNrKSB7XG5cdFx0XHRcdFx0dGhpcy5ldmVudHNbbmFtZV1baW5kZXhdID0gbnVsbDtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHRcdHJldHVybiB0aGlzO1xuXHRcdH07XG5cblx0XHQvLyBFbWl0XG5cdFx0Ly8gVHJpZ2dlcnMgYW55IHN1YnNjcmliZWQgZXZlbnRzXG5cdFx0dGhpcy5lbWl0ID0gZnVuY3Rpb24oZXZ0IC8qLCBkYXRhLCAuLi4gKi8pIHtcblxuXHRcdFx0Ly8gR2V0IGFyZ3VtZW50cyBhcyBhbiBBcnJheSwga25vY2sgb2ZmIHRoZSBmaXJzdCBvbmVcblx0XHRcdHZhciBhcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKTtcblx0XHRcdGFyZ3MucHVzaChldnQpO1xuXG5cdFx0XHQvLyBIYW5kbGVyXG5cdFx0XHR2YXIgaGFuZGxlciA9IGZ1bmN0aW9uKG5hbWUsIGluZGV4KSB7XG5cblx0XHRcdFx0Ly8gUmVwbGFjZSB0aGUgbGFzdCBwcm9wZXJ0eSB3aXRoIHRoZSBldmVudCBuYW1lXG5cdFx0XHRcdGFyZ3NbYXJncy5sZW5ndGggLSAxXSA9IChuYW1lID09PSAnKicgPyBldnQgOiBuYW1lKTtcblxuXHRcdFx0XHQvLyBUcmlnZ2VyXG5cdFx0XHRcdHRoaXMuZXZlbnRzW25hbWVdW2luZGV4XS5hcHBseSh0aGlzLCBhcmdzKTtcblx0XHRcdH07XG5cblx0XHRcdC8vIEZpbmQgdGhlIGNhbGxiYWNrcyB3aGljaCBtYXRjaCB0aGUgY29uZGl0aW9uIGFuZCBjYWxsXG5cdFx0XHR2YXIgX3RoaXMgPSB0aGlzO1xuXHRcdFx0d2hpbGUgKF90aGlzICYmIF90aGlzLmZpbmRFdmVudHMpIHtcblxuXHRcdFx0XHQvLyBGaW5kIGV2ZW50cyB3aGljaCBtYXRjaFxuXHRcdFx0XHRfdGhpcy5maW5kRXZlbnRzKGV2dCArICcsKicsIGhhbmRsZXIpO1xuXHRcdFx0XHRfdGhpcyA9IF90aGlzLnBhcmVudDtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0fTtcblxuXHRcdC8vXG5cdFx0Ly8gRWFzeSBmdW5jdGlvbnNcblx0XHR0aGlzLmVtaXRBZnRlciA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIF90aGlzID0gdGhpcztcblx0XHRcdHZhciBhcmdzID0gYXJndW1lbnRzO1xuXHRcdFx0c2V0VGltZW91dChmdW5jdGlvbigpIHtcblx0XHRcdFx0X3RoaXMuZW1pdC5hcHBseShfdGhpcywgYXJncyk7XG5cdFx0XHR9LCAwKTtcblxuXHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0fTtcblxuXHRcdHRoaXMuZmluZEV2ZW50cyA9IGZ1bmN0aW9uKGV2dCwgY2FsbGJhY2spIHtcblxuXHRcdFx0dmFyIGEgPSBldnQuc3BsaXQoc2VwYXJhdG9yKTtcblxuXHRcdFx0Zm9yICh2YXIgbmFtZSBpbiB0aGlzLmV2ZW50cykge2lmICh0aGlzLmV2ZW50cy5oYXNPd25Qcm9wZXJ0eShuYW1lKSkge1xuXG5cdFx0XHRcdGlmIChhLmluZGV4T2YobmFtZSkgPiAtMSkge1xuXG5cdFx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmV2ZW50c1tuYW1lXS5sZW5ndGg7IGkrKykge1xuXG5cdFx0XHRcdFx0XHQvLyBEb2VzIHRoZSBldmVudCBoYW5kbGVyIGV4aXN0P1xuXHRcdFx0XHRcdFx0aWYgKHRoaXMuZXZlbnRzW25hbWVdW2ldKSB7XG5cdFx0XHRcdFx0XHRcdC8vIEVtaXQgb24gdGhlIGxvY2FsIGluc3RhbmNlIG9mIHRoaXNcblx0XHRcdFx0XHRcdFx0Y2FsbGJhY2suY2FsbCh0aGlzLCBuYW1lLCBpKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH19XG5cdFx0fTtcblxuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXG5cdC8vIEdsb2JhbCBFdmVudHNcblx0Ly8gQXR0YWNoIHRoZSBjYWxsYmFjayB0byB0aGUgd2luZG93IG9iamVjdFxuXHQvLyBSZXR1cm4gaXRzIHVuaXF1ZSByZWZlcmVuY2Vcblx0Z2xvYmFsRXZlbnQ6IGZ1bmN0aW9uKGNhbGxiYWNrLCBndWlkKSB7XG5cdFx0Ly8gSWYgdGhlIGd1aWQgaGFzIG5vdCBiZWVuIHN1cHBsaWVkIHRoZW4gY3JlYXRlIGEgbmV3IG9uZS5cblx0XHRndWlkID0gZ3VpZCB8fCAnX2hlbGxvanNfJyArIHBhcnNlSW50KE1hdGgucmFuZG9tKCkgKiAxZTEyLCAxMCkudG9TdHJpbmcoMzYpO1xuXG5cdFx0Ly8gRGVmaW5lIHRoZSBjYWxsYmFjayBmdW5jdGlvblxuXHRcdHdpbmRvd1tndWlkXSA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0Ly8gVHJpZ2dlciB0aGUgY2FsbGJhY2tcblx0XHRcdHRyeSB7XG5cdFx0XHRcdGlmIChjYWxsYmFjay5hcHBseSh0aGlzLCBhcmd1bWVudHMpKSB7XG5cdFx0XHRcdFx0ZGVsZXRlIHdpbmRvd1tndWlkXTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0Y2F0Y2ggKGUpIHtcblx0XHRcdFx0Y29uc29sZS5lcnJvcihlKTtcblx0XHRcdH1cblx0XHR9O1xuXG5cdFx0cmV0dXJuIGd1aWQ7XG5cdH0sXG5cblx0Ly8gVHJpZ2dlciBhIGNsaWVudHNpZGUgcG9wdXBcblx0Ly8gVGhpcyBoYXMgYmVlbiBhdWdtZW50ZWQgdG8gc3VwcG9ydCBQaG9uZUdhcFxuXHRwb3B1cDogZnVuY3Rpb24odXJsLCByZWRpcmVjdFVyaSwgb3B0aW9ucykge1xuXG5cdFx0dmFyIGRvY3VtZW50RWxlbWVudCA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDtcblxuXHRcdC8vIE11bHRpIFNjcmVlbiBQb3B1cCBQb3NpdGlvbmluZyAoaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL2EvMTY4NjEwNTApXG5cdFx0Ly8gQ3JlZGl0OiBodHRwOi8vd3d3Lnh0Zi5kay8yMDExLzA4L2NlbnRlci1uZXctcG9wdXAtd2luZG93LWV2ZW4tb24uaHRtbFxuXHRcdC8vIEZpeGVzIGR1YWwtc2NyZWVuIHBvc2l0aW9uICAgICAgICAgICAgICAgICAgICAgICAgIE1vc3QgYnJvd3NlcnMgICAgICBGaXJlZm94XG5cblx0XHRpZiAob3B0aW9ucy5oZWlnaHQpIHtcblx0XHRcdHZhciBkdWFsU2NyZWVuVG9wID0gd2luZG93LnNjcmVlblRvcCAhPT0gdW5kZWZpbmVkID8gd2luZG93LnNjcmVlblRvcCA6IHNjcmVlbi50b3A7XG5cdFx0XHR2YXIgaGVpZ2h0ID0gc2NyZWVuLmhlaWdodCB8fCB3aW5kb3cuaW5uZXJIZWlnaHQgfHwgZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodDtcblx0XHRcdG9wdGlvbnMudG9wID0gcGFyc2VJbnQoKGhlaWdodCAtIG9wdGlvbnMuaGVpZ2h0KSAvIDIsIDEwKSArIGR1YWxTY3JlZW5Ub3A7XG5cdFx0fVxuXG5cdFx0aWYgKG9wdGlvbnMud2lkdGgpIHtcblx0XHRcdHZhciBkdWFsU2NyZWVuTGVmdCA9IHdpbmRvdy5zY3JlZW5MZWZ0ICE9PSB1bmRlZmluZWQgPyB3aW5kb3cuc2NyZWVuTGVmdCA6IHNjcmVlbi5sZWZ0O1xuXHRcdFx0dmFyIHdpZHRoID0gc2NyZWVuLndpZHRoIHx8IHdpbmRvdy5pbm5lcldpZHRoIHx8IGRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aDtcblx0XHRcdG9wdGlvbnMubGVmdCA9IHBhcnNlSW50KCh3aWR0aCAtIG9wdGlvbnMud2lkdGgpIC8gMiwgMTApICsgZHVhbFNjcmVlbkxlZnQ7XG5cdFx0fVxuXG5cdFx0Ly8gQ29udmVydCBvcHRpb25zIGludG8gYW4gYXJyYXlcblx0XHR2YXIgb3B0aW9uc0FycmF5ID0gW107XG5cdFx0T2JqZWN0LmtleXMob3B0aW9ucykuZm9yRWFjaChmdW5jdGlvbihuYW1lKSB7XG5cdFx0XHR2YXIgdmFsdWUgPSBvcHRpb25zW25hbWVdO1xuXHRcdFx0b3B0aW9uc0FycmF5LnB1c2gobmFtZSArICh2YWx1ZSAhPT0gbnVsbCA/ICc9JyArIHZhbHVlIDogJycpKTtcblx0XHR9KTtcblxuXHRcdC8vIENhbGwgdGhlIG9wZW4oKSBmdW5jdGlvbiB3aXRoIHRoZSBpbml0aWFsIHBhdGhcblx0XHQvL1xuXHRcdC8vIE9BdXRoIHJlZGlyZWN0LCBmaXhlcyBVUkkgZnJhZ21lbnRzIGZyb20gYmVpbmcgbG9zdCBpbiBTYWZhcmlcblx0XHQvLyAoVVJJIEZyYWdtZW50cyB3aXRoaW4gMzAyIExvY2F0aW9uIFVSSSBhcmUgbG9zdCBvdmVyIEhUVFBTKVxuXHRcdC8vIExvYWRpbmcgdGhlIHJlZGlyZWN0Lmh0bWwgYmVmb3JlIHRyaWdnZXJpbmcgdGhlIE9BdXRoIEZsb3cgc2VlbXMgdG8gZml4IGl0LlxuXHRcdC8vXG5cdFx0Ly8gRmlyZWZveCAgZGVjb2RlcyBVUkwgZnJhZ21lbnRzIHdoZW4gY2FsbGluZyBsb2NhdGlvbi5oYXNoLlxuXHRcdC8vICAtIFRoaXMgaXMgYmFkIGlmIHRoZSB2YWx1ZSBjb250YWlucyBicmVhayBwb2ludHMgd2hpY2ggYXJlIGVzY2FwZWRcblx0XHQvLyAgLSBIZW5jZSB0aGUgdXJsIG11c3QgYmUgZW5jb2RlZCB0d2ljZSBhcyBpdCBjb250YWlucyBicmVha3BvaW50cy5cblx0XHRpZiAobmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCdTYWZhcmknKSAhPT0gLTEgJiYgbmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCdDaHJvbWUnKSA9PT0gLTEpIHtcblx0XHRcdHVybCA9IHJlZGlyZWN0VXJpICsgJyNvYXV0aF9yZWRpcmVjdD0nICsgZW5jb2RlVVJJQ29tcG9uZW50KGVuY29kZVVSSUNvbXBvbmVudCh1cmwpKTtcblx0XHR9XG5cdFx0dmFyIHBvcHVwID0gd2luZG93Lm9wZW4oXG5cdFx0XHR1cmwsXG5cdFx0XHQnX2JsYW5rJyxcblx0XHRcdG9wdGlvbnNBcnJheS5qb2luKCcsJylcblx0XHQpO1xuXG5cdFx0aWYgKHBvcHVwICYmIHBvcHVwLmZvY3VzKSB7XG5cdFx0XHRwb3B1cC5mb2N1cygpO1xuXHRcdH1cblxuXHRcdHJldHVybiBwb3B1cDtcblx0fSxcblxuXHQvLyBPQXV0aCBhbmQgQVBJIHJlc3BvbnNlIGhhbmRsZXJcblx0cmVzcG9uc2VIYW5kbGVyOiBmdW5jdGlvbih3aW5kb3csIHBhcmVudCkge1xuXG5cdFx0dmFyIF90aGlzID0gdGhpcztcblx0XHR2YXIgcDtcblx0XHR2YXIgbG9jYXRpb24gPSB3aW5kb3cubG9jYXRpb247XG5cblx0XHQvLyBJcyB0aGlzIGFuIGF1dGggcmVsYXkgbWVzc2FnZSB3aGljaCBuZWVkcyB0byBjYWxsIHRoZSBwcm94eT9cblx0XHRwID0gX3RoaXMucGFyYW0obG9jYXRpb24uc2VhcmNoKTtcblxuXHRcdC8vIE9BdXRoMiBvciBPQXV0aDEgc2VydmVyIHJlc3BvbnNlP1xuXHRcdGlmIChwICYmIHAuc3RhdGUgJiYgKHAuY29kZSB8fCBwLm9hdXRoX3Rva2VuKSkge1xuXG5cdFx0XHR2YXIgc3RhdGUgPSBKU09OLnBhcnNlKHAuc3RhdGUpO1xuXG5cdFx0XHQvLyBBZGQgdGhpcyBwYXRoIGFzIHRoZSByZWRpcmVjdF91cmlcblx0XHRcdHAucmVkaXJlY3RfdXJpID0gc3RhdGUucmVkaXJlY3RfdXJpIHx8IGxvY2F0aW9uLmhyZWYucmVwbGFjZSgvW1xcP1xcI10uKiQvLCAnJyk7XG5cblx0XHRcdC8vIFJlZGlyZWN0IHRvIHRoZSBob3N0XG5cdFx0XHR2YXIgcGF0aCA9IHN0YXRlLm9hdXRoX3Byb3h5ICsgJz8nICsgX3RoaXMucGFyYW0ocCk7XG5cblx0XHRcdGxvY2F0aW9uLmFzc2lnbihwYXRoKTtcblxuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdC8vIFNhdmUgc2Vzc2lvbiwgZnJvbSByZWRpcmVjdGVkIGF1dGhlbnRpY2F0aW9uXG5cdFx0Ly8gI2FjY2Vzc190b2tlbiBoYXMgY29tZSBpbj9cblx0XHQvL1xuXHRcdC8vIEZBQ0VCT09LIGlzIHJldHVybmluZyBhdXRoIGVycm9ycyB3aXRoaW4gYXMgYSBxdWVyeV9zdHJpbmcuLi4gdGhhdHMgYSBzdGlja2xlciBmb3IgY29uc2lzdGVuY3kuXG5cdFx0Ly8gU291bmRDbG91ZCBpcyB0aGUgc3RhdGUgaW4gdGhlIHF1ZXJ5c3RyaW5nIGFuZCB0aGUgdG9rZW4gaW4gdGhlIGhhc2h0YWcsIHNvIHdlJ2xsIG1peCB0aGUgdHdvIHRvZ2V0aGVyXG5cblx0XHRwID0gX3RoaXMubWVyZ2UoX3RoaXMucGFyYW0obG9jYXRpb24uc2VhcmNoIHx8ICcnKSwgX3RoaXMucGFyYW0obG9jYXRpb24uaGFzaCB8fCAnJykpO1xuXG5cdFx0Ly8gSWYgcC5zdGF0ZVxuXHRcdGlmIChwICYmICdzdGF0ZScgaW4gcCkge1xuXG5cdFx0XHQvLyBSZW1vdmUgYW55IGFkZGl0aW9uIGluZm9ybWF0aW9uXG5cdFx0XHQvLyBFLmcuIHAuc3RhdGUgPSAnZmFjZWJvb2sucGFnZSc7XG5cdFx0XHR0cnkge1xuXHRcdFx0XHR2YXIgYSA9IEpTT04ucGFyc2UocC5zdGF0ZSk7XG5cdFx0XHRcdF90aGlzLmV4dGVuZChwLCBhKTtcblx0XHRcdH1cblx0XHRcdGNhdGNoIChlKSB7XG5cdFx0XHRcdGNvbnNvbGUuZXJyb3IoJ0NvdWxkIG5vdCBkZWNvZGUgc3RhdGUgcGFyYW1ldGVyJyk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIEFjY2Vzc190b2tlbj9cblx0XHRcdGlmICgoJ2FjY2Vzc190b2tlbicgaW4gcCAmJiBwLmFjY2Vzc190b2tlbikgJiYgcC5uZXR3b3JrKSB7XG5cblx0XHRcdFx0aWYgKCFwLmV4cGlyZXNfaW4gfHwgcGFyc2VJbnQocC5leHBpcmVzX2luLCAxMCkgPT09IDApIHtcblx0XHRcdFx0XHQvLyBJZiBwLmV4cGlyZXNfaW4gaXMgdW5zZXQsIHNldCB0byAwXG5cdFx0XHRcdFx0cC5leHBpcmVzX2luID0gMDtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHAuZXhwaXJlc19pbiA9IHBhcnNlSW50KHAuZXhwaXJlc19pbiwgMTApO1xuXHRcdFx0XHRwLmV4cGlyZXMgPSAoKG5ldyBEYXRlKCkpLmdldFRpbWUoKSAvIDFlMykgKyAocC5leHBpcmVzX2luIHx8ICg2MCAqIDYwICogMjQgKiAzNjUpKTtcblxuXHRcdFx0XHQvLyBMZXRzIHVzZSB0aGUgXCJzdGF0ZVwiIHRvIGFzc2lnbiBpdCB0byBvbmUgb2Ygb3VyIG5ldHdvcmtzXG5cdFx0XHRcdGF1dGhDYWxsYmFjayhwLCB3aW5kb3csIHBhcmVudCk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIEVycm9yPT9cblx0XHRcdC8vICZlcnJvcl9kZXNjcmlwdGlvbj0/XG5cdFx0XHQvLyAmc3RhdGU9P1xuXHRcdFx0ZWxzZSBpZiAoKCdlcnJvcicgaW4gcCAmJiBwLmVycm9yKSAmJiBwLm5ldHdvcmspIHtcblxuXHRcdFx0XHRwLmVycm9yID0ge1xuXHRcdFx0XHRcdGNvZGU6IHAuZXJyb3IsXG5cdFx0XHRcdFx0bWVzc2FnZTogcC5lcnJvcl9tZXNzYWdlIHx8IHAuZXJyb3JfZGVzY3JpcHRpb25cblx0XHRcdFx0fTtcblxuXHRcdFx0XHQvLyBMZXQgdGhlIHN0YXRlIGhhbmRsZXIgaGFuZGxlIGl0XG5cdFx0XHRcdGF1dGhDYWxsYmFjayhwLCB3aW5kb3csIHBhcmVudCk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIEFQSSBjYWxsLCBvciBhIGNhbmNlbGxlZCBsb2dpblxuXHRcdFx0Ly8gUmVzdWx0IGlzIHNlcmlhbGl6ZWQgSlNPTiBzdHJpbmdcblx0XHRcdGVsc2UgaWYgKHAuY2FsbGJhY2sgJiYgcC5jYWxsYmFjayBpbiBwYXJlbnQpIHtcblxuXHRcdFx0XHQvLyBUcmlnZ2VyIGEgZnVuY3Rpb24gaW4gdGhlIHBhcmVudFxuXHRcdFx0XHR2YXIgcmVzID0gJ3Jlc3VsdCcgaW4gcCAmJiBwLnJlc3VsdCA/IEpTT04ucGFyc2UocC5yZXN1bHQpIDogZmFsc2U7XG5cblx0XHRcdFx0Ly8gVHJpZ2dlciB0aGUgY2FsbGJhY2sgb24gdGhlIHBhcmVudFxuXHRcdFx0XHRwYXJlbnRbcC5jYWxsYmFja10ocmVzKTtcblx0XHRcdFx0Y2xvc2VXaW5kb3coKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gSWYgdGhpcyBwYWdlIGlzIHN0aWxsIG9wZW5cblx0XHRcdGlmIChwLnBhZ2VfdXJpKSB7XG5cdFx0XHRcdGxvY2F0aW9uLmFzc2lnbihwLnBhZ2VfdXJpKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBPQXV0aCByZWRpcmVjdCwgZml4ZXMgVVJJIGZyYWdtZW50cyBmcm9tIGJlaW5nIGxvc3QgaW4gU2FmYXJpXG5cdFx0Ly8gKFVSSSBGcmFnbWVudHMgd2l0aGluIDMwMiBMb2NhdGlvbiBVUkkgYXJlIGxvc3Qgb3ZlciBIVFRQUylcblx0XHQvLyBMb2FkaW5nIHRoZSByZWRpcmVjdC5odG1sIGJlZm9yZSB0cmlnZ2VyaW5nIHRoZSBPQXV0aCBGbG93IHNlZW1zIHRvIGZpeCBpdC5cblx0XHRlbHNlIGlmICgnb2F1dGhfcmVkaXJlY3QnIGluIHApIHtcblxuXHRcdFx0bG9jYXRpb24uYXNzaWduKGRlY29kZVVSSUNvbXBvbmVudChwLm9hdXRoX3JlZGlyZWN0KSk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Ly8gVHJpZ2dlciBhIGNhbGxiYWNrIHRvIGF1dGhlbnRpY2F0ZVxuXHRcdGZ1bmN0aW9uIGF1dGhDYWxsYmFjayhvYmosIHdpbmRvdywgcGFyZW50KSB7XG5cblx0XHRcdHZhciBjYiA9IG9iai5jYWxsYmFjaztcblx0XHRcdHZhciBuZXR3b3JrID0gb2JqLm5ldHdvcms7XG5cblx0XHRcdC8vIFRyaWdnZXIgdGhlIGNhbGxiYWNrIG9uIHRoZSBwYXJlbnRcblx0XHRcdF90aGlzLnN0b3JlKG5ldHdvcmssIG9iaik7XG5cblx0XHRcdC8vIElmIHRoaXMgaXMgYSBwYWdlIHJlcXVlc3QgaXQgaGFzIG5vIHBhcmVudCBvciBvcGVuZXIgd2luZG93IHRvIGhhbmRsZSBjYWxsYmFja3Ncblx0XHRcdGlmICgoJ2Rpc3BsYXknIGluIG9iaikgJiYgb2JqLmRpc3BsYXkgPT09ICdwYWdlJykge1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdC8vIFJlbW92ZSBmcm9tIHNlc3Npb24gb2JqZWN0XG5cdFx0XHRpZiAocGFyZW50ICYmIGNiICYmIGNiIGluIHBhcmVudCkge1xuXG5cdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0ZGVsZXRlIG9iai5jYWxsYmFjaztcblx0XHRcdFx0fVxuXHRcdFx0XHRjYXRjaCAoZSkge31cblxuXHRcdFx0XHQvLyBVcGRhdGUgc3RvcmVcblx0XHRcdFx0X3RoaXMuc3RvcmUobmV0d29yaywgb2JqKTtcblxuXHRcdFx0XHQvLyBDYWxsIHRoZSBnbG9iYWxFdmVudCBmdW5jdGlvbiBvbiB0aGUgcGFyZW50XG5cdFx0XHRcdC8vIEl0J3Mgc2FmZXIgdG8gcGFzcyBiYWNrIGEgc3RyaW5nIHRvIHRoZSBwYXJlbnQsXG5cdFx0XHRcdC8vIFJhdGhlciB0aGFuIGFuIG9iamVjdC9hcnJheSAoYmV0dGVyIGZvciBJRTgpXG5cdFx0XHRcdHZhciBzdHIgPSBKU09OLnN0cmluZ2lmeShvYmopO1xuXG5cdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0cGFyZW50W2NiXShzdHIpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGNhdGNoIChlKSB7XG5cdFx0XHRcdFx0Ly8gRXJyb3IgdGhyb3duIHdoaWxzdCBleGVjdXRpbmcgcGFyZW50IGNhbGxiYWNrXG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0Y2xvc2VXaW5kb3coKTtcblx0XHR9XG5cblx0XHRmdW5jdGlvbiBjbG9zZVdpbmRvdygpIHtcblxuXHRcdFx0aWYgKHdpbmRvdy5mcmFtZUVsZW1lbnQpIHtcblx0XHRcdFx0Ly8gSW5zaWRlIGFuIGlmcmFtZSwgcmVtb3ZlIGZyb20gcGFyZW50XG5cdFx0XHRcdHBhcmVudC5kb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKHdpbmRvdy5mcmFtZUVsZW1lbnQpO1xuXHRcdFx0fVxuXHRcdFx0ZWxzZSB7XG5cdFx0XHRcdC8vIENsb3NlIHRoaXMgY3VycmVudCB3aW5kb3dcblx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHR3aW5kb3cuY2xvc2UoKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRjYXRjaCAoZSkge31cblxuXHRcdFx0XHQvLyBJT1MgYnVnIHdvbnQgbGV0IHVzIGNsb3NlIGEgcG9wdXAgaWYgc3RpbGwgbG9hZGluZ1xuXHRcdFx0XHRpZiAod2luZG93LmFkZEV2ZW50TGlzdGVuZXIpIHtcblx0XHRcdFx0XHR3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0d2luZG93LmNsb3NlKCk7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdH1cblx0fVxufSk7XG5cbi8vIEV2ZW50c1xuLy8gRXh0ZW5kIHRoZSBoZWxsbyBvYmplY3Qgd2l0aCBpdHMgb3duIGV2ZW50IGluc3RhbmNlXG5oZWxsby51dGlscy5FdmVudC5jYWxsKGhlbGxvKTtcblxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIE1vbml0b3Jpbmcgc2Vzc2lvbiBzdGF0ZVxuLy8gQ2hlY2sgZm9yIHNlc3Npb24gY2hhbmdlc1xuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuKGZ1bmN0aW9uKGhlbGxvKSB7XG5cblx0Ly8gTW9uaXRvciBmb3IgYSBjaGFuZ2UgaW4gc3RhdGUgYW5kIGZpcmVcblx0dmFyIG9sZFNlc3Npb25zID0ge307XG5cblx0Ly8gSGFzaCBvZiBleHBpcmVkIHRva2Vuc1xuXHR2YXIgZXhwaXJlZCA9IHt9O1xuXG5cdC8vIExpc3RlbiB0byBvdGhlciB0cmlnZ2VycyB0byBBdXRoIGV2ZW50cywgdXNlIHRoZXNlIHRvIHVwZGF0ZSB0aGlzXG5cdGhlbGxvLm9uKCdhdXRoLmxvZ2luLCBhdXRoLmxvZ291dCcsIGZ1bmN0aW9uKGF1dGgpIHtcblx0XHRpZiAoYXV0aCAmJiB0eXBlb2YgKGF1dGgpID09PSAnb2JqZWN0JyAmJiBhdXRoLm5ldHdvcmspIHtcblx0XHRcdG9sZFNlc3Npb25zW2F1dGgubmV0d29ya10gPSBoZWxsby51dGlscy5zdG9yZShhdXRoLm5ldHdvcmspIHx8IHt9O1xuXHRcdH1cblx0fSk7XG5cblx0KGZ1bmN0aW9uIHNlbGYoKSB7XG5cblx0XHR2YXIgQ1VSUkVOVF9USU1FID0gKChuZXcgRGF0ZSgpKS5nZXRUaW1lKCkgLyAxZTMpO1xuXHRcdHZhciBlbWl0ID0gZnVuY3Rpb24oZXZlbnROYW1lKSB7XG5cdFx0XHRoZWxsby5lbWl0KCdhdXRoLicgKyBldmVudE5hbWUsIHtcblx0XHRcdFx0bmV0d29yazogbmFtZSxcblx0XHRcdFx0YXV0aFJlc3BvbnNlOiBzZXNzaW9uXG5cdFx0XHR9KTtcblx0XHR9O1xuXG5cdFx0Ly8gTG9vcCB0aHJvdWdoIHRoZSBzZXJ2aWNlc1xuXHRcdGZvciAodmFyIG5hbWUgaW4gaGVsbG8uc2VydmljZXMpIHtpZiAoaGVsbG8uc2VydmljZXMuaGFzT3duUHJvcGVydHkobmFtZSkpIHtcblxuXHRcdFx0aWYgKCFoZWxsby5zZXJ2aWNlc1tuYW1lXS5pZCkge1xuXHRcdFx0XHQvLyBXZSBoYXZlbid0IGF0dGFjaGVkIGFuIElEIHNvIGRvbnQgbGlzdGVuLlxuXHRcdFx0XHRjb250aW51ZTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gR2V0IHNlc3Npb25cblx0XHRcdHZhciBzZXNzaW9uID0gaGVsbG8udXRpbHMuc3RvcmUobmFtZSkgfHwge307XG5cdFx0XHR2YXIgcHJvdmlkZXIgPSBoZWxsby5zZXJ2aWNlc1tuYW1lXTtcblx0XHRcdHZhciBvbGRTZXNzID0gb2xkU2Vzc2lvbnNbbmFtZV0gfHwge307XG5cblx0XHRcdC8vIExpc3RlbiBmb3IgZ2xvYmFsRXZlbnRzIHRoYXQgZGlkIG5vdCBnZXQgdHJpZ2dlcmVkIGZyb20gdGhlIGNoaWxkXG5cdFx0XHRpZiAoc2Vzc2lvbiAmJiAnY2FsbGJhY2snIGluIHNlc3Npb24pIHtcblxuXHRcdFx0XHQvLyBUbyBkbyByZW1vdmUgZnJvbSBzZXNzaW9uIG9iamVjdC4uLlxuXHRcdFx0XHR2YXIgY2IgPSBzZXNzaW9uLmNhbGxiYWNrO1xuXHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdGRlbGV0ZSBzZXNzaW9uLmNhbGxiYWNrO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGNhdGNoIChlKSB7fVxuXG5cdFx0XHRcdC8vIFVwZGF0ZSBzdG9yZVxuXHRcdFx0XHQvLyBSZW1vdmluZyB0aGUgY2FsbGJhY2tcblx0XHRcdFx0aGVsbG8udXRpbHMuc3RvcmUobmFtZSwgc2Vzc2lvbik7XG5cblx0XHRcdFx0Ly8gRW1pdCBnbG9iYWwgZXZlbnRzXG5cdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0d2luZG93W2NiXShzZXNzaW9uKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRjYXRjaCAoZSkge31cblx0XHRcdH1cblxuXHRcdFx0Ly8gUmVmcmVzaCB0b2tlblxuXHRcdFx0aWYgKHNlc3Npb24gJiYgKCdleHBpcmVzJyBpbiBzZXNzaW9uKSAmJiBzZXNzaW9uLmV4cGlyZXMgPCBDVVJSRU5UX1RJTUUpIHtcblxuXHRcdFx0XHQvLyBJZiBhdXRvIHJlZnJlc2ggaXMgcG9zc2libGVcblx0XHRcdFx0Ly8gRWl0aGVyIHRoZSBicm93c2VyIHN1cHBvcnRzXG5cdFx0XHRcdHZhciByZWZyZXNoID0gcHJvdmlkZXIucmVmcmVzaCB8fCBzZXNzaW9uLnJlZnJlc2hfdG9rZW47XG5cblx0XHRcdFx0Ly8gSGFzIHRoZSByZWZyZXNoIGJlZW4gcnVuIHJlY2VudGx5P1xuXHRcdFx0XHRpZiAocmVmcmVzaCAmJiAoIShuYW1lIGluIGV4cGlyZWQpIHx8IGV4cGlyZWRbbmFtZV0gPCBDVVJSRU5UX1RJTUUpKSB7XG5cdFx0XHRcdFx0Ly8gVHJ5IHRvIHJlc2lnbmluXG5cdFx0XHRcdFx0aGVsbG8uZW1pdCgnbm90aWNlJywgbmFtZSArICcgaGFzIGV4cGlyZWQgdHJ5aW5nIHRvIHJlc2lnbmluJyk7XG5cdFx0XHRcdFx0aGVsbG8ubG9naW4obmFtZSwge2Rpc3BsYXk6ICdub25lJywgZm9yY2U6IGZhbHNlfSk7XG5cblx0XHRcdFx0XHQvLyBVcGRhdGUgZXhwaXJlZCwgZXZlcnkgMTAgbWludXRlc1xuXHRcdFx0XHRcdGV4cGlyZWRbbmFtZV0gPSBDVVJSRU5UX1RJTUUgKyA2MDA7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBEb2VzIHRoaXMgcHJvdmlkZXIgbm90IHN1cHBvcnQgcmVmcmVzaFxuXHRcdFx0XHRlbHNlIGlmICghcmVmcmVzaCAmJiAhKG5hbWUgaW4gZXhwaXJlZCkpIHtcblx0XHRcdFx0XHQvLyBMYWJlbCB0aGUgZXZlbnRcblx0XHRcdFx0XHRlbWl0KCdleHBpcmVkJyk7XG5cdFx0XHRcdFx0ZXhwaXJlZFtuYW1lXSA9IHRydWU7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBJZiBzZXNzaW9uIGhhcyBleHBpcmVkIHRoZW4gd2UgZG9udCB3YW50IHRvIHN0b3JlIGl0cyB2YWx1ZSB1bnRpbCBpdCBjYW4gYmUgZXN0YWJsaXNoZWQgdGhhdCBpdHMgYmVlbiB1cGRhdGVkXG5cdFx0XHRcdGNvbnRpbnVlO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBIYXMgc2Vzc2lvbiBjaGFuZ2VkP1xuXHRcdFx0ZWxzZSBpZiAob2xkU2Vzcy5hY2Nlc3NfdG9rZW4gPT09IHNlc3Npb24uYWNjZXNzX3Rva2VuICYmXG5cdFx0XHRvbGRTZXNzLmV4cGlyZXMgPT09IHNlc3Npb24uZXhwaXJlcykge1xuXHRcdFx0XHRjb250aW51ZTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gQWNjZXNzX3Rva2VuIGhhcyBiZWVuIHJlbW92ZWRcblx0XHRcdGVsc2UgaWYgKCFzZXNzaW9uLmFjY2Vzc190b2tlbiAmJiBvbGRTZXNzLmFjY2Vzc190b2tlbikge1xuXHRcdFx0XHRlbWl0KCdsb2dvdXQnKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gQWNjZXNzX3Rva2VuIGhhcyBiZWVuIGNyZWF0ZWRcblx0XHRcdGVsc2UgaWYgKHNlc3Npb24uYWNjZXNzX3Rva2VuICYmICFvbGRTZXNzLmFjY2Vzc190b2tlbikge1xuXHRcdFx0XHRlbWl0KCdsb2dpbicpO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBBY2Nlc3NfdG9rZW4gaGFzIGJlZW4gdXBkYXRlZFxuXHRcdFx0ZWxzZSBpZiAoc2Vzc2lvbi5leHBpcmVzICE9PSBvbGRTZXNzLmV4cGlyZXMpIHtcblx0XHRcdFx0ZW1pdCgndXBkYXRlJyk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIFVwZGF0ZWQgc3RvcmVkIHNlc3Npb25cblx0XHRcdG9sZFNlc3Npb25zW25hbWVdID0gc2Vzc2lvbjtcblxuXHRcdFx0Ly8gUmVtb3ZlIHRoZSBleHBpcmVkIGZsYWdzXG5cdFx0XHRpZiAobmFtZSBpbiBleHBpcmVkKSB7XG5cdFx0XHRcdGRlbGV0ZSBleHBpcmVkW25hbWVdO1xuXHRcdFx0fVxuXHRcdH19XG5cblx0XHQvLyBDaGVjayBlcnJvciBldmVudHNcblx0XHRzZXRUaW1lb3V0KHNlbGYsIDEwMDApO1xuXHR9KSgpO1xuXG59KShoZWxsbyk7XG5cbi8vIEVPRiBDT1JFIGxpYlxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gQVBJXG4vLyBAcGFyYW0gcGF0aCAgICBzdHJpbmdcbi8vIEBwYXJhbSBxdWVyeSAgIG9iamVjdCAob3B0aW9uYWwpXG4vLyBAcGFyYW0gbWV0aG9kICBzdHJpbmcgKG9wdGlvbmFsKVxuLy8gQHBhcmFtIGRhdGEgICAgb2JqZWN0IChvcHRpb25hbClcbi8vIEBwYXJhbSB0aW1lb3V0IGludGVnZXIgKG9wdGlvbmFsKVxuLy8gQHBhcmFtIGNhbGxiYWNrICBmdW5jdGlvbiAob3B0aW9uYWwpXG5cbmhlbGxvLmFwaSA9IGZ1bmN0aW9uKCkge1xuXG5cdC8vIFNob3J0aGFuZFxuXHR2YXIgX3RoaXMgPSB0aGlzO1xuXHR2YXIgdXRpbHMgPSBfdGhpcy51dGlscztcblx0dmFyIGVycm9yID0gdXRpbHMuZXJyb3I7XG5cblx0Ly8gQ29uc3RydWN0IGEgbmV3IFByb21pc2Ugb2JqZWN0XG5cdHZhciBwcm9taXNlID0gdXRpbHMuUHJvbWlzZSgpO1xuXG5cdC8vIEFyZ3VtZW50c1xuXHR2YXIgcCA9IHV0aWxzLmFyZ3Moe3BhdGg6ICdzIScsIHF1ZXJ5OiAnbycsIG1ldGhvZDogJ3MnLCBkYXRhOiAnbycsIHRpbWVvdXQ6ICdpJywgY2FsbGJhY2s6ICdmJ30sIGFyZ3VtZW50cyk7XG5cblx0Ly8gTWV0aG9kXG5cdHAubWV0aG9kID0gKHAubWV0aG9kIHx8ICdnZXQnKS50b0xvd2VyQ2FzZSgpO1xuXG5cdC8vIEhlYWRlcnNcblx0cC5oZWFkZXJzID0gcC5oZWFkZXJzIHx8IHt9O1xuXG5cdC8vIFF1ZXJ5XG5cdHAucXVlcnkgPSBwLnF1ZXJ5IHx8IHt9O1xuXG5cdC8vIElmIGdldCwgcHV0IGFsbCBwYXJhbWV0ZXJzIGludG8gcXVlcnlcblx0aWYgKHAubWV0aG9kID09PSAnZ2V0JyB8fCBwLm1ldGhvZCA9PT0gJ2RlbGV0ZScpIHtcblx0XHR1dGlscy5leHRlbmQocC5xdWVyeSwgcC5kYXRhKTtcblx0XHRwLmRhdGEgPSB7fTtcblx0fVxuXG5cdHZhciBkYXRhID0gcC5kYXRhID0gcC5kYXRhIHx8IHt9O1xuXG5cdC8vIENvbXBsZXRlZCBldmVudCBjYWxsYmFja1xuXHRwcm9taXNlLnRoZW4ocC5jYWxsYmFjaywgcC5jYWxsYmFjayk7XG5cblx0Ly8gUmVtb3ZlIHRoZSBuZXR3b3JrIGZyb20gcGF0aCwgZS5nLiBmYWNlYm9vazovbWUvZnJpZW5kc1xuXHQvLyBSZXN1bHRzIGluIHsgbmV0d29yayA6IGZhY2Vib29rLCBwYXRoIDogbWUvZnJpZW5kcyB9XG5cdGlmICghcC5wYXRoKSB7XG5cdFx0cmV0dXJuIHByb21pc2UucmVqZWN0KGVycm9yKCdpbnZhbGlkX3BhdGgnLCAnTWlzc2luZyB0aGUgcGF0aCBwYXJhbWV0ZXIgZnJvbSB0aGUgcmVxdWVzdCcpKTtcblx0fVxuXG5cdHAucGF0aCA9IHAucGF0aC5yZXBsYWNlKC9eXFwvKy8sICcnKTtcblx0dmFyIGEgPSAocC5wYXRoLnNwbGl0KC9bXFwvXFw6XS8sIDIpIHx8IFtdKVswXS50b0xvd2VyQ2FzZSgpO1xuXG5cdGlmIChhIGluIF90aGlzLnNlcnZpY2VzKSB7XG5cdFx0cC5uZXR3b3JrID0gYTtcblx0XHR2YXIgcmVnID0gbmV3IFJlZ0V4cCgnXicgKyBhICsgJzo/XFwvPycpO1xuXHRcdHAucGF0aCA9IHAucGF0aC5yZXBsYWNlKHJlZywgJycpO1xuXHR9XG5cblx0Ly8gTmV0d29yayAmIFByb3ZpZGVyXG5cdC8vIERlZmluZSB0aGUgbmV0d29yayB0aGF0IHRoaXMgcmVxdWVzdCBpcyBtYWRlIGZvclxuXHRwLm5ldHdvcmsgPSBfdGhpcy5zZXR0aW5ncy5kZWZhdWx0X3NlcnZpY2UgPSBwLm5ldHdvcmsgfHwgX3RoaXMuc2V0dGluZ3MuZGVmYXVsdF9zZXJ2aWNlO1xuXHR2YXIgbyA9IF90aGlzLnNlcnZpY2VzW3AubmV0d29ya107XG5cblx0Ly8gSU5WQUxJRFxuXHQvLyBJcyB0aGVyZSBubyBzZXJ2aWNlIGJ5IHRoZSBnaXZlbiBuZXR3b3JrIG5hbWU/XG5cdGlmICghbykge1xuXHRcdHJldHVybiBwcm9taXNlLnJlamVjdChlcnJvcignaW52YWxpZF9uZXR3b3JrJywgJ0NvdWxkIG5vdCBtYXRjaCB0aGUgc2VydmljZSByZXF1ZXN0ZWQ6ICcgKyBwLm5ldHdvcmspKTtcblx0fVxuXG5cdC8vIFBBVEhcblx0Ly8gQXMgbG9uZyBhcyB0aGUgcGF0aCBpc24ndCBmbGFnZ2VkIGFzIHVuYXZhaWFibGUsIGUuZy4gcGF0aCA9PSBmYWxzZVxuXG5cdGlmICghKCEocC5tZXRob2QgaW4gbykgfHwgIShwLnBhdGggaW4gb1twLm1ldGhvZF0pIHx8IG9bcC5tZXRob2RdW3AucGF0aF0gIT09IGZhbHNlKSkge1xuXHRcdHJldHVybiBwcm9taXNlLnJlamVjdChlcnJvcignaW52YWxpZF9wYXRoJywgJ1RoZSBwcm92aWRlZCBwYXRoIGlzIG5vdCBhdmFpbGFibGUgb24gdGhlIHNlbGVjdGVkIG5ldHdvcmsnKSk7XG5cdH1cblxuXHQvLyBQUk9YWVxuXHQvLyBPQXV0aDEgY2FsbHMgYWx3YXlzIG5lZWQgYSBwcm94eVxuXG5cdGlmICghcC5vYXV0aF9wcm94eSkge1xuXHRcdHAub2F1dGhfcHJveHkgPSBfdGhpcy5zZXR0aW5ncy5vYXV0aF9wcm94eTtcblx0fVxuXG5cdGlmICghKCdwcm94eScgaW4gcCkpIHtcblx0XHRwLnByb3h5ID0gcC5vYXV0aF9wcm94eSAmJiBvLm9hdXRoICYmIHBhcnNlSW50KG8ub2F1dGgudmVyc2lvbiwgMTApID09PSAxO1xuXHR9XG5cblx0Ly8gVElNRU9VVFxuXHQvLyBBZG9wdCB0aW1lb3V0IGZyb20gZ2xvYmFsIHNldHRpbmdzIGJ5IGRlZmF1bHRcblxuXHRpZiAoISgndGltZW91dCcgaW4gcCkpIHtcblx0XHRwLnRpbWVvdXQgPSBfdGhpcy5zZXR0aW5ncy50aW1lb3V0O1xuXHR9XG5cblx0Ly8gRm9ybWF0IHJlc3BvbnNlXG5cdC8vIFdoZXRoZXIgdG8gcnVuIHRoZSByYXcgcmVzcG9uc2UgdGhyb3VnaCBwb3N0IHByb2Nlc3NpbmcuXG5cdGlmICghKCdmb3JtYXRSZXNwb25zZScgaW4gcCkpIHtcblx0XHRwLmZvcm1hdFJlc3BvbnNlID0gdHJ1ZTtcblx0fVxuXG5cdC8vIEdldCB0aGUgY3VycmVudCBzZXNzaW9uXG5cdC8vIEFwcGVuZCB0aGUgYWNjZXNzX3Rva2VuIHRvIHRoZSBxdWVyeVxuXHRwLmF1dGhSZXNwb25zZSA9IF90aGlzLmdldEF1dGhSZXNwb25zZShwLm5ldHdvcmspO1xuXHRpZiAocC5hdXRoUmVzcG9uc2UgJiYgcC5hdXRoUmVzcG9uc2UuYWNjZXNzX3Rva2VuKSB7XG5cdFx0cC5xdWVyeS5hY2Nlc3NfdG9rZW4gPSBwLmF1dGhSZXNwb25zZS5hY2Nlc3NfdG9rZW47XG5cdH1cblxuXHR2YXIgdXJsID0gcC5wYXRoO1xuXHR2YXIgbTtcblxuXHQvLyBTdG9yZSB0aGUgcXVlcnkgYXMgb3B0aW9uc1xuXHQvLyBUaGlzIGlzIHVzZWQgdG8gcG9wdWxhdGUgdGhlIHJlcXVlc3Qgb2JqZWN0IGJlZm9yZSB0aGUgZGF0YSBpcyBhdWdtZW50ZWQgYnkgdGhlIHByZXdyYXAgaGFuZGxlcnMuXG5cdHAub3B0aW9ucyA9IHV0aWxzLmNsb25lKHAucXVlcnkpO1xuXG5cdC8vIENsb25lIHRoZSBkYXRhIG9iamVjdFxuXHQvLyBQcmV2ZW50IHRoaXMgc2NyaXB0IG92ZXJ3cml0aW5nIHRoZSBkYXRhIG9mIHRoZSBpbmNvbWluZyBvYmplY3QuXG5cdC8vIEVuc3VyZSB0aGF0IGV2ZXJ5dGltZSB3ZSBydW4gYW4gaXRlcmF0aW9uIHRoZSBjYWxsYmFja3MgaGF2ZW4ndCByZW1vdmVkIHNvbWUgZGF0YVxuXHRwLmRhdGEgPSB1dGlscy5jbG9uZShkYXRhKTtcblxuXHQvLyBVUkwgTWFwcGluZ1xuXHQvLyBJcyB0aGVyZSBhIG1hcCBmb3IgdGhlIGdpdmVuIFVSTD9cblx0dmFyIGFjdGlvbnMgPSBvW3snZGVsZXRlJzogJ2RlbCd9W3AubWV0aG9kXSB8fCBwLm1ldGhvZF0gfHwge307XG5cblx0Ly8gRXh0cmFwb2xhdGUgdGhlIFF1ZXJ5U3RyaW5nXG5cdC8vIFByb3ZpZGUgYSBjbGVhbiBwYXRoXG5cdC8vIE1vdmUgdGhlIHF1ZXJ5c3RyaW5nIGludG8gdGhlIGRhdGFcblx0aWYgKHAubWV0aG9kID09PSAnZ2V0Jykge1xuXG5cdFx0dmFyIHF1ZXJ5ID0gdXJsLnNwbGl0KC9bXFw/I10vKVsxXTtcblx0XHRpZiAocXVlcnkpIHtcblx0XHRcdHV0aWxzLmV4dGVuZChwLnF1ZXJ5LCB1dGlscy5wYXJhbShxdWVyeSkpO1xuXG5cdFx0XHQvLyBSZW1vdmUgdGhlIHF1ZXJ5IHBhcnQgZnJvbSB0aGUgVVJMXG5cdFx0XHR1cmwgPSB1cmwucmVwbGFjZSgvXFw/Lio/KCN8JCkvLCAnJDEnKTtcblx0XHR9XG5cdH1cblxuXHQvLyBJcyB0aGUgaGFzaCBmcmFnbWVudCBkZWZpbmVkXG5cdGlmICgobSA9IHVybC5tYXRjaCgvIyguKykvLCAnJykpKSB7XG5cdFx0dXJsID0gdXJsLnNwbGl0KCcjJylbMF07XG5cdFx0cC5wYXRoID0gbVsxXTtcblx0fVxuXHRlbHNlIGlmICh1cmwgaW4gYWN0aW9ucykge1xuXHRcdHAucGF0aCA9IHVybDtcblx0XHR1cmwgPSBhY3Rpb25zW3VybF07XG5cdH1cblx0ZWxzZSBpZiAoJ2RlZmF1bHQnIGluIGFjdGlvbnMpIHtcblx0XHR1cmwgPSBhY3Rpb25zWydkZWZhdWx0J107XG5cdH1cblxuXHQvLyBSZWRpcmVjdCBIYW5kbGVyXG5cdC8vIFRoaXMgZGVmaW5lcyBmb3IgdGhlIEZvcm0rSWZyYW1lK0hhc2ggaGFjayB3aGVyZSB0byByZXR1cm4gdGhlIHJlc3VsdHMgdG9vLlxuXHRwLnJlZGlyZWN0X3VyaSA9IF90aGlzLnNldHRpbmdzLnJlZGlyZWN0X3VyaTtcblxuXHQvLyBEZWZpbmUgRm9ybWF0SGFuZGxlclxuXHQvLyBUaGUgcmVxdWVzdCBjYW4gYmUgcHJvY2VzZWQgaW4gYSBtdWx0aXR1ZGUgb2Ygd2F5c1xuXHQvLyBIZXJlJ3MgdGhlIG9wdGlvbnMgLSBkZXBlbmRpbmcgb24gdGhlIGJyb3dzZXIgYW5kIGVuZHBvaW50XG5cdHAueGhyID0gby54aHI7XG5cdHAuanNvbnAgPSBvLmpzb25wO1xuXHRwLmZvcm0gPSBvLmZvcm07XG5cblx0Ly8gTWFrZSByZXF1ZXN0XG5cdGlmICh0eXBlb2YgKHVybCkgPT09ICdmdW5jdGlvbicpIHtcblx0XHQvLyBEb2VzIHNlbGYgaGF2ZSBpdHMgb3duIGNhbGxiYWNrP1xuXHRcdHVybChwLCBnZXRQYXRoKTtcblx0fVxuXHRlbHNlIHtcblx0XHQvLyBFbHNlIHRoZSBVUkwgaXMgYSBzdHJpbmdcblx0XHRnZXRQYXRoKHVybCk7XG5cdH1cblxuXHRyZXR1cm4gcHJvbWlzZS5wcm94eTtcblxuXHQvLyBJZiB1cmwgbmVlZHMgYSBiYXNlXG5cdC8vIFdyYXAgZXZlcnl0aGluZyBpblxuXHRmdW5jdGlvbiBnZXRQYXRoKHVybCkge1xuXG5cdFx0Ly8gRm9ybWF0IHRoZSBzdHJpbmcgaWYgaXQgbmVlZHMgaXRcblx0XHR1cmwgPSB1cmwucmVwbGFjZSgvXFxAXFx7KFthLXpcXF9cXC1dKykoXFx8Lio/KT9cXH0vZ2ksIGZ1bmN0aW9uKG0sIGtleSwgZGVmYXVsdHMpIHtcblx0XHRcdHZhciB2YWwgPSBkZWZhdWx0cyA/IGRlZmF1bHRzLnJlcGxhY2UoL15cXHwvLCAnJykgOiAnJztcblx0XHRcdGlmIChrZXkgaW4gcC5xdWVyeSkge1xuXHRcdFx0XHR2YWwgPSBwLnF1ZXJ5W2tleV07XG5cdFx0XHRcdGRlbGV0ZSBwLnF1ZXJ5W2tleV07XG5cdFx0XHR9XG5cdFx0XHRlbHNlIGlmIChwLmRhdGEgJiYga2V5IGluIHAuZGF0YSkge1xuXHRcdFx0XHR2YWwgPSBwLmRhdGFba2V5XTtcblx0XHRcdFx0ZGVsZXRlIHAuZGF0YVtrZXldO1xuXHRcdFx0fVxuXHRcdFx0ZWxzZSBpZiAoIWRlZmF1bHRzKSB7XG5cdFx0XHRcdHByb21pc2UucmVqZWN0KGVycm9yKCdtaXNzaW5nX2F0dHJpYnV0ZScsICdUaGUgYXR0cmlidXRlICcgKyBrZXkgKyAnIGlzIG1pc3NpbmcgZnJvbSB0aGUgcmVxdWVzdCcpKTtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIHZhbDtcblx0XHR9KTtcblxuXHRcdC8vIEFkZCBiYXNlXG5cdFx0aWYgKCF1cmwubWF0Y2goL15odHRwcz86XFwvXFwvLykpIHtcblx0XHRcdHVybCA9IG8uYmFzZSArIHVybDtcblx0XHR9XG5cblx0XHQvLyBEZWZpbmUgdGhlIHJlcXVlc3QgVVJMXG5cdFx0cC51cmwgPSB1cmw7XG5cblx0XHQvLyBNYWtlIHRoZSBIVFRQIHJlcXVlc3Qgd2l0aCB0aGUgY3VyYXRlZCByZXF1ZXN0IG9iamVjdFxuXHRcdC8vIENBTExCQUNLIEhBTkRMRVJcblx0XHQvLyBAIHJlc3BvbnNlIG9iamVjdFxuXHRcdC8vIEAgc3RhdHVzQ29kZSBpbnRlZ2VyIGlmIGF2YWlsYWJsZVxuXHRcdHV0aWxzLnJlcXVlc3QocCwgZnVuY3Rpb24ociwgaGVhZGVycykge1xuXG5cdFx0XHQvLyBJcyB0aGlzIGEgcmF3IHJlc3BvbnNlP1xuXHRcdFx0aWYgKCFwLmZvcm1hdFJlc3BvbnNlKSB7XG5cdFx0XHRcdC8vIEJhZCByZXF1ZXN0PyBlcnJvciBzdGF0dXNDb2RlIG9yIG90aGVyd2lzZSBjb250YWlucyBhbiBlcnJvciByZXNwb25zZSB2aXMgSlNPTlA/XG5cdFx0XHRcdGlmICh0eXBlb2YgaGVhZGVycyA9PT0gJ29iamVjdCcgPyAoaGVhZGVycy5zdGF0dXNDb2RlID49IDQwMCkgOiAodHlwZW9mIHIgPT09ICdvYmplY3QnICYmICdlcnJvcicgaW4gcikpIHtcblx0XHRcdFx0XHRwcm9taXNlLnJlamVjdChyKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRlbHNlIHtcblx0XHRcdFx0XHRwcm9taXNlLmZ1bGZpbGwocik7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdC8vIFNob3VsZCB0aGlzIGJlIGFuIG9iamVjdFxuXHRcdFx0aWYgKHIgPT09IHRydWUpIHtcblx0XHRcdFx0ciA9IHtzdWNjZXNzOnRydWV9O1xuXHRcdFx0fVxuXHRcdFx0ZWxzZSBpZiAoIXIpIHtcblx0XHRcdFx0ciA9IHt9O1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBUaGUgZGVsZXRlIGNhbGxiYWNrIG5lZWRzIGEgYmV0dGVyIHJlc3BvbnNlXG5cdFx0XHRpZiAocC5tZXRob2QgPT09ICdkZWxldGUnKSB7XG5cdFx0XHRcdHIgPSAoIXIgfHwgdXRpbHMuaXNFbXB0eShyKSkgPyB7c3VjY2Vzczp0cnVlfSA6IHI7XG5cdFx0XHR9XG5cblx0XHRcdC8vIEZPUk1BVCBSRVNQT05TRT9cblx0XHRcdC8vIERvZXMgc2VsZiByZXF1ZXN0IGhhdmUgYSBjb3JyZXNwb25kaW5nIGZvcm1hdHRlclxuXHRcdFx0aWYgKG8ud3JhcCAmJiAoKHAucGF0aCBpbiBvLndyYXApIHx8ICgnZGVmYXVsdCcgaW4gby53cmFwKSkpIHtcblx0XHRcdFx0dmFyIHdyYXAgPSAocC5wYXRoIGluIG8ud3JhcCA/IHAucGF0aCA6ICdkZWZhdWx0Jyk7XG5cdFx0XHRcdHZhciB0aW1lID0gKG5ldyBEYXRlKCkpLmdldFRpbWUoKTtcblxuXHRcdFx0XHQvLyBGT1JNQVQgUkVTUE9OU0Vcblx0XHRcdFx0dmFyIGIgPSBvLndyYXBbd3JhcF0ociwgaGVhZGVycywgcCk7XG5cblx0XHRcdFx0Ly8gSGFzIHRoZSByZXNwb25zZSBiZWVuIHV0dGVybHkgb3ZlcndyaXR0ZW4/XG5cdFx0XHRcdC8vIFR5cGljYWxseSBzZWxmIGF1Z21lbnRzIHRoZSBleGlzdGluZyBvYmplY3QuLiBidXQgZm9yIHRob3NlIHJhcmUgb2NjYXNzaW9uc1xuXHRcdFx0XHRpZiAoYikge1xuXHRcdFx0XHRcdHIgPSBiO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdC8vIElzIHRoZXJlIGEgbmV4dF9wYWdlIGRlZmluZWQgaW4gdGhlIHJlc3BvbnNlP1xuXHRcdFx0aWYgKHIgJiYgJ3BhZ2luZycgaW4gciAmJiByLnBhZ2luZy5uZXh0KSB7XG5cblx0XHRcdFx0Ly8gQWRkIHRoZSByZWxhdGl2ZSBwYXRoIGlmIGl0IGlzIG1pc3NpbmcgZnJvbSB0aGUgcGFnaW5nL25leHQgcGF0aFxuXHRcdFx0XHRpZiAoci5wYWdpbmcubmV4dFswXSA9PT0gJz8nKSB7XG5cdFx0XHRcdFx0ci5wYWdpbmcubmV4dCA9IHAucGF0aCArIHIucGFnaW5nLm5leHQ7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBUaGUgcmVsYXRpdmUgcGF0aCBoYXMgYmVlbiBkZWZpbmVkLCBsZXRzIG1hcmt1cCB0aGUgaGFuZGxlciBpbiB0aGUgSGFzaEZyYWdtZW50XG5cdFx0XHRcdGVsc2Uge1xuXHRcdFx0XHRcdHIucGFnaW5nLm5leHQgKz0gJyMnICsgcC5wYXRoO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdC8vIERpc3BhdGNoIHRvIGxpc3RlbmVyc1xuXHRcdFx0Ly8gRW1pdCBldmVudHMgd2hpY2ggcGVydGFpbiB0byB0aGUgZm9ybWF0dGVkIHJlc3BvbnNlXG5cdFx0XHRpZiAoIXIgfHwgJ2Vycm9yJyBpbiByKSB7XG5cdFx0XHRcdHByb21pc2UucmVqZWN0KHIpO1xuXHRcdFx0fVxuXHRcdFx0ZWxzZSB7XG5cdFx0XHRcdHByb21pc2UuZnVsZmlsbChyKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxufTtcblxuLy8gQVBJIHV0aWxpdGllc1xuaGVsbG8udXRpbHMuZXh0ZW5kKGhlbGxvLnV0aWxzLCB7XG5cblx0Ly8gTWFrZSBhbiBIVFRQIHJlcXVlc3Rcblx0cmVxdWVzdDogZnVuY3Rpb24ocCwgY2FsbGJhY2spIHtcblxuXHRcdHZhciBfdGhpcyA9IHRoaXM7XG5cdFx0dmFyIGVycm9yID0gX3RoaXMuZXJyb3I7XG5cblx0XHQvLyBUaGlzIGhhcyB0byBnbyB0aHJvdWdoIGEgUE9TVCByZXF1ZXN0XG5cdFx0aWYgKCFfdGhpcy5pc0VtcHR5KHAuZGF0YSkgJiYgISgnRmlsZUxpc3QnIGluIHdpbmRvdykgJiYgX3RoaXMuaGFzQmluYXJ5KHAuZGF0YSkpIHtcblxuXHRcdFx0Ly8gRGlzYWJsZSBYSFIgYW5kIEpTT05QXG5cdFx0XHRwLnhociA9IGZhbHNlO1xuXHRcdFx0cC5qc29ucCA9IGZhbHNlO1xuXHRcdH1cblxuXHRcdC8vIENoZWNrIGlmIHRoZSBicm93c2VyIGFuZCBzZXJ2aWNlIHN1cHBvcnQgQ09SU1xuXHRcdHZhciBjb3JzID0gdGhpcy5yZXF1ZXN0X2NvcnMoZnVuY3Rpb24oKSB7XG5cdFx0XHQvLyBJZiBpdCBkb2VzIHRoZW4gcnVuIHRoaXMuLi5cblx0XHRcdHJldHVybiAoKHAueGhyID09PSB1bmRlZmluZWQpIHx8IChwLnhociAmJiAodHlwZW9mIChwLnhocikgIT09ICdmdW5jdGlvbicgfHwgcC54aHIocCwgcC5xdWVyeSkpKSk7XG5cdFx0fSk7XG5cblx0XHRpZiAoY29ycykge1xuXG5cdFx0XHRmb3JtYXRVcmwocCwgZnVuY3Rpb24odXJsKSB7XG5cblx0XHRcdFx0dmFyIHggPSBfdGhpcy54aHIocC5tZXRob2QsIHVybCwgcC5oZWFkZXJzLCBwLmRhdGEsIGNhbGxiYWNrKTtcblx0XHRcdFx0eC5vbnByb2dyZXNzID0gcC5vbnByb2dyZXNzIHx8IG51bGw7XG5cblx0XHRcdFx0Ly8gV2luZG93cyBQaG9uZSBkb2VzIG5vdCBzdXBwb3J0IHhoci51cGxvYWQsIHNlZSAjNzRcblx0XHRcdFx0Ly8gRmVhdHVyZSBkZXRlY3Rcblx0XHRcdFx0aWYgKHgudXBsb2FkICYmIHAub251cGxvYWRwcm9ncmVzcykge1xuXHRcdFx0XHRcdHgudXBsb2FkLm9ucHJvZ3Jlc3MgPSBwLm9udXBsb2FkcHJvZ3Jlc3M7XG5cdFx0XHRcdH1cblxuXHRcdFx0fSk7XG5cblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQvLyBDbG9uZSB0aGUgcXVlcnkgb2JqZWN0XG5cdFx0Ly8gRWFjaCByZXF1ZXN0IG1vZGlmaWVzIHRoZSBxdWVyeSBvYmplY3QgYW5kIG5lZWRzIHRvIGJlIHRhcmVkIGFmdGVyIGVhY2ggb25lLlxuXHRcdHZhciBfcXVlcnkgPSBwLnF1ZXJ5O1xuXG5cdFx0cC5xdWVyeSA9IF90aGlzLmNsb25lKHAucXVlcnkpO1xuXG5cdFx0Ly8gQXNzaWduIGEgbmV3IGNhbGxiYWNrSURcblx0XHRwLmNhbGxiYWNrSUQgPSBfdGhpcy5nbG9iYWxFdmVudCgpO1xuXG5cdFx0Ly8gSlNPTlBcblx0XHRpZiAocC5qc29ucCAhPT0gZmFsc2UpIHtcblxuXHRcdFx0Ly8gQ2xvbmUgdGhlIHF1ZXJ5IG9iamVjdFxuXHRcdFx0cC5xdWVyeS5jYWxsYmFjayA9IHAuY2FsbGJhY2tJRDtcblxuXHRcdFx0Ly8gSWYgdGhlIEpTT05QIGlzIGEgZnVuY3Rpb24gdGhlbiBydW4gaXRcblx0XHRcdGlmICh0eXBlb2YgKHAuanNvbnApID09PSAnZnVuY3Rpb24nKSB7XG5cdFx0XHRcdHAuanNvbnAocCwgcC5xdWVyeSk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIExldHMgdXNlIEpTT05QIGlmIHRoZSBtZXRob2QgaXMgJ2dldCdcblx0XHRcdGlmIChwLm1ldGhvZCA9PT0gJ2dldCcpIHtcblxuXHRcdFx0XHRmb3JtYXRVcmwocCwgZnVuY3Rpb24odXJsKSB7XG5cdFx0XHRcdFx0X3RoaXMuanNvbnAodXJsLCBjYWxsYmFjaywgcC5jYWxsYmFja0lELCBwLnRpbWVvdXQpO1xuXHRcdFx0XHR9KTtcblxuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cdFx0XHRlbHNlIHtcblx0XHRcdFx0Ly8gSXQncyBub3QgY29tcGF0aWJsZSByZXNldCBxdWVyeVxuXHRcdFx0XHRwLnF1ZXJ5ID0gX3F1ZXJ5O1xuXHRcdFx0fVxuXG5cdFx0fVxuXG5cdFx0Ly8gT3RoZXJ3aXNlIHdlJ3JlIG9uIHRvIHRoZSBvbGQgc2Nob29sLCBpZnJhbWUgaGFja3MgYW5kIEpTT05QXG5cdFx0aWYgKHAuZm9ybSAhPT0gZmFsc2UpIHtcblxuXHRcdFx0Ly8gQWRkIHNvbWUgYWRkaXRpb25hbCBxdWVyeSBwYXJhbWV0ZXJzIHRvIHRoZSBVUkxcblx0XHRcdC8vIFdlJ3JlIHByZXR0eSBzdHVmZmVkIGlmIHRoZSBlbmRwb2ludCBkb2Vzbid0IGxpa2UgdGhlc2Vcblx0XHRcdHAucXVlcnkucmVkaXJlY3RfdXJpID0gcC5yZWRpcmVjdF91cmk7XG5cdFx0XHRwLnF1ZXJ5LnN0YXRlID0gSlNPTi5zdHJpbmdpZnkoe2NhbGxiYWNrOnAuY2FsbGJhY2tJRH0pO1xuXG5cdFx0XHR2YXIgb3B0cztcblxuXHRcdFx0aWYgKHR5cGVvZiAocC5mb3JtKSA9PT0gJ2Z1bmN0aW9uJykge1xuXG5cdFx0XHRcdC8vIEZvcm1hdCB0aGUgcmVxdWVzdFxuXHRcdFx0XHRvcHRzID0gcC5mb3JtKHAsIHAucXVlcnkpO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAocC5tZXRob2QgPT09ICdwb3N0JyAmJiBvcHRzICE9PSBmYWxzZSkge1xuXG5cdFx0XHRcdGZvcm1hdFVybChwLCBmdW5jdGlvbih1cmwpIHtcblx0XHRcdFx0XHRfdGhpcy5wb3N0KHVybCwgcC5kYXRhLCBvcHRzLCBjYWxsYmFjaywgcC5jYWxsYmFja0lELCBwLnRpbWVvdXQpO1xuXHRcdFx0XHR9KTtcblxuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gTm9uZSBvZiB0aGUgbWV0aG9kcyB3ZXJlIHN1Y2Nlc3NmdWwgdGhyb3cgYW4gZXJyb3Jcblx0XHRjYWxsYmFjayhlcnJvcignaW52YWxpZF9yZXF1ZXN0JywgJ1RoZXJlIHdhcyBubyBtZWNoYW5pc20gZm9yIGhhbmRsaW5nIHRoaXMgcmVxdWVzdCcpKTtcblxuXHRcdHJldHVybjtcblxuXHRcdC8vIEZvcm1hdCBVUkxcblx0XHQvLyBDb25zdHJ1Y3RzIHRoZSByZXF1ZXN0IFVSTCwgb3B0aW9uYWxseSB3cmFwcyB0aGUgVVJMIHRocm91Z2ggYSBjYWxsIHRvIGEgcHJveHkgc2VydmVyXG5cdFx0Ly8gUmV0dXJucyB0aGUgZm9ybWF0dGVkIFVSTFxuXHRcdGZ1bmN0aW9uIGZvcm1hdFVybChwLCBjYWxsYmFjaykge1xuXG5cdFx0XHQvLyBBcmUgd2Ugc2lnbmluZyB0aGUgcmVxdWVzdD9cblx0XHRcdHZhciBzaWduO1xuXG5cdFx0XHQvLyBPQXV0aDFcblx0XHRcdC8vIFJlbW92ZSB0aGUgdG9rZW4gZnJvbSB0aGUgcXVlcnkgYmVmb3JlIHNpZ25pbmdcblx0XHRcdGlmIChwLmF1dGhSZXNwb25zZSAmJiBwLmF1dGhSZXNwb25zZS5vYXV0aCAmJiBwYXJzZUludChwLmF1dGhSZXNwb25zZS5vYXV0aC52ZXJzaW9uLCAxMCkgPT09IDEpIHtcblxuXHRcdFx0XHQvLyBPQVVUSCBTSUdOSU5HIFBST1hZXG5cdFx0XHRcdHNpZ24gPSBwLnF1ZXJ5LmFjY2Vzc190b2tlbjtcblxuXHRcdFx0XHQvLyBSZW1vdmUgdGhlIGFjY2Vzc190b2tlblxuXHRcdFx0XHRkZWxldGUgcC5xdWVyeS5hY2Nlc3NfdG9rZW47XG5cblx0XHRcdFx0Ly8gRW5mb3JlIHVzZSBvZiBQcm94eVxuXHRcdFx0XHRwLnByb3h5ID0gdHJ1ZTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gUE9TVCBib2R5IHRvIHF1ZXJ5c3RyaW5nXG5cdFx0XHRpZiAocC5kYXRhICYmIChwLm1ldGhvZCA9PT0gJ2dldCcgfHwgcC5tZXRob2QgPT09ICdkZWxldGUnKSkge1xuXHRcdFx0XHQvLyBBdHRhY2ggdGhlIHAuZGF0YSB0byB0aGUgcXVlcnlzdHJpbmcuXG5cdFx0XHRcdF90aGlzLmV4dGVuZChwLnF1ZXJ5LCBwLmRhdGEpO1xuXHRcdFx0XHRwLmRhdGEgPSBudWxsO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBDb25zdHJ1Y3QgdGhlIHBhdGhcblx0XHRcdHZhciBwYXRoID0gX3RoaXMucXMocC51cmwsIHAucXVlcnkpO1xuXG5cdFx0XHQvLyBQcm94eSB0aGUgcmVxdWVzdCB0aHJvdWdoIGEgc2VydmVyXG5cdFx0XHQvLyBVc2VkIGZvciBzaWduaW5nIE9BdXRoMVxuXHRcdFx0Ly8gQW5kIGNpcmN1bXZlbnRpbmcgc2VydmljZXMgd2l0aG91dCBBY2Nlc3MtQ29udHJvbCBIZWFkZXJzXG5cdFx0XHRpZiAocC5wcm94eSkge1xuXHRcdFx0XHQvLyBVc2UgdGhlIHByb3h5IGFzIGEgcGF0aFxuXHRcdFx0XHRwYXRoID0gX3RoaXMucXMocC5vYXV0aF9wcm94eSwge1xuXHRcdFx0XHRcdHBhdGg6IHBhdGgsXG5cdFx0XHRcdFx0YWNjZXNzX3Rva2VuOiBzaWduIHx8ICcnLFxuXG5cdFx0XHRcdFx0Ly8gVGhpcyB3aWxsIHByb21wdCB0aGUgcmVxdWVzdCB0byBiZSBzaWduZWQgYXMgdGhvdWdoIGl0IGlzIE9BdXRoMVxuXHRcdFx0XHRcdHRoZW46IHAucHJveHlfcmVzcG9uc2VfdHlwZSB8fCAocC5tZXRob2QudG9Mb3dlckNhc2UoKSA9PT0gJ2dldCcgPyAncmVkaXJlY3QnIDogJ3Byb3h5JyksXG5cdFx0XHRcdFx0bWV0aG9kOiBwLm1ldGhvZC50b0xvd2VyQ2FzZSgpLFxuXHRcdFx0XHRcdHN1cHByZXNzX3Jlc3BvbnNlX2NvZGVzOiB0cnVlXG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXG5cdFx0XHRjYWxsYmFjayhwYXRoKTtcblx0XHR9XG5cdH0sXG5cblx0Ly8gVGVzdCB3aGV0aGVyIHRoZSBicm93c2VyIHN1cHBvcnRzIHRoZSBDT1JTIHJlc3BvbnNlXG5cdHJlcXVlc3RfY29yczogZnVuY3Rpb24oY2FsbGJhY2spIHtcblx0XHRyZXR1cm4gJ3dpdGhDcmVkZW50aWFscycgaW4gbmV3IFhNTEh0dHBSZXF1ZXN0KCkgJiYgY2FsbGJhY2soKTtcblx0fSxcblxuXHQvLyBSZXR1cm4gdGhlIHR5cGUgb2YgRE9NIG9iamVjdFxuXHRkb21JbnN0YW5jZTogZnVuY3Rpb24odHlwZSwgZGF0YSkge1xuXHRcdHZhciB0ZXN0ID0gJ0hUTUwnICsgKHR5cGUgfHwgJycpLnJlcGxhY2UoXG5cdFx0XHQvXlthLXpdLyxcblx0XHRcdGZ1bmN0aW9uKG0pIHtcblx0XHRcdFx0cmV0dXJuIG0udG9VcHBlckNhc2UoKTtcblx0XHRcdH1cblxuXHRcdCkgKyAnRWxlbWVudCc7XG5cblx0XHRpZiAoIWRhdGEpIHtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cblx0XHRpZiAod2luZG93W3Rlc3RdKSB7XG5cdFx0XHRyZXR1cm4gZGF0YSBpbnN0YW5jZW9mIHdpbmRvd1t0ZXN0XTtcblx0XHR9XG5cdFx0ZWxzZSBpZiAod2luZG93LkVsZW1lbnQpIHtcblx0XHRcdHJldHVybiBkYXRhIGluc3RhbmNlb2Ygd2luZG93LkVsZW1lbnQgJiYgKCF0eXBlIHx8IChkYXRhLnRhZ05hbWUgJiYgZGF0YS50YWdOYW1lLnRvTG93ZXJDYXNlKCkgPT09IHR5cGUpKTtcblx0XHR9XG5cdFx0ZWxzZSB7XG5cdFx0XHRyZXR1cm4gKCEoZGF0YSBpbnN0YW5jZW9mIE9iamVjdCB8fCBkYXRhIGluc3RhbmNlb2YgQXJyYXkgfHwgZGF0YSBpbnN0YW5jZW9mIFN0cmluZyB8fCBkYXRhIGluc3RhbmNlb2YgTnVtYmVyKSAmJiBkYXRhLnRhZ05hbWUgJiYgZGF0YS50YWdOYW1lLnRvTG93ZXJDYXNlKCkgPT09IHR5cGUpO1xuXHRcdH1cblx0fSxcblxuXHQvLyBDcmVhdGUgYSBjbG9uZSBvZiBhbiBvYmplY3Rcblx0Y2xvbmU6IGZ1bmN0aW9uKG9iaikge1xuXHRcdC8vIERvZXMgbm90IGNsb25lIERPTSBlbGVtZW50cywgbm9yIEJpbmFyeSBkYXRhLCBlLmcuIEJsb2JzLCBGaWxlbGlzdHNcblx0XHRpZiAob2JqID09PSBudWxsIHx8IHR5cGVvZiAob2JqKSAhPT0gJ29iamVjdCcgfHwgb2JqIGluc3RhbmNlb2YgRGF0ZSB8fCAnbm9kZU5hbWUnIGluIG9iaiB8fCB0aGlzLmlzQmluYXJ5KG9iaikgfHwgKHR5cGVvZiBGb3JtRGF0YSA9PT0gJ2Z1bmN0aW9uJyAmJiBvYmogaW5zdGFuY2VvZiBGb3JtRGF0YSkpIHtcblx0XHRcdHJldHVybiBvYmo7XG5cdFx0fVxuXG5cdFx0aWYgKEFycmF5LmlzQXJyYXkob2JqKSkge1xuXHRcdFx0Ly8gQ2xvbmUgZWFjaCBpdGVtIGluIHRoZSBhcnJheVxuXHRcdFx0cmV0dXJuIG9iai5tYXAodGhpcy5jbG9uZS5iaW5kKHRoaXMpKTtcblx0XHR9XG5cblx0XHQvLyBCdXQgZG9lcyBjbG9uZSBldmVyeXRoaW5nIGVsc2UuXG5cdFx0dmFyIGNsb25lID0ge307XG5cdFx0Zm9yICh2YXIgeCBpbiBvYmopIHtcblx0XHRcdGNsb25lW3hdID0gdGhpcy5jbG9uZShvYmpbeF0pO1xuXHRcdH1cblxuXHRcdHJldHVybiBjbG9uZTtcblx0fSxcblxuXHQvLyBYSFI6IHVzZXMgQ09SUyB0byBtYWtlIHJlcXVlc3RzXG5cdHhocjogZnVuY3Rpb24obWV0aG9kLCB1cmwsIGhlYWRlcnMsIGRhdGEsIGNhbGxiYWNrKSB7XG5cblx0XHR2YXIgciA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuXHRcdHZhciBlcnJvciA9IHRoaXMuZXJyb3I7XG5cblx0XHQvLyBCaW5hcnk/XG5cdFx0dmFyIGJpbmFyeSA9IGZhbHNlO1xuXHRcdGlmIChtZXRob2QgPT09ICdibG9iJykge1xuXHRcdFx0YmluYXJ5ID0gbWV0aG9kO1xuXHRcdFx0bWV0aG9kID0gJ0dFVCc7XG5cdFx0fVxuXG5cdFx0bWV0aG9kID0gbWV0aG9kLnRvVXBwZXJDYXNlKCk7XG5cblx0XHQvLyBYaHIucmVzcG9uc2VUeXBlICdqc29uJyBpcyBub3Qgc3VwcG9ydGVkIGluIGFueSBvZiB0aGUgdmVuZG9ycyB5ZXQuXG5cdFx0ci5vbmxvYWQgPSBmdW5jdGlvbihlKSB7XG5cdFx0XHR2YXIganNvbiA9IHIucmVzcG9uc2U7XG5cdFx0XHR0cnkge1xuXHRcdFx0XHRqc29uID0gSlNPTi5wYXJzZShyLnJlc3BvbnNlVGV4dCk7XG5cdFx0XHR9XG5cdFx0XHRjYXRjaCAoX2UpIHtcblx0XHRcdFx0aWYgKHIuc3RhdHVzID09PSA0MDEpIHtcblx0XHRcdFx0XHRqc29uID0gZXJyb3IoJ2FjY2Vzc19kZW5pZWQnLCByLnN0YXR1c1RleHQpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdHZhciBoZWFkZXJzID0gaGVhZGVyc1RvSlNPTihyLmdldEFsbFJlc3BvbnNlSGVhZGVycygpKTtcblx0XHRcdGhlYWRlcnMuc3RhdHVzQ29kZSA9IHIuc3RhdHVzO1xuXG5cdFx0XHRjYWxsYmFjayhqc29uIHx8IChtZXRob2QgPT09ICdHRVQnID8gZXJyb3IoJ2VtcHR5X3Jlc3BvbnNlJywgJ0NvdWxkIG5vdCBnZXQgcmVzb3VyY2UnKSA6IHt9KSwgaGVhZGVycyk7XG5cdFx0fTtcblxuXHRcdHIub25lcnJvciA9IGZ1bmN0aW9uKGUpIHtcblx0XHRcdHZhciBqc29uID0gci5yZXNwb25zZVRleHQ7XG5cdFx0XHR0cnkge1xuXHRcdFx0XHRqc29uID0gSlNPTi5wYXJzZShyLnJlc3BvbnNlVGV4dCk7XG5cdFx0XHR9XG5cdFx0XHRjYXRjaCAoX2UpIHt9XG5cblx0XHRcdGNhbGxiYWNrKGpzb24gfHwgZXJyb3IoJ2FjY2Vzc19kZW5pZWQnLCAnQ291bGQgbm90IGdldCByZXNvdXJjZScpKTtcblx0XHR9O1xuXG5cdFx0dmFyIHg7XG5cblx0XHQvLyBTaG91bGQgd2UgYWRkIHRoZSBxdWVyeSB0byB0aGUgVVJMP1xuXHRcdGlmIChtZXRob2QgPT09ICdHRVQnIHx8IG1ldGhvZCA9PT0gJ0RFTEVURScpIHtcblx0XHRcdGRhdGEgPSBudWxsO1xuXHRcdH1cblx0XHRlbHNlIGlmIChkYXRhICYmIHR5cGVvZiAoZGF0YSkgIT09ICdzdHJpbmcnICYmICEoZGF0YSBpbnN0YW5jZW9mIEZvcm1EYXRhKSAmJiAhKGRhdGEgaW5zdGFuY2VvZiBGaWxlKSAmJiAhKGRhdGEgaW5zdGFuY2VvZiBCbG9iKSkge1xuXHRcdFx0Ly8gTG9vcCB0aHJvdWdoIGFuZCBhZGQgZm9ybURhdGFcblx0XHRcdHZhciBmID0gbmV3IEZvcm1EYXRhKCk7XG5cdFx0XHRmb3IgKHggaW4gZGF0YSkgaWYgKGRhdGEuaGFzT3duUHJvcGVydHkoeCkpIHtcblx0XHRcdFx0aWYgKGRhdGFbeF0gaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7XG5cdFx0XHRcdFx0aWYgKCdmaWxlcycgaW4gZGF0YVt4XSAmJiBkYXRhW3hdLmZpbGVzLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0XHRcdGYuYXBwZW5kKHgsIGRhdGFbeF0uZmlsZXNbMF0pO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHRlbHNlIGlmIChkYXRhW3hdIGluc3RhbmNlb2YgQmxvYikge1xuXHRcdFx0XHRcdGYuYXBwZW5kKHgsIGRhdGFbeF0sIGRhdGEubmFtZSk7XG5cdFx0XHRcdH1cblx0XHRcdFx0ZWxzZSB7XG5cdFx0XHRcdFx0Zi5hcHBlbmQoeCwgZGF0YVt4XSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0ZGF0YSA9IGY7XG5cdFx0fVxuXG5cdFx0Ly8gT3BlbiB0aGUgcGF0aCwgYXN5bmNcblx0XHRyLm9wZW4obWV0aG9kLCB1cmwsIHRydWUpO1xuXG5cdFx0aWYgKGJpbmFyeSkge1xuXHRcdFx0aWYgKCdyZXNwb25zZVR5cGUnIGluIHIpIHtcblx0XHRcdFx0ci5yZXNwb25zZVR5cGUgPSBiaW5hcnk7XG5cdFx0XHR9XG5cdFx0XHRlbHNlIHtcblx0XHRcdFx0ci5vdmVycmlkZU1pbWVUeXBlKCd0ZXh0L3BsYWluOyBjaGFyc2V0PXgtdXNlci1kZWZpbmVkJyk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gU2V0IGFueSBiZXNwb2tlIGhlYWRlcnNcblx0XHRpZiAoaGVhZGVycykge1xuXHRcdFx0Zm9yICh4IGluIGhlYWRlcnMpIHtcblx0XHRcdFx0ci5zZXRSZXF1ZXN0SGVhZGVyKHgsIGhlYWRlcnNbeF0pO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHIuc2VuZChkYXRhKTtcblxuXHRcdHJldHVybiByO1xuXG5cdFx0Ly8gSGVhZGVycyBhcmUgcmV0dXJuZWQgYXMgYSBzdHJpbmdcblx0XHRmdW5jdGlvbiBoZWFkZXJzVG9KU09OKHMpIHtcblx0XHRcdHZhciByID0ge307XG5cdFx0XHR2YXIgcmVnID0gLyhbYS16XFwtXSspOlxccz8oLiopOz8vZ2k7XG5cdFx0XHR2YXIgbTtcblx0XHRcdHdoaWxlICgobSA9IHJlZy5leGVjKHMpKSkge1xuXHRcdFx0XHRyW21bMV1dID0gbVsyXTtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIHI7XG5cdFx0fVxuXHR9LFxuXG5cdC8vIEpTT05QXG5cdC8vIEluamVjdHMgYSBzY3JpcHQgdGFnIGludG8gdGhlIERPTSB0byBiZSBleGVjdXRlZCBhbmQgYXBwZW5kcyBhIGNhbGxiYWNrIGZ1bmN0aW9uIHRvIHRoZSB3aW5kb3cgb2JqZWN0XG5cdC8vIEBwYXJhbSBzdHJpbmcvZnVuY3Rpb24gcGF0aEZ1bmMgZWl0aGVyIGEgc3RyaW5nIG9mIHRoZSBVUkwgb3IgYSBjYWxsYmFjayBmdW5jdGlvbiBwYXRoRnVuYyhxdWVyeXN0cmluZ2hhc2gsIGNvbnRpbnVlRnVuYyk7XG5cdC8vIEBwYXJhbSBmdW5jdGlvbiBjYWxsYmFjayBhIGZ1bmN0aW9uIHRvIGNhbGwgb24gY29tcGxldGlvbjtcblx0anNvbnA6IGZ1bmN0aW9uKHVybCwgY2FsbGJhY2ssIGNhbGxiYWNrSUQsIHRpbWVvdXQpIHtcblxuXHRcdHZhciBfdGhpcyA9IHRoaXM7XG5cdFx0dmFyIGVycm9yID0gX3RoaXMuZXJyb3I7XG5cblx0XHQvLyBDaGFuZ2UgdGhlIG5hbWUgb2YgdGhlIGNhbGxiYWNrXG5cdFx0dmFyIGJvb2wgPSAwO1xuXHRcdHZhciBoZWFkID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2hlYWQnKVswXTtcblx0XHR2YXIgb3BlcmFGaXg7XG5cdFx0dmFyIHJlc3VsdCA9IGVycm9yKCdzZXJ2ZXJfZXJyb3InLCAnc2VydmVyX2Vycm9yJyk7XG5cdFx0dmFyIGNiID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRpZiAoIShib29sKyspKSB7XG5cdFx0XHRcdHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdGNhbGxiYWNrKHJlc3VsdCk7XG5cdFx0XHRcdFx0aGVhZC5yZW1vdmVDaGlsZChzY3JpcHQpO1xuXHRcdFx0XHR9LCAwKTtcblx0XHRcdH1cblxuXHRcdH07XG5cblx0XHQvLyBBZGQgY2FsbGJhY2sgdG8gdGhlIHdpbmRvdyBvYmplY3Rcblx0XHRjYWxsYmFja0lEID0gX3RoaXMuZ2xvYmFsRXZlbnQoZnVuY3Rpb24oanNvbikge1xuXHRcdFx0cmVzdWx0ID0ganNvbjtcblx0XHRcdHJldHVybiB0cnVlO1xuXG5cdFx0XHQvLyBNYXJrIGNhbGxiYWNrIGFzIGRvbmVcblx0XHR9LCBjYWxsYmFja0lEKTtcblxuXHRcdC8vIFRoZSBVUkwgaXMgYSBmdW5jdGlvbiBmb3Igc29tZSBjYXNlcyBhbmQgYXMgc3VjaFxuXHRcdC8vIERldGVybWluZSBpdHMgdmFsdWUgd2l0aCBhIGNhbGxiYWNrIGNvbnRhaW5pbmcgdGhlIG5ldyBwYXJhbWV0ZXJzIG9mIHRoaXMgZnVuY3Rpb24uXG5cdFx0dXJsID0gdXJsLnJlcGxhY2UobmV3IFJlZ0V4cCgnPVxcXFw/KCZ8JCknKSwgJz0nICsgY2FsbGJhY2tJRCArICckMScpO1xuXG5cdFx0Ly8gQnVpbGQgc2NyaXB0IHRhZ1xuXHRcdHZhciBzY3JpcHQgPSBfdGhpcy5hcHBlbmQoJ3NjcmlwdCcsIHtcblx0XHRcdGlkOiBjYWxsYmFja0lELFxuXHRcdFx0bmFtZTogY2FsbGJhY2tJRCxcblx0XHRcdHNyYzogdXJsLFxuXHRcdFx0YXN5bmM6IHRydWUsXG5cdFx0XHRvbmxvYWQ6IGNiLFxuXHRcdFx0b25lcnJvcjogY2IsXG5cdFx0XHRvbnJlYWR5c3RhdGVjaGFuZ2U6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRpZiAoL2xvYWRlZHxjb21wbGV0ZS9pLnRlc3QodGhpcy5yZWFkeVN0YXRlKSkge1xuXHRcdFx0XHRcdGNiKCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdC8vIE9wZXJhIGZpeCBlcnJvclxuXHRcdC8vIFByb2JsZW06IElmIGFuIGVycm9yIG9jY3VycyB3aXRoIHNjcmlwdCBsb2FkaW5nIE9wZXJhIGZhaWxzIHRvIHRyaWdnZXIgdGhlIHNjcmlwdC5vbmVycm9yIGhhbmRsZXIgd2Ugc3BlY2lmaWVkXG5cdFx0Ly9cblx0XHQvLyBGaXg6XG5cdFx0Ly8gQnkgc2V0dGluZyB0aGUgcmVxdWVzdCB0byBzeW5jaHJvbm91cyB3ZSBjYW4gdHJpZ2dlciB0aGUgZXJyb3IgaGFuZGxlciB3aGVuIGFsbCBlbHNlIGZhaWxzLlxuXHRcdC8vIFRoaXMgYWN0aW9uIHdpbGwgYmUgaWdub3JlZCBpZiB3ZSd2ZSBhbHJlYWR5IGNhbGxlZCB0aGUgY2FsbGJhY2sgaGFuZGxlciBcImNiXCIgd2l0aCBhIHN1Y2Nlc3NmdWwgb25sb2FkIGV2ZW50XG5cdFx0aWYgKHdpbmRvdy5uYXZpZ2F0b3IudXNlckFnZW50LnRvTG93ZXJDYXNlKCkuaW5kZXhPZignb3BlcmEnKSA+IC0xKSB7XG5cdFx0XHRvcGVyYUZpeCA9IF90aGlzLmFwcGVuZCgnc2NyaXB0Jywge1xuXHRcdFx0XHR0ZXh0OiAnZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXFwnJyArIGNhbGxiYWNrSUQgKyAnXFwnKS5vbmVycm9yKCk7J1xuXHRcdFx0fSk7XG5cdFx0XHRzY3JpcHQuYXN5bmMgPSBmYWxzZTtcblx0XHR9XG5cblx0XHQvLyBBZGQgdGltZW91dFxuXHRcdGlmICh0aW1lb3V0KSB7XG5cdFx0XHR3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbigpIHtcblx0XHRcdFx0cmVzdWx0ID0gZXJyb3IoJ3RpbWVvdXQnLCAndGltZW91dCcpO1xuXHRcdFx0XHRjYigpO1xuXHRcdFx0fSwgdGltZW91dCk7XG5cdFx0fVxuXG5cdFx0Ly8gVE9ETzogYWRkIGZpeCBmb3IgSUUsXG5cdFx0Ly8gSG93ZXZlcjogdW5hYmxlIHJlY3JlYXRlIHRoZSBidWcgb2YgZmlyaW5nIG9mZiB0aGUgb25yZWFkeXN0YXRlY2hhbmdlIGJlZm9yZSB0aGUgc2NyaXB0IGNvbnRlbnQgaGFzIGJlZW4gZXhlY3V0ZWQgYW5kIHRoZSB2YWx1ZSBvZiBcInJlc3VsdFwiIGhhcyBiZWVuIGRlZmluZWQuXG5cdFx0Ly8gSW5qZWN0IHNjcmlwdCB0YWcgaW50byB0aGUgaGVhZCBlbGVtZW50XG5cdFx0aGVhZC5hcHBlbmRDaGlsZChzY3JpcHQpO1xuXG5cdFx0Ly8gQXBwZW5kIE9wZXJhIEZpeCB0byBydW4gYWZ0ZXIgb3VyIHNjcmlwdFxuXHRcdGlmIChvcGVyYUZpeCkge1xuXHRcdFx0aGVhZC5hcHBlbmRDaGlsZChvcGVyYUZpeCk7XG5cdFx0fVxuXHR9LFxuXG5cdC8vIFBvc3Rcblx0Ly8gU2VuZCBpbmZvcm1hdGlvbiB0byBhIHJlbW90ZSBsb2NhdGlvbiB1c2luZyB0aGUgcG9zdCBtZWNoYW5pc21cblx0Ly8gQHBhcmFtIHN0cmluZyB1cmkgcGF0aFxuXHQvLyBAcGFyYW0gb2JqZWN0IGRhdGEsIGtleSB2YWx1ZSBkYXRhIHRvIHNlbmRcblx0Ly8gQHBhcmFtIGZ1bmN0aW9uIGNhbGxiYWNrLCBmdW5jdGlvbiB0byBleGVjdXRlIGluIHJlc3BvbnNlXG5cdHBvc3Q6IGZ1bmN0aW9uKHVybCwgZGF0YSwgb3B0aW9ucywgY2FsbGJhY2ssIGNhbGxiYWNrSUQsIHRpbWVvdXQpIHtcblxuXHRcdHZhciBfdGhpcyA9IHRoaXM7XG5cdFx0dmFyIGVycm9yID0gX3RoaXMuZXJyb3I7XG5cdFx0dmFyIGRvYyA9IGRvY3VtZW50O1xuXG5cdFx0Ly8gVGhpcyBoYWNrIG5lZWRzIGEgZm9ybVxuXHRcdHZhciBmb3JtID0gbnVsbDtcblx0XHR2YXIgcmVlbmFibGVBZnRlclN1Ym1pdCA9IFtdO1xuXHRcdHZhciBuZXdmb3JtO1xuXHRcdHZhciBpID0gMDtcblx0XHR2YXIgeCA9IG51bGw7XG5cdFx0dmFyIGJvb2wgPSAwO1xuXHRcdHZhciBjYiA9IGZ1bmN0aW9uKHIpIHtcblx0XHRcdGlmICghKGJvb2wrKykpIHtcblx0XHRcdFx0Y2FsbGJhY2socik7XG5cdFx0XHR9XG5cdFx0fTtcblxuXHRcdC8vIFdoYXQgaXMgdGhlIG5hbWUgb2YgdGhlIGNhbGxiYWNrIHRvIGNvbnRhaW5cblx0XHQvLyBXZSdsbCBhbHNvIHVzZSB0aGlzIHRvIG5hbWUgdGhlIGlmcmFtZVxuXHRcdF90aGlzLmdsb2JhbEV2ZW50KGNiLCBjYWxsYmFja0lEKTtcblxuXHRcdC8vIEJ1aWxkIHRoZSBpZnJhbWUgd2luZG93XG5cdFx0dmFyIHdpbjtcblx0XHR0cnkge1xuXHRcdFx0Ly8gSUU3IGhhY2ssIG9ubHkgbGV0cyB1cyBkZWZpbmUgdGhlIG5hbWUgaGVyZSwgbm90IGxhdGVyLlxuXHRcdFx0d2luID0gZG9jLmNyZWF0ZUVsZW1lbnQoJzxpZnJhbWUgbmFtZT1cIicgKyBjYWxsYmFja0lEICsgJ1wiPicpO1xuXHRcdH1cblx0XHRjYXRjaCAoZSkge1xuXHRcdFx0d2luID0gZG9jLmNyZWF0ZUVsZW1lbnQoJ2lmcmFtZScpO1xuXHRcdH1cblxuXHRcdHdpbi5uYW1lID0gY2FsbGJhY2tJRDtcblx0XHR3aW4uaWQgPSBjYWxsYmFja0lEO1xuXHRcdHdpbi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXG5cdFx0Ly8gT3ZlcnJpZGUgY2FsbGJhY2sgbWVjaGFuaXNtLiBUcmlnZ2dlciBhIHJlc3BvbnNlIG9ubG9hZC9vbmVycm9yXG5cdFx0aWYgKG9wdGlvbnMgJiYgb3B0aW9ucy5jYWxsYmFja29ubG9hZCkge1xuXHRcdFx0Ly8gT25sb2FkIGlzIGJlaW5nIGZpcmVkIHR3aWNlXG5cdFx0XHR3aW4ub25sb2FkID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGNiKHtcblx0XHRcdFx0XHRyZXNwb25zZTogJ3Bvc3RlZCcsXG5cdFx0XHRcdFx0bWVzc2FnZTogJ0NvbnRlbnQgd2FzIHBvc3RlZCdcblx0XHRcdFx0fSk7XG5cdFx0XHR9O1xuXHRcdH1cblxuXHRcdGlmICh0aW1lb3V0KSB7XG5cdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRjYihlcnJvcigndGltZW91dCcsICdUaGUgcG9zdCBvcGVyYXRpb24gdGltZWQgb3V0JykpO1xuXHRcdFx0fSwgdGltZW91dCk7XG5cdFx0fVxuXG5cdFx0ZG9jLmJvZHkuYXBwZW5kQ2hpbGQod2luKTtcblxuXHRcdC8vIElmIHdlIGFyZSBqdXN0IHBvc3RpbmcgYSBzaW5nbGUgaXRlbVxuXHRcdGlmIChfdGhpcy5kb21JbnN0YW5jZSgnZm9ybScsIGRhdGEpKSB7XG5cdFx0XHQvLyBHZXQgdGhlIHBhcmVudCBmb3JtXG5cdFx0XHRmb3JtID0gZGF0YS5mb3JtO1xuXG5cdFx0XHQvLyBMb29wIHRocm91Z2ggYW5kIGRpc2FibGUgYWxsIG9mIGl0cyBzaWJsaW5nc1xuXHRcdFx0Zm9yIChpID0gMDsgaSA8IGZvcm0uZWxlbWVudHMubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0aWYgKGZvcm0uZWxlbWVudHNbaV0gIT09IGRhdGEpIHtcblx0XHRcdFx0XHRmb3JtLmVsZW1lbnRzW2ldLnNldEF0dHJpYnV0ZSgnZGlzYWJsZWQnLCB0cnVlKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvLyBNb3ZlIHRoZSBmb2N1cyB0byB0aGUgZm9ybVxuXHRcdFx0ZGF0YSA9IGZvcm07XG5cdFx0fVxuXG5cdFx0Ly8gUG9zdGluZyBhIGZvcm1cblx0XHRpZiAoX3RoaXMuZG9tSW5zdGFuY2UoJ2Zvcm0nLCBkYXRhKSkge1xuXHRcdFx0Ly8gVGhpcyBpcyBhIGZvcm0gZWxlbWVudFxuXHRcdFx0Zm9ybSA9IGRhdGE7XG5cblx0XHRcdC8vIERvZXMgdGhpcyBmb3JtIG5lZWQgdG8gYmUgYSBtdWx0aXBhcnQgZm9ybT9cblx0XHRcdGZvciAoaSA9IDA7IGkgPCBmb3JtLmVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdGlmICghZm9ybS5lbGVtZW50c1tpXS5kaXNhYmxlZCAmJiBmb3JtLmVsZW1lbnRzW2ldLnR5cGUgPT09ICdmaWxlJykge1xuXHRcdFx0XHRcdGZvcm0uZW5jb2RpbmcgPSBmb3JtLmVuY3R5cGUgPSAnbXVsdGlwYXJ0L2Zvcm0tZGF0YSc7XG5cdFx0XHRcdFx0Zm9ybS5lbGVtZW50c1tpXS5zZXRBdHRyaWJ1dGUoJ25hbWUnLCAnZmlsZScpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHRcdGVsc2Uge1xuXHRcdFx0Ly8gSXRzIG5vdCBhIGZvcm0gZWxlbWVudCxcblx0XHRcdC8vIFRoZXJlZm9yZSBpdCBtdXN0IGJlIGEgSlNPTiBvYmplY3Qgb2YgS2V5PT5WYWx1ZSBvciBLZXk9PkVsZW1lbnRcblx0XHRcdC8vIElmIGFueW9uZSBvZiB0aG9zZSB2YWx1ZXMgYXJlIGEgaW5wdXQgdHlwZT1maWxlIHdlIHNoYWxsIHNoYWxsIGluc2VydCBpdHMgc2libGluZ3MgaW50byB0aGUgZm9ybSBmb3Igd2hpY2ggaXQgYmVsb25ncy5cblx0XHRcdGZvciAoeCBpbiBkYXRhKSBpZiAoZGF0YS5oYXNPd25Qcm9wZXJ0eSh4KSkge1xuXHRcdFx0XHQvLyBJcyB0aGlzIGFuIGlucHV0IEVsZW1lbnQ/XG5cdFx0XHRcdGlmIChfdGhpcy5kb21JbnN0YW5jZSgnaW5wdXQnLCBkYXRhW3hdKSAmJiBkYXRhW3hdLnR5cGUgPT09ICdmaWxlJykge1xuXHRcdFx0XHRcdGZvcm0gPSBkYXRhW3hdLmZvcm07XG5cdFx0XHRcdFx0Zm9ybS5lbmNvZGluZyA9IGZvcm0uZW5jdHlwZSA9ICdtdWx0aXBhcnQvZm9ybS1kYXRhJztcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvLyBEbyBJZiB0aGVyZSBpcyBubyBkZWZpbmVkIGZvcm0gZWxlbWVudCwgbGV0cyBjcmVhdGUgb25lLlxuXHRcdFx0aWYgKCFmb3JtKSB7XG5cdFx0XHRcdC8vIEJ1aWxkIGZvcm1cblx0XHRcdFx0Zm9ybSA9IGRvYy5jcmVhdGVFbGVtZW50KCdmb3JtJyk7XG5cdFx0XHRcdGRvYy5ib2R5LmFwcGVuZENoaWxkKGZvcm0pO1xuXHRcdFx0XHRuZXdmb3JtID0gZm9ybTtcblx0XHRcdH1cblxuXHRcdFx0dmFyIGlucHV0O1xuXG5cdFx0XHQvLyBBZGQgZWxlbWVudHMgdG8gdGhlIGZvcm0gaWYgdGhleSBkb250IGV4aXN0XG5cdFx0XHRmb3IgKHggaW4gZGF0YSkgaWYgKGRhdGEuaGFzT3duUHJvcGVydHkoeCkpIHtcblxuXHRcdFx0XHQvLyBJcyB0aGlzIGFuIGVsZW1lbnQ/XG5cdFx0XHRcdHZhciBlbCA9IChfdGhpcy5kb21JbnN0YW5jZSgnaW5wdXQnLCBkYXRhW3hdKSB8fCBfdGhpcy5kb21JbnN0YW5jZSgndGV4dEFyZWEnLCBkYXRhW3hdKSB8fCBfdGhpcy5kb21JbnN0YW5jZSgnc2VsZWN0JywgZGF0YVt4XSkpO1xuXG5cdFx0XHRcdC8vIElzIHRoaXMgbm90IGFuIGlucHV0IGVsZW1lbnQsIG9yIG9uZSB0aGF0IGV4aXN0cyBvdXRzaWRlIHRoZSBmb3JtLlxuXHRcdFx0XHRpZiAoIWVsIHx8IGRhdGFbeF0uZm9ybSAhPT0gZm9ybSkge1xuXG5cdFx0XHRcdFx0Ly8gRG9lcyBhbiBlbGVtZW50IGhhdmUgdGhlIHNhbWUgbmFtZT9cblx0XHRcdFx0XHR2YXIgaW5wdXRzID0gZm9ybS5lbGVtZW50c1t4XTtcblx0XHRcdFx0XHRpZiAoaW5wdXQpIHtcblx0XHRcdFx0XHRcdC8vIFJlbW92ZSBpdC5cblx0XHRcdFx0XHRcdGlmICghKGlucHV0cyBpbnN0YW5jZW9mIE5vZGVMaXN0KSkge1xuXHRcdFx0XHRcdFx0XHRpbnB1dHMgPSBbaW5wdXRzXTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0Zm9yIChpID0gMDsgaSA8IGlucHV0cy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdFx0XHRpbnB1dHNbaV0ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChpbnB1dHNbaV0pO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0Ly8gQ3JlYXRlIGFuIGlucHV0IGVsZW1lbnRcblx0XHRcdFx0XHRpbnB1dCA9IGRvYy5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xuXHRcdFx0XHRcdGlucHV0LnNldEF0dHJpYnV0ZSgndHlwZScsICdoaWRkZW4nKTtcblx0XHRcdFx0XHRpbnB1dC5zZXRBdHRyaWJ1dGUoJ25hbWUnLCB4KTtcblxuXHRcdFx0XHRcdC8vIERvZXMgaXQgaGF2ZSBhIHZhbHVlIGF0dHJpYnV0ZT9cblx0XHRcdFx0XHRpZiAoZWwpIHtcblx0XHRcdFx0XHRcdGlucHV0LnZhbHVlID0gZGF0YVt4XS52YWx1ZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0ZWxzZSBpZiAoX3RoaXMuZG9tSW5zdGFuY2UobnVsbCwgZGF0YVt4XSkpIHtcblx0XHRcdFx0XHRcdGlucHV0LnZhbHVlID0gZGF0YVt4XS5pbm5lckhUTUwgfHwgZGF0YVt4XS5pbm5lclRleHQ7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGVsc2Uge1xuXHRcdFx0XHRcdFx0aW5wdXQudmFsdWUgPSBkYXRhW3hdO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGZvcm0uYXBwZW5kQ2hpbGQoaW5wdXQpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gSXQgaXMgYW4gZWxlbWVudCwgd2hpY2ggZXhpc3RzIHdpdGhpbiB0aGUgZm9ybSwgYnV0IHRoZSBuYW1lIGlzIHdyb25nXG5cdFx0XHRcdGVsc2UgaWYgKGVsICYmIGRhdGFbeF0ubmFtZSAhPT0geCkge1xuXHRcdFx0XHRcdGRhdGFbeF0uc2V0QXR0cmlidXRlKCduYW1lJywgeCk7XG5cdFx0XHRcdFx0ZGF0YVt4XS5uYW1lID0geDtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvLyBEaXNhYmxlIGVsZW1lbnRzIGZyb20gd2l0aGluIHRoZSBmb3JtIGlmIHRoZXkgd2VyZW4ndCBzcGVjaWZpZWRcblx0XHRcdGZvciAoaSA9IDA7IGkgPCBmb3JtLmVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7XG5cblx0XHRcdFx0aW5wdXQgPSBmb3JtLmVsZW1lbnRzW2ldO1xuXG5cdFx0XHRcdC8vIERvZXMgdGhlIHNhbWUgbmFtZSBhbmQgdmFsdWUgZXhpc3QgaW4gdGhlIHBhcmVudFxuXHRcdFx0XHRpZiAoIShpbnB1dC5uYW1lIGluIGRhdGEpICYmIGlucHV0LmdldEF0dHJpYnV0ZSgnZGlzYWJsZWQnKSAhPT0gdHJ1ZSkge1xuXHRcdFx0XHRcdC8vIERpc2FibGVcblx0XHRcdFx0XHRpbnB1dC5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgdHJ1ZSk7XG5cblx0XHRcdFx0XHQvLyBBZGQgcmUtZW5hYmxlIHRvIGNhbGxiYWNrXG5cdFx0XHRcdFx0cmVlbmFibGVBZnRlclN1Ym1pdC5wdXNoKGlucHV0KTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIFNldCB0aGUgdGFyZ2V0IG9mIHRoZSBmb3JtXG5cdFx0Zm9ybS5zZXRBdHRyaWJ1dGUoJ21ldGhvZCcsICdQT1NUJyk7XG5cdFx0Zm9ybS5zZXRBdHRyaWJ1dGUoJ3RhcmdldCcsIGNhbGxiYWNrSUQpO1xuXHRcdGZvcm0udGFyZ2V0ID0gY2FsbGJhY2tJRDtcblxuXHRcdC8vIFVwZGF0ZSB0aGUgZm9ybSBVUkxcblx0XHRmb3JtLnNldEF0dHJpYnV0ZSgnYWN0aW9uJywgdXJsKTtcblxuXHRcdC8vIFN1Ym1pdCB0aGUgZm9ybVxuXHRcdC8vIFNvbWUgcmVhc29uIHRoaXMgbmVlZHMgdG8gYmUgb2Zmc2V0IGZyb20gdGhlIGN1cnJlbnQgd2luZG93IGV4ZWN1dGlvblxuXHRcdHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG5cdFx0XHRmb3JtLnN1Ym1pdCgpO1xuXG5cdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdC8vIFJlbW92ZSB0aGUgaWZyYW1lIGZyb20gdGhlIHBhZ2UuXG5cdFx0XHRcdFx0Ly93aW4ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh3aW4pO1xuXHRcdFx0XHRcdC8vIFJlbW92ZSB0aGUgZm9ybVxuXHRcdFx0XHRcdGlmIChuZXdmb3JtKSB7XG5cdFx0XHRcdFx0XHRuZXdmb3JtLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQobmV3Zm9ybSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHRcdGNhdGNoIChlKSB7XG5cdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdGNvbnNvbGUuZXJyb3IoJ0hlbGxvSlM6IGNvdWxkIG5vdCByZW1vdmUgaWZyYW1lJyk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGNhdGNoIChlZSkge31cblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIFJlZW5hYmxlIHRoZSBkaXNhYmxlZCBmb3JtXG5cdFx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgcmVlbmFibGVBZnRlclN1Ym1pdC5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdGlmIChyZWVuYWJsZUFmdGVyU3VibWl0W2ldKSB7XG5cdFx0XHRcdFx0XHRyZWVuYWJsZUFmdGVyU3VibWl0W2ldLnNldEF0dHJpYnV0ZSgnZGlzYWJsZWQnLCBmYWxzZSk7XG5cdFx0XHRcdFx0XHRyZWVuYWJsZUFmdGVyU3VibWl0W2ldLmRpc2FibGVkID0gZmFsc2U7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9LCAwKTtcblx0XHR9LCAxMDApO1xuXHR9LFxuXG5cdC8vIFNvbWUgb2YgdGhlIHByb3ZpZGVycyByZXF1aXJlIHRoYXQgb25seSBtdWx0aXBhcnQgaXMgdXNlZCB3aXRoIG5vbi1iaW5hcnkgZm9ybXMuXG5cdC8vIFRoaXMgZnVuY3Rpb24gY2hlY2tzIHdoZXRoZXIgdGhlIGZvcm0gY29udGFpbnMgYmluYXJ5IGRhdGFcblx0aGFzQmluYXJ5OiBmdW5jdGlvbihkYXRhKSB7XG5cdFx0Zm9yICh2YXIgeCBpbiBkYXRhKSBpZiAoZGF0YS5oYXNPd25Qcm9wZXJ0eSh4KSkge1xuXHRcdFx0aWYgKHRoaXMuaXNCaW5hcnkoZGF0YVt4XSkpIHtcblx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9LFxuXG5cdC8vIERldGVybWluZXMgaWYgYSB2YXJpYWJsZSBFaXRoZXIgSXMgb3IgbGlrZSBhIEZvcm1JbnB1dCBoYXMgdGhlIHZhbHVlIG9mIGEgQmxvYlxuXG5cdGlzQmluYXJ5OiBmdW5jdGlvbihkYXRhKSB7XG5cblx0XHRyZXR1cm4gZGF0YSBpbnN0YW5jZW9mIE9iamVjdCAmJiAoXG5cdFx0KHRoaXMuZG9tSW5zdGFuY2UoJ2lucHV0JywgZGF0YSkgJiYgZGF0YS50eXBlID09PSAnZmlsZScpIHx8XG5cdFx0KCdGaWxlTGlzdCcgaW4gd2luZG93ICYmIGRhdGEgaW5zdGFuY2VvZiB3aW5kb3cuRmlsZUxpc3QpIHx8XG5cdFx0KCdGaWxlJyBpbiB3aW5kb3cgJiYgZGF0YSBpbnN0YW5jZW9mIHdpbmRvdy5GaWxlKSB8fFxuXHRcdCgnQmxvYicgaW4gd2luZG93ICYmIGRhdGEgaW5zdGFuY2VvZiB3aW5kb3cuQmxvYikpO1xuXG5cdH0sXG5cblx0Ly8gQ29udmVydCBEYXRhLVVSSSB0byBCbG9iIHN0cmluZ1xuXHR0b0Jsb2I6IGZ1bmN0aW9uKGRhdGFVUkkpIHtcblx0XHR2YXIgcmVnID0gL15kYXRhXFw6KFteOyxdKyhcXDtjaGFyc2V0PVteOyxdKyk/KShcXDtiYXNlNjQpPywvaTtcblx0XHR2YXIgbSA9IGRhdGFVUkkubWF0Y2gocmVnKTtcblx0XHRpZiAoIW0pIHtcblx0XHRcdHJldHVybiBkYXRhVVJJO1xuXHRcdH1cblxuXHRcdHZhciBiaW5hcnkgPSBhdG9iKGRhdGFVUkkucmVwbGFjZShyZWcsICcnKSk7XG5cdFx0dmFyIGFycmF5ID0gW107XG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBiaW5hcnkubGVuZ3RoOyBpKyspIHtcblx0XHRcdGFycmF5LnB1c2goYmluYXJ5LmNoYXJDb2RlQXQoaSkpO1xuXHRcdH1cblxuXHRcdHJldHVybiBuZXcgQmxvYihbbmV3IFVpbnQ4QXJyYXkoYXJyYXkpXSwge3R5cGU6IG1bMV19KTtcblx0fVxuXG59KTtcblxuLy8gRVhUUkE6IENvbnZlcnQgRm9ybUVsZW1lbnQgdG8gSlNPTiBmb3IgUE9TVGluZ1xuLy8gV3JhcHBlcnMgdG8gYWRkIGFkZGl0aW9uYWwgZnVuY3Rpb25hbGl0eSB0byBleGlzdGluZyBmdW5jdGlvbnNcbihmdW5jdGlvbihoZWxsbykge1xuXG5cdC8vIENvcHkgb3JpZ2luYWwgZnVuY3Rpb25cblx0dmFyIGFwaSA9IGhlbGxvLmFwaTtcblx0dmFyIHV0aWxzID0gaGVsbG8udXRpbHM7XG5cblx0dXRpbHMuZXh0ZW5kKHV0aWxzLCB7XG5cblx0XHQvLyBEYXRhVG9KU09OXG5cdFx0Ly8gVGhpcyB0YWtlcyBhIEZvcm1FbGVtZW50fE5vZGVMaXN0fElucHV0RWxlbWVudHxNaXhlZE9iamVjdHMgYW5kIGNvbnZlcnMgdGhlIGRhdGEgb2JqZWN0IHRvIEpTT04uXG5cdFx0ZGF0YVRvSlNPTjogZnVuY3Rpb24ocCkge1xuXG5cdFx0XHR2YXIgX3RoaXMgPSB0aGlzO1xuXHRcdFx0dmFyIHcgPSB3aW5kb3c7XG5cdFx0XHR2YXIgZGF0YSA9IHAuZGF0YTtcblxuXHRcdFx0Ly8gSXMgZGF0YSBhIGZvcm0gb2JqZWN0XG5cdFx0XHRpZiAoX3RoaXMuZG9tSW5zdGFuY2UoJ2Zvcm0nLCBkYXRhKSkge1xuXHRcdFx0XHRkYXRhID0gX3RoaXMubm9kZUxpc3RUb0pTT04oZGF0YS5lbGVtZW50cyk7XG5cdFx0XHR9XG5cdFx0XHRlbHNlIGlmICgnTm9kZUxpc3QnIGluIHcgJiYgZGF0YSBpbnN0YW5jZW9mIE5vZGVMaXN0KSB7XG5cdFx0XHRcdGRhdGEgPSBfdGhpcy5ub2RlTGlzdFRvSlNPTihkYXRhKTtcblx0XHRcdH1cblx0XHRcdGVsc2UgaWYgKF90aGlzLmRvbUluc3RhbmNlKCdpbnB1dCcsIGRhdGEpKSB7XG5cdFx0XHRcdGRhdGEgPSBfdGhpcy5ub2RlTGlzdFRvSlNPTihbZGF0YV0pO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBJcyBkYXRhIGEgYmxvYiwgRmlsZSwgRmlsZUxpc3Q/XG5cdFx0XHRpZiAoKCdGaWxlJyBpbiB3ICYmIGRhdGEgaW5zdGFuY2VvZiB3LkZpbGUpIHx8XG5cdFx0XHRcdCgnQmxvYicgaW4gdyAmJiBkYXRhIGluc3RhbmNlb2Ygdy5CbG9iKSB8fFxuXHRcdFx0XHQoJ0ZpbGVMaXN0JyBpbiB3ICYmIGRhdGEgaW5zdGFuY2VvZiB3LkZpbGVMaXN0KSkge1xuXHRcdFx0XHRkYXRhID0ge2ZpbGU6IGRhdGF9O1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBMb29wIHRocm91Z2ggZGF0YSBpZiBpdCdzIG5vdCBmb3JtIGRhdGEgaXQgbXVzdCBub3cgYmUgYSBKU09OIG9iamVjdFxuXHRcdFx0aWYgKCEoJ0Zvcm1EYXRhJyBpbiB3ICYmIGRhdGEgaW5zdGFuY2VvZiB3LkZvcm1EYXRhKSkge1xuXG5cdFx0XHRcdGZvciAodmFyIHggaW4gZGF0YSkgaWYgKGRhdGEuaGFzT3duUHJvcGVydHkoeCkpIHtcblxuXHRcdFx0XHRcdGlmICgnRmlsZUxpc3QnIGluIHcgJiYgZGF0YVt4XSBpbnN0YW5jZW9mIHcuRmlsZUxpc3QpIHtcblx0XHRcdFx0XHRcdGlmIChkYXRhW3hdLmxlbmd0aCA9PT0gMSkge1xuXHRcdFx0XHRcdFx0XHRkYXRhW3hdID0gZGF0YVt4XVswXTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0ZWxzZSBpZiAoX3RoaXMuZG9tSW5zdGFuY2UoJ2lucHV0JywgZGF0YVt4XSkgJiYgZGF0YVt4XS50eXBlID09PSAnZmlsZScpIHtcblx0XHRcdFx0XHRcdGNvbnRpbnVlO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRlbHNlIGlmIChfdGhpcy5kb21JbnN0YW5jZSgnaW5wdXQnLCBkYXRhW3hdKSB8fFxuXHRcdFx0XHRcdFx0X3RoaXMuZG9tSW5zdGFuY2UoJ3NlbGVjdCcsIGRhdGFbeF0pIHx8XG5cdFx0XHRcdFx0XHRfdGhpcy5kb21JbnN0YW5jZSgndGV4dEFyZWEnLCBkYXRhW3hdKSkge1xuXHRcdFx0XHRcdFx0ZGF0YVt4XSA9IGRhdGFbeF0udmFsdWU7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGVsc2UgaWYgKF90aGlzLmRvbUluc3RhbmNlKG51bGwsIGRhdGFbeF0pKSB7XG5cdFx0XHRcdFx0XHRkYXRhW3hdID0gZGF0YVt4XS5pbm5lckhUTUwgfHwgZGF0YVt4XS5pbm5lclRleHQ7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdHAuZGF0YSA9IGRhdGE7XG5cdFx0XHRyZXR1cm4gZGF0YTtcblx0XHR9LFxuXG5cdFx0Ly8gTm9kZUxpc3RUb0pTT05cblx0XHQvLyBHaXZlbiBhIGxpc3Qgb2YgZWxlbWVudHMgZXh0cmFwb2xhdGUgdGhlaXIgdmFsdWVzIGFuZCByZXR1cm4gYXMgYSBqc29uIG9iamVjdFxuXHRcdG5vZGVMaXN0VG9KU09OOiBmdW5jdGlvbihub2RlbGlzdCkge1xuXG5cdFx0XHR2YXIganNvbiA9IHt9O1xuXG5cdFx0XHQvLyBDcmVhdGUgYSBkYXRhIHN0cmluZ1xuXHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBub2RlbGlzdC5sZW5ndGg7IGkrKykge1xuXG5cdFx0XHRcdHZhciBpbnB1dCA9IG5vZGVsaXN0W2ldO1xuXG5cdFx0XHRcdC8vIElmIHRoZSBuYW1lIG9mIHRoZSBpbnB1dCBpcyBlbXB0eSBvciBkaWFibGVkLCBkb250IGFkZCBpdC5cblx0XHRcdFx0aWYgKGlucHV0LmRpc2FibGVkIHx8ICFpbnB1dC5uYW1lKSB7XG5cdFx0XHRcdFx0Y29udGludWU7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBJcyB0aGlzIGEgZmlsZSwgZG9lcyB0aGUgYnJvd3NlciBub3Qgc3VwcG9ydCAnZmlsZXMnIGFuZCAnRm9ybURhdGEnP1xuXHRcdFx0XHRpZiAoaW5wdXQudHlwZSA9PT0gJ2ZpbGUnKSB7XG5cdFx0XHRcdFx0anNvbltpbnB1dC5uYW1lXSA9IGlucHV0O1xuXHRcdFx0XHR9XG5cdFx0XHRcdGVsc2Uge1xuXHRcdFx0XHRcdGpzb25baW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZSB8fCBpbnB1dC5pbm5lckhUTUw7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIGpzb247XG5cdFx0fVxuXHR9KTtcblxuXHQvLyBSZXBsYWNlIGl0XG5cdGhlbGxvLmFwaSA9IGZ1bmN0aW9uKCkge1xuXG5cdFx0Ly8gR2V0IGFyZ3VtZW50c1xuXHRcdHZhciBwID0gdXRpbHMuYXJncyh7cGF0aDogJ3MhJywgbWV0aG9kOiAncycsIGRhdGE6J28nLCB0aW1lb3V0OiAnaScsIGNhbGxiYWNrOiAnZid9LCBhcmd1bWVudHMpO1xuXG5cdFx0Ly8gQ2hhbmdlIGZvciBpbnRvIGEgZGF0YSBvYmplY3Rcblx0XHRpZiAocC5kYXRhKSB7XG5cdFx0XHR1dGlscy5kYXRhVG9KU09OKHApO1xuXHRcdH1cblxuXHRcdHJldHVybiBhcGkuY2FsbCh0aGlzLCBwKTtcblx0fTtcblxufSkoaGVsbG8pO1xuXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4vL1xuLy8gU2F2ZSBhbnkgYWNjZXNzIHRva2VuIHRoYXQgaXMgaW4gdGhlIGN1cnJlbnQgcGFnZSBVUkxcbi8vIEhhbmRsZSBhbnkgcmVzcG9uc2Ugc29saWNpdGVkIHRocm91Z2ggaWZyYW1lIGhhc2ggdGFnIGZvbGxvd2luZyBhbiBBUEkgcmVxdWVzdFxuLy9cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuaGVsbG8udXRpbHMucmVzcG9uc2VIYW5kbGVyKHdpbmRvdywgd2luZG93Lm9wZW5lciB8fCB3aW5kb3cucGFyZW50KTtcblxuLy8gU2NyaXB0IHRvIHN1cHBvcnQgQ2hyb21lQXBwc1xuLy8gVGhpcyBvdmVyaWRlcyB0aGUgaGVsbG8udXRpbHMucG9wdXAgbWV0aG9kIHRvIHN1cHBvcnQgY2hyb21lLmlkZW50aXR5LmxhdW5jaFdlYkF1dGhGbG93XG4vLyBTZWUgaHR0cHM6Ly9kZXZlbG9wZXIuY2hyb21lLmNvbS9hcHBzL2FwcF9pZGVudGl0eSNub25cblxuLy8gSXMgdGhpcyBhIGNocm9tZSBhcHA/XG5cbmlmICh0eXBlb2YgY2hyb21lID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgY2hyb21lLmlkZW50aXR5ID09PSAnb2JqZWN0JyAmJiBjaHJvbWUuaWRlbnRpdHkubGF1bmNoV2ViQXV0aEZsb3cpIHtcblxuXHQoZnVuY3Rpb24oKSB7XG5cblx0XHQvLyBTd2FwIHRoZSBwb3B1cCBtZXRob2Rcblx0XHRoZWxsby51dGlscy5wb3B1cCA9IGZ1bmN0aW9uKHVybCkge1xuXG5cdFx0XHRyZXR1cm4gX29wZW4odXJsLCB0cnVlKTtcblxuXHRcdH07XG5cblx0XHQvLyBTd2FwIHRoZSBoaWRkZW4gaWZyYW1lIG1ldGhvZFxuXHRcdGhlbGxvLnV0aWxzLmlmcmFtZSA9IGZ1bmN0aW9uKHVybCkge1xuXG5cdFx0XHRfb3Blbih1cmwsIGZhbHNlKTtcblxuXHRcdH07XG5cblx0XHQvLyBTd2FwIHRoZSByZXF1ZXN0X2NvcnMgbWV0aG9kXG5cdFx0aGVsbG8udXRpbHMucmVxdWVzdF9jb3JzID0gZnVuY3Rpb24oY2FsbGJhY2spIHtcblxuXHRcdFx0Y2FsbGJhY2soKTtcblxuXHRcdFx0Ly8gQWx3YXlzIHJ1biBhcyBDT1JTXG5cblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH07XG5cblx0XHQvLyBTd2FwIHRoZSBzdG9yYWdlIG1ldGhvZFxuXHRcdHZhciBfY2FjaGUgPSB7fTtcblx0XHRjaHJvbWUuc3RvcmFnZS5sb2NhbC5nZXQoJ2hlbGxvJywgZnVuY3Rpb24ocikge1xuXHRcdFx0Ly8gVXBkYXRlIHRoZSBjYWNoZVxuXHRcdFx0X2NhY2hlID0gci5oZWxsbyB8fCB7fTtcblx0XHR9KTtcblxuXHRcdGhlbGxvLnV0aWxzLnN0b3JlID0gZnVuY3Rpb24obmFtZSwgdmFsdWUpIHtcblxuXHRcdFx0Ly8gR2V0IGFsbFxuXHRcdFx0aWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDApIHtcblx0XHRcdFx0cmV0dXJuIF9jYWNoZTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gR2V0XG5cdFx0XHRpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMSkge1xuXHRcdFx0XHRyZXR1cm4gX2NhY2hlW25hbWVdIHx8IG51bGw7XG5cdFx0XHR9XG5cblx0XHRcdC8vIFNldFxuXHRcdFx0aWYgKHZhbHVlKSB7XG5cdFx0XHRcdF9jYWNoZVtuYW1lXSA9IHZhbHVlO1xuXHRcdFx0XHRjaHJvbWUuc3RvcmFnZS5sb2NhbC5zZXQoe2hlbGxvOiBfY2FjaGV9KTtcblx0XHRcdFx0cmV0dXJuIHZhbHVlO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBEZWxldGVcblx0XHRcdGlmICh2YWx1ZSA9PT0gbnVsbCkge1xuXHRcdFx0XHRkZWxldGUgX2NhY2hlW25hbWVdO1xuXHRcdFx0XHRjaHJvbWUuc3RvcmFnZS5sb2NhbC5zZXQoe2hlbGxvOiBfY2FjaGV9KTtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cdFx0fTtcblxuXHRcdC8vIE9wZW4gZnVuY3Rpb25cblx0XHRmdW5jdGlvbiBfb3Blbih1cmwsIGludGVyYWN0aXZlKSB7XG5cblx0XHRcdC8vIExhdW5jaFxuXHRcdFx0dmFyIHJlZiA9IHtcblx0XHRcdFx0Y2xvc2VkOiBmYWxzZVxuXHRcdFx0fTtcblxuXHRcdFx0Ly8gTGF1bmNoIHRoZSB3ZWJBdXRoRmxvd1xuXHRcdFx0Y2hyb21lLmlkZW50aXR5LmxhdW5jaFdlYkF1dGhGbG93KHtcblx0XHRcdFx0dXJsOiB1cmwsXG5cdFx0XHRcdGludGVyYWN0aXZlOiBpbnRlcmFjdGl2ZVxuXHRcdFx0fSwgZnVuY3Rpb24ocmVzcG9uc2VVcmwpIHtcblxuXHRcdFx0XHQvLyBEaWQgdGhlIHVzZXIgY2FuY2VsIHRoaXMgcHJlbWF0dXJlbHlcblx0XHRcdFx0aWYgKHJlc3BvbnNlVXJsID09PSB1bmRlZmluZWQpIHtcblx0XHRcdFx0XHRyZWYuY2xvc2VkID0gdHJ1ZTtcblx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBTcGxpdCBhcHBhcnQgdGhlIFVSTFxuXHRcdFx0XHR2YXIgYSA9IGhlbGxvLnV0aWxzLnVybChyZXNwb25zZVVybCk7XG5cblx0XHRcdFx0Ly8gVGhlIGxvY2F0aW9uIGNhbiBiZSBhdWdtZW50ZWQgaW4gdG8gYSBsb2NhdGlvbiBvYmplY3QgbGlrZSBzby4uLlxuXHRcdFx0XHQvLyBXZSBkb250IGhhdmUgd2luZG93IG9wZXJhdGlvbnMgb24gdGhlIHBvcHVwIHNvIGxldHMgY3JlYXRlIHNvbWVcblx0XHRcdFx0dmFyIF9wb3B1cCA9IHtcblx0XHRcdFx0XHRsb2NhdGlvbjoge1xuXG5cdFx0XHRcdFx0XHQvLyBDaGFuZ2UgdGhlIGxvY2F0aW9uIG9mIHRoZSBwb3B1cFxuXHRcdFx0XHRcdFx0YXNzaWduOiBmdW5jdGlvbih1cmwpIHtcblxuXHRcdFx0XHRcdFx0XHQvLyBJZiB0aGVyZSBpcyBhIHNlY29uZGFyeSByZWFzc2lnblxuXHRcdFx0XHRcdFx0XHQvLyBJbiB0aGUgY2FzZSBvZiBPQXV0aDFcblx0XHRcdFx0XHRcdFx0Ly8gVHJpZ2dlciB0aGlzIGluIG5vbi1pbnRlcmFjdGl2ZSBtb2RlLlxuXHRcdFx0XHRcdFx0XHRfb3Blbih1cmwsIGZhbHNlKTtcblx0XHRcdFx0XHRcdH0sXG5cblx0XHRcdFx0XHRcdHNlYXJjaDogYS5zZWFyY2gsXG5cdFx0XHRcdFx0XHRoYXNoOiBhLmhhc2gsXG5cdFx0XHRcdFx0XHRocmVmOiBhLmhyZWZcblx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdGNsb3NlOiBmdW5jdGlvbigpIHt9XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0Ly8gVGhlbiB0aGlzIFVSTCBjb250YWlucyBpbmZvcm1hdGlvbiB3aGljaCBIZWxsb0pTIG11c3QgcHJvY2Vzc1xuXHRcdFx0XHQvLyBVUkwgc3RyaW5nXG5cdFx0XHRcdC8vIFdpbmRvdyAtIGFueSBhY3Rpb24gc3VjaCBhcyB3aW5kb3cgcmVsb2NhdGlvbiBnb2VzIGhlcmVcblx0XHRcdFx0Ly8gT3BlbmVyIC0gdGhlIHBhcmVudCB3aW5kb3cgd2hpY2ggb3BlbmVkIHRoaXMsIGFrYSB0aGlzIHNjcmlwdFxuXG5cdFx0XHRcdGhlbGxvLnV0aWxzLnJlc3BvbnNlSGFuZGxlcihfcG9wdXAsIHdpbmRvdyk7XG5cdFx0XHR9KTtcblxuXHRcdFx0Ly8gUmV0dXJuIHRoZSByZWZlcmVuY2Vcblx0XHRcdHJldHVybiByZWY7XG5cdFx0fVxuXG5cdH0pKCk7XG59XG5cbi8vIFBob25lZ2FwIG92ZXJyaWRlIGZvciBoZWxsby5waG9uZWdhcC5qc1xuKGZ1bmN0aW9uKCkge1xuXG5cdC8vIElzIHRoaXMgYSBwaG9uZWdhcCBpbXBsZW1lbnRhdGlvbj9cblx0aWYgKCEoL15maWxlOlxcL3szfVteXFwvXS8udGVzdCh3aW5kb3cubG9jYXRpb24uaHJlZikgJiYgd2luZG93LmNvcmRvdmEpKSB7XG5cdFx0Ly8gQ29yZG92YSBpcyBub3QgaW5jbHVkZWQuXG5cdFx0cmV0dXJuO1xuXHR9XG5cblx0Ly8gQXVnbWVudCB0aGUgaGlkZGVuIGlmcmFtZSBtZXRob2Rcblx0aGVsbG8udXRpbHMuaWZyYW1lID0gZnVuY3Rpb24odXJsLCByZWRpcmVjdFVyaSkge1xuXHRcdGhlbGxvLnV0aWxzLnBvcHVwKHVybCwgcmVkaXJlY3RVcmksIHtoaWRkZW46ICd5ZXMnfSk7XG5cdH07XG5cblx0Ly8gQXVnbWVudCB0aGUgcG9wdXBcblx0dmFyIHV0aWxQb3B1cCA9IGhlbGxvLnV0aWxzLnBvcHVwO1xuXG5cdC8vIFJlcGxhY2UgcG9wdXBcblx0aGVsbG8udXRpbHMucG9wdXAgPSBmdW5jdGlvbih1cmwsIHJlZGlyZWN0VXJpLCBvcHRpb25zKSB7XG5cblx0XHQvLyBSdW4gdGhlIHN0YW5kYXJkXG5cdFx0dmFyIHBvcHVwID0gdXRpbFBvcHVwLmNhbGwodGhpcywgdXJsLCByZWRpcmVjdFVyaSwgb3B0aW9ucyk7XG5cblx0XHQvLyBDcmVhdGUgYSBmdW5jdGlvbiBmb3IgcmVvcGVuaW5nIHRoZSBwb3B1cCwgYW5kIGFzc2lnbmluZyBldmVudHMgdG8gdGhlIG5ldyBwb3B1cCBvYmplY3Rcblx0XHQvLyBQaG9uZUdhcCBzdXBwb3J0XG5cdFx0Ly8gQWRkIGFuIGV2ZW50IGxpc3RlbmVyIHRvIGxpc3RlbiB0byB0aGUgY2hhbmdlIGluIHRoZSBwb3B1cCB3aW5kb3dzIFVSTFxuXHRcdC8vIFRoaXMgbXVzdCBhcHBlYXIgYmVmb3JlIHBvcHVwLmZvY3VzKCk7XG5cdFx0dHJ5IHtcblx0XHRcdGlmIChwb3B1cCAmJiBwb3B1cC5hZGRFdmVudExpc3RlbmVyKSB7XG5cblx0XHRcdFx0Ly8gR2V0IHRoZSBvcmlnaW4gb2YgdGhlIHJlZGlyZWN0IFVSSVxuXG5cdFx0XHRcdHZhciBhID0gaGVsbG8udXRpbHMudXJsKHJlZGlyZWN0VXJpKTtcblx0XHRcdFx0dmFyIHJlZGlyZWN0VXJpT3JpZ2luID0gYS5vcmlnaW4gfHwgKGEucHJvdG9jb2wgKyAnLy8nICsgYS5ob3N0bmFtZSk7XG5cblx0XHRcdFx0Ly8gTGlzdGVuIHRvIGNoYW5nZXMgaW4gdGhlIEluQXBwQnJvd3NlciB3aW5kb3dcblxuXHRcdFx0XHRwb3B1cC5hZGRFdmVudExpc3RlbmVyKCdsb2Fkc3RhcnQnLCBmdW5jdGlvbihlKSB7XG5cblx0XHRcdFx0XHR2YXIgdXJsID0gZS51cmw7XG5cblx0XHRcdFx0XHQvLyBJcyB0aGlzIHRoZSBwYXRoLCBhcyBnaXZlbiBieSB0aGUgcmVkaXJlY3RVcmk/XG5cdFx0XHRcdFx0Ly8gQ2hlY2sgdGhlIG5ldyBVUkwgYWdhaW5zIHRoZSByZWRpcmVjdFVyaU9yaWdpbi5cblx0XHRcdFx0XHQvLyBBY2NvcmRpbmcgdG8gIzYzIGEgdXNlciBjb3VsZCBjbGljayAnY2FuY2VsJyBpbiBzb21lIGRpYWxvZyBib3hlcyAuLi4uXG5cdFx0XHRcdFx0Ly8gVGhlIHBvcHVwIHJlZGlyZWN0cyB0byBhbm90aGVyIHBhZ2Ugd2l0aCB0aGUgc2FtZSBvcmlnaW4sIHlldCB3ZSBzdGlsbCB3aXNoIGl0IHRvIGNsb3NlLlxuXG5cdFx0XHRcdFx0aWYgKHVybC5pbmRleE9mKHJlZGlyZWN0VXJpT3JpZ2luKSAhPT0gMCkge1xuXHRcdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdC8vIFNwbGl0IGFwcGFydCB0aGUgVVJMXG5cdFx0XHRcdFx0dmFyIGEgPSBoZWxsby51dGlscy51cmwodXJsKTtcblxuXHRcdFx0XHRcdC8vIFdlIGRvbnQgaGF2ZSB3aW5kb3cgb3BlcmF0aW9ucyBvbiB0aGUgcG9wdXAgc28gbGV0cyBjcmVhdGUgc29tZVxuXHRcdFx0XHRcdC8vIFRoZSBsb2NhdGlvbiBjYW4gYmUgYXVnbWVudGVkIGluIHRvIGEgbG9jYXRpb24gb2JqZWN0IGxpa2Ugc28uLi5cblxuXHRcdFx0XHRcdHZhciBfcG9wdXAgPSB7XG5cdFx0XHRcdFx0XHRsb2NhdGlvbjoge1xuXHRcdFx0XHRcdFx0XHQvLyBDaGFuZ2UgdGhlIGxvY2F0aW9uIG9mIHRoZSBwb3B1cFxuXHRcdFx0XHRcdFx0XHRhc3NpZ246IGZ1bmN0aW9uKGxvY2F0aW9uKSB7XG5cblx0XHRcdFx0XHRcdFx0XHQvLyBVbmZvdXJ0dW5hdGx5IGFuIGFwcCBpcyBtYXkgbm90IGNoYW5nZSB0aGUgbG9jYXRpb24gb2YgYSBJbkFwcEJyb3dzZXIgd2luZG93LlxuXHRcdFx0XHRcdFx0XHRcdC8vIFNvIHRvIHNoaW0gdGhpcywganVzdCBvcGVuIGEgbmV3IG9uZS5cblx0XHRcdFx0XHRcdFx0XHRwb3B1cC5leGVjdXRlU2NyaXB0KHtjb2RlOiAnd2luZG93LmxvY2F0aW9uLmhyZWYgPSBcIicgKyBsb2NhdGlvbiArICdcIjsnfSk7XG5cdFx0XHRcdFx0XHRcdH0sXG5cblx0XHRcdFx0XHRcdFx0c2VhcmNoOiBhLnNlYXJjaCxcblx0XHRcdFx0XHRcdFx0aGFzaDogYS5oYXNoLFxuXHRcdFx0XHRcdFx0XHRocmVmOiBhLmhyZWZcblx0XHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0XHRjbG9zZTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRcdGlmIChwb3B1cC5jbG9zZSkge1xuXHRcdFx0XHRcdFx0XHRcdHBvcHVwLmNsb3NlKCk7XG5cdFx0XHRcdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdFx0XHRcdHBvcHVwLmNsb3NlZCA9IHRydWU7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdGNhdGNoIChfZSkge31cblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHQvLyBUaGVuIHRoaXMgVVJMIGNvbnRhaW5zIGluZm9ybWF0aW9uIHdoaWNoIEhlbGxvSlMgbXVzdCBwcm9jZXNzXG5cdFx0XHRcdFx0Ly8gVVJMIHN0cmluZ1xuXHRcdFx0XHRcdC8vIFdpbmRvdyAtIGFueSBhY3Rpb24gc3VjaCBhcyB3aW5kb3cgcmVsb2NhdGlvbiBnb2VzIGhlcmVcblx0XHRcdFx0XHQvLyBPcGVuZXIgLSB0aGUgcGFyZW50IHdpbmRvdyB3aGljaCBvcGVuZWQgdGhpcywgYWthIHRoaXMgc2NyaXB0XG5cblx0XHRcdFx0XHRoZWxsby51dGlscy5yZXNwb25zZUhhbmRsZXIoX3BvcHVwLCB3aW5kb3cpO1xuXG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRjYXRjaCAoZSkge31cblxuXHRcdHJldHVybiBwb3B1cDtcblx0fTtcblxufSkoKTtcblxuKGZ1bmN0aW9uKGhlbGxvKSB7XG5cblx0Ly8gT0F1dGgxXG5cdHZhciBPQXV0aDFTZXR0aW5ncyA9IHtcblx0XHR2ZXJzaW9uOiAnMS4wJyxcblx0XHRhdXRoOiAnaHR0cHM6Ly93d3cuZHJvcGJveC5jb20vMS9vYXV0aC9hdXRob3JpemUnLFxuXHRcdHJlcXVlc3Q6ICdodHRwczovL2FwaS5kcm9wYm94LmNvbS8xL29hdXRoL3JlcXVlc3RfdG9rZW4nLFxuXHRcdHRva2VuOiAnaHR0cHM6Ly9hcGkuZHJvcGJveC5jb20vMS9vYXV0aC9hY2Nlc3NfdG9rZW4nXG5cdH07XG5cblx0Ly8gT0F1dGgyIFNldHRpbmdzXG5cdHZhciBPQXV0aDJTZXR0aW5ncyA9IHtcblx0XHR2ZXJzaW9uOiAyLFxuXHRcdGF1dGg6ICdodHRwczovL3d3dy5kcm9wYm94LmNvbS8xL29hdXRoMi9hdXRob3JpemUnLFxuXHRcdGdyYW50OiAnaHR0cHM6Ly9hcGkuZHJvcGJveC5jb20vMS9vYXV0aDIvdG9rZW4nXG5cdH07XG5cblx0Ly8gSW5pdGlhdGUgdGhlIERyb3Bib3ggbW9kdWxlXG5cdGhlbGxvLmluaXQoe1xuXG5cdFx0ZHJvcGJveDoge1xuXG5cdFx0XHRuYW1lOiAnRHJvcGJveCcsXG5cblx0XHRcdG9hdXRoOiBPQXV0aDJTZXR0aW5ncyxcblxuXHRcdFx0bG9naW46IGZ1bmN0aW9uKHApIHtcblx0XHRcdFx0Ly8gT0F1dGgyIG5vbi1zdGFuZGFyZCBhZGp1c3RtZW50c1xuXHRcdFx0XHRwLnFzLnNjb3BlID0gJyc7XG5cblx0XHRcdFx0Ly8gU2hvdWxkIHRoaXMgYmUgcnVuIGFzIE9BdXRoMT9cblx0XHRcdFx0Ly8gSWYgdGhlIHJlZGlyZWN0X3VyaSBpcyBpcyBIVFRQIChub24tc2VjdXJlKSB0aGVuIGl0cyByZXF1aXJlZCB0byByZXZlcnQgdG8gdGhlIE9BdXRoMSBlbmRwb2ludHNcblx0XHRcdFx0dmFyIHJlZGlyZWN0ID0gZGVjb2RlVVJJQ29tcG9uZW50KHAucXMucmVkaXJlY3RfdXJpKTtcblx0XHRcdFx0aWYgKHJlZGlyZWN0LmluZGV4T2YoJ2h0dHA6JykgPT09IDAgJiYgcmVkaXJlY3QuaW5kZXhPZignaHR0cDovL2xvY2FsaG9zdC8nKSAhPT0gMCkge1xuXG5cdFx0XHRcdFx0Ly8gT3ZlcnJpZGUgdGhlIGRyb3Bib3ggT0F1dGggc2V0dGluZ3MuXG5cdFx0XHRcdFx0aGVsbG8uc2VydmljZXMuZHJvcGJveC5vYXV0aCA9IE9BdXRoMVNldHRpbmdzO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGVsc2Uge1xuXHRcdFx0XHRcdC8vIE92ZXJyaWRlIHRoZSBkcm9wYm94IE9BdXRoIHNldHRpbmdzLlxuXHRcdFx0XHRcdGhlbGxvLnNlcnZpY2VzLmRyb3Bib3gub2F1dGggPSBPQXV0aDJTZXR0aW5ncztcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIFRoZSBkcm9wYm94IGxvZ2luIHdpbmRvdyBpcyBhIGRpZmZlcmVudCBzaXplXG5cdFx0XHRcdHAub3B0aW9ucy5wb3B1cC53aWR0aCA9IDEwMDA7XG5cdFx0XHRcdHAub3B0aW9ucy5wb3B1cC5oZWlnaHQgPSAxMDAwO1xuXHRcdFx0fSxcblxuXHRcdFx0Lypcblx0XHRcdFx0RHJvcGJveCBkb2VzIG5vdCBhbGxvdyBpbnNlY3VyZSBIVFRQIFVSSSdzIGluIHRoZSByZWRpcmVjdF91cmkgZmllbGRcblx0XHRcdFx0Li4ub3RoZXJ3aXNlIEknZCBsb3ZlIHRvIHVzZSBPQXV0aDJcblxuXHRcdFx0XHRGb2xsb3cgcmVxdWVzdCBodHRwczovL2ZvcnVtcy5kcm9wYm94LmNvbS90b3BpYy5waHA/aWQ9MTA2NTA1XG5cblx0XHRcdFx0cC5xcy5yZXNwb25zZV90eXBlID0gJ2NvZGUnO1xuXHRcdFx0XHRvYXV0aDoge1xuXHRcdFx0XHRcdHZlcnNpb246IDIsXG5cdFx0XHRcdFx0YXV0aDogJ2h0dHBzOi8vd3d3LmRyb3Bib3guY29tLzEvb2F1dGgyL2F1dGhvcml6ZScsXG5cdFx0XHRcdFx0Z3JhbnQ6ICdodHRwczovL2FwaS5kcm9wYm94LmNvbS8xL29hdXRoMi90b2tlbidcblx0XHRcdFx0fVxuXHRcdFx0Ki9cblxuXHRcdFx0Ly8gQVBJIEJhc2UgVVJMXG5cdFx0XHRiYXNlOiAnaHR0cHM6Ly9hcGkuZHJvcGJveC5jb20vMS8nLFxuXG5cdFx0XHQvLyBCZXNwb2tlIHNldHRpbmc6IHRoaXMgaXMgc3RhdGVzIHdoZXRoZXIgdG8gdXNlIHRoZSBjdXN0b20gZW52aXJvbm1lbnQgb2YgRHJvcGJveCBvciB0byB1c2UgdGhlaXIgb3duIGVudmlyb25tZW50XG5cdFx0XHQvLyBCZWNhdXNlIGl0J3Mgbm90b3Jpb3VzbHkgZGlmZmljdWx0IGZvciBEcm9wYm94IHRvbyBwcm92aWRlIGFjY2VzcyBmcm9tIG90aGVyIHdlYnNlcnZpY2VzLCB0aGlzIGRlZmF1bHRzIHRvIFNhbmRib3hcblx0XHRcdHJvb3Q6ICdzYW5kYm94JyxcblxuXHRcdFx0Ly8gTWFwIEdFVCByZXF1ZXN0c1xuXHRcdFx0Z2V0OiB7XG5cdFx0XHRcdG1lOiAnYWNjb3VudC9pbmZvJyxcblxuXHRcdFx0XHQvLyBIdHRwczovL3d3dy5kcm9wYm94LmNvbS9kZXZlbG9wZXJzL2NvcmUvZG9jcyNtZXRhZGF0YVxuXHRcdFx0XHQnbWUvZmlsZXMnOiByZXEoJ21ldGFkYXRhL2F1dG8vQHtwYXJlbnR8fScpLFxuXHRcdFx0XHQnbWUvZm9sZGVyJzogcmVxKCdtZXRhZGF0YS9hdXRvL0B7aWR9JyksXG5cdFx0XHRcdCdtZS9mb2xkZXJzJzogcmVxKCdtZXRhZGF0YS9hdXRvLycpLFxuXG5cdFx0XHRcdCdkZWZhdWx0JzogZnVuY3Rpb24ocCwgY2FsbGJhY2spIHtcblx0XHRcdFx0XHRpZiAocC5wYXRoLm1hdGNoKCdodHRwczovL2FwaS1jb250ZW50LmRyb3Bib3guY29tLzEvZmlsZXMvJykpIHtcblx0XHRcdFx0XHRcdC8vIFRoaXMgaXMgYSBmaWxlLCByZXR1cm4gYmluYXJ5IGRhdGFcblx0XHRcdFx0XHRcdHAubWV0aG9kID0gJ2Jsb2InO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGNhbGxiYWNrKHAucGF0aCk7XG5cdFx0XHRcdH1cblx0XHRcdH0sXG5cblx0XHRcdHBvc3Q6IHtcblx0XHRcdFx0J21lL2ZpbGVzJzogZnVuY3Rpb24ocCwgY2FsbGJhY2spIHtcblxuXHRcdFx0XHRcdHZhciBwYXRoID0gcC5kYXRhLnBhcmVudDtcblx0XHRcdFx0XHR2YXIgZmlsZU5hbWUgPSBwLmRhdGEubmFtZTtcblxuXHRcdFx0XHRcdHAuZGF0YSA9IHtcblx0XHRcdFx0XHRcdGZpbGU6IHAuZGF0YS5maWxlXG5cdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdC8vIERvZXMgdGhpcyBoYXZlIGEgZGF0YS11cmkgdG8gdXBsb2FkIGFzIGEgZmlsZT9cblx0XHRcdFx0XHRpZiAodHlwZW9mIChwLmRhdGEuZmlsZSkgPT09ICdzdHJpbmcnKSB7XG5cdFx0XHRcdFx0XHRwLmRhdGEuZmlsZSA9IGhlbGxvLnV0aWxzLnRvQmxvYihwLmRhdGEuZmlsZSk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0Y2FsbGJhY2soJ2h0dHBzOi8vYXBpLWNvbnRlbnQuZHJvcGJveC5jb20vMS9maWxlc19wdXQvYXV0by8nICsgcGF0aCArICcvJyArIGZpbGVOYW1lKTtcblx0XHRcdFx0fSxcblxuXHRcdFx0XHQnbWUvZm9sZGVycyc6IGZ1bmN0aW9uKHAsIGNhbGxiYWNrKSB7XG5cblx0XHRcdFx0XHR2YXIgbmFtZSA9IHAuZGF0YS5uYW1lO1xuXHRcdFx0XHRcdHAuZGF0YSA9IHt9O1xuXG5cdFx0XHRcdFx0Y2FsbGJhY2soJ2ZpbGVvcHMvY3JlYXRlX2ZvbGRlcj9yb290PUB7cm9vdHxzYW5kYm94fSYnICsgaGVsbG8udXRpbHMucGFyYW0oe1xuXHRcdFx0XHRcdFx0cGF0aDogbmFtZVxuXHRcdFx0XHRcdH0pKTtcblx0XHRcdFx0fVxuXHRcdFx0fSxcblxuXHRcdFx0Ly8gTWFwIERFTEVURSByZXF1ZXN0c1xuXHRcdFx0ZGVsOiB7XG5cdFx0XHRcdCdtZS9maWxlcyc6ICdmaWxlb3BzL2RlbGV0ZT9yb290PUB7cm9vdHxzYW5kYm94fSZwYXRoPUB7aWR9Jyxcblx0XHRcdFx0J21lL2ZvbGRlcic6ICdmaWxlb3BzL2RlbGV0ZT9yb290PUB7cm9vdHxzYW5kYm94fSZwYXRoPUB7aWR9J1xuXHRcdFx0fSxcblxuXHRcdFx0d3JhcDoge1xuXHRcdFx0XHRtZTogZnVuY3Rpb24obykge1xuXHRcdFx0XHRcdGZvcm1hdEVycm9yKG8pO1xuXHRcdFx0XHRcdGlmICghby51aWQpIHtcblx0XHRcdFx0XHRcdHJldHVybiBvO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdG8ubmFtZSA9IG8uZGlzcGxheV9uYW1lO1xuXHRcdFx0XHRcdHZhciBtID0gby5uYW1lLnNwbGl0KCcgJyk7XG5cdFx0XHRcdFx0by5maXJzdF9uYW1lID0gbS5zaGlmdCgpO1xuXHRcdFx0XHRcdG8ubGFzdF9uYW1lID0gbS5qb2luKCcgJyk7XG5cdFx0XHRcdFx0by5pZCA9IG8udWlkO1xuXHRcdFx0XHRcdGRlbGV0ZSBvLnVpZDtcblx0XHRcdFx0XHRkZWxldGUgby5kaXNwbGF5X25hbWU7XG5cdFx0XHRcdFx0cmV0dXJuIG87XG5cdFx0XHRcdH0sXG5cblx0XHRcdFx0J2RlZmF1bHQnOiBmdW5jdGlvbihvLCBoZWFkZXJzLCByZXEpIHtcblx0XHRcdFx0XHRmb3JtYXRFcnJvcihvKTtcblx0XHRcdFx0XHRpZiAoby5pc19kaXIgJiYgby5jb250ZW50cykge1xuXHRcdFx0XHRcdFx0by5kYXRhID0gby5jb250ZW50cztcblx0XHRcdFx0XHRcdGRlbGV0ZSBvLmNvbnRlbnRzO1xuXG5cdFx0XHRcdFx0XHRvLmRhdGEuZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7XG5cdFx0XHRcdFx0XHRcdGl0ZW0ucm9vdCA9IG8ucm9vdDtcblx0XHRcdFx0XHRcdFx0Zm9ybWF0RmlsZShpdGVtLCBoZWFkZXJzLCByZXEpO1xuXHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0Zm9ybWF0RmlsZShvLCBoZWFkZXJzLCByZXEpO1xuXG5cdFx0XHRcdFx0aWYgKG8uaXNfZGVsZXRlZCkge1xuXHRcdFx0XHRcdFx0by5zdWNjZXNzID0gdHJ1ZTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRyZXR1cm4gbztcblx0XHRcdFx0fVxuXHRcdFx0fSxcblxuXHRcdFx0Ly8gRG9lc24ndCByZXR1cm4gdGhlIENPUlMgaGVhZGVyc1xuXHRcdFx0eGhyOiBmdW5jdGlvbihwKSB7XG5cblx0XHRcdFx0Ly8gVGhlIHByb3h5IHN1cHBvcnRzIGFsbG93LWNyb3NzLW9yaWdpbi1yZXNvdXJjZVxuXHRcdFx0XHQvLyBBbGFzIHRoYXQncyB0aGUgb25seSB0aGluZyB3ZSdyZSB1c2luZy5cblx0XHRcdFx0aWYgKHAuZGF0YSAmJiBwLmRhdGEuZmlsZSkge1xuXHRcdFx0XHRcdHZhciBmaWxlID0gcC5kYXRhLmZpbGU7XG5cdFx0XHRcdFx0aWYgKGZpbGUpIHtcblx0XHRcdFx0XHRcdGlmIChmaWxlLmZpbGVzKSB7XG5cdFx0XHRcdFx0XHRcdHAuZGF0YSA9IGZpbGUuZmlsZXNbMF07XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRlbHNlIHtcblx0XHRcdFx0XHRcdFx0cC5kYXRhID0gZmlsZTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAocC5tZXRob2QgPT09ICdkZWxldGUnKSB7XG5cdFx0XHRcdFx0cC5tZXRob2QgPSAncG9zdCc7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdH0sXG5cblx0XHRcdGZvcm06IGZ1bmN0aW9uKHAsIHFzKSB7XG5cdFx0XHRcdGRlbGV0ZSBxcy5zdGF0ZTtcblx0XHRcdFx0ZGVsZXRlIHFzLnJlZGlyZWN0X3VyaTtcblx0XHRcdH1cblx0XHR9XG5cdH0pO1xuXG5cdGZ1bmN0aW9uIGZvcm1hdEVycm9yKG8pIHtcblx0XHRpZiAobyAmJiAnZXJyb3InIGluIG8pIHtcblx0XHRcdG8uZXJyb3IgPSB7XG5cdFx0XHRcdGNvZGU6ICdzZXJ2ZXJfZXJyb3InLFxuXHRcdFx0XHRtZXNzYWdlOiBvLmVycm9yLm1lc3NhZ2UgfHwgby5lcnJvclxuXHRcdFx0fTtcblx0XHR9XG5cdH1cblxuXHRmdW5jdGlvbiBmb3JtYXRGaWxlKG8sIGhlYWRlcnMsIHJlcSkge1xuXG5cdFx0aWYgKHR5cGVvZiBvICE9PSAnb2JqZWN0JyB8fFxuXHRcdFx0KHR5cGVvZiBCbG9iICE9PSAndW5kZWZpbmVkJyAmJiBvIGluc3RhbmNlb2YgQmxvYikgfHxcblx0XHRcdCh0eXBlb2YgQXJyYXlCdWZmZXIgIT09ICd1bmRlZmluZWQnICYmIG8gaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcikpIHtcblx0XHRcdC8vIFRoaXMgaXMgYSBmaWxlLCBsZXQgaXQgdGhyb3VnaCB1bmZvcm1hdHRlZFxuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdGlmICgnZXJyb3InIGluIG8pIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHR2YXIgcGF0aCA9IChvLnJvb3QgIT09ICdhcHBfZm9sZGVyJyA/IG8ucm9vdCA6ICcnKSArIG8ucGF0aC5yZXBsYWNlKC9cXCYvZywgJyUyNicpO1xuXHRcdHBhdGggPSBwYXRoLnJlcGxhY2UoL15cXC8vLCAnJyk7XG5cdFx0aWYgKG8udGh1bWJfZXhpc3RzKSB7XG5cdFx0XHRvLnRodW1ibmFpbCA9IHJlcS5vYXV0aF9wcm94eSArICc/cGF0aD0nICtcblx0XHRcdGVuY29kZVVSSUNvbXBvbmVudCgnaHR0cHM6Ly9hcGktY29udGVudC5kcm9wYm94LmNvbS8xL3RodW1ibmFpbHMvYXV0by8nICsgcGF0aCArICc/Zm9ybWF0PWpwZWcmc2l6ZT1tJykgKyAnJmFjY2Vzc190b2tlbj0nICsgcmVxLm9wdGlvbnMuYWNjZXNzX3Rva2VuO1xuXHRcdH1cblxuXHRcdG8udHlwZSA9IChvLmlzX2RpciA/ICdmb2xkZXInIDogby5taW1lX3R5cGUpO1xuXHRcdG8ubmFtZSA9IG8ucGF0aC5yZXBsYWNlKC8uKlxcLy9nLCAnJyk7XG5cdFx0aWYgKG8uaXNfZGlyKSB7XG5cdFx0XHRvLmZpbGVzID0gcGF0aC5yZXBsYWNlKC9eXFwvLywgJycpO1xuXHRcdH1cblx0XHRlbHNlIHtcblx0XHRcdG8uZG93bmxvYWRMaW5rID0gaGVsbG8uc2V0dGluZ3Mub2F1dGhfcHJveHkgKyAnP3BhdGg9JyArXG5cdFx0XHRlbmNvZGVVUklDb21wb25lbnQoJ2h0dHBzOi8vYXBpLWNvbnRlbnQuZHJvcGJveC5jb20vMS9maWxlcy9hdXRvLycgKyBwYXRoKSArICcmYWNjZXNzX3Rva2VuPScgKyByZXEub3B0aW9ucy5hY2Nlc3NfdG9rZW47XG5cdFx0XHRvLmZpbGUgPSAnaHR0cHM6Ly9hcGktY29udGVudC5kcm9wYm94LmNvbS8xL2ZpbGVzL2F1dG8vJyArIHBhdGg7XG5cdFx0fVxuXG5cdFx0aWYgKCFvLmlkKSB7XG5cdFx0XHRvLmlkID0gby5wYXRoLnJlcGxhY2UoL15cXC8vLCAnJyk7XG5cdFx0fVxuXG5cdFx0Ly8gTy5tZWRpYSA9ICdodHRwczovL2FwaS1jb250ZW50LmRyb3Bib3guY29tLzEvZmlsZXMvJyArIHBhdGg7XG5cdH1cblxuXHRmdW5jdGlvbiByZXEoc3RyKSB7XG5cdFx0cmV0dXJuIGZ1bmN0aW9uKHAsIGNiKSB7XG5cdFx0XHRkZWxldGUgcC5xdWVyeS5saW1pdDtcblx0XHRcdGNiKHN0cik7XG5cdFx0fTtcblx0fVxuXG59KShoZWxsbyk7XG5cbihmdW5jdGlvbihoZWxsbykge1xuXG5cdGhlbGxvLmluaXQoe1xuXG5cdFx0ZmFjZWJvb2s6IHtcblxuXHRcdFx0bmFtZTogJ0ZhY2Vib29rJyxcblxuXHRcdFx0Ly8gU0VFIGh0dHBzOi8vZGV2ZWxvcGVycy5mYWNlYm9vay5jb20vZG9jcy9mYWNlYm9vay1sb2dpbi9tYW51YWxseS1idWlsZC1hLWxvZ2luLWZsb3cvdjIuMVxuXHRcdFx0b2F1dGg6IHtcblx0XHRcdFx0dmVyc2lvbjogMixcblx0XHRcdFx0YXV0aDogJ2h0dHBzOi8vd3d3LmZhY2Vib29rLmNvbS9kaWFsb2cvb2F1dGgvJyxcblx0XHRcdFx0Z3JhbnQ6ICdodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS9vYXV0aC9hY2Nlc3NfdG9rZW4nXG5cdFx0XHR9LFxuXG5cdFx0XHQvLyBBdXRob3JpemF0aW9uIHNjb3Blc1xuXHRcdFx0c2NvcGU6IHtcblx0XHRcdFx0YmFzaWM6ICdwdWJsaWNfcHJvZmlsZScsXG5cdFx0XHRcdGVtYWlsOiAnZW1haWwnLFxuXHRcdFx0XHRzaGFyZTogJ3VzZXJfcG9zdHMnLFxuXHRcdFx0XHRiaXJ0aGRheTogJ3VzZXJfYmlydGhkYXknLFxuXHRcdFx0XHRldmVudHM6ICd1c2VyX2V2ZW50cycsXG5cdFx0XHRcdHBob3RvczogJ3VzZXJfcGhvdG9zJyxcblx0XHRcdFx0dmlkZW9zOiAndXNlcl92aWRlb3MnLFxuXHRcdFx0XHRmcmllbmRzOiAndXNlcl9mcmllbmRzJyxcblx0XHRcdFx0ZmlsZXM6ICd1c2VyX3Bob3Rvcyx1c2VyX3ZpZGVvcycsXG5cdFx0XHRcdHB1Ymxpc2hfZmlsZXM6ICd1c2VyX3Bob3Rvcyx1c2VyX3ZpZGVvcyxwdWJsaXNoX2FjdGlvbnMnLFxuXHRcdFx0XHRwdWJsaXNoOiAncHVibGlzaF9hY3Rpb25zJyxcblxuXHRcdFx0XHQvLyBEZXByZWNhdGVkIGluIHYyLjBcblx0XHRcdFx0Ly8gQ3JlYXRlX2V2ZW50XHQ6ICdjcmVhdGVfZXZlbnQnLFxuXG5cdFx0XHRcdG9mZmxpbmVfYWNjZXNzOiAnJ1xuXHRcdFx0fSxcblxuXHRcdFx0Ly8gUmVmcmVzaCB0aGUgYWNjZXNzX3Rva2VuXG5cdFx0XHRyZWZyZXNoOiB0cnVlLFxuXG5cdFx0XHRsb2dpbjogZnVuY3Rpb24ocCkge1xuXG5cdFx0XHRcdC8vIFJlYXV0aGVudGljYXRlXG5cdFx0XHRcdC8vIGh0dHBzOi8vZGV2ZWxvcGVycy5mYWNlYm9vay5jb20vZG9jcy9mYWNlYm9vay1sb2dpbi9yZWF1dGhlbnRpY2F0aW9uXG5cdFx0XHRcdGlmIChwLm9wdGlvbnMuZm9yY2UpIHtcblx0XHRcdFx0XHRwLnFzLmF1dGhfdHlwZSA9ICdyZWF1dGhlbnRpY2F0ZSc7XG5cdFx0XHRcdH1cblx0XHRcdH0sXG5cblx0XHRcdGxvZ291dDogZnVuY3Rpb24oY2FsbGJhY2ssIG9wdGlvbnMpIHtcblx0XHRcdFx0Ly8gQXNzaWduIGNhbGxiYWNrIHRvIGEgZ2xvYmFsIGhhbmRsZXJcblx0XHRcdFx0dmFyIGNhbGxiYWNrSUQgPSBoZWxsby51dGlscy5nbG9iYWxFdmVudChjYWxsYmFjayk7XG5cdFx0XHRcdHZhciByZWRpcmVjdCA9IGVuY29kZVVSSUNvbXBvbmVudChoZWxsby5zZXR0aW5ncy5yZWRpcmVjdF91cmkgKyAnPycgKyBoZWxsby51dGlscy5wYXJhbSh7Y2FsbGJhY2s6Y2FsbGJhY2tJRCwgcmVzdWx0OiBKU09OLnN0cmluZ2lmeSh7Zm9yY2U6dHJ1ZX0pLCBzdGF0ZTogJ3t9J30pKTtcblx0XHRcdFx0dmFyIHRva2VuID0gKG9wdGlvbnMuYXV0aFJlc3BvbnNlIHx8IHt9KS5hY2Nlc3NfdG9rZW47XG5cdFx0XHRcdGhlbGxvLnV0aWxzLmlmcmFtZSgnaHR0cHM6Ly93d3cuZmFjZWJvb2suY29tL2xvZ291dC5waHA/bmV4dD0nICsgcmVkaXJlY3QgKyAnJmFjY2Vzc190b2tlbj0nICsgdG9rZW4pO1xuXG5cdFx0XHRcdC8vIFBvc3NpYmxlIHJlc3BvbnNlczpcblx0XHRcdFx0Ly8gU3RyaW5nIFVSTFx0LSBoZWxsby5sb2dvdXQgc2hvdWxkIGhhbmRsZSB0aGUgbG9nb3V0XG5cdFx0XHRcdC8vIFVuZGVmaW5lZFx0LSB0aGlzIGZ1bmN0aW9uIHdpbGwgaGFuZGxlIHRoZSBjYWxsYmFja1xuXHRcdFx0XHQvLyBUcnVlIC0gdGhyb3cgYSBzdWNjZXNzLCB0aGlzIGNhbGxiYWNrIGlzbid0IGhhbmRsaW5nIHRoZSBjYWxsYmFja1xuXHRcdFx0XHQvLyBGYWxzZSAtIHRocm93IGEgZXJyb3Jcblx0XHRcdFx0aWYgKCF0b2tlbikge1xuXHRcdFx0XHRcdC8vIElmIHRoZXJlIGlzbid0IGEgdG9rZW4sIHRoZSBhYm92ZSB3b250IHJldHVybiBhIHJlc3BvbnNlLCBzbyBsZXRzIHRyaWdnZXIgYSByZXNwb25zZVxuXHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0fVxuXHRcdFx0fSxcblxuXHRcdFx0Ly8gQVBJIEJhc2UgVVJMXG5cdFx0XHRiYXNlOiAnaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vdjIuNC8nLFxuXG5cdFx0XHQvLyBNYXAgR0VUIHJlcXVlc3RzXG5cdFx0XHRnZXQ6IHtcblx0XHRcdFx0bWU6ICdtZT9maWVsZHM9ZW1haWwsZmlyc3RfbmFtZSxsYXN0X25hbWUsbmFtZSx0aW1lem9uZSx2ZXJpZmllZCcsXG5cdFx0XHRcdCdtZS9mcmllbmRzJzogJ21lL2ZyaWVuZHMnLFxuXHRcdFx0XHQnbWUvZm9sbG93aW5nJzogJ21lL2ZyaWVuZHMnLFxuXHRcdFx0XHQnbWUvZm9sbG93ZXJzJzogJ21lL2ZyaWVuZHMnLFxuXHRcdFx0XHQnbWUvc2hhcmUnOiAnbWUvZmVlZCcsXG5cdFx0XHRcdCdtZS9saWtlJzogJ21lL2xpa2VzJyxcblx0XHRcdFx0J21lL2ZpbGVzJzogJ21lL2FsYnVtcycsXG5cdFx0XHRcdCdtZS9hbGJ1bXMnOiAnbWUvYWxidW1zP2ZpZWxkcz1jb3Zlcl9waG90byxuYW1lJyxcblx0XHRcdFx0J21lL2FsYnVtJzogJ0B7aWR9L3Bob3Rvcz9maWVsZHM9cGljdHVyZScsXG5cdFx0XHRcdCdtZS9waG90b3MnOiAnbWUvcGhvdG9zJyxcblx0XHRcdFx0J21lL3Bob3RvJzogJ0B7aWR9Jyxcblx0XHRcdFx0J2ZyaWVuZC9hbGJ1bXMnOiAnQHtpZH0vYWxidW1zJyxcblx0XHRcdFx0J2ZyaWVuZC9waG90b3MnOiAnQHtpZH0vcGhvdG9zJ1xuXG5cdFx0XHRcdC8vIFBhZ2luYXRpb25cblx0XHRcdFx0Ly8gSHR0cHM6Ly9kZXZlbG9wZXJzLmZhY2Vib29rLmNvbS9kb2NzL3JlZmVyZW5jZS9hcGkvcGFnaW5hdGlvbi9cblx0XHRcdH0sXG5cblx0XHRcdC8vIE1hcCBQT1NUIHJlcXVlc3RzXG5cdFx0XHRwb3N0OiB7XG5cdFx0XHRcdCdtZS9zaGFyZSc6ICdtZS9mZWVkJyxcblx0XHRcdFx0J21lL3Bob3RvJzogJ0B7aWR9J1xuXG5cdFx0XHRcdC8vIEh0dHBzOi8vZGV2ZWxvcGVycy5mYWNlYm9vay5jb20vZG9jcy9ncmFwaC1hcGkvcmVmZXJlbmNlL3YyLjIvb2JqZWN0L2xpa2VzL1xuXHRcdFx0fSxcblxuXHRcdFx0d3JhcDoge1xuXHRcdFx0XHRtZTogZm9ybWF0VXNlcixcblx0XHRcdFx0J21lL2ZyaWVuZHMnOiBmb3JtYXRGcmllbmRzLFxuXHRcdFx0XHQnbWUvZm9sbG93aW5nJzogZm9ybWF0RnJpZW5kcyxcblx0XHRcdFx0J21lL2ZvbGxvd2Vycyc6IGZvcm1hdEZyaWVuZHMsXG5cdFx0XHRcdCdtZS9hbGJ1bXMnOiBmb3JtYXQsXG5cdFx0XHRcdCdtZS9waG90b3MnOiBmb3JtYXQsXG5cdFx0XHRcdCdtZS9maWxlcyc6IGZvcm1hdCxcblx0XHRcdFx0J2RlZmF1bHQnOiBmb3JtYXRcblx0XHRcdH0sXG5cblx0XHRcdC8vIFNwZWNpYWwgcmVxdWlyZW1lbnRzIGZvciBoYW5kbGluZyBYSFJcblx0XHRcdHhocjogZnVuY3Rpb24ocCwgcXMpIHtcblx0XHRcdFx0aWYgKHAubWV0aG9kID09PSAnZ2V0JyB8fCBwLm1ldGhvZCA9PT0gJ3Bvc3QnKSB7XG5cdFx0XHRcdFx0cXMuc3VwcHJlc3NfcmVzcG9uc2VfY29kZXMgPSB0cnVlO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gSXMgdGhpcyBhIHBvc3Qgd2l0aCBhIGRhdGEtdXJpP1xuXHRcdFx0XHRpZiAocC5tZXRob2QgPT09ICdwb3N0JyAmJiBwLmRhdGEgJiYgdHlwZW9mIChwLmRhdGEuZmlsZSkgPT09ICdzdHJpbmcnKSB7XG5cdFx0XHRcdFx0Ly8gQ29udmVydCB0aGUgRGF0YS1VUkkgdG8gYSBCbG9iXG5cdFx0XHRcdFx0cC5kYXRhLmZpbGUgPSBoZWxsby51dGlscy50b0Jsb2IocC5kYXRhLmZpbGUpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHR9LFxuXG5cdFx0XHQvLyBTcGVjaWFsIHJlcXVpcmVtZW50cyBmb3IgaGFuZGxpbmcgSlNPTlAgZmFsbGJhY2tcblx0XHRcdGpzb25wOiBmdW5jdGlvbihwLCBxcykge1xuXHRcdFx0XHR2YXIgbSA9IHAubWV0aG9kO1xuXHRcdFx0XHRpZiAobSAhPT0gJ2dldCcgJiYgIWhlbGxvLnV0aWxzLmhhc0JpbmFyeShwLmRhdGEpKSB7XG5cdFx0XHRcdFx0cC5kYXRhLm1ldGhvZCA9IG07XG5cdFx0XHRcdFx0cC5tZXRob2QgPSAnZ2V0Jztcblx0XHRcdFx0fVxuXHRcdFx0XHRlbHNlIGlmIChwLm1ldGhvZCA9PT0gJ2RlbGV0ZScpIHtcblx0XHRcdFx0XHRxcy5tZXRob2QgPSAnZGVsZXRlJztcblx0XHRcdFx0XHRwLm1ldGhvZCA9ICdwb3N0Jztcblx0XHRcdFx0fVxuXHRcdFx0fSxcblxuXHRcdFx0Ly8gU3BlY2lhbCByZXF1aXJlbWVudHMgZm9yIGlmcmFtZSBmb3JtIGhhY2tcblx0XHRcdGZvcm06IGZ1bmN0aW9uKHApIHtcblx0XHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0XHQvLyBGaXJlIHRoZSBjYWxsYmFjayBvbmxvYWRcblx0XHRcdFx0XHRjYWxsYmFja29ubG9hZDogdHJ1ZVxuXHRcdFx0XHR9O1xuXHRcdFx0fVxuXHRcdH1cblx0fSk7XG5cblx0dmFyIGJhc2UgPSAnaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vJztcblxuXHRmdW5jdGlvbiBmb3JtYXRVc2VyKG8pIHtcblx0XHRpZiAoby5pZCkge1xuXHRcdFx0by50aHVtYm5haWwgPSBvLnBpY3R1cmUgPSAnaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vJyArIG8uaWQgKyAnL3BpY3R1cmUnO1xuXHRcdH1cblxuXHRcdHJldHVybiBvO1xuXHR9XG5cblx0ZnVuY3Rpb24gZm9ybWF0RnJpZW5kcyhvKSB7XG5cdFx0aWYgKCdkYXRhJyBpbiBvKSB7XG5cdFx0XHRvLmRhdGEuZm9yRWFjaChmb3JtYXRVc2VyKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gbztcblx0fVxuXG5cdGZ1bmN0aW9uIGZvcm1hdChvLCBoZWFkZXJzLCByZXEpIHtcblx0XHRpZiAodHlwZW9mIG8gPT09ICdib29sZWFuJykge1xuXHRcdFx0byA9IHtzdWNjZXNzOiBvfTtcblx0XHR9XG5cblx0XHRpZiAobyAmJiAnZGF0YScgaW4gbykge1xuXHRcdFx0dmFyIHRva2VuID0gcmVxLnF1ZXJ5LmFjY2Vzc190b2tlbjtcblxuXHRcdFx0aWYgKCEoby5kYXRhIGluc3RhbmNlb2YgQXJyYXkpKSB7XG5cdFx0XHRcdHZhciBkYXRhID0gby5kYXRhO1xuXHRcdFx0XHRkZWxldGUgby5kYXRhO1xuXHRcdFx0XHRvLmRhdGEgPSBbZGF0YV07XG5cdFx0XHR9XG5cblx0XHRcdG8uZGF0YS5mb3JFYWNoKGZ1bmN0aW9uKGQpIHtcblxuXHRcdFx0XHRpZiAoZC5waWN0dXJlKSB7XG5cdFx0XHRcdFx0ZC50aHVtYm5haWwgPSBkLnBpY3R1cmU7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRkLnBpY3R1cmVzID0gKGQuaW1hZ2VzIHx8IFtdKVxuXHRcdFx0XHRcdC5zb3J0KGZ1bmN0aW9uKGEsIGIpIHtcblx0XHRcdFx0XHRcdHJldHVybiBhLndpZHRoIC0gYi53aWR0aDtcblx0XHRcdFx0XHR9KTtcblxuXHRcdFx0XHRpZiAoZC5jb3Zlcl9waG90byAmJiBkLmNvdmVyX3Bob3RvLmlkKSB7XG5cdFx0XHRcdFx0ZC50aHVtYm5haWwgPSBiYXNlICsgZC5jb3Zlcl9waG90by5pZCArICcvcGljdHVyZT9hY2Nlc3NfdG9rZW49JyArIHRva2VuO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYgKGQudHlwZSA9PT0gJ2FsYnVtJykge1xuXHRcdFx0XHRcdGQuZmlsZXMgPSBkLnBob3RvcyA9IGJhc2UgKyBkLmlkICsgJy9waG90b3MnO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYgKGQuY2FuX3VwbG9hZCkge1xuXHRcdFx0XHRcdGQudXBsb2FkX2xvY2F0aW9uID0gYmFzZSArIGQuaWQgKyAnL3Bob3Rvcyc7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdHJldHVybiBvO1xuXHR9XG5cbn0pKGhlbGxvKTtcblxuKGZ1bmN0aW9uKGhlbGxvKSB7XG5cblx0aGVsbG8uaW5pdCh7XG5cblx0XHRmbGlja3I6IHtcblxuXHRcdFx0bmFtZTogJ0ZsaWNrcicsXG5cblx0XHRcdC8vIEVuc3VyZSB0aGF0IHlvdSBkZWZpbmUgYW4gb2F1dGhfcHJveHlcblx0XHRcdG9hdXRoOiB7XG5cdFx0XHRcdHZlcnNpb246ICcxLjBhJyxcblx0XHRcdFx0YXV0aDogJ2h0dHBzOi8vd3d3LmZsaWNrci5jb20vc2VydmljZXMvb2F1dGgvYXV0aG9yaXplP3Blcm1zPXJlYWQnLFxuXHRcdFx0XHRyZXF1ZXN0OiAnaHR0cHM6Ly93d3cuZmxpY2tyLmNvbS9zZXJ2aWNlcy9vYXV0aC9yZXF1ZXN0X3Rva2VuJyxcblx0XHRcdFx0dG9rZW46ICdodHRwczovL3d3dy5mbGlja3IuY29tL3NlcnZpY2VzL29hdXRoL2FjY2Vzc190b2tlbidcblx0XHRcdH0sXG5cblx0XHRcdC8vIEFQSSBiYXNlIFVSTFxuXHRcdFx0YmFzZTogJ2h0dHBzOi8vYXBpLmZsaWNrci5jb20vc2VydmljZXMvcmVzdCcsXG5cblx0XHRcdC8vIE1hcCBHRVQgcmVzcXVlc3RzXG5cdFx0XHRnZXQ6IHtcblx0XHRcdFx0bWU6IHNpZ24oJ2ZsaWNrci5wZW9wbGUuZ2V0SW5mbycpLFxuXHRcdFx0XHQnbWUvZnJpZW5kcyc6IHNpZ24oJ2ZsaWNrci5jb250YWN0cy5nZXRMaXN0Jywge3Blcl9wYWdlOidAe2xpbWl0fDUwfSd9KSxcblx0XHRcdFx0J21lL2ZvbGxvd2luZyc6IHNpZ24oJ2ZsaWNrci5jb250YWN0cy5nZXRMaXN0Jywge3Blcl9wYWdlOidAe2xpbWl0fDUwfSd9KSxcblx0XHRcdFx0J21lL2ZvbGxvd2Vycyc6IHNpZ24oJ2ZsaWNrci5jb250YWN0cy5nZXRMaXN0Jywge3Blcl9wYWdlOidAe2xpbWl0fDUwfSd9KSxcblx0XHRcdFx0J21lL2FsYnVtcyc6IHNpZ24oJ2ZsaWNrci5waG90b3NldHMuZ2V0TGlzdCcsIHtwZXJfcGFnZTonQHtsaW1pdHw1MH0nfSksXG5cdFx0XHRcdCdtZS9hbGJ1bSc6IHNpZ24oJ2ZsaWNrci5waG90b3NldHMuZ2V0UGhvdG9zJywge3Bob3Rvc2V0X2lkOiAnQHtpZH0nfSksXG5cdFx0XHRcdCdtZS9waG90b3MnOiBzaWduKCdmbGlja3IucGVvcGxlLmdldFBob3RvcycsIHtwZXJfcGFnZTonQHtsaW1pdHw1MH0nfSlcblx0XHRcdH0sXG5cblx0XHRcdHdyYXA6IHtcblx0XHRcdFx0bWU6IGZ1bmN0aW9uKG8pIHtcblx0XHRcdFx0XHRmb3JtYXRFcnJvcihvKTtcblx0XHRcdFx0XHRvID0gY2hlY2tSZXNwb25zZShvLCAncGVyc29uJyk7XG5cdFx0XHRcdFx0aWYgKG8uaWQpIHtcblx0XHRcdFx0XHRcdGlmIChvLnJlYWxuYW1lKSB7XG5cdFx0XHRcdFx0XHRcdG8ubmFtZSA9IG8ucmVhbG5hbWUuX2NvbnRlbnQ7XG5cdFx0XHRcdFx0XHRcdHZhciBtID0gby5uYW1lLnNwbGl0KCcgJyk7XG5cdFx0XHRcdFx0XHRcdG8uZmlyc3RfbmFtZSA9IG0uc2hpZnQoKTtcblx0XHRcdFx0XHRcdFx0by5sYXN0X25hbWUgPSBtLmpvaW4oJyAnKTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0by50aHVtYm5haWwgPSBnZXRCdWRkeUljb24obywgJ2wnKTtcblx0XHRcdFx0XHRcdG8ucGljdHVyZSA9IGdldEJ1ZGR5SWNvbihvLCAnbCcpO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHJldHVybiBvO1xuXHRcdFx0XHR9LFxuXG5cdFx0XHRcdCdtZS9mcmllbmRzJzogZm9ybWF0RnJpZW5kcyxcblx0XHRcdFx0J21lL2ZvbGxvd2Vycyc6IGZvcm1hdEZyaWVuZHMsXG5cdFx0XHRcdCdtZS9mb2xsb3dpbmcnOiBmb3JtYXRGcmllbmRzLFxuXHRcdFx0XHQnbWUvYWxidW1zJzogZnVuY3Rpb24obykge1xuXHRcdFx0XHRcdGZvcm1hdEVycm9yKG8pO1xuXHRcdFx0XHRcdG8gPSBjaGVja1Jlc3BvbnNlKG8sICdwaG90b3NldHMnKTtcblx0XHRcdFx0XHRwYWdpbmcobyk7XG5cdFx0XHRcdFx0aWYgKG8ucGhvdG9zZXQpIHtcblx0XHRcdFx0XHRcdG8uZGF0YSA9IG8ucGhvdG9zZXQ7XG5cdFx0XHRcdFx0XHRvLmRhdGEuZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7XG5cdFx0XHRcdFx0XHRcdGl0ZW0ubmFtZSA9IGl0ZW0udGl0bGUuX2NvbnRlbnQ7XG5cdFx0XHRcdFx0XHRcdGl0ZW0ucGhvdG9zID0gJ2h0dHBzOi8vYXBpLmZsaWNrci5jb20vc2VydmljZXMvcmVzdCcgKyBnZXRBcGlVcmwoJ2ZsaWNrci5waG90b3NldHMuZ2V0UGhvdG9zJywge3Bob3Rvc2V0X2lkOiBpdGVtLmlkfSwgdHJ1ZSk7XG5cdFx0XHRcdFx0XHR9KTtcblxuXHRcdFx0XHRcdFx0ZGVsZXRlIG8ucGhvdG9zZXQ7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0cmV0dXJuIG87XG5cdFx0XHRcdH0sXG5cblx0XHRcdFx0J21lL3Bob3Rvcyc6IGZ1bmN0aW9uKG8pIHtcblx0XHRcdFx0XHRmb3JtYXRFcnJvcihvKTtcblx0XHRcdFx0XHRyZXR1cm4gZm9ybWF0UGhvdG9zKG8pO1xuXHRcdFx0XHR9LFxuXG5cdFx0XHRcdCdkZWZhdWx0JzogZnVuY3Rpb24obykge1xuXHRcdFx0XHRcdGZvcm1hdEVycm9yKG8pO1xuXHRcdFx0XHRcdHJldHVybiBmb3JtYXRQaG90b3Mobyk7XG5cdFx0XHRcdH1cblx0XHRcdH0sXG5cblx0XHRcdHhocjogZmFsc2UsXG5cblx0XHRcdGpzb25wOiBmdW5jdGlvbihwLCBxcykge1xuXHRcdFx0XHRpZiAocC5tZXRob2QgPT0gJ2dldCcpIHtcblx0XHRcdFx0XHRkZWxldGUgcXMuY2FsbGJhY2s7XG5cdFx0XHRcdFx0cXMuanNvbmNhbGxiYWNrID0gcC5jYWxsYmFja0lEO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHR9KTtcblxuXHRmdW5jdGlvbiBnZXRBcGlVcmwobWV0aG9kLCBleHRyYVBhcmFtcywgc2tpcE5ldHdvcmspIHtcblx0XHR2YXIgdXJsID0gKChza2lwTmV0d29yaykgPyAnJyA6ICdmbGlja3I6JykgK1xuXHRcdFx0Jz9tZXRob2Q9JyArIG1ldGhvZCArXG5cdFx0XHQnJmFwaV9rZXk9JyArIGhlbGxvLnNlcnZpY2VzLmZsaWNrci5pZCArXG5cdFx0XHQnJmZvcm1hdD1qc29uJztcblx0XHRmb3IgKHZhciBwYXJhbSBpbiBleHRyYVBhcmFtcykge1xuXHRcdFx0aWYgKGV4dHJhUGFyYW1zLmhhc093blByb3BlcnR5KHBhcmFtKSkge1xuXHRcdFx0XHR1cmwgKz0gJyYnICsgcGFyYW0gKyAnPScgKyBleHRyYVBhcmFtc1twYXJhbV07XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHVybDtcblx0fVxuXG5cdC8vIFRoaXMgaXMgbm90IGV4YWN0bHkgbmVhdCBidXQgYXZvaWQgdG8gY2FsbFxuXHQvLyBUaGUgbWV0aG9kICdmbGlja3IudGVzdC5sb2dpbicgZm9yIGVhY2ggYXBpIGNhbGxcblxuXHRmdW5jdGlvbiB3aXRoVXNlcihjYikge1xuXHRcdHZhciBhdXRoID0gaGVsbG8uZ2V0QXV0aFJlc3BvbnNlKCdmbGlja3InKTtcblx0XHRjYihhdXRoICYmIGF1dGgudXNlcl9uc2lkID8gYXV0aC51c2VyX25zaWQgOiBudWxsKTtcblx0fVxuXG5cdGZ1bmN0aW9uIHNpZ24odXJsLCBwYXJhbXMpIHtcblx0XHRpZiAoIXBhcmFtcykge1xuXHRcdFx0cGFyYW1zID0ge307XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGZ1bmN0aW9uKHAsIGNhbGxiYWNrKSB7XG5cdFx0XHR3aXRoVXNlcihmdW5jdGlvbih1c2VySWQpIHtcblx0XHRcdFx0cGFyYW1zLnVzZXJfaWQgPSB1c2VySWQ7XG5cdFx0XHRcdGNhbGxiYWNrKGdldEFwaVVybCh1cmwsIHBhcmFtcywgdHJ1ZSkpO1xuXHRcdFx0fSk7XG5cdFx0fTtcblx0fVxuXG5cdGZ1bmN0aW9uIGdldEJ1ZGR5SWNvbihwcm9maWxlLCBzaXplKSB7XG5cdFx0dmFyIHVybCA9ICdodHRwczovL3d3dy5mbGlja3IuY29tL2ltYWdlcy9idWRkeWljb24uZ2lmJztcblx0XHRpZiAocHJvZmlsZS5uc2lkICYmIHByb2ZpbGUuaWNvbnNlcnZlciAmJiBwcm9maWxlLmljb25mYXJtKSB7XG5cdFx0XHR1cmwgPSAnaHR0cHM6Ly9mYXJtJyArIHByb2ZpbGUuaWNvbmZhcm0gKyAnLnN0YXRpY2ZsaWNrci5jb20vJyArXG5cdFx0XHRcdHByb2ZpbGUuaWNvbnNlcnZlciArICcvJyArXG5cdFx0XHRcdCdidWRkeWljb25zLycgKyBwcm9maWxlLm5zaWQgK1xuXHRcdFx0XHQoKHNpemUpID8gJ18nICsgc2l6ZSA6ICcnKSArICcuanBnJztcblx0XHR9XG5cblx0XHRyZXR1cm4gdXJsO1xuXHR9XG5cblx0Ly8gU2VlOiBodHRwczovL3d3dy5mbGlja3IuY29tL3NlcnZpY2VzL2FwaS9taXNjLnVybHMuaHRtbFxuXHRmdW5jdGlvbiBjcmVhdGVQaG90b1VybChpZCwgZmFybSwgc2VydmVyLCBzZWNyZXQsIHNpemUpIHtcblx0XHRzaXplID0gKHNpemUpID8gJ18nICsgc2l6ZSA6ICcnO1xuXHRcdHJldHVybiAnaHR0cHM6Ly9mYXJtJyArIGZhcm0gKyAnLnN0YXRpY2ZsaWNrci5jb20vJyArIHNlcnZlciArICcvJyArIGlkICsgJ18nICsgc2VjcmV0ICsgc2l6ZSArICcuanBnJztcblx0fVxuXG5cdGZ1bmN0aW9uIGZvcm1hdFVzZXIobykge1xuXHR9XG5cblx0ZnVuY3Rpb24gZm9ybWF0RXJyb3Iobykge1xuXHRcdGlmIChvICYmIG8uc3RhdCAmJiBvLnN0YXQudG9Mb3dlckNhc2UoKSAhPSAnb2snKSB7XG5cdFx0XHRvLmVycm9yID0ge1xuXHRcdFx0XHRjb2RlOiAnaW52YWxpZF9yZXF1ZXN0Jyxcblx0XHRcdFx0bWVzc2FnZTogby5tZXNzYWdlXG5cdFx0XHR9O1xuXHRcdH1cblx0fVxuXG5cdGZ1bmN0aW9uIGZvcm1hdFBob3RvcyhvKSB7XG5cdFx0aWYgKG8ucGhvdG9zZXQgfHwgby5waG90b3MpIHtcblx0XHRcdHZhciBzZXQgPSAoJ3Bob3Rvc2V0JyBpbiBvKSA/ICdwaG90b3NldCcgOiAncGhvdG9zJztcblx0XHRcdG8gPSBjaGVja1Jlc3BvbnNlKG8sIHNldCk7XG5cdFx0XHRwYWdpbmcobyk7XG5cdFx0XHRvLmRhdGEgPSBvLnBob3RvO1xuXHRcdFx0ZGVsZXRlIG8ucGhvdG87XG5cdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IG8uZGF0YS5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHR2YXIgcGhvdG8gPSBvLmRhdGFbaV07XG5cdFx0XHRcdHBob3RvLm5hbWUgPSBwaG90by50aXRsZTtcblx0XHRcdFx0cGhvdG8ucGljdHVyZSA9IGNyZWF0ZVBob3RvVXJsKHBob3RvLmlkLCBwaG90by5mYXJtLCBwaG90by5zZXJ2ZXIsIHBob3RvLnNlY3JldCwgJycpO1xuXHRcdFx0XHRwaG90by5waWN0dXJlcyA9IGNyZWF0ZVBpY3R1cmVzKHBob3RvLmlkLCBwaG90by5mYXJtLCBwaG90by5zZXJ2ZXIsIHBob3RvLnNlY3JldCk7XG5cdFx0XHRcdHBob3RvLnNvdXJjZSA9IGNyZWF0ZVBob3RvVXJsKHBob3RvLmlkLCBwaG90by5mYXJtLCBwaG90by5zZXJ2ZXIsIHBob3RvLnNlY3JldCwgJ2InKTtcblx0XHRcdFx0cGhvdG8udGh1bWJuYWlsID0gY3JlYXRlUGhvdG9VcmwocGhvdG8uaWQsIHBob3RvLmZhcm0sIHBob3RvLnNlcnZlciwgcGhvdG8uc2VjcmV0LCAnbScpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybiBvO1xuXHR9XG5cblx0Ly8gU2VlOiBodHRwczovL3d3dy5mbGlja3IuY29tL3NlcnZpY2VzL2FwaS9taXNjLnVybHMuaHRtbFxuXHRmdW5jdGlvbiBjcmVhdGVQaWN0dXJlcyhpZCwgZmFybSwgc2VydmVyLCBzZWNyZXQpIHtcblxuXHRcdHZhciBOT19MSU1JVCA9IDIwNDg7XG5cdFx0dmFyIHNpemVzID0gW1xuXHRcdFx0e2lkOiAndCcsIG1heDogMTAwfSxcblx0XHRcdHtpZDogJ20nLCBtYXg6IDI0MH0sXG5cdFx0XHR7aWQ6ICduJywgbWF4OiAzMjB9LFxuXHRcdFx0e2lkOiAnJywgbWF4OiA1MDB9LFxuXHRcdFx0e2lkOiAneicsIG1heDogNjQwfSxcblx0XHRcdHtpZDogJ2MnLCBtYXg6IDgwMH0sXG5cdFx0XHR7aWQ6ICdiJywgbWF4OiAxMDI0fSxcblx0XHRcdHtpZDogJ2gnLCBtYXg6IDE2MDB9LFxuXHRcdFx0e2lkOiAnaycsIG1heDogMjA0OH0sXG5cdFx0XHR7aWQ6ICdvJywgbWF4OiBOT19MSU1JVH1cblx0XHRdO1xuXG5cdFx0cmV0dXJuIHNpemVzLm1hcChmdW5jdGlvbihzaXplKSB7XG5cdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRzb3VyY2U6IGNyZWF0ZVBob3RvVXJsKGlkLCBmYXJtLCBzZXJ2ZXIsIHNlY3JldCwgc2l6ZS5pZCksXG5cblx0XHRcdFx0Ly8gTm90ZTogdGhpcyBpcyBhIGd1ZXNzIHRoYXQncyBhbG1vc3QgY2VydGFpbiB0byBiZSB3cm9uZyAodW5sZXNzIHNxdWFyZSBzb3VyY2UpXG5cdFx0XHRcdHdpZHRoOiBzaXplLm1heCxcblx0XHRcdFx0aGVpZ2h0OiBzaXplLm1heFxuXHRcdFx0fTtcblx0XHR9KTtcblx0fVxuXG5cdGZ1bmN0aW9uIGNoZWNrUmVzcG9uc2Uobywga2V5KSB7XG5cblx0XHRpZiAoa2V5IGluIG8pIHtcblx0XHRcdG8gPSBvW2tleV07XG5cdFx0fVxuXHRcdGVsc2UgaWYgKCEoJ2Vycm9yJyBpbiBvKSkge1xuXHRcdFx0by5lcnJvciA9IHtcblx0XHRcdFx0Y29kZTogJ2ludmFsaWRfcmVxdWVzdCcsXG5cdFx0XHRcdG1lc3NhZ2U6IG8ubWVzc2FnZSB8fCAnRmFpbGVkIHRvIGdldCBkYXRhIGZyb20gRmxpY2tyJ1xuXHRcdFx0fTtcblx0XHR9XG5cblx0XHRyZXR1cm4gbztcblx0fVxuXG5cdGZ1bmN0aW9uIGZvcm1hdEZyaWVuZHMobykge1xuXHRcdGZvcm1hdEVycm9yKG8pO1xuXHRcdGlmIChvLmNvbnRhY3RzKSB7XG5cdFx0XHRvID0gY2hlY2tSZXNwb25zZShvLCAnY29udGFjdHMnKTtcblx0XHRcdHBhZ2luZyhvKTtcblx0XHRcdG8uZGF0YSA9IG8uY29udGFjdDtcblx0XHRcdGRlbGV0ZSBvLmNvbnRhY3Q7XG5cdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IG8uZGF0YS5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHR2YXIgaXRlbSA9IG8uZGF0YVtpXTtcblx0XHRcdFx0aXRlbS5pZCA9IGl0ZW0ubnNpZDtcblx0XHRcdFx0aXRlbS5uYW1lID0gaXRlbS5yZWFsbmFtZSB8fCBpdGVtLnVzZXJuYW1lO1xuXHRcdFx0XHRpdGVtLnRodW1ibmFpbCA9IGdldEJ1ZGR5SWNvbihpdGVtLCAnbScpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybiBvO1xuXHR9XG5cblx0ZnVuY3Rpb24gcGFnaW5nKHJlcykge1xuXHRcdGlmIChyZXMucGFnZSAmJiByZXMucGFnZXMgJiYgcmVzLnBhZ2UgIT09IHJlcy5wYWdlcykge1xuXHRcdFx0cmVzLnBhZ2luZyA9IHtcblx0XHRcdFx0bmV4dDogJz9wYWdlPScgKyAoKytyZXMucGFnZSlcblx0XHRcdH07XG5cdFx0fVxuXHR9XG5cbn0pKGhlbGxvKTtcblxuKGZ1bmN0aW9uKGhlbGxvKSB7XG5cblx0aGVsbG8uaW5pdCh7XG5cblx0XHRmb3Vyc3F1YXJlOiB7XG5cblx0XHRcdG5hbWU6ICdGb3Vyc3F1YXJlJyxcblxuXHRcdFx0b2F1dGg6IHtcblx0XHRcdFx0Ly8gU2VlOiBodHRwczovL2RldmVsb3Blci5mb3Vyc3F1YXJlLmNvbS9vdmVydmlldy9hdXRoXG5cdFx0XHRcdHZlcnNpb246IDIsXG5cdFx0XHRcdGF1dGg6ICdodHRwczovL2ZvdXJzcXVhcmUuY29tL29hdXRoMi9hdXRoZW50aWNhdGUnLFxuXHRcdFx0XHRncmFudDogJ2h0dHBzOi8vZm91cnNxdWFyZS5jb20vb2F1dGgyL2FjY2Vzc190b2tlbidcblx0XHRcdH0sXG5cblx0XHRcdC8vIFJlZnJlc2ggdGhlIGFjY2Vzc190b2tlbiBvbmNlIGV4cGlyZWRcblx0XHRcdHJlZnJlc2g6IHRydWUsXG5cblx0XHRcdGJhc2U6ICdodHRwczovL2FwaS5mb3Vyc3F1YXJlLmNvbS92Mi8nLFxuXG5cdFx0XHRnZXQ6IHtcblx0XHRcdFx0bWU6ICd1c2Vycy9zZWxmJyxcblx0XHRcdFx0J21lL2ZyaWVuZHMnOiAndXNlcnMvc2VsZi9mcmllbmRzJyxcblx0XHRcdFx0J21lL2ZvbGxvd2Vycyc6ICd1c2Vycy9zZWxmL2ZyaWVuZHMnLFxuXHRcdFx0XHQnbWUvZm9sbG93aW5nJzogJ3VzZXJzL3NlbGYvZnJpZW5kcydcblx0XHRcdH0sXG5cblx0XHRcdHdyYXA6IHtcblx0XHRcdFx0bWU6IGZ1bmN0aW9uKG8pIHtcblx0XHRcdFx0XHRmb3JtYXRFcnJvcihvKTtcblx0XHRcdFx0XHRpZiAobyAmJiBvLnJlc3BvbnNlKSB7XG5cdFx0XHRcdFx0XHRvID0gby5yZXNwb25zZS51c2VyO1xuXHRcdFx0XHRcdFx0Zm9ybWF0VXNlcihvKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRyZXR1cm4gbztcblx0XHRcdFx0fSxcblxuXHRcdFx0XHQnZGVmYXVsdCc6IGZ1bmN0aW9uKG8pIHtcblx0XHRcdFx0XHRmb3JtYXRFcnJvcihvKTtcblxuXHRcdFx0XHRcdC8vIEZvcm1hdCBmcmllbmRzXG5cdFx0XHRcdFx0aWYgKG8gJiYgJ3Jlc3BvbnNlJyBpbiBvICYmICdmcmllbmRzJyBpbiBvLnJlc3BvbnNlICYmICdpdGVtcycgaW4gby5yZXNwb25zZS5mcmllbmRzKSB7XG5cdFx0XHRcdFx0XHRvLmRhdGEgPSBvLnJlc3BvbnNlLmZyaWVuZHMuaXRlbXM7XG5cdFx0XHRcdFx0XHRvLmRhdGEuZm9yRWFjaChmb3JtYXRVc2VyKTtcblx0XHRcdFx0XHRcdGRlbGV0ZSBvLnJlc3BvbnNlO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHJldHVybiBvO1xuXHRcdFx0XHR9XG5cdFx0XHR9LFxuXG5cdFx0XHR4aHI6IGZvcm1hdFJlcXVlc3QsXG5cdFx0XHRqc29ucDogZm9ybWF0UmVxdWVzdFxuXHRcdH1cblx0fSk7XG5cblx0ZnVuY3Rpb24gZm9ybWF0RXJyb3Iobykge1xuXHRcdGlmIChvLm1ldGEgJiYgKG8ubWV0YS5jb2RlID09PSA0MDAgfHwgby5tZXRhLmNvZGUgPT09IDQwMSkpIHtcblx0XHRcdG8uZXJyb3IgPSB7XG5cdFx0XHRcdGNvZGU6ICdhY2Nlc3NfZGVuaWVkJyxcblx0XHRcdFx0bWVzc2FnZTogby5tZXRhLmVycm9yRGV0YWlsXG5cdFx0XHR9O1xuXHRcdH1cblx0fVxuXG5cdGZ1bmN0aW9uIGZvcm1hdFVzZXIobykge1xuXHRcdGlmIChvICYmIG8uaWQpIHtcblx0XHRcdG8udGh1bWJuYWlsID0gby5waG90by5wcmVmaXggKyAnMTAweDEwMCcgKyBvLnBob3RvLnN1ZmZpeDtcblx0XHRcdG8ubmFtZSA9IG8uZmlyc3ROYW1lICsgJyAnICsgby5sYXN0TmFtZTtcblx0XHRcdG8uZmlyc3RfbmFtZSA9IG8uZmlyc3ROYW1lO1xuXHRcdFx0by5sYXN0X25hbWUgPSBvLmxhc3ROYW1lO1xuXHRcdFx0aWYgKG8uY29udGFjdCkge1xuXHRcdFx0XHRpZiAoby5jb250YWN0LmVtYWlsKSB7XG5cdFx0XHRcdFx0by5lbWFpbCA9IG8uY29udGFjdC5lbWFpbDtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdGZ1bmN0aW9uIGZvcm1hdFJlcXVlc3QocCwgcXMpIHtcblx0XHR2YXIgdG9rZW4gPSBxcy5hY2Nlc3NfdG9rZW47XG5cdFx0ZGVsZXRlIHFzLmFjY2Vzc190b2tlbjtcblx0XHRxcy5vYXV0aF90b2tlbiA9IHRva2VuO1xuXHRcdHFzLnYgPSAyMDEyMTEyNTtcblx0XHRyZXR1cm4gdHJ1ZTtcblx0fVxuXG59KShoZWxsbyk7XG5cbihmdW5jdGlvbihoZWxsbykge1xuXG5cdGhlbGxvLmluaXQoe1xuXG5cdFx0Z2l0aHViOiB7XG5cblx0XHRcdG5hbWU6ICdHaXRIdWInLFxuXG5cdFx0XHRvYXV0aDoge1xuXHRcdFx0XHR2ZXJzaW9uOiAyLFxuXHRcdFx0XHRhdXRoOiAnaHR0cHM6Ly9naXRodWIuY29tL2xvZ2luL29hdXRoL2F1dGhvcml6ZScsXG5cdFx0XHRcdGdyYW50OiAnaHR0cHM6Ly9naXRodWIuY29tL2xvZ2luL29hdXRoL2FjY2Vzc190b2tlbicsXG5cdFx0XHRcdHJlc3BvbnNlX3R5cGU6ICdjb2RlJ1xuXHRcdFx0fSxcblxuXHRcdFx0c2NvcGU6IHtcblx0XHRcdFx0ZW1haWw6ICd1c2VyOmVtYWlsJ1xuXHRcdFx0fSxcblxuXHRcdFx0YmFzZTogJ2h0dHBzOi8vYXBpLmdpdGh1Yi5jb20vJyxcblxuXHRcdFx0Z2V0OiB7XG5cdFx0XHRcdG1lOiAndXNlcicsXG5cdFx0XHRcdCdtZS9mcmllbmRzJzogJ3VzZXIvZm9sbG93aW5nP3Blcl9wYWdlPUB7bGltaXR8MTAwfScsXG5cdFx0XHRcdCdtZS9mb2xsb3dpbmcnOiAndXNlci9mb2xsb3dpbmc/cGVyX3BhZ2U9QHtsaW1pdHwxMDB9Jyxcblx0XHRcdFx0J21lL2ZvbGxvd2Vycyc6ICd1c2VyL2ZvbGxvd2Vycz9wZXJfcGFnZT1Ae2xpbWl0fDEwMH0nLFxuXHRcdFx0XHQnbWUvbGlrZSc6ICd1c2VyL3N0YXJyZWQ/cGVyX3BhZ2U9QHtsaW1pdHwxMDB9J1xuXHRcdFx0fSxcblxuXHRcdFx0d3JhcDoge1xuXHRcdFx0XHRtZTogZnVuY3Rpb24obywgaGVhZGVycykge1xuXG5cdFx0XHRcdFx0Zm9ybWF0RXJyb3IobywgaGVhZGVycyk7XG5cdFx0XHRcdFx0Zm9ybWF0VXNlcihvKTtcblxuXHRcdFx0XHRcdHJldHVybiBvO1xuXHRcdFx0XHR9LFxuXG5cdFx0XHRcdCdkZWZhdWx0JzogZnVuY3Rpb24obywgaGVhZGVycywgcmVxKSB7XG5cblx0XHRcdFx0XHRmb3JtYXRFcnJvcihvLCBoZWFkZXJzKTtcblxuXHRcdFx0XHRcdGlmIChBcnJheS5pc0FycmF5KG8pKSB7XG5cdFx0XHRcdFx0XHRvID0ge2RhdGE6b307XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0aWYgKG8uZGF0YSkge1xuXHRcdFx0XHRcdFx0cGFnaW5nKG8sIGhlYWRlcnMsIHJlcSk7XG5cdFx0XHRcdFx0XHRvLmRhdGEuZm9yRWFjaChmb3JtYXRVc2VyKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRyZXR1cm4gbztcblx0XHRcdFx0fVxuXHRcdFx0fSxcblxuXHRcdFx0eGhyOiBmdW5jdGlvbihwKSB7XG5cblx0XHRcdFx0aWYgKHAubWV0aG9kICE9PSAnZ2V0JyAmJiBwLmRhdGEpIHtcblxuXHRcdFx0XHRcdC8vIFNlcmlhbGl6ZSBwYXlsb2FkIGFzIEpTT05cblx0XHRcdFx0XHRwLmhlYWRlcnMgPSBwLmhlYWRlcnMgfHwge307XG5cdFx0XHRcdFx0cC5oZWFkZXJzWydDb250ZW50LVR5cGUnXSA9ICdhcHBsaWNhdGlvbi9qc29uJztcblx0XHRcdFx0XHRpZiAodHlwZW9mIChwLmRhdGEpID09PSAnb2JqZWN0Jykge1xuXHRcdFx0XHRcdFx0cC5kYXRhID0gSlNPTi5zdHJpbmdpZnkocC5kYXRhKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdH1cblx0XHR9XG5cdH0pO1xuXG5cdGZ1bmN0aW9uIGZvcm1hdEVycm9yKG8sIGhlYWRlcnMpIHtcblx0XHR2YXIgY29kZSA9IGhlYWRlcnMgPyBoZWFkZXJzLnN0YXR1c0NvZGUgOiAobyAmJiAnbWV0YScgaW4gbyAmJiAnc3RhdHVzJyBpbiBvLm1ldGEgJiYgby5tZXRhLnN0YXR1cyk7XG5cdFx0aWYgKChjb2RlID09PSA0MDEgfHwgY29kZSA9PT0gNDAzKSkge1xuXHRcdFx0by5lcnJvciA9IHtcblx0XHRcdFx0Y29kZTogJ2FjY2Vzc19kZW5pZWQnLFxuXHRcdFx0XHRtZXNzYWdlOiBvLm1lc3NhZ2UgfHwgKG8uZGF0YSA/IG8uZGF0YS5tZXNzYWdlIDogJ0NvdWxkIG5vdCBnZXQgcmVzcG9uc2UnKVxuXHRcdFx0fTtcblx0XHRcdGRlbGV0ZSBvLm1lc3NhZ2U7XG5cdFx0fVxuXHR9XG5cblx0ZnVuY3Rpb24gZm9ybWF0VXNlcihvKSB7XG5cdFx0aWYgKG8uaWQpIHtcblx0XHRcdG8udGh1bWJuYWlsID0gby5waWN0dXJlID0gby5hdmF0YXJfdXJsO1xuXHRcdFx0by5uYW1lID0gby5sb2dpbjtcblx0XHR9XG5cdH1cblxuXHRmdW5jdGlvbiBwYWdpbmcocmVzLCBoZWFkZXJzLCByZXEpIHtcblx0XHRpZiAocmVzLmRhdGEgJiYgcmVzLmRhdGEubGVuZ3RoICYmIGhlYWRlcnMgJiYgaGVhZGVycy5MaW5rKSB7XG5cdFx0XHR2YXIgbmV4dCA9IGhlYWRlcnMuTGluay5tYXRjaCgvPCguKj8pPjtcXHMqcmVsPVxcXCJuZXh0XFxcIi8pO1xuXHRcdFx0aWYgKG5leHQpIHtcblx0XHRcdFx0cmVzLnBhZ2luZyA9IHtcblx0XHRcdFx0XHRuZXh0OiBuZXh0WzFdXG5cdFx0XHRcdH07XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cbn0pKGhlbGxvKTtcblxuKGZ1bmN0aW9uKGhlbGxvKSB7XG5cblx0dmFyIGNvbnRhY3RzVXJsID0gJ2h0dHBzOi8vd3d3Lmdvb2dsZS5jb20vbTgvZmVlZHMvY29udGFjdHMvZGVmYXVsdC9mdWxsP3Y9My4wJmFsdD1qc29uJm1heC1yZXN1bHRzPUB7bGltaXR8MTAwMH0mc3RhcnQtaW5kZXg9QHtzdGFydHwxfSc7XG5cblx0aGVsbG8uaW5pdCh7XG5cblx0XHRnb29nbGU6IHtcblxuXHRcdFx0bmFtZTogJ0dvb2dsZSBQbHVzJyxcblxuXHRcdFx0Ly8gU2VlOiBodHRwOi8vY29kZS5nb29nbGUuY29tL2FwaXMvYWNjb3VudHMvZG9jcy9PQXV0aDJVc2VyQWdlbnQuaHRtbFxuXHRcdFx0b2F1dGg6IHtcblx0XHRcdFx0dmVyc2lvbjogMixcblx0XHRcdFx0YXV0aDogJ2h0dHBzOi8vYWNjb3VudHMuZ29vZ2xlLmNvbS9vL29hdXRoMi9hdXRoJyxcblx0XHRcdFx0Z3JhbnQ6ICdodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20vby9vYXV0aDIvdG9rZW4nXG5cdFx0XHR9LFxuXG5cdFx0XHQvLyBBdXRob3JpemF0aW9uIHNjb3Blc1xuXHRcdFx0c2NvcGU6IHtcblx0XHRcdFx0YmFzaWM6ICdodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9hdXRoL3BsdXMubWUgcHJvZmlsZScsXG5cdFx0XHRcdGVtYWlsOiAnZW1haWwnLFxuXHRcdFx0XHRiaXJ0aGRheTogJycsXG5cdFx0XHRcdGV2ZW50czogJycsXG5cdFx0XHRcdHBob3RvczogJ2h0dHBzOi8vcGljYXNhd2ViLmdvb2dsZS5jb20vZGF0YS8nLFxuXHRcdFx0XHR2aWRlb3M6ICdodHRwOi8vZ2RhdGEueW91dHViZS5jb20nLFxuXHRcdFx0XHRmcmllbmRzOiAnaHR0cHM6Ly93d3cuZ29vZ2xlLmNvbS9tOC9mZWVkcywgaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vYXV0aC9wbHVzLmxvZ2luJyxcblx0XHRcdFx0ZmlsZXM6ICdodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9hdXRoL2RyaXZlLnJlYWRvbmx5Jyxcblx0XHRcdFx0cHVibGlzaDogJycsXG5cdFx0XHRcdHB1Ymxpc2hfZmlsZXM6ICdodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9hdXRoL2RyaXZlJyxcblx0XHRcdFx0c2hhcmU6ICcnLFxuXHRcdFx0XHRjcmVhdGVfZXZlbnQ6ICcnLFxuXHRcdFx0XHRvZmZsaW5lX2FjY2VzczogJydcblx0XHRcdH0sXG5cblx0XHRcdHNjb3BlX2RlbGltOiAnICcsXG5cblx0XHRcdGxvZ2luOiBmdW5jdGlvbihwKSB7XG5cblx0XHRcdFx0aWYgKHAucXMucmVzcG9uc2VfdHlwZSA9PT0gJ2NvZGUnKSB7XG5cblx0XHRcdFx0XHQvLyBMZXQncyBzZXQgdGhpcyB0byBhbiBvZmZsaW5lIGFjY2VzcyB0byByZXR1cm4gYSByZWZyZXNoX3Rva2VuXG5cdFx0XHRcdFx0cC5xcy5hY2Nlc3NfdHlwZSA9ICdvZmZsaW5lJztcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIFJlYXV0aGVudGljYXRlXG5cdFx0XHRcdC8vIGh0dHBzOi8vZGV2ZWxvcGVycy5nb29nbGUuY29tL2lkZW50aXR5L3Byb3RvY29scy9cblx0XHRcdFx0aWYgKHAub3B0aW9ucy5mb3JjZSkge1xuXHRcdFx0XHRcdHAucXMuYXBwcm92YWxfcHJvbXB0ID0gJ2ZvcmNlJztcblx0XHRcdFx0fVxuXHRcdFx0fSxcblxuXHRcdFx0Ly8gQVBJIGJhc2UgVVJJXG5cdFx0XHRiYXNlOiAnaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vJyxcblxuXHRcdFx0Ly8gTWFwIEdFVCByZXF1ZXN0c1xuXHRcdFx0Z2V0OiB7XG5cdFx0XHRcdG1lOiAncGx1cy92MS9wZW9wbGUvbWUnLFxuXG5cdFx0XHRcdC8vIERlcHJlY2F0ZWQgU2VwdCAxLCAyMDE0XG5cdFx0XHRcdC8vJ21lJzogJ29hdXRoMi92MS91c2VyaW5mbz9hbHQ9anNvbicsXG5cblx0XHRcdFx0Ly8gU2VlOiBodHRwczovL2RldmVsb3BlcnMuZ29vZ2xlLmNvbS8rL2FwaS9sYXRlc3QvcGVvcGxlL2xpc3Rcblx0XHRcdFx0J21lL2ZyaWVuZHMnOiAncGx1cy92MS9wZW9wbGUvbWUvcGVvcGxlL3Zpc2libGU/bWF4UmVzdWx0cz1Ae2xpbWl0fDEwMH0nLFxuXHRcdFx0XHQnbWUvZm9sbG93aW5nJzogY29udGFjdHNVcmwsXG5cdFx0XHRcdCdtZS9mb2xsb3dlcnMnOiBjb250YWN0c1VybCxcblx0XHRcdFx0J21lL2NvbnRhY3RzJzogY29udGFjdHNVcmwsXG5cdFx0XHRcdCdtZS9zaGFyZSc6ICdwbHVzL3YxL3Blb3BsZS9tZS9hY3Rpdml0aWVzL3B1YmxpYz9tYXhSZXN1bHRzPUB7bGltaXR8MTAwfScsXG5cdFx0XHRcdCdtZS9mZWVkJzogJ3BsdXMvdjEvcGVvcGxlL21lL2FjdGl2aXRpZXMvcHVibGljP21heFJlc3VsdHM9QHtsaW1pdHwxMDB9Jyxcblx0XHRcdFx0J21lL2FsYnVtcyc6ICdodHRwczovL3BpY2FzYXdlYi5nb29nbGUuY29tL2RhdGEvZmVlZC9hcGkvdXNlci9kZWZhdWx0P2FsdD1qc29uJm1heC1yZXN1bHRzPUB7bGltaXR8MTAwfSZzdGFydC1pbmRleD1Ae3N0YXJ0fDF9Jyxcblx0XHRcdFx0J21lL2FsYnVtJzogZnVuY3Rpb24ocCwgY2FsbGJhY2spIHtcblx0XHRcdFx0XHR2YXIga2V5ID0gcC5xdWVyeS5pZDtcblx0XHRcdFx0XHRkZWxldGUgcC5xdWVyeS5pZDtcblx0XHRcdFx0XHRjYWxsYmFjayhrZXkucmVwbGFjZSgnL2VudHJ5LycsICcvZmVlZC8nKSk7XG5cdFx0XHRcdH0sXG5cblx0XHRcdFx0J21lL3Bob3Rvcyc6ICdodHRwczovL3BpY2FzYXdlYi5nb29nbGUuY29tL2RhdGEvZmVlZC9hcGkvdXNlci9kZWZhdWx0P2FsdD1qc29uJmtpbmQ9cGhvdG8mbWF4LXJlc3VsdHM9QHtsaW1pdHwxMDB9JnN0YXJ0LWluZGV4PUB7c3RhcnR8MX0nLFxuXG5cdFx0XHRcdC8vIFNlZTogaHR0cHM6Ly9kZXZlbG9wZXJzLmdvb2dsZS5jb20vZHJpdmUvdjIvcmVmZXJlbmNlL2ZpbGVzL2xpc3Rcblx0XHRcdFx0J21lL2ZpbGUnOiAnZHJpdmUvdjIvZmlsZXMvQHtpZH0nLFxuXHRcdFx0XHQnbWUvZmlsZXMnOiAnZHJpdmUvdjIvZmlsZXM/cT0lMjJAe3BhcmVudHxyb290fSUyMitpbitwYXJlbnRzK2FuZCt0cmFzaGVkPWZhbHNlJm1heFJlc3VsdHM9QHtsaW1pdHwxMDB9JyxcblxuXHRcdFx0XHQvLyBTZWU6IGh0dHBzOi8vZGV2ZWxvcGVycy5nb29nbGUuY29tL2RyaXZlL3YyL3JlZmVyZW5jZS9maWxlcy9saXN0XG5cdFx0XHRcdCdtZS9mb2xkZXJzJzogJ2RyaXZlL3YyL2ZpbGVzP3E9JTIyQHtpZHxyb290fSUyMitpbitwYXJlbnRzK2FuZCttaW1lVHlwZSs9KyUyMmFwcGxpY2F0aW9uL3ZuZC5nb29nbGUtYXBwcy5mb2xkZXIlMjIrYW5kK3RyYXNoZWQ9ZmFsc2UmbWF4UmVzdWx0cz1Ae2xpbWl0fDEwMH0nLFxuXG5cdFx0XHRcdC8vIFNlZTogaHR0cHM6Ly9kZXZlbG9wZXJzLmdvb2dsZS5jb20vZHJpdmUvdjIvcmVmZXJlbmNlL2ZpbGVzL2xpc3Rcblx0XHRcdFx0J21lL2ZvbGRlcic6ICdkcml2ZS92Mi9maWxlcz9xPSUyMkB7aWR8cm9vdH0lMjIraW4rcGFyZW50cythbmQrdHJhc2hlZD1mYWxzZSZtYXhSZXN1bHRzPUB7bGltaXR8MTAwfSdcblx0XHRcdH0sXG5cblx0XHRcdC8vIE1hcCBQT1NUIHJlcXVlc3RzXG5cdFx0XHRwb3N0OiB7XG5cblx0XHRcdFx0Ly8gR29vZ2xlIERyaXZlXG5cdFx0XHRcdCdtZS9maWxlcyc6IHVwbG9hZERyaXZlLFxuXHRcdFx0XHQnbWUvZm9sZGVycyc6IGZ1bmN0aW9uKHAsIGNhbGxiYWNrKSB7XG5cdFx0XHRcdFx0cC5kYXRhID0ge1xuXHRcdFx0XHRcdFx0dGl0bGU6IHAuZGF0YS5uYW1lLFxuXHRcdFx0XHRcdFx0cGFyZW50czogW3tpZDogcC5kYXRhLnBhcmVudCB8fCAncm9vdCd9XSxcblx0XHRcdFx0XHRcdG1pbWVUeXBlOiAnYXBwbGljYXRpb24vdm5kLmdvb2dsZS1hcHBzLmZvbGRlcidcblx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdGNhbGxiYWNrKCdkcml2ZS92Mi9maWxlcycpO1xuXHRcdFx0XHR9XG5cdFx0XHR9LFxuXG5cdFx0XHQvLyBNYXAgUFVUIHJlcXVlc3RzXG5cdFx0XHRwdXQ6IHtcblx0XHRcdFx0J21lL2ZpbGVzJzogdXBsb2FkRHJpdmVcblx0XHRcdH0sXG5cblx0XHRcdC8vIE1hcCBERUxFVEUgcmVxdWVzdHNcblx0XHRcdGRlbDoge1xuXHRcdFx0XHQnbWUvZmlsZXMnOiAnZHJpdmUvdjIvZmlsZXMvQHtpZH0nLFxuXHRcdFx0XHQnbWUvZm9sZGVyJzogJ2RyaXZlL3YyL2ZpbGVzL0B7aWR9J1xuXHRcdFx0fSxcblxuXHRcdFx0Ly8gTWFwIFBBVENIIHJlcXVlc3RzXG5cdFx0XHRwYXRjaDoge1xuXHRcdFx0XHQnbWUvZmlsZSc6ICdkcml2ZS92Mi9maWxlcy9Ae2lkfSdcblx0XHRcdH0sXG5cblx0XHRcdHdyYXA6IHtcblx0XHRcdFx0bWU6IGZ1bmN0aW9uKG8pIHtcblx0XHRcdFx0XHRpZiAoby5pZCkge1xuXHRcdFx0XHRcdFx0by5sYXN0X25hbWUgPSBvLmZhbWlseV9uYW1lIHx8IChvLm5hbWUgPyBvLm5hbWUuZmFtaWx5TmFtZSA6IG51bGwpO1xuXHRcdFx0XHRcdFx0by5maXJzdF9uYW1lID0gby5naXZlbl9uYW1lIHx8IChvLm5hbWUgPyBvLm5hbWUuZ2l2ZW5OYW1lIDogbnVsbCk7XG5cblx0XHRcdFx0XHRcdGlmIChvLmVtYWlscyAmJiBvLmVtYWlscy5sZW5ndGgpIHtcblx0XHRcdFx0XHRcdFx0by5lbWFpbCA9IG8uZW1haWxzWzBdLnZhbHVlO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRmb3JtYXRQZXJzb24obyk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0cmV0dXJuIG87XG5cdFx0XHRcdH0sXG5cblx0XHRcdFx0J21lL2ZyaWVuZHMnOiBmdW5jdGlvbihvKSB7XG5cdFx0XHRcdFx0aWYgKG8uaXRlbXMpIHtcblx0XHRcdFx0XHRcdHBhZ2luZyhvKTtcblx0XHRcdFx0XHRcdG8uZGF0YSA9IG8uaXRlbXM7XG5cdFx0XHRcdFx0XHRvLmRhdGEuZm9yRWFjaChmb3JtYXRQZXJzb24pO1xuXHRcdFx0XHRcdFx0ZGVsZXRlIG8uaXRlbXM7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0cmV0dXJuIG87XG5cdFx0XHRcdH0sXG5cblx0XHRcdFx0J21lL2NvbnRhY3RzJzogZm9ybWF0RnJpZW5kcyxcblx0XHRcdFx0J21lL2ZvbGxvd2Vycyc6IGZvcm1hdEZyaWVuZHMsXG5cdFx0XHRcdCdtZS9mb2xsb3dpbmcnOiBmb3JtYXRGcmllbmRzLFxuXHRcdFx0XHQnbWUvc2hhcmUnOiBmb3JtYXRGZWVkLFxuXHRcdFx0XHQnbWUvZmVlZCc6IGZvcm1hdEZlZWQsXG5cdFx0XHRcdCdtZS9hbGJ1bXMnOiBnRW50cnksXG5cdFx0XHRcdCdtZS9waG90b3MnOiBmb3JtYXRQaG90b3MsXG5cdFx0XHRcdCdkZWZhdWx0JzogZ0VudHJ5XG5cdFx0XHR9LFxuXG5cdFx0XHR4aHI6IGZ1bmN0aW9uKHApIHtcblxuXHRcdFx0XHRpZiAocC5tZXRob2QgPT09ICdwb3N0JyB8fCBwLm1ldGhvZCA9PT0gJ3B1dCcpIHtcblx0XHRcdFx0XHR0b0pTT04ocCk7XG5cdFx0XHRcdH1cblx0XHRcdFx0ZWxzZSBpZiAocC5tZXRob2QgPT09ICdwYXRjaCcpIHtcblx0XHRcdFx0XHRoZWxsby51dGlscy5leHRlbmQocC5xdWVyeSwgcC5kYXRhKTtcblx0XHRcdFx0XHRwLmRhdGEgPSBudWxsO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHR9LFxuXG5cdFx0XHQvLyBEb24ndCBldmVuIHRyeSBzdWJtaXR0aW5nIHZpYSBmb3JtLlxuXHRcdFx0Ly8gVGhpcyBtZWFucyBubyBQT1NUIG9wZXJhdGlvbnMgaW4gPD1JRTlcblx0XHRcdGZvcm06IGZhbHNlXG5cdFx0fVxuXHR9KTtcblxuXHRmdW5jdGlvbiB0b0ludChzKSB7XG5cdFx0cmV0dXJuIHBhcnNlSW50KHMsIDEwKTtcblx0fVxuXG5cdGZ1bmN0aW9uIGZvcm1hdEZlZWQobykge1xuXHRcdHBhZ2luZyhvKTtcblx0XHRvLmRhdGEgPSBvLml0ZW1zO1xuXHRcdGRlbGV0ZSBvLml0ZW1zO1xuXHRcdHJldHVybiBvO1xuXHR9XG5cblx0Ly8gRm9ybWF0OiBlbnN1cmUgZWFjaCByZWNvcmQgY29udGFpbnMgYSBuYW1lLCBpZCBldGMuXG5cdGZ1bmN0aW9uIGZvcm1hdEl0ZW0obykge1xuXHRcdGlmIChvLmVycm9yKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0aWYgKCFvLm5hbWUpIHtcblx0XHRcdG8ubmFtZSA9IG8udGl0bGUgfHwgby5tZXNzYWdlO1xuXHRcdH1cblxuXHRcdGlmICghby5waWN0dXJlKSB7XG5cdFx0XHRvLnBpY3R1cmUgPSBvLnRodW1ibmFpbExpbms7XG5cdFx0fVxuXG5cdFx0aWYgKCFvLnRodW1ibmFpbCkge1xuXHRcdFx0by50aHVtYm5haWwgPSBvLnRodW1ibmFpbExpbms7XG5cdFx0fVxuXG5cdFx0aWYgKG8ubWltZVR5cGUgPT09ICdhcHBsaWNhdGlvbi92bmQuZ29vZ2xlLWFwcHMuZm9sZGVyJykge1xuXHRcdFx0by50eXBlID0gJ2ZvbGRlcic7XG5cdFx0XHRvLmZpbGVzID0gJ2h0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL2RyaXZlL3YyL2ZpbGVzP3E9JTIyJyArIG8uaWQgKyAnJTIyK2luK3BhcmVudHMnO1xuXHRcdH1cblxuXHRcdHJldHVybiBvO1xuXHR9XG5cblx0ZnVuY3Rpb24gZm9ybWF0SW1hZ2UoaW1hZ2UpIHtcblx0XHRyZXR1cm4ge1xuXHRcdFx0c291cmNlOiBpbWFnZS51cmwsXG5cdFx0XHR3aWR0aDogaW1hZ2Uud2lkdGgsXG5cdFx0XHRoZWlnaHQ6IGltYWdlLmhlaWdodFxuXHRcdH07XG5cdH1cblxuXHRmdW5jdGlvbiBmb3JtYXRQaG90b3Mobykge1xuXHRcdG8uZGF0YSA9IG8uZmVlZC5lbnRyeS5tYXAoZm9ybWF0RW50cnkpO1xuXHRcdGRlbGV0ZSBvLmZlZWQ7XG5cdH1cblxuXHQvLyBHb29nbGUgaGFzIGEgaG9ycmlibGUgSlNPTiBBUElcblx0ZnVuY3Rpb24gZ0VudHJ5KG8pIHtcblx0XHRwYWdpbmcobyk7XG5cblx0XHRpZiAoJ2ZlZWQnIGluIG8gJiYgJ2VudHJ5JyBpbiBvLmZlZWQpIHtcblx0XHRcdG8uZGF0YSA9IG8uZmVlZC5lbnRyeS5tYXAoZm9ybWF0RW50cnkpO1xuXHRcdFx0ZGVsZXRlIG8uZmVlZDtcblx0XHR9XG5cblx0XHQvLyBPbGQgc3R5bGU6IFBpY2FzYSwgZXRjLlxuXHRcdGVsc2UgaWYgKCdlbnRyeScgaW4gbykge1xuXHRcdFx0cmV0dXJuIGZvcm1hdEVudHJ5KG8uZW50cnkpO1xuXHRcdH1cblxuXHRcdC8vIE5ldyBzdHlsZTogR29vZ2xlIERyaXZlICYgUGx1c1xuXHRcdGVsc2UgaWYgKCdpdGVtcycgaW4gbykge1xuXHRcdFx0by5kYXRhID0gby5pdGVtcy5tYXAoZm9ybWF0SXRlbSk7XG5cdFx0XHRkZWxldGUgby5pdGVtcztcblx0XHR9XG5cdFx0ZWxzZSB7XG5cdFx0XHRmb3JtYXRJdGVtKG8pO1xuXHRcdH1cblxuXHRcdHJldHVybiBvO1xuXHR9XG5cblx0ZnVuY3Rpb24gZm9ybWF0UGVyc29uKG8pIHtcblx0XHRvLm5hbWUgPSBvLmRpc3BsYXlOYW1lIHx8IG8ubmFtZTtcblx0XHRvLnBpY3R1cmUgPSBvLnBpY3R1cmUgfHwgKG8uaW1hZ2UgPyBvLmltYWdlLnVybCA6IG51bGwpO1xuXHRcdG8udGh1bWJuYWlsID0gby5waWN0dXJlO1xuXHR9XG5cblx0ZnVuY3Rpb24gZm9ybWF0RnJpZW5kcyhvLCBoZWFkZXJzLCByZXEpIHtcblx0XHRwYWdpbmcobyk7XG5cdFx0dmFyIHIgPSBbXTtcblx0XHRpZiAoJ2ZlZWQnIGluIG8gJiYgJ2VudHJ5JyBpbiBvLmZlZWQpIHtcblx0XHRcdHZhciB0b2tlbiA9IHJlcS5xdWVyeS5hY2Nlc3NfdG9rZW47XG5cdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IG8uZmVlZC5lbnRyeS5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHR2YXIgYSA9IG8uZmVlZC5lbnRyeVtpXTtcblxuXHRcdFx0XHRhLmlkXHQ9IGEuaWQuJHQ7XG5cdFx0XHRcdGEubmFtZVx0PSBhLnRpdGxlLiR0O1xuXHRcdFx0XHRkZWxldGUgYS50aXRsZTtcblx0XHRcdFx0aWYgKGEuZ2QkZW1haWwpIHtcblx0XHRcdFx0XHRhLmVtYWlsXHQ9IChhLmdkJGVtYWlsICYmIGEuZ2QkZW1haWwubGVuZ3RoID4gMCkgPyBhLmdkJGVtYWlsWzBdLmFkZHJlc3MgOiBudWxsO1xuXHRcdFx0XHRcdGEuZW1haWxzID0gYS5nZCRlbWFpbDtcblx0XHRcdFx0XHRkZWxldGUgYS5nZCRlbWFpbDtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmIChhLnVwZGF0ZWQpIHtcblx0XHRcdFx0XHRhLnVwZGF0ZWQgPSBhLnVwZGF0ZWQuJHQ7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAoYS5saW5rKSB7XG5cblx0XHRcdFx0XHR2YXIgcGljID0gKGEubGluay5sZW5ndGggPiAwKSA/IGEubGlua1swXS5ocmVmIDogbnVsbDtcblx0XHRcdFx0XHRpZiAocGljICYmIGEubGlua1swXS5nZCRldGFnKSB7XG5cdFx0XHRcdFx0XHRwaWMgKz0gKHBpYy5pbmRleE9mKCc/JykgPiAtMSA/ICcmJyA6ICc/JykgKyAnYWNjZXNzX3Rva2VuPScgKyB0b2tlbjtcblx0XHRcdFx0XHRcdGEucGljdHVyZSA9IHBpYztcblx0XHRcdFx0XHRcdGEudGh1bWJuYWlsID0gcGljO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGRlbGV0ZSBhLmxpbms7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAoYS5jYXRlZ29yeSkge1xuXHRcdFx0XHRcdGRlbGV0ZSBhLmNhdGVnb3J5O1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdG8uZGF0YSA9IG8uZmVlZC5lbnRyeTtcblx0XHRcdGRlbGV0ZSBvLmZlZWQ7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIG87XG5cdH1cblxuXHRmdW5jdGlvbiBmb3JtYXRFbnRyeShhKSB7XG5cblx0XHR2YXIgZ3JvdXAgPSBhLm1lZGlhJGdyb3VwO1xuXHRcdHZhciBwaG90byA9IGdyb3VwLm1lZGlhJGNvbnRlbnQubGVuZ3RoID8gZ3JvdXAubWVkaWEkY29udGVudFswXSA6IHt9O1xuXHRcdHZhciBtZWRpYUNvbnRlbnQgPSBncm91cC5tZWRpYSRjb250ZW50IHx8IFtdO1xuXHRcdHZhciBtZWRpYVRodW1ibmFpbCA9IGdyb3VwLm1lZGlhJHRodW1ibmFpbCB8fCBbXTtcblxuXHRcdHZhciBwaWN0dXJlcyA9IG1lZGlhQ29udGVudFxuXHRcdFx0LmNvbmNhdChtZWRpYVRodW1ibmFpbClcblx0XHRcdC5tYXAoZm9ybWF0SW1hZ2UpXG5cdFx0XHQuc29ydChmdW5jdGlvbihhLCBiKSB7XG5cdFx0XHRcdHJldHVybiBhLndpZHRoIC0gYi53aWR0aDtcblx0XHRcdH0pO1xuXG5cdFx0dmFyIGkgPSAwO1xuXHRcdHZhciBfYTtcblx0XHR2YXIgcCA9IHtcblx0XHRcdGlkOiBhLmlkLiR0LFxuXHRcdFx0bmFtZTogYS50aXRsZS4kdCxcblx0XHRcdGRlc2NyaXB0aW9uOiBhLnN1bW1hcnkuJHQsXG5cdFx0XHR1cGRhdGVkX3RpbWU6IGEudXBkYXRlZC4kdCxcblx0XHRcdGNyZWF0ZWRfdGltZTogYS5wdWJsaXNoZWQuJHQsXG5cdFx0XHRwaWN0dXJlOiBwaG90byA/IHBob3RvLnVybCA6IG51bGwsXG5cdFx0XHRwaWN0dXJlczogcGljdHVyZXMsXG5cdFx0XHRpbWFnZXM6IFtdLFxuXHRcdFx0dGh1bWJuYWlsOiBwaG90byA/IHBob3RvLnVybCA6IG51bGwsXG5cdFx0XHR3aWR0aDogcGhvdG8ud2lkdGgsXG5cdFx0XHRoZWlnaHQ6IHBob3RvLmhlaWdodFxuXHRcdH07XG5cblx0XHQvLyBHZXQgZmVlZC9jaGlsZHJlblxuXHRcdGlmICgnbGluaycgaW4gYSkge1xuXHRcdFx0Zm9yIChpID0gMDsgaSA8IGEubGluay5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHR2YXIgZCA9IGEubGlua1tpXTtcblx0XHRcdFx0aWYgKGQucmVsLm1hdGNoKC9cXCNmZWVkJC8pKSB7XG5cdFx0XHRcdFx0cC51cGxvYWRfbG9jYXRpb24gPSBwLmZpbGVzID0gcC5waG90b3MgPSBkLmhyZWY7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBHZXQgaW1hZ2VzIG9mIGRpZmZlcmVudCBzY2FsZXNcblx0XHRpZiAoJ2NhdGVnb3J5JyBpbiBhICYmIGEuY2F0ZWdvcnkubGVuZ3RoKSB7XG5cdFx0XHRfYSA9IGEuY2F0ZWdvcnk7XG5cdFx0XHRmb3IgKGkgPSAwOyBpIDwgX2EubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0aWYgKF9hW2ldLnNjaGVtZSAmJiBfYVtpXS5zY2hlbWUubWF0Y2goL1xcI2tpbmQkLykpIHtcblx0XHRcdFx0XHRwLnR5cGUgPSBfYVtpXS50ZXJtLnJlcGxhY2UoL14uKj9cXCMvLCAnJyk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBHZXQgaW1hZ2VzIG9mIGRpZmZlcmVudCBzY2FsZXNcblx0XHRpZiAoJ21lZGlhJHRodW1ibmFpbCcgaW4gZ3JvdXAgJiYgZ3JvdXAubWVkaWEkdGh1bWJuYWlsLmxlbmd0aCkge1xuXHRcdFx0X2EgPSBncm91cC5tZWRpYSR0aHVtYm5haWw7XG5cdFx0XHRwLnRodW1ibmFpbCA9IF9hWzBdLnVybDtcblx0XHRcdHAuaW1hZ2VzID0gX2EubWFwKGZvcm1hdEltYWdlKTtcblx0XHR9XG5cblx0XHRfYSA9IGdyb3VwLm1lZGlhJGNvbnRlbnQ7XG5cblx0XHRpZiAoX2EgJiYgX2EubGVuZ3RoKSB7XG5cdFx0XHRwLmltYWdlcy5wdXNoKGZvcm1hdEltYWdlKF9hWzBdKSk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHA7XG5cdH1cblxuXHRmdW5jdGlvbiBwYWdpbmcocmVzKSB7XG5cblx0XHQvLyBDb250YWN0cyBWMlxuXHRcdGlmICgnZmVlZCcgaW4gcmVzICYmIHJlcy5mZWVkLm9wZW5TZWFyY2gkaXRlbXNQZXJQYWdlKSB7XG5cdFx0XHR2YXIgbGltaXQgPSB0b0ludChyZXMuZmVlZC5vcGVuU2VhcmNoJGl0ZW1zUGVyUGFnZS4kdCk7XG5cdFx0XHR2YXIgc3RhcnQgPSB0b0ludChyZXMuZmVlZC5vcGVuU2VhcmNoJHN0YXJ0SW5kZXguJHQpO1xuXHRcdFx0dmFyIHRvdGFsID0gdG9JbnQocmVzLmZlZWQub3BlblNlYXJjaCR0b3RhbFJlc3VsdHMuJHQpO1xuXG5cdFx0XHRpZiAoKHN0YXJ0ICsgbGltaXQpIDwgdG90YWwpIHtcblx0XHRcdFx0cmVzLnBhZ2luZyA9IHtcblx0XHRcdFx0XHRuZXh0OiAnP3N0YXJ0PScgKyAoc3RhcnQgKyBsaW1pdClcblx0XHRcdFx0fTtcblx0XHRcdH1cblx0XHR9XG5cdFx0ZWxzZSBpZiAoJ25leHRQYWdlVG9rZW4nIGluIHJlcykge1xuXHRcdFx0cmVzLnBhZ2luZyA9IHtcblx0XHRcdFx0bmV4dDogJz9wYWdlVG9rZW49JyArIHJlcy5uZXh0UGFnZVRva2VuXG5cdFx0XHR9O1xuXHRcdH1cblx0fVxuXG5cdC8vIENvbnN0cnVjdCBhIG11bHRpcGFydCBtZXNzYWdlXG5cdGZ1bmN0aW9uIE11bHRpcGFydCgpIHtcblxuXHRcdC8vIEludGVybmFsIGJvZHlcblx0XHR2YXIgYm9keSA9IFtdO1xuXHRcdHZhciBib3VuZGFyeSA9IChNYXRoLnJhbmRvbSgpICogMWUxMCkudG9TdHJpbmcoMzIpO1xuXHRcdHZhciBjb3VudGVyID0gMDtcblx0XHR2YXIgbGluZUJyZWFrID0gJ1xcclxcbic7XG5cdFx0dmFyIGRlbGltID0gbGluZUJyZWFrICsgJy0tJyArIGJvdW5kYXJ5O1xuXHRcdHZhciByZWFkeSA9IGZ1bmN0aW9uKCkge307XG5cblx0XHR2YXIgZGF0YVVyaSA9IC9eZGF0YVxcOihbXjssXSsoXFw7Y2hhcnNldD1bXjssXSspPykoXFw7YmFzZTY0KT8sL2k7XG5cblx0XHQvLyBBZGQgZmlsZVxuXHRcdGZ1bmN0aW9uIGFkZEZpbGUoaXRlbSkge1xuXHRcdFx0dmFyIGZyID0gbmV3IEZpbGVSZWFkZXIoKTtcblx0XHRcdGZyLm9ubG9hZCA9IGZ1bmN0aW9uKGUpIHtcblx0XHRcdFx0YWRkQ29udGVudChidG9hKGUudGFyZ2V0LnJlc3VsdCksIGl0ZW0udHlwZSArIGxpbmVCcmVhayArICdDb250ZW50LVRyYW5zZmVyLUVuY29kaW5nOiBiYXNlNjQnKTtcblx0XHRcdH07XG5cblx0XHRcdGZyLnJlYWRBc0JpbmFyeVN0cmluZyhpdGVtKTtcblx0XHR9XG5cblx0XHQvLyBBZGQgY29udGVudFxuXHRcdGZ1bmN0aW9uIGFkZENvbnRlbnQoY29udGVudCwgdHlwZSkge1xuXHRcdFx0Ym9keS5wdXNoKGxpbmVCcmVhayArICdDb250ZW50LVR5cGU6ICcgKyB0eXBlICsgbGluZUJyZWFrICsgbGluZUJyZWFrICsgY29udGVudCk7XG5cdFx0XHRjb3VudGVyLS07XG5cdFx0XHRyZWFkeSgpO1xuXHRcdH1cblxuXHRcdC8vIEFkZCBuZXcgdGhpbmdzIHRvIHRoZSBvYmplY3Rcblx0XHR0aGlzLmFwcGVuZCA9IGZ1bmN0aW9uKGNvbnRlbnQsIHR5cGUpIHtcblxuXHRcdFx0Ly8gRG9lcyB0aGUgY29udGVudCBoYXZlIGFuIGFycmF5XG5cdFx0XHRpZiAodHlwZW9mIChjb250ZW50KSA9PT0gJ3N0cmluZycgfHwgISgnbGVuZ3RoJyBpbiBPYmplY3QoY29udGVudCkpKSB7XG5cdFx0XHRcdC8vIENvbnZlcnRpIHRvIG11bHRpcGxlc1xuXHRcdFx0XHRjb250ZW50ID0gW2NvbnRlbnRdO1xuXHRcdFx0fVxuXG5cdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGNvbnRlbnQubGVuZ3RoOyBpKyspIHtcblxuXHRcdFx0XHRjb3VudGVyKys7XG5cblx0XHRcdFx0dmFyIGl0ZW0gPSBjb250ZW50W2ldO1xuXG5cdFx0XHRcdC8vIElzIHRoaXMgYSBmaWxlP1xuXHRcdFx0XHQvLyBGaWxlcyBjYW4gYmUgZWl0aGVyIEJsb2JzIG9yIEZpbGUgdHlwZXNcblx0XHRcdFx0aWYgKFxuXHRcdFx0XHRcdCh0eXBlb2YgKEZpbGUpICE9PSAndW5kZWZpbmVkJyAmJiBpdGVtIGluc3RhbmNlb2YgRmlsZSkgfHxcblx0XHRcdFx0XHQodHlwZW9mIChCbG9iKSAhPT0gJ3VuZGVmaW5lZCcgJiYgaXRlbSBpbnN0YW5jZW9mIEJsb2IpXG5cdFx0XHRcdCkge1xuXHRcdFx0XHRcdC8vIFJlYWQgdGhlIGZpbGUgaW5cblx0XHRcdFx0XHRhZGRGaWxlKGl0ZW0pO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gRGF0YS1VUkk/XG5cdFx0XHRcdC8vIERhdGE6WzxtaW1lIHR5cGU+XVs7Y2hhcnNldD08Y2hhcnNldD5dWztiYXNlNjRdLDxlbmNvZGVkIGRhdGE+XG5cdFx0XHRcdC8vIC9eZGF0YVxcOihbXjssXSsoXFw7Y2hhcnNldD1bXjssXSspPykoXFw7YmFzZTY0KT8sL2lcblx0XHRcdFx0ZWxzZSBpZiAodHlwZW9mIChpdGVtKSA9PT0gJ3N0cmluZycgJiYgaXRlbS5tYXRjaChkYXRhVXJpKSkge1xuXHRcdFx0XHRcdHZhciBtID0gaXRlbS5tYXRjaChkYXRhVXJpKTtcblx0XHRcdFx0XHRhZGRDb250ZW50KGl0ZW0ucmVwbGFjZShkYXRhVXJpLCAnJyksIG1bMV0gKyBsaW5lQnJlYWsgKyAnQ29udGVudC1UcmFuc2Zlci1FbmNvZGluZzogYmFzZTY0Jyk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBSZWd1bGFyIHN0cmluZ1xuXHRcdFx0XHRlbHNlIHtcblx0XHRcdFx0XHRhZGRDb250ZW50KGl0ZW0sIHR5cGUpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fTtcblxuXHRcdHRoaXMub25yZWFkeSA9IGZ1bmN0aW9uKGZuKSB7XG5cdFx0XHRyZWFkeSA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRpZiAoY291bnRlciA9PT0gMCkge1xuXHRcdFx0XHRcdC8vIFRyaWdnZXIgcmVhZHlcblx0XHRcdFx0XHRib2R5LnVuc2hpZnQoJycpO1xuXHRcdFx0XHRcdGJvZHkucHVzaCgnLS0nKTtcblx0XHRcdFx0XHRmbihib2R5LmpvaW4oZGVsaW0pLCBib3VuZGFyeSk7XG5cdFx0XHRcdFx0Ym9keSA9IFtdO1xuXHRcdFx0XHR9XG5cdFx0XHR9O1xuXG5cdFx0XHRyZWFkeSgpO1xuXHRcdH07XG5cdH1cblxuXHQvLyBVcGxvYWQgdG8gRHJpdmVcblx0Ly8gSWYgdGhpcyBpcyBQVVQgdGhlbiBvbmx5IGF1Z21lbnQgdGhlIGZpbGUgdXBsb2FkZWRcblx0Ly8gUFVUIGh0dHBzOi8vZGV2ZWxvcGVycy5nb29nbGUuY29tL2RyaXZlL3YyL3JlZmVyZW5jZS9maWxlcy91cGRhdGVcblx0Ly8gUE9TVCBodHRwczovL2RldmVsb3BlcnMuZ29vZ2xlLmNvbS9kcml2ZS9tYW5hZ2UtdXBsb2Fkc1xuXHRmdW5jdGlvbiB1cGxvYWREcml2ZShwLCBjYWxsYmFjaykge1xuXG5cdFx0dmFyIGRhdGEgPSB7fTtcblxuXHRcdC8vIFRlc3QgZm9yIERPTSBlbGVtZW50XG5cdFx0aWYgKHAuZGF0YSAmJlxuXHRcdFx0KHR5cGVvZiAoSFRNTElucHV0RWxlbWVudCkgIT09ICd1bmRlZmluZWQnICYmIHAuZGF0YSBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpXG5cdFx0KSB7XG5cdFx0XHRwLmRhdGEgPSB7ZmlsZTogcC5kYXRhfTtcblx0XHR9XG5cblx0XHRpZiAoIXAuZGF0YS5uYW1lICYmIE9iamVjdChPYmplY3QocC5kYXRhLmZpbGUpLmZpbGVzKS5sZW5ndGggJiYgcC5tZXRob2QgPT09ICdwb3N0Jykge1xuXHRcdFx0cC5kYXRhLm5hbWUgPSBwLmRhdGEuZmlsZS5maWxlc1swXS5uYW1lO1xuXHRcdH1cblxuXHRcdGlmIChwLm1ldGhvZCA9PT0gJ3Bvc3QnKSB7XG5cdFx0XHRwLmRhdGEgPSB7XG5cdFx0XHRcdHRpdGxlOiBwLmRhdGEubmFtZSxcblx0XHRcdFx0cGFyZW50czogW3tpZDogcC5kYXRhLnBhcmVudCB8fCAncm9vdCd9XSxcblx0XHRcdFx0ZmlsZTogcC5kYXRhLmZpbGVcblx0XHRcdH07XG5cdFx0fVxuXHRcdGVsc2Uge1xuXG5cdFx0XHQvLyBNYWtlIGEgcmVmZXJlbmNlXG5cdFx0XHRkYXRhID0gcC5kYXRhO1xuXHRcdFx0cC5kYXRhID0ge307XG5cblx0XHRcdC8vIEFkZCB0aGUgcGFydHMgdG8gY2hhbmdlIGFzIHJlcXVpcmVkXG5cdFx0XHRpZiAoZGF0YS5wYXJlbnQpIHtcblx0XHRcdFx0cC5kYXRhLnBhcmVudHMgPSBbe2lkOiBwLmRhdGEucGFyZW50IHx8ICdyb290J31dO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAoZGF0YS5maWxlKSB7XG5cdFx0XHRcdHAuZGF0YS5maWxlID0gZGF0YS5maWxlO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAoZGF0YS5uYW1lKSB7XG5cdFx0XHRcdHAuZGF0YS50aXRsZSA9IGRhdGEubmFtZTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBFeHRyYWN0IHRoZSBmaWxlLCBpZiBpdCBleGlzdHMgZnJvbSB0aGUgZGF0YSBvYmplY3Rcblx0XHQvLyBJZiB0aGUgRmlsZSBpcyBhbiBJTlBVVCBlbGVtZW50IGxldHMganVzdCBjb25jZXJuIG91cnNlbHZlcyB3aXRoIHRoZSBOb2RlTGlzdFxuXHRcdHZhciBmaWxlO1xuXHRcdGlmICgnZmlsZScgaW4gcC5kYXRhKSB7XG5cdFx0XHRmaWxlID0gcC5kYXRhLmZpbGU7XG5cdFx0XHRkZWxldGUgcC5kYXRhLmZpbGU7XG5cblx0XHRcdGlmICh0eXBlb2YgKGZpbGUpID09PSAnb2JqZWN0JyAmJiAnZmlsZXMnIGluIGZpbGUpIHtcblx0XHRcdFx0Ly8gQXNzaWduIHRoZSBOb2RlTGlzdFxuXHRcdFx0XHRmaWxlID0gZmlsZS5maWxlcztcblx0XHRcdH1cblxuXHRcdFx0aWYgKCFmaWxlIHx8ICFmaWxlLmxlbmd0aCkge1xuXHRcdFx0XHRjYWxsYmFjayh7XG5cdFx0XHRcdFx0ZXJyb3I6IHtcblx0XHRcdFx0XHRcdGNvZGU6ICdyZXF1ZXN0X2ludmFsaWQnLFxuXHRcdFx0XHRcdFx0bWVzc2FnZTogJ1RoZXJlIHdlcmUgbm8gZmlsZXMgYXR0YWNoZWQgd2l0aCB0aGlzIHJlcXVlc3QgdG8gdXBsb2FkJ1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBTZXQgdHlwZSBwLmRhdGEubWltZVR5cGUgPSBPYmplY3QoZmlsZVswXSkudHlwZSB8fCAnYXBwbGljYXRpb24vb2N0ZXQtc3RyZWFtJztcblxuXHRcdC8vIENvbnN0cnVjdCBhIG11bHRpcGFydCBtZXNzYWdlXG5cdFx0dmFyIHBhcnRzID0gbmV3IE11bHRpcGFydCgpO1xuXHRcdHBhcnRzLmFwcGVuZChKU09OLnN0cmluZ2lmeShwLmRhdGEpLCAnYXBwbGljYXRpb24vanNvbicpO1xuXG5cdFx0Ly8gUmVhZCB0aGUgZmlsZSBpbnRvIGEgIGJhc2U2NCBzdHJpbmcuLi4geWVwIGEgaGFzc2xlLCBpIGtub3dcblx0XHQvLyBGb3JtRGF0YSBkb2Vzbid0IGxldCB1cyBhc3NpZ24gb3VyIG93biBNdWx0aXBhcnQgaGVhZGVycyBhbmQgSFRUUCBDb250ZW50LVR5cGVcblx0XHQvLyBBbGFzIEdvb2dsZUFwaSBuZWVkIHRoZXNlIGluIGEgcGFydGljdWxhciBmb3JtYXRcblx0XHRpZiAoZmlsZSkge1xuXHRcdFx0cGFydHMuYXBwZW5kKGZpbGUpO1xuXHRcdH1cblxuXHRcdHBhcnRzLm9ucmVhZHkoZnVuY3Rpb24oYm9keSwgYm91bmRhcnkpIHtcblxuXHRcdFx0cC5oZWFkZXJzWydjb250ZW50LXR5cGUnXSA9ICdtdWx0aXBhcnQvcmVsYXRlZDsgYm91bmRhcnk9XCInICsgYm91bmRhcnkgKyAnXCInO1xuXHRcdFx0cC5kYXRhID0gYm9keTtcblxuXHRcdFx0Y2FsbGJhY2soJ3VwbG9hZC9kcml2ZS92Mi9maWxlcycgKyAoZGF0YS5pZCA/ICcvJyArIGRhdGEuaWQgOiAnJykgKyAnP3VwbG9hZFR5cGU9bXVsdGlwYXJ0Jyk7XG5cdFx0fSk7XG5cblx0fVxuXG5cdGZ1bmN0aW9uIHRvSlNPTihwKSB7XG5cdFx0aWYgKHR5cGVvZiAocC5kYXRhKSA9PT0gJ29iamVjdCcpIHtcblx0XHRcdC8vIENvbnZlcnQgdGhlIFBPU1QgaW50byBhIGphdmFzY3JpcHQgb2JqZWN0XG5cdFx0XHR0cnkge1xuXHRcdFx0XHRwLmRhdGEgPSBKU09OLnN0cmluZ2lmeShwLmRhdGEpO1xuXHRcdFx0XHRwLmhlYWRlcnNbJ2NvbnRlbnQtdHlwZSddID0gJ2FwcGxpY2F0aW9uL2pzb24nO1xuXHRcdFx0fVxuXHRcdFx0Y2F0Y2ggKGUpIHt9XG5cdFx0fVxuXHR9XG5cbn0pKGhlbGxvKTtcblxuKGZ1bmN0aW9uKGhlbGxvKSB7XG5cblx0aGVsbG8uaW5pdCh7XG5cblx0XHRpbnN0YWdyYW06IHtcblxuXHRcdFx0bmFtZTogJ0luc3RhZ3JhbScsXG5cblx0XHRcdG9hdXRoOiB7XG5cdFx0XHRcdC8vIFNlZTogaHR0cDovL2luc3RhZ3JhbS5jb20vZGV2ZWxvcGVyL2F1dGhlbnRpY2F0aW9uL1xuXHRcdFx0XHR2ZXJzaW9uOiAyLFxuXHRcdFx0XHRhdXRoOiAnaHR0cHM6Ly9pbnN0YWdyYW0uY29tL29hdXRoL2F1dGhvcml6ZS8nLFxuXHRcdFx0XHRncmFudDogJ2h0dHBzOi8vYXBpLmluc3RhZ3JhbS5jb20vb2F1dGgvYWNjZXNzX3Rva2VuJ1xuXHRcdFx0fSxcblxuXHRcdFx0Ly8gUmVmcmVzaCB0aGUgYWNjZXNzX3Rva2VuIG9uY2UgZXhwaXJlZFxuXHRcdFx0cmVmcmVzaDogdHJ1ZSxcblxuXHRcdFx0c2NvcGU6IHtcblx0XHRcdFx0YmFzaWM6ICdiYXNpYycsXG5cdFx0XHRcdHBob3RvczogJycsXG5cdFx0XHRcdGZyaWVuZHM6ICdyZWxhdGlvbnNoaXBzJyxcblx0XHRcdFx0cHVibGlzaDogJ2xpa2VzIGNvbW1lbnRzJyxcblx0XHRcdFx0ZW1haWw6ICcnLFxuXHRcdFx0XHRzaGFyZTogJycsXG5cdFx0XHRcdHB1Ymxpc2hfZmlsZXM6ICcnLFxuXHRcdFx0XHRmaWxlczogJycsXG5cdFx0XHRcdHZpZGVvczogJycsXG5cdFx0XHRcdG9mZmxpbmVfYWNjZXNzOiAnJ1xuXHRcdFx0fSxcblxuXHRcdFx0c2NvcGVfZGVsaW06ICcgJyxcblxuXHRcdFx0YmFzZTogJ2h0dHBzOi8vYXBpLmluc3RhZ3JhbS5jb20vdjEvJyxcblxuXHRcdFx0Z2V0OiB7XG5cdFx0XHRcdG1lOiAndXNlcnMvc2VsZicsXG5cdFx0XHRcdCdtZS9mZWVkJzogJ3VzZXJzL3NlbGYvZmVlZD9jb3VudD1Ae2xpbWl0fDEwMH0nLFxuXHRcdFx0XHQnbWUvcGhvdG9zJzogJ3VzZXJzL3NlbGYvbWVkaWEvcmVjZW50P21pbl9pZD0wJmNvdW50PUB7bGltaXR8MTAwfScsXG5cdFx0XHRcdCdtZS9mcmllbmRzJzogJ3VzZXJzL3NlbGYvZm9sbG93cz9jb3VudD1Ae2xpbWl0fDEwMH0nLFxuXHRcdFx0XHQnbWUvZm9sbG93aW5nJzogJ3VzZXJzL3NlbGYvZm9sbG93cz9jb3VudD1Ae2xpbWl0fDEwMH0nLFxuXHRcdFx0XHQnbWUvZm9sbG93ZXJzJzogJ3VzZXJzL3NlbGYvZm9sbG93ZWQtYnk/Y291bnQ9QHtsaW1pdHwxMDB9Jyxcblx0XHRcdFx0J2ZyaWVuZC9waG90b3MnOiAndXNlcnMvQHtpZH0vbWVkaWEvcmVjZW50P21pbl9pZD0wJmNvdW50PUB7bGltaXR8MTAwfSdcblx0XHRcdH0sXG5cblx0XHRcdHBvc3Q6IHtcblx0XHRcdFx0J21lL2xpa2UnOiBmdW5jdGlvbihwLCBjYWxsYmFjaykge1xuXHRcdFx0XHRcdHZhciBpZCA9IHAuZGF0YS5pZDtcblx0XHRcdFx0XHRwLmRhdGEgPSB7fTtcblx0XHRcdFx0XHRjYWxsYmFjaygnbWVkaWEvJyArIGlkICsgJy9saWtlcycpO1xuXHRcdFx0XHR9XG5cdFx0XHR9LFxuXG5cdFx0XHRkZWw6IHtcblx0XHRcdFx0J21lL2xpa2UnOiAnbWVkaWEvQHtpZH0vbGlrZXMnXG5cdFx0XHR9LFxuXG5cdFx0XHR3cmFwOiB7XG5cdFx0XHRcdG1lOiBmdW5jdGlvbihvKSB7XG5cblx0XHRcdFx0XHRmb3JtYXRFcnJvcihvKTtcblxuXHRcdFx0XHRcdGlmICgnZGF0YScgaW4gbykge1xuXHRcdFx0XHRcdFx0by5pZCA9IG8uZGF0YS5pZDtcblx0XHRcdFx0XHRcdG8udGh1bWJuYWlsID0gby5kYXRhLnByb2ZpbGVfcGljdHVyZTtcblx0XHRcdFx0XHRcdG8ubmFtZSA9IG8uZGF0YS5mdWxsX25hbWUgfHwgby5kYXRhLnVzZXJuYW1lO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHJldHVybiBvO1xuXHRcdFx0XHR9LFxuXG5cdFx0XHRcdCdtZS9mcmllbmRzJzogZm9ybWF0RnJpZW5kcyxcblx0XHRcdFx0J21lL2ZvbGxvd2luZyc6IGZvcm1hdEZyaWVuZHMsXG5cdFx0XHRcdCdtZS9mb2xsb3dlcnMnOiBmb3JtYXRGcmllbmRzLFxuXHRcdFx0XHQnbWUvcGhvdG9zJzogZnVuY3Rpb24obykge1xuXG5cdFx0XHRcdFx0Zm9ybWF0RXJyb3Iobyk7XG5cdFx0XHRcdFx0cGFnaW5nKG8pO1xuXG5cdFx0XHRcdFx0aWYgKCdkYXRhJyBpbiBvKSB7XG5cdFx0XHRcdFx0XHRvLmRhdGEgPSBvLmRhdGEuZmlsdGVyKGZ1bmN0aW9uKGQpIHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIGQudHlwZSA9PT0gJ2ltYWdlJztcblx0XHRcdFx0XHRcdH0pO1xuXG5cdFx0XHRcdFx0XHRvLmRhdGEuZm9yRWFjaChmdW5jdGlvbihkKSB7XG5cdFx0XHRcdFx0XHRcdGQubmFtZSA9IGQuY2FwdGlvbiA/IGQuY2FwdGlvbi50ZXh0IDogbnVsbDtcblx0XHRcdFx0XHRcdFx0ZC50aHVtYm5haWwgPSBkLmltYWdlcy50aHVtYm5haWwudXJsO1xuXHRcdFx0XHRcdFx0XHRkLnBpY3R1cmUgPSBkLmltYWdlcy5zdGFuZGFyZF9yZXNvbHV0aW9uLnVybDtcblx0XHRcdFx0XHRcdFx0ZC5waWN0dXJlcyA9IE9iamVjdC5rZXlzKGQuaW1hZ2VzKVxuXHRcdFx0XHRcdFx0XHRcdC5tYXAoZnVuY3Rpb24oa2V5KSB7XG5cdFx0XHRcdFx0XHRcdFx0XHR2YXIgaW1hZ2UgPSBkLmltYWdlc1trZXldO1xuXHRcdFx0XHRcdFx0XHRcdFx0cmV0dXJuIGZvcm1hdEltYWdlKGltYWdlKTtcblx0XHRcdFx0XHRcdFx0XHR9KVxuXHRcdFx0XHRcdFx0XHRcdC5zb3J0KGZ1bmN0aW9uKGEsIGIpIHtcblx0XHRcdFx0XHRcdFx0XHRcdHJldHVybiBhLndpZHRoIC0gYi53aWR0aDtcblx0XHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHJldHVybiBvO1xuXHRcdFx0XHR9LFxuXG5cdFx0XHRcdCdkZWZhdWx0JzogZnVuY3Rpb24obykge1xuXHRcdFx0XHRcdG8gPSBmb3JtYXRFcnJvcihvKTtcblx0XHRcdFx0XHRwYWdpbmcobyk7XG5cdFx0XHRcdFx0cmV0dXJuIG87XG5cdFx0XHRcdH1cblx0XHRcdH0sXG5cblx0XHRcdC8vIEluc3RhZ3JhbSBkb2VzIG5vdCByZXR1cm4gYW55IENPUlMgSGVhZGVyc1xuXHRcdFx0Ly8gU28gYmVzaWRlcyBKU09OUCB3ZSdyZSBzdHVjayB3aXRoIHByb3h5XG5cdFx0XHR4aHI6IGZ1bmN0aW9uKHAsIHFzKSB7XG5cblx0XHRcdFx0dmFyIG1ldGhvZCA9IHAubWV0aG9kO1xuXHRcdFx0XHR2YXIgcHJveHkgPSBtZXRob2QgIT09ICdnZXQnO1xuXG5cdFx0XHRcdGlmIChwcm94eSkge1xuXG5cdFx0XHRcdFx0aWYgKChtZXRob2QgPT09ICdwb3N0JyB8fCBtZXRob2QgPT09ICdwdXQnKSAmJiBwLnF1ZXJ5LmFjY2Vzc190b2tlbikge1xuXHRcdFx0XHRcdFx0cC5kYXRhLmFjY2Vzc190b2tlbiA9IHAucXVlcnkuYWNjZXNzX3Rva2VuO1xuXHRcdFx0XHRcdFx0ZGVsZXRlIHAucXVlcnkuYWNjZXNzX3Rva2VuO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdC8vIE5vIGFjY2VzcyBjb250cm9sIGhlYWRlcnNcblx0XHRcdFx0XHQvLyBVc2UgdGhlIHByb3h5IGluc3RlYWRcblx0XHRcdFx0XHRwLnByb3h5ID0gcHJveHk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRyZXR1cm4gcHJveHk7XG5cdFx0XHR9LFxuXG5cdFx0XHQvLyBObyBmb3JtXG5cdFx0XHRmb3JtOiBmYWxzZVxuXHRcdH1cblx0fSk7XG5cblx0ZnVuY3Rpb24gZm9ybWF0SW1hZ2UoaW1hZ2UpIHtcblx0XHRyZXR1cm4ge1xuXHRcdFx0c291cmNlOiBpbWFnZS51cmwsXG5cdFx0XHR3aWR0aDogaW1hZ2Uud2lkdGgsXG5cdFx0XHRoZWlnaHQ6IGltYWdlLmhlaWdodFxuXHRcdH07XG5cdH1cblxuXHRmdW5jdGlvbiBmb3JtYXRFcnJvcihvKSB7XG5cdFx0aWYgKHR5cGVvZiBvID09PSAnc3RyaW5nJykge1xuXHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0ZXJyb3I6IHtcblx0XHRcdFx0XHRjb2RlOiAnaW52YWxpZF9yZXF1ZXN0Jyxcblx0XHRcdFx0XHRtZXNzYWdlOiBvXG5cdFx0XHRcdH1cblx0XHRcdH07XG5cdFx0fVxuXG5cdFx0aWYgKG8gJiYgJ21ldGEnIGluIG8gJiYgJ2Vycm9yX3R5cGUnIGluIG8ubWV0YSkge1xuXHRcdFx0by5lcnJvciA9IHtcblx0XHRcdFx0Y29kZTogby5tZXRhLmVycm9yX3R5cGUsXG5cdFx0XHRcdG1lc3NhZ2U6IG8ubWV0YS5lcnJvcl9tZXNzYWdlXG5cdFx0XHR9O1xuXHRcdH1cblxuXHRcdHJldHVybiBvO1xuXHR9XG5cblx0ZnVuY3Rpb24gZm9ybWF0RnJpZW5kcyhvKSB7XG5cdFx0cGFnaW5nKG8pO1xuXHRcdGlmIChvICYmICdkYXRhJyBpbiBvKSB7XG5cdFx0XHRvLmRhdGEuZm9yRWFjaChmb3JtYXRGcmllbmQpO1xuXHRcdH1cblxuXHRcdHJldHVybiBvO1xuXHR9XG5cblx0ZnVuY3Rpb24gZm9ybWF0RnJpZW5kKG8pIHtcblx0XHRpZiAoby5pZCkge1xuXHRcdFx0by50aHVtYm5haWwgPSBvLnByb2ZpbGVfcGljdHVyZTtcblx0XHRcdG8ubmFtZSA9IG8uZnVsbF9uYW1lIHx8IG8udXNlcm5hbWU7XG5cdFx0fVxuXHR9XG5cblx0Ly8gU2VlOiBodHRwOi8vaW5zdGFncmFtLmNvbS9kZXZlbG9wZXIvZW5kcG9pbnRzL1xuXHRmdW5jdGlvbiBwYWdpbmcocmVzKSB7XG5cdFx0aWYgKCdwYWdpbmF0aW9uJyBpbiByZXMpIHtcblx0XHRcdHJlcy5wYWdpbmcgPSB7XG5cdFx0XHRcdG5leHQ6IHJlcy5wYWdpbmF0aW9uLm5leHRfdXJsXG5cdFx0XHR9O1xuXHRcdFx0ZGVsZXRlIHJlcy5wYWdpbmF0aW9uO1xuXHRcdH1cblx0fVxuXG59KShoZWxsbyk7XG5cbihmdW5jdGlvbihoZWxsbykge1xuXG5cdGhlbGxvLmluaXQoe1xuXG5cdFx0am9pbm1lOiB7XG5cblx0XHRcdG5hbWU6ICdqb2luLm1lJyxcblxuXHRcdFx0b2F1dGg6IHtcblx0XHRcdFx0dmVyc2lvbjogMixcblx0XHRcdFx0YXV0aDogJ2h0dHBzOi8vc2VjdXJlLmpvaW4ubWUvYXBpL3B1YmxpYy92MS9hdXRoL29hdXRoMicsXG5cdFx0XHRcdGdyYW50OiAnaHR0cHM6Ly9zZWN1cmUuam9pbi5tZS9hcGkvcHVibGljL3YxL2F1dGgvb2F1dGgyJ1xuXHRcdFx0fSxcblxuXHRcdFx0cmVmcmVzaDogZmFsc2UsXG5cblx0XHRcdHNjb3BlOiB7XG5cdFx0XHRcdGJhc2ljOiAndXNlcl9pbmZvJyxcblx0XHRcdFx0dXNlcjogJ3VzZXJfaW5mbycsXG5cdFx0XHRcdHNjaGVkdWxlcjogJ3NjaGVkdWxlcicsXG5cdFx0XHRcdHN0YXJ0OiAnc3RhcnRfbWVldGluZycsXG5cdFx0XHRcdGVtYWlsOiAnJyxcblx0XHRcdFx0ZnJpZW5kczogJycsXG5cdFx0XHRcdHNoYXJlOiAnJyxcblx0XHRcdFx0cHVibGlzaDogJycsXG5cdFx0XHRcdHBob3RvczogJycsXG5cdFx0XHRcdHB1Ymxpc2hfZmlsZXM6ICcnLFxuXHRcdFx0XHRmaWxlczogJycsXG5cdFx0XHRcdHZpZGVvczogJycsXG5cdFx0XHRcdG9mZmxpbmVfYWNjZXNzOiAnJ1xuXHRcdFx0fSxcblxuXHRcdFx0c2NvcGVfZGVsaW06ICcgJyxcblxuXHRcdFx0bG9naW46IGZ1bmN0aW9uKHApIHtcblx0XHRcdFx0cC5vcHRpb25zLnBvcHVwLndpZHRoID0gNDAwO1xuXHRcdFx0XHRwLm9wdGlvbnMucG9wdXAuaGVpZ2h0ID0gNzAwO1xuXHRcdFx0fSxcblxuXHRcdFx0YmFzZTogJ2h0dHBzOi8vYXBpLmpvaW4ubWUvdjEvJyxcblxuXHRcdFx0Z2V0OiB7XG5cdFx0XHRcdG1lOiAndXNlcicsXG5cdFx0XHRcdG1lZXRpbmdzOiAnbWVldGluZ3MnLFxuXHRcdFx0XHQnbWVldGluZ3MvaW5mbyc6ICdtZWV0aW5ncy9Ae2lkfSdcblx0XHRcdH0sXG5cblx0XHRcdHBvc3Q6IHtcblx0XHRcdFx0J21lZXRpbmdzL3N0YXJ0L2FkaG9jJzogZnVuY3Rpb24ocCwgY2FsbGJhY2spIHtcblx0XHRcdFx0XHRjYWxsYmFjaygnbWVldGluZ3Mvc3RhcnQnKTtcblx0XHRcdFx0fSxcblxuXHRcdFx0XHQnbWVldGluZ3Mvc3RhcnQvc2NoZWR1bGVkJzogZnVuY3Rpb24ocCwgY2FsbGJhY2spIHtcblx0XHRcdFx0XHR2YXIgbWVldGluZ0lkID0gcC5kYXRhLm1lZXRpbmdJZDtcblx0XHRcdFx0XHRwLmRhdGEgPSB7fTtcblx0XHRcdFx0XHRjYWxsYmFjaygnbWVldGluZ3MvJyArIG1lZXRpbmdJZCArICcvc3RhcnQnKTtcblx0XHRcdFx0fSxcblxuXHRcdFx0XHQnbWVldGluZ3Mvc2NoZWR1bGUnOiBmdW5jdGlvbihwLCBjYWxsYmFjaykge1xuXHRcdFx0XHRcdGNhbGxiYWNrKCdtZWV0aW5ncycpO1xuXHRcdFx0XHR9XG5cdFx0XHR9LFxuXG5cdFx0XHRwYXRjaDoge1xuXHRcdFx0XHQnbWVldGluZ3MvdXBkYXRlJzogZnVuY3Rpb24ocCwgY2FsbGJhY2spIHtcblx0XHRcdFx0XHRjYWxsYmFjaygnbWVldGluZ3MvJyArIHAuZGF0YS5tZWV0aW5nSWQpO1xuXHRcdFx0XHR9XG5cdFx0XHR9LFxuXG5cdFx0XHRkZWw6IHtcblx0XHRcdFx0J21lZXRpbmdzL2RlbGV0ZSc6ICdtZWV0aW5ncy9Ae2lkfSdcblx0XHRcdH0sXG5cblx0XHRcdHdyYXA6IHtcblx0XHRcdFx0bWU6IGZ1bmN0aW9uKG8sIGhlYWRlcnMpIHtcblx0XHRcdFx0XHRmb3JtYXRFcnJvcihvLCBoZWFkZXJzKTtcblxuXHRcdFx0XHRcdGlmICghby5lbWFpbCkge1xuXHRcdFx0XHRcdFx0cmV0dXJuIG87XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0by5uYW1lID0gby5mdWxsTmFtZTtcblx0XHRcdFx0XHRvLmZpcnN0X25hbWUgPSBvLm5hbWUuc3BsaXQoJyAnKVswXTtcblx0XHRcdFx0XHRvLmxhc3RfbmFtZSA9IG8ubmFtZS5zcGxpdCgnICcpWzFdO1xuXHRcdFx0XHRcdG8uaWQgPSBvLmVtYWlsO1xuXG5cdFx0XHRcdFx0cmV0dXJuIG87XG5cdFx0XHRcdH0sXG5cblx0XHRcdFx0J2RlZmF1bHQnOiBmdW5jdGlvbihvLCBoZWFkZXJzKSB7XG5cdFx0XHRcdFx0Zm9ybWF0RXJyb3IobywgaGVhZGVycyk7XG5cblx0XHRcdFx0XHRyZXR1cm4gbztcblx0XHRcdFx0fVxuXHRcdFx0fSxcblxuXHRcdFx0eGhyOiBmb3JtYXRSZXF1ZXN0XG5cblx0XHR9XG5cdH0pO1xuXG5cdGZ1bmN0aW9uIGZvcm1hdEVycm9yKG8sIGhlYWRlcnMpIHtcblx0XHR2YXIgZXJyb3JDb2RlO1xuXHRcdHZhciBtZXNzYWdlO1xuXHRcdHZhciBkZXRhaWxzO1xuXG5cdFx0aWYgKG8gJiYgKCdNZXNzYWdlJyBpbiBvKSkge1xuXHRcdFx0bWVzc2FnZSA9IG8uTWVzc2FnZTtcblx0XHRcdGRlbGV0ZSBvLk1lc3NhZ2U7XG5cblx0XHRcdGlmICgnRXJyb3JDb2RlJyBpbiBvKSB7XG5cdFx0XHRcdGVycm9yQ29kZSA9IG8uRXJyb3JDb2RlO1xuXHRcdFx0XHRkZWxldGUgby5FcnJvckNvZGU7XG5cdFx0XHR9XG5cdFx0XHRlbHNlIHtcblx0XHRcdFx0ZXJyb3JDb2RlID0gZ2V0RXJyb3JDb2RlKGhlYWRlcnMpO1xuXHRcdFx0fVxuXG5cdFx0XHRvLmVycm9yID0ge1xuXHRcdFx0XHRjb2RlOiBlcnJvckNvZGUsXG5cdFx0XHRcdG1lc3NhZ2U6IG1lc3NhZ2UsXG5cdFx0XHRcdGRldGFpbHM6IG9cblx0XHRcdH07XG5cdFx0fVxuXG5cdFx0cmV0dXJuIG87XG5cdH1cblxuXHRmdW5jdGlvbiBmb3JtYXRSZXF1ZXN0KHAsIHFzKSB7XG5cdFx0Ly8gTW92ZSB0aGUgYWNjZXNzIHRva2VuIGZyb20gdGhlIHJlcXVlc3QgYm9keSB0byB0aGUgcmVxdWVzdCBoZWFkZXJcblx0XHR2YXIgdG9rZW4gPSBxcy5hY2Nlc3NfdG9rZW47XG5cdFx0ZGVsZXRlIHFzLmFjY2Vzc190b2tlbjtcblx0XHRwLmhlYWRlcnMuQXV0aG9yaXphdGlvbiA9ICdCZWFyZXIgJyArIHRva2VuO1xuXG5cdFx0Ly8gRm9ybWF0IG5vbi1nZXQgcmVxdWVzdHMgdG8gaW5kaWNhdGUganNvbiBib2R5XG5cdFx0aWYgKHAubWV0aG9kICE9PSAnZ2V0JyAmJiBwLmRhdGEpIHtcblx0XHRcdHAuaGVhZGVyc1snQ29udGVudC1UeXBlJ10gPSAnYXBwbGljYXRpb24vanNvbic7XG5cdFx0XHRpZiAodHlwZW9mIChwLmRhdGEpID09PSAnb2JqZWN0Jykge1xuXHRcdFx0XHRwLmRhdGEgPSBKU09OLnN0cmluZ2lmeShwLmRhdGEpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGlmIChwLm1ldGhvZCA9PT0gJ3B1dCcpIHtcblx0XHRcdHAubWV0aG9kID0gJ3BhdGNoJztcblx0XHR9XG5cblx0XHRyZXR1cm4gdHJ1ZTtcblx0fVxuXG5cdGZ1bmN0aW9uIGdldEVycm9yQ29kZShoZWFkZXJzKSB7XG5cdFx0c3dpdGNoIChoZWFkZXJzLnN0YXR1c0NvZGUpIHtcblx0XHRcdGNhc2UgNDAwOlxuXHRcdFx0XHRyZXR1cm4gJ2ludmFsaWRfcmVxdWVzdCc7XG5cdFx0XHRjYXNlIDQwMzpcblx0XHRcdFx0cmV0dXJuICdzdGFsZV90b2tlbic7XG5cdFx0XHRjYXNlIDQwMTpcblx0XHRcdFx0cmV0dXJuICdpbnZhbGlkX3Rva2VuJztcblx0XHRcdGNhc2UgNTAwOlxuXHRcdFx0XHRyZXR1cm4gJ3NlcnZlcl9lcnJvcic7XG5cdFx0XHRkZWZhdWx0OlxuXHRcdFx0XHRyZXR1cm4gJ3NlcnZlcl9lcnJvcic7XG5cdFx0fVxuXHR9XG5cbn0oaGVsbG8pKTtcblxuKGZ1bmN0aW9uKGhlbGxvKSB7XG5cblx0aGVsbG8uaW5pdCh7XG5cblx0XHRsaW5rZWRpbjoge1xuXG5cdFx0XHRvYXV0aDoge1xuXHRcdFx0XHR2ZXJzaW9uOiAyLFxuXHRcdFx0XHRyZXNwb25zZV90eXBlOiAnY29kZScsXG5cdFx0XHRcdGF1dGg6ICdodHRwczovL3d3dy5saW5rZWRpbi5jb20vdWFzL29hdXRoMi9hdXRob3JpemF0aW9uJyxcblx0XHRcdFx0Z3JhbnQ6ICdodHRwczovL3d3dy5saW5rZWRpbi5jb20vdWFzL29hdXRoMi9hY2Nlc3NUb2tlbidcblx0XHRcdH0sXG5cblx0XHRcdC8vIFJlZnJlc2ggdGhlIGFjY2Vzc190b2tlbiBvbmNlIGV4cGlyZWRcblx0XHRcdHJlZnJlc2g6IHRydWUsXG5cblx0XHRcdHNjb3BlOiB7XG5cdFx0XHRcdGJhc2ljOiAncl9iYXNpY3Byb2ZpbGUnLFxuXHRcdFx0XHRlbWFpbDogJ3JfZW1haWxhZGRyZXNzJyxcblx0XHRcdFx0ZmlsZXM6ICcnLFxuXHRcdFx0XHRmcmllbmRzOiAnJyxcblx0XHRcdFx0cGhvdG9zOiAnJyxcblx0XHRcdFx0cHVibGlzaDogJ3dfc2hhcmUnLFxuXHRcdFx0XHRwdWJsaXNoX2ZpbGVzOiAnd19zaGFyZScsXG5cdFx0XHRcdHNoYXJlOiAnJyxcblx0XHRcdFx0dmlkZW9zOiAnJyxcblx0XHRcdFx0b2ZmbGluZV9hY2Nlc3M6ICcnXG5cdFx0XHR9LFxuXHRcdFx0c2NvcGVfZGVsaW06ICcgJyxcblxuXHRcdFx0YmFzZTogJ2h0dHBzOi8vYXBpLmxpbmtlZGluLmNvbS92MS8nLFxuXG5cdFx0XHRnZXQ6IHtcblx0XHRcdFx0bWU6ICdwZW9wbGUvfjoocGljdHVyZS11cmwsZmlyc3QtbmFtZSxsYXN0LW5hbWUsaWQsZm9ybWF0dGVkLW5hbWUsZW1haWwtYWRkcmVzcyknLFxuXG5cdFx0XHRcdC8vIFNlZTogaHR0cDovL2RldmVsb3Blci5saW5rZWRpbi5jb20vZG9jdW1lbnRzL2dldC1uZXR3b3JrLXVwZGF0ZXMtYW5kLXN0YXRpc3RpY3MtYXBpXG5cdFx0XHRcdCdtZS9zaGFyZSc6ICdwZW9wbGUvfi9uZXR3b3JrL3VwZGF0ZXM/Y291bnQ9QHtsaW1pdHwyNTB9J1xuXHRcdFx0fSxcblxuXHRcdFx0cG9zdDoge1xuXG5cdFx0XHRcdC8vIFNlZTogaHR0cHM6Ly9kZXZlbG9wZXIubGlua2VkaW4uY29tL2RvY3VtZW50cy9hcGktcmVxdWVzdHMtanNvblxuXHRcdFx0XHQnbWUvc2hhcmUnOiBmdW5jdGlvbihwLCBjYWxsYmFjaykge1xuXHRcdFx0XHRcdHZhciBkYXRhID0ge1xuXHRcdFx0XHRcdFx0dmlzaWJpbGl0eToge1xuXHRcdFx0XHRcdFx0XHRjb2RlOiAnYW55b25lJ1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHRpZiAocC5kYXRhLmlkKSB7XG5cblx0XHRcdFx0XHRcdGRhdGEuYXR0cmlidXRpb24gPSB7XG5cdFx0XHRcdFx0XHRcdHNoYXJlOiB7XG5cdFx0XHRcdFx0XHRcdFx0aWQ6IHAuZGF0YS5pZFxuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGVsc2Uge1xuXHRcdFx0XHRcdFx0ZGF0YS5jb21tZW50ID0gcC5kYXRhLm1lc3NhZ2U7XG5cdFx0XHRcdFx0XHRpZiAocC5kYXRhLnBpY3R1cmUgJiYgcC5kYXRhLmxpbmspIHtcblx0XHRcdFx0XHRcdFx0ZGF0YS5jb250ZW50ID0ge1xuXHRcdFx0XHRcdFx0XHRcdCdzdWJtaXR0ZWQtdXJsJzogcC5kYXRhLmxpbmssXG5cdFx0XHRcdFx0XHRcdFx0J3N1Ym1pdHRlZC1pbWFnZS11cmwnOiBwLmRhdGEucGljdHVyZVxuXHRcdFx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHAuZGF0YSA9IEpTT04uc3RyaW5naWZ5KGRhdGEpO1xuXG5cdFx0XHRcdFx0Y2FsbGJhY2soJ3Blb3BsZS9+L3NoYXJlcz9mb3JtYXQ9anNvbicpO1xuXHRcdFx0XHR9LFxuXG5cdFx0XHRcdCdtZS9saWtlJzogbGlrZVxuXHRcdFx0fSxcblxuXHRcdFx0ZGVsOntcblx0XHRcdFx0J21lL2xpa2UnOiBsaWtlXG5cdFx0XHR9LFxuXG5cdFx0XHR3cmFwOiB7XG5cdFx0XHRcdG1lOiBmdW5jdGlvbihvKSB7XG5cdFx0XHRcdFx0Zm9ybWF0RXJyb3Iobyk7XG5cdFx0XHRcdFx0Zm9ybWF0VXNlcihvKTtcblx0XHRcdFx0XHRyZXR1cm4gbztcblx0XHRcdFx0fSxcblxuXHRcdFx0XHQnbWUvZnJpZW5kcyc6IGZvcm1hdEZyaWVuZHMsXG5cdFx0XHRcdCdtZS9mb2xsb3dpbmcnOiBmb3JtYXRGcmllbmRzLFxuXHRcdFx0XHQnbWUvZm9sbG93ZXJzJzogZm9ybWF0RnJpZW5kcyxcblx0XHRcdFx0J21lL3NoYXJlJzogZnVuY3Rpb24obykge1xuXHRcdFx0XHRcdGZvcm1hdEVycm9yKG8pO1xuXHRcdFx0XHRcdHBhZ2luZyhvKTtcblx0XHRcdFx0XHRpZiAoby52YWx1ZXMpIHtcblx0XHRcdFx0XHRcdG8uZGF0YSA9IG8udmFsdWVzLm1hcChmb3JtYXRVc2VyKTtcblx0XHRcdFx0XHRcdG8uZGF0YS5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcblx0XHRcdFx0XHRcdFx0aXRlbS5tZXNzYWdlID0gaXRlbS5oZWFkbGluZTtcblx0XHRcdFx0XHRcdH0pO1xuXG5cdFx0XHRcdFx0XHRkZWxldGUgby52YWx1ZXM7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0cmV0dXJuIG87XG5cdFx0XHRcdH0sXG5cblx0XHRcdFx0J2RlZmF1bHQnOiBmdW5jdGlvbihvLCBoZWFkZXJzKSB7XG5cdFx0XHRcdFx0Zm9ybWF0RXJyb3Iobyk7XG5cdFx0XHRcdFx0ZW1wdHkobywgaGVhZGVycyk7XG5cdFx0XHRcdFx0cGFnaW5nKG8pO1xuXHRcdFx0XHR9XG5cdFx0XHR9LFxuXG5cdFx0XHRqc29ucDogZnVuY3Rpb24ocCwgcXMpIHtcblx0XHRcdFx0Zm9ybWF0UXVlcnkocXMpO1xuXHRcdFx0XHRpZiAocC5tZXRob2QgPT09ICdnZXQnKSB7XG5cdFx0XHRcdFx0cXMuZm9ybWF0ID0gJ2pzb25wJztcblx0XHRcdFx0XHRxc1snZXJyb3ItY2FsbGJhY2snXSA9IHAuY2FsbGJhY2tJRDtcblx0XHRcdFx0fVxuXHRcdFx0fSxcblxuXHRcdFx0eGhyOiBmdW5jdGlvbihwLCBxcykge1xuXHRcdFx0XHRpZiAocC5tZXRob2QgIT09ICdnZXQnKSB7XG5cdFx0XHRcdFx0Zm9ybWF0UXVlcnkocXMpO1xuXHRcdFx0XHRcdHAuaGVhZGVyc1snQ29udGVudC1UeXBlJ10gPSAnYXBwbGljYXRpb24vanNvbic7XG5cblx0XHRcdFx0XHQvLyBOb3RlOiB4LWxpLWZvcm1hdCBlbnN1cmVzIGVycm9yIHJlc3BvbnNlcyBhcmUgbm90IHJldHVybmVkIGluIFhNTFxuXHRcdFx0XHRcdHAuaGVhZGVyc1sneC1saS1mb3JtYXQnXSA9ICdqc29uJztcblx0XHRcdFx0XHRwLnByb3h5ID0gdHJ1ZTtcblx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdH1cblx0XHR9XG5cdH0pO1xuXG5cdGZ1bmN0aW9uIGZvcm1hdEVycm9yKG8pIHtcblx0XHRpZiAobyAmJiAnZXJyb3JDb2RlJyBpbiBvKSB7XG5cdFx0XHRvLmVycm9yID0ge1xuXHRcdFx0XHRjb2RlOiBvLnN0YXR1cyxcblx0XHRcdFx0bWVzc2FnZTogby5tZXNzYWdlXG5cdFx0XHR9O1xuXHRcdH1cblx0fVxuXG5cdGZ1bmN0aW9uIGZvcm1hdFVzZXIobykge1xuXHRcdGlmIChvLmVycm9yKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0by5maXJzdF9uYW1lID0gby5maXJzdE5hbWU7XG5cdFx0by5sYXN0X25hbWUgPSBvLmxhc3ROYW1lO1xuXHRcdG8ubmFtZSA9IG8uZm9ybWF0dGVkTmFtZSB8fCAoby5maXJzdF9uYW1lICsgJyAnICsgby5sYXN0X25hbWUpO1xuXHRcdG8udGh1bWJuYWlsID0gby5waWN0dXJlVXJsO1xuXHRcdG8uZW1haWwgPSBvLmVtYWlsQWRkcmVzcztcblx0XHRyZXR1cm4gbztcblx0fVxuXG5cdGZ1bmN0aW9uIGZvcm1hdEZyaWVuZHMobykge1xuXHRcdGZvcm1hdEVycm9yKG8pO1xuXHRcdHBhZ2luZyhvKTtcblx0XHRpZiAoby52YWx1ZXMpIHtcblx0XHRcdG8uZGF0YSA9IG8udmFsdWVzLm1hcChmb3JtYXRVc2VyKTtcblx0XHRcdGRlbGV0ZSBvLnZhbHVlcztcblx0XHR9XG5cblx0XHRyZXR1cm4gbztcblx0fVxuXG5cdGZ1bmN0aW9uIHBhZ2luZyhyZXMpIHtcblx0XHRpZiAoJ19jb3VudCcgaW4gcmVzICYmICdfc3RhcnQnIGluIHJlcyAmJiAocmVzLl9jb3VudCArIHJlcy5fc3RhcnQpIDwgcmVzLl90b3RhbCkge1xuXHRcdFx0cmVzLnBhZ2luZyA9IHtcblx0XHRcdFx0bmV4dDogJz9zdGFydD0nICsgKHJlcy5fc3RhcnQgKyByZXMuX2NvdW50KSArICcmY291bnQ9JyArIHJlcy5fY291bnRcblx0XHRcdH07XG5cdFx0fVxuXHR9XG5cblx0ZnVuY3Rpb24gZW1wdHkobywgaGVhZGVycykge1xuXHRcdGlmIChKU09OLnN0cmluZ2lmeShvKSA9PT0gJ3t9JyAmJiBoZWFkZXJzLnN0YXR1c0NvZGUgPT09IDIwMCkge1xuXHRcdFx0by5zdWNjZXNzID0gdHJ1ZTtcblx0XHR9XG5cdH1cblxuXHRmdW5jdGlvbiBmb3JtYXRRdWVyeShxcykge1xuXHRcdC8vIExpbmtlZEluIHNpZ25zIHJlcXVlc3RzIHdpdGggdGhlIHBhcmFtZXRlciAnb2F1dGgyX2FjY2Vzc190b2tlbidcblx0XHQvLyAuLi4geWVhaCBhbm90aGVyIG9uZSB3aG8gdGhpbmtzIHRoZXkgc2hvdWxkIGJlIGRpZmZlcmVudCFcblx0XHRpZiAocXMuYWNjZXNzX3Rva2VuKSB7XG5cdFx0XHRxcy5vYXV0aDJfYWNjZXNzX3Rva2VuID0gcXMuYWNjZXNzX3Rva2VuO1xuXHRcdFx0ZGVsZXRlIHFzLmFjY2Vzc190b2tlbjtcblx0XHR9XG5cdH1cblxuXHRmdW5jdGlvbiBsaWtlKHAsIGNhbGxiYWNrKSB7XG5cdFx0cC5oZWFkZXJzWyd4LWxpLWZvcm1hdCddID0gJ2pzb24nO1xuXHRcdHZhciBpZCA9IHAuZGF0YS5pZDtcblx0XHRwLmRhdGEgPSAocC5tZXRob2QgIT09ICdkZWxldGUnKS50b1N0cmluZygpO1xuXHRcdHAubWV0aG9kID0gJ3B1dCc7XG5cdFx0Y2FsbGJhY2soJ3Blb3BsZS9+L25ldHdvcmsvdXBkYXRlcy9rZXk9JyArIGlkICsgJy9pcy1saWtlZCcpO1xuXHR9XG5cbn0pKGhlbGxvKTtcblxuLy8gU2VlOiBodHRwczovL2RldmVsb3BlcnMuc291bmRjbG91ZC5jb20vZG9jcy9hcGkvcmVmZXJlbmNlXG4oZnVuY3Rpb24oaGVsbG8pIHtcblxuXHRoZWxsby5pbml0KHtcblxuXHRcdHNvdW5kY2xvdWQ6IHtcblx0XHRcdG5hbWU6ICdTb3VuZENsb3VkJyxcblxuXHRcdFx0b2F1dGg6IHtcblx0XHRcdFx0dmVyc2lvbjogMixcblx0XHRcdFx0YXV0aDogJ2h0dHBzOi8vc291bmRjbG91ZC5jb20vY29ubmVjdCcsXG5cdFx0XHRcdGdyYW50OiAnaHR0cHM6Ly9zb3VuZGNsb3VkLmNvbS9vYXV0aDIvdG9rZW4nXG5cdFx0XHR9LFxuXG5cdFx0XHQvLyBSZXF1ZXN0IHBhdGggdHJhbnNsYXRlZFxuXHRcdFx0YmFzZTogJ2h0dHBzOi8vYXBpLnNvdW5kY2xvdWQuY29tLycsXG5cdFx0XHRnZXQ6IHtcblx0XHRcdFx0bWU6ICdtZS5qc29uJyxcblxuXHRcdFx0XHQvLyBIdHRwOi8vZGV2ZWxvcGVycy5zb3VuZGNsb3VkLmNvbS9kb2NzL2FwaS9yZWZlcmVuY2UjbWVcblx0XHRcdFx0J21lL2ZyaWVuZHMnOiAnbWUvZm9sbG93aW5ncy5qc29uJyxcblx0XHRcdFx0J21lL2ZvbGxvd2Vycyc6ICdtZS9mb2xsb3dlcnMuanNvbicsXG5cdFx0XHRcdCdtZS9mb2xsb3dpbmcnOiAnbWUvZm9sbG93aW5ncy5qc29uJyxcblxuXHRcdFx0XHQvLyBTZWU6IGh0dHA6Ly9kZXZlbG9wZXJzLnNvdW5kY2xvdWQuY29tL2RvY3MvYXBpL3JlZmVyZW5jZSNhY3Rpdml0aWVzXG5cdFx0XHRcdCdkZWZhdWx0JzogZnVuY3Rpb24ocCwgY2FsbGJhY2spIHtcblxuXHRcdFx0XHRcdC8vIEluY2x1ZGUgJy5qc29uIGF0IHRoZSBlbmQgb2YgZWFjaCByZXF1ZXN0J1xuXHRcdFx0XHRcdGNhbGxiYWNrKHAucGF0aCArICcuanNvbicpO1xuXHRcdFx0XHR9XG5cdFx0XHR9LFxuXG5cdFx0XHQvLyBSZXNwb25zZSBoYW5kbGVyc1xuXHRcdFx0d3JhcDoge1xuXHRcdFx0XHRtZTogZnVuY3Rpb24obykge1xuXHRcdFx0XHRcdGZvcm1hdFVzZXIobyk7XG5cdFx0XHRcdFx0cmV0dXJuIG87XG5cdFx0XHRcdH0sXG5cblx0XHRcdFx0J2RlZmF1bHQnOiBmdW5jdGlvbihvKSB7XG5cdFx0XHRcdFx0aWYgKEFycmF5LmlzQXJyYXkobykpIHtcblx0XHRcdFx0XHRcdG8gPSB7XG5cdFx0XHRcdFx0XHRcdGRhdGE6IG8ubWFwKGZvcm1hdFVzZXIpXG5cdFx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHBhZ2luZyhvKTtcblx0XHRcdFx0XHRyZXR1cm4gbztcblx0XHRcdFx0fVxuXHRcdFx0fSxcblxuXHRcdFx0eGhyOiBmb3JtYXRSZXF1ZXN0LFxuXHRcdFx0anNvbnA6IGZvcm1hdFJlcXVlc3Rcblx0XHR9XG5cdH0pO1xuXG5cdGZ1bmN0aW9uIGZvcm1hdFJlcXVlc3QocCwgcXMpIHtcblx0XHQvLyBBbHRlciB0aGUgcXVlcnlzdHJpbmdcblx0XHR2YXIgdG9rZW4gPSBxcy5hY2Nlc3NfdG9rZW47XG5cdFx0ZGVsZXRlIHFzLmFjY2Vzc190b2tlbjtcblx0XHRxcy5vYXV0aF90b2tlbiA9IHRva2VuO1xuXHRcdHFzWydfc3RhdHVzX2NvZGVfbWFwWzMwMl0nXSA9IDIwMDtcblx0XHRyZXR1cm4gdHJ1ZTtcblx0fVxuXG5cdGZ1bmN0aW9uIGZvcm1hdFVzZXIobykge1xuXHRcdGlmIChvLmlkKSB7XG5cdFx0XHRvLnBpY3R1cmUgPSBvLmF2YXRhcl91cmw7XG5cdFx0XHRvLnRodW1ibmFpbCA9IG8uYXZhdGFyX3VybDtcblx0XHRcdG8ubmFtZSA9IG8udXNlcm5hbWUgfHwgby5mdWxsX25hbWU7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIG87XG5cdH1cblxuXHQvLyBTZWU6IGh0dHA6Ly9kZXZlbG9wZXJzLnNvdW5kY2xvdWQuY29tL2RvY3MvYXBpL3JlZmVyZW5jZSNhY3Rpdml0aWVzXG5cdGZ1bmN0aW9uIHBhZ2luZyhyZXMpIHtcblx0XHRpZiAoJ25leHRfaHJlZicgaW4gcmVzKSB7XG5cdFx0XHRyZXMucGFnaW5nID0ge1xuXHRcdFx0XHRuZXh0OiByZXMubmV4dF9ocmVmXG5cdFx0XHR9O1xuXHRcdH1cblx0fVxuXG59KShoZWxsbyk7XG5cbihmdW5jdGlvbihoZWxsbykge1xuXG5cdHZhciBiYXNlID0gJ2h0dHBzOi8vYXBpLnR3aXR0ZXIuY29tLyc7XG5cblx0aGVsbG8uaW5pdCh7XG5cblx0XHR0d2l0dGVyOiB7XG5cblx0XHRcdC8vIEVuc3VyZSB0aGF0IHlvdSBkZWZpbmUgYW4gb2F1dGhfcHJveHlcblx0XHRcdG9hdXRoOiB7XG5cdFx0XHRcdHZlcnNpb246ICcxLjBhJyxcblx0XHRcdFx0YXV0aDogYmFzZSArICdvYXV0aC9hdXRoZW50aWNhdGUnLFxuXHRcdFx0XHRyZXF1ZXN0OiBiYXNlICsgJ29hdXRoL3JlcXVlc3RfdG9rZW4nLFxuXHRcdFx0XHR0b2tlbjogYmFzZSArICdvYXV0aC9hY2Nlc3NfdG9rZW4nXG5cdFx0XHR9LFxuXG5cdFx0XHRsb2dpbjogZnVuY3Rpb24ocCkge1xuXHRcdFx0XHQvLyBSZWF1dGhlbnRpY2F0ZVxuXHRcdFx0XHQvLyBodHRwczovL2Rldi50d2l0dGVyLmNvbS9vYXV0aC9yZWZlcmVuY2UvZ2V0L29hdXRoL2F1dGhlbnRpY2F0ZVxuXHRcdFx0XHR2YXIgcHJlZml4ID0gJz9mb3JjZV9sb2dpbj10cnVlJztcblx0XHRcdFx0dGhpcy5vYXV0aC5hdXRoID0gdGhpcy5vYXV0aC5hdXRoLnJlcGxhY2UocHJlZml4LCAnJykgKyAocC5vcHRpb25zLmZvcmNlID8gcHJlZml4IDogJycpO1xuXHRcdFx0fSxcblxuXHRcdFx0YmFzZTogYmFzZSArICcxLjEvJyxcblxuXHRcdFx0Z2V0OiB7XG5cdFx0XHRcdG1lOiAnYWNjb3VudC92ZXJpZnlfY3JlZGVudGlhbHMuanNvbicsXG5cdFx0XHRcdCdtZS9mcmllbmRzJzogJ2ZyaWVuZHMvbGlzdC5qc29uP2NvdW50PUB7bGltaXR8MjAwfScsXG5cdFx0XHRcdCdtZS9mb2xsb3dpbmcnOiAnZnJpZW5kcy9saXN0Lmpzb24/Y291bnQ9QHtsaW1pdHwyMDB9Jyxcblx0XHRcdFx0J21lL2ZvbGxvd2Vycyc6ICdmb2xsb3dlcnMvbGlzdC5qc29uP2NvdW50PUB7bGltaXR8MjAwfScsXG5cblx0XHRcdFx0Ly8gSHR0cHM6Ly9kZXYudHdpdHRlci5jb20vZG9jcy9hcGkvMS4xL2dldC9zdGF0dXNlcy91c2VyX3RpbWVsaW5lXG5cdFx0XHRcdCdtZS9zaGFyZSc6ICdzdGF0dXNlcy91c2VyX3RpbWVsaW5lLmpzb24/Y291bnQ9QHtsaW1pdHwyMDB9JyxcblxuXHRcdFx0XHQvLyBIdHRwczovL2Rldi50d2l0dGVyLmNvbS9yZXN0L3JlZmVyZW5jZS9nZXQvZmF2b3JpdGVzL2xpc3Rcblx0XHRcdFx0J21lL2xpa2UnOiAnZmF2b3JpdGVzL2xpc3QuanNvbj9jb3VudD1Ae2xpbWl0fDIwMH0nXG5cdFx0XHR9LFxuXG5cdFx0XHRwb3N0OiB7XG5cdFx0XHRcdCdtZS9zaGFyZSc6IGZ1bmN0aW9uKHAsIGNhbGxiYWNrKSB7XG5cblx0XHRcdFx0XHR2YXIgZGF0YSA9IHAuZGF0YTtcblx0XHRcdFx0XHRwLmRhdGEgPSBudWxsO1xuXG5cdFx0XHRcdFx0dmFyIHN0YXR1cyA9IFtdO1xuXG5cdFx0XHRcdFx0Ly8gQ2hhbmdlIG1lc3NhZ2UgdG8gc3RhdHVzXG5cdFx0XHRcdFx0aWYgKGRhdGEubWVzc2FnZSkge1xuXHRcdFx0XHRcdFx0c3RhdHVzLnB1c2goZGF0YS5tZXNzYWdlKTtcblx0XHRcdFx0XHRcdGRlbGV0ZSBkYXRhLm1lc3NhZ2U7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0Ly8gSWYgbGluayBpcyBnaXZlblxuXHRcdFx0XHRcdGlmIChkYXRhLmxpbmspIHtcblx0XHRcdFx0XHRcdHN0YXR1cy5wdXNoKGRhdGEubGluayk7XG5cdFx0XHRcdFx0XHRkZWxldGUgZGF0YS5saW5rO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGlmIChkYXRhLnBpY3R1cmUpIHtcblx0XHRcdFx0XHRcdHN0YXR1cy5wdXNoKGRhdGEucGljdHVyZSk7XG5cdFx0XHRcdFx0XHRkZWxldGUgZGF0YS5waWN0dXJlO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdC8vIENvbXBvdW5kIGFsbCB0aGUgY29tcG9uZW50c1xuXHRcdFx0XHRcdGlmIChzdGF0dXMubGVuZ3RoKSB7XG5cdFx0XHRcdFx0XHRkYXRhLnN0YXR1cyA9IHN0YXR1cy5qb2luKCcgJyk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0Ly8gVHdlZXQgbWVkaWFcblx0XHRcdFx0XHRpZiAoZGF0YS5maWxlKSB7XG5cdFx0XHRcdFx0XHRkYXRhWydtZWRpYVtdJ10gPSBkYXRhLmZpbGU7XG5cdFx0XHRcdFx0XHRkZWxldGUgZGF0YS5maWxlO1xuXHRcdFx0XHRcdFx0cC5kYXRhID0gZGF0YTtcblx0XHRcdFx0XHRcdGNhbGxiYWNrKCdzdGF0dXNlcy91cGRhdGVfd2l0aF9tZWRpYS5qc29uJyk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0Ly8gUmV0d2VldD9cblx0XHRcdFx0XHRlbHNlIGlmICgnaWQnIGluIGRhdGEpIHtcblx0XHRcdFx0XHRcdGNhbGxiYWNrKCdzdGF0dXNlcy9yZXR3ZWV0LycgKyBkYXRhLmlkICsgJy5qc29uJyk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0Ly8gVHdlZXRcblx0XHRcdFx0XHRlbHNlIHtcblx0XHRcdFx0XHRcdC8vIEFzc2lnbiB0aGUgcG9zdCBib2R5IHRvIHRoZSBxdWVyeSBwYXJhbWV0ZXJzXG5cdFx0XHRcdFx0XHRoZWxsby51dGlscy5leHRlbmQocC5xdWVyeSwgZGF0YSk7XG5cdFx0XHRcdFx0XHRjYWxsYmFjaygnc3RhdHVzZXMvdXBkYXRlLmpzb24/aW5jbHVkZV9lbnRpdGllcz0xJyk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9LFxuXG5cdFx0XHRcdC8vIFNlZTogaHR0cHM6Ly9kZXYudHdpdHRlci5jb20vcmVzdC9yZWZlcmVuY2UvcG9zdC9mYXZvcml0ZXMvY3JlYXRlXG5cdFx0XHRcdCdtZS9saWtlJzogZnVuY3Rpb24ocCwgY2FsbGJhY2spIHtcblx0XHRcdFx0XHR2YXIgaWQgPSBwLmRhdGEuaWQ7XG5cdFx0XHRcdFx0cC5kYXRhID0gbnVsbDtcblx0XHRcdFx0XHRjYWxsYmFjaygnZmF2b3JpdGVzL2NyZWF0ZS5qc29uP2lkPScgKyBpZCk7XG5cdFx0XHRcdH1cblx0XHRcdH0sXG5cblx0XHRcdGRlbDoge1xuXG5cdFx0XHRcdC8vIFNlZTogaHR0cHM6Ly9kZXYudHdpdHRlci5jb20vcmVzdC9yZWZlcmVuY2UvcG9zdC9mYXZvcml0ZXMvZGVzdHJveVxuXHRcdFx0XHQnbWUvbGlrZSc6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdHAubWV0aG9kID0gJ3Bvc3QnO1xuXHRcdFx0XHRcdHZhciBpZCA9IHAuZGF0YS5pZDtcblx0XHRcdFx0XHRwLmRhdGEgPSBudWxsO1xuXHRcdFx0XHRcdGNhbGxiYWNrKCdmYXZvcml0ZXMvZGVzdHJveS5qc29uP2lkPScgKyBpZCk7XG5cdFx0XHRcdH1cblx0XHRcdH0sXG5cblx0XHRcdHdyYXA6IHtcblx0XHRcdFx0bWU6IGZ1bmN0aW9uKHJlcykge1xuXHRcdFx0XHRcdGZvcm1hdEVycm9yKHJlcyk7XG5cdFx0XHRcdFx0Zm9ybWF0VXNlcihyZXMpO1xuXHRcdFx0XHRcdHJldHVybiByZXM7XG5cdFx0XHRcdH0sXG5cblx0XHRcdFx0J21lL2ZyaWVuZHMnOiBmb3JtYXRGcmllbmRzLFxuXHRcdFx0XHQnbWUvZm9sbG93ZXJzJzogZm9ybWF0RnJpZW5kcyxcblx0XHRcdFx0J21lL2ZvbGxvd2luZyc6IGZvcm1hdEZyaWVuZHMsXG5cblx0XHRcdFx0J21lL3NoYXJlJzogZnVuY3Rpb24ocmVzKSB7XG5cdFx0XHRcdFx0Zm9ybWF0RXJyb3IocmVzKTtcblx0XHRcdFx0XHRwYWdpbmcocmVzKTtcblx0XHRcdFx0XHRpZiAoIXJlcy5lcnJvciAmJiAnbGVuZ3RoJyBpbiByZXMpIHtcblx0XHRcdFx0XHRcdHJldHVybiB7ZGF0YTogcmVzfTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRyZXR1cm4gcmVzO1xuXHRcdFx0XHR9LFxuXG5cdFx0XHRcdCdkZWZhdWx0JzogZnVuY3Rpb24ocmVzKSB7XG5cdFx0XHRcdFx0cmVzID0gYXJyYXlUb0RhdGFSZXNwb25zZShyZXMpO1xuXHRcdFx0XHRcdHBhZ2luZyhyZXMpO1xuXHRcdFx0XHRcdHJldHVybiByZXM7XG5cdFx0XHRcdH1cblx0XHRcdH0sXG5cdFx0XHR4aHI6IGZ1bmN0aW9uKHApIHtcblxuXHRcdFx0XHQvLyBSZWx5IG9uIHRoZSBwcm94eSBmb3Igbm9uLUdFVCByZXF1ZXN0cy5cblx0XHRcdFx0cmV0dXJuIChwLm1ldGhvZCAhPT0gJ2dldCcpO1xuXHRcdFx0fVxuXHRcdH1cblx0fSk7XG5cblx0ZnVuY3Rpb24gZm9ybWF0VXNlcihvKSB7XG5cdFx0aWYgKG8uaWQpIHtcblx0XHRcdGlmIChvLm5hbWUpIHtcblx0XHRcdFx0dmFyIG0gPSBvLm5hbWUuc3BsaXQoJyAnKTtcblx0XHRcdFx0by5maXJzdF9uYW1lID0gbS5zaGlmdCgpO1xuXHRcdFx0XHRvLmxhc3RfbmFtZSA9IG0uam9pbignICcpO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBTZWU6IGh0dHBzOi8vZGV2LnR3aXR0ZXIuY29tL292ZXJ2aWV3L2dlbmVyYWwvdXNlci1wcm9maWxlLWltYWdlcy1hbmQtYmFubmVyc1xuXHRcdFx0by50aHVtYm5haWwgPSBvLnByb2ZpbGVfaW1hZ2VfdXJsX2h0dHBzIHx8IG8ucHJvZmlsZV9pbWFnZV91cmw7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIG87XG5cdH1cblxuXHRmdW5jdGlvbiBmb3JtYXRGcmllbmRzKG8pIHtcblx0XHRmb3JtYXRFcnJvcihvKTtcblx0XHRwYWdpbmcobyk7XG5cdFx0aWYgKG8udXNlcnMpIHtcblx0XHRcdG8uZGF0YSA9IG8udXNlcnMubWFwKGZvcm1hdFVzZXIpO1xuXHRcdFx0ZGVsZXRlIG8udXNlcnM7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIG87XG5cdH1cblxuXHRmdW5jdGlvbiBmb3JtYXRFcnJvcihvKSB7XG5cdFx0aWYgKG8uZXJyb3JzKSB7XG5cdFx0XHR2YXIgZSA9IG8uZXJyb3JzWzBdO1xuXHRcdFx0by5lcnJvciA9IHtcblx0XHRcdFx0Y29kZTogJ3JlcXVlc3RfZmFpbGVkJyxcblx0XHRcdFx0bWVzc2FnZTogZS5tZXNzYWdlXG5cdFx0XHR9O1xuXHRcdH1cblx0fVxuXG5cdC8vIFRha2UgYSBjdXJzb3IgYW5kIGFkZCBpdCB0byB0aGUgcGF0aFxuXHRmdW5jdGlvbiBwYWdpbmcocmVzKSB7XG5cdFx0Ly8gRG9lcyB0aGUgcmVzcG9uc2UgaW5jbHVkZSBhICduZXh0X2N1cnNvcl9zdHJpbmcnXG5cdFx0aWYgKCduZXh0X2N1cnNvcl9zdHInIGluIHJlcykge1xuXHRcdFx0Ly8gU2VlOiBodHRwczovL2Rldi50d2l0dGVyLmNvbS9kb2NzL21pc2MvY3Vyc29yaW5nXG5cdFx0XHRyZXMucGFnaW5nID0ge1xuXHRcdFx0XHRuZXh0OiAnP2N1cnNvcj0nICsgcmVzLm5leHRfY3Vyc29yX3N0clxuXHRcdFx0fTtcblx0XHR9XG5cdH1cblxuXHRmdW5jdGlvbiBhcnJheVRvRGF0YVJlc3BvbnNlKHJlcykge1xuXHRcdHJldHVybiBBcnJheS5pc0FycmF5KHJlcykgPyB7ZGF0YTogcmVzfSA6IHJlcztcblx0fVxuXG5cdC8qKlxuXHQvLyBUaGUgZG9jdW1lbnRhdGlvbiBzYXlzIHRvIGRlZmluZSB1c2VyIGluIHRoZSByZXF1ZXN0XG5cdC8vIEFsdGhvdWdoIGl0cyBub3QgYWN0dWFsbHkgcmVxdWlyZWQuXG5cblx0dmFyIHVzZXJfaWQ7XG5cblx0ZnVuY3Rpb24gd2l0aFVzZXJJZChjYWxsYmFjayl7XG5cdFx0aWYodXNlcl9pZCl7XG5cdFx0XHRjYWxsYmFjayh1c2VyX2lkKTtcblx0XHR9XG5cdFx0ZWxzZXtcblx0XHRcdGhlbGxvLmFwaSgndHdpdHRlcjovbWUnLCBmdW5jdGlvbihvKXtcblx0XHRcdFx0dXNlcl9pZCA9IG8uaWQ7XG5cdFx0XHRcdGNhbGxiYWNrKG8uaWQpO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHR9XG5cblx0ZnVuY3Rpb24gc2lnbih1cmwpe1xuXHRcdHJldHVybiBmdW5jdGlvbihwLCBjYWxsYmFjayl7XG5cdFx0XHR3aXRoVXNlcklkKGZ1bmN0aW9uKHVzZXJfaWQpe1xuXHRcdFx0XHRjYWxsYmFjayh1cmwrJz91c2VyX2lkPScrdXNlcl9pZCk7XG5cdFx0XHR9KTtcblx0XHR9O1xuXHR9XG5cdCovXG5cbn0pKGhlbGxvKTtcblxuLy8gVmtvbnRha3RlICh2ay5jb20pXG4oZnVuY3Rpb24oaGVsbG8pIHtcblxuXHRoZWxsby5pbml0KHtcblxuXHRcdHZrOiB7XG5cdFx0XHRuYW1lOiAnVmsnLFxuXG5cdFx0XHQvLyBTZWUgaHR0cHM6Ly92ay5jb20vZGV2L29hdXRoX2RpYWxvZ1xuXHRcdFx0b2F1dGg6IHtcblx0XHRcdFx0dmVyc2lvbjogMixcblx0XHRcdFx0YXV0aDogJ2h0dHBzOi8vb2F1dGgudmsuY29tL2F1dGhvcml6ZScsXG5cdFx0XHRcdGdyYW50OiAnaHR0cHM6Ly9vYXV0aC52ay5jb20vYWNjZXNzX3Rva2VuJ1xuXHRcdFx0fSxcblxuXHRcdFx0Ly8gQXV0aG9yaXphdGlvbiBzY29wZXNcblx0XHRcdC8vIFNlZSBodHRwczovL3ZrLmNvbS9kZXYvcGVybWlzc2lvbnNcblx0XHRcdHNjb3BlOiB7XG5cdFx0XHRcdGVtYWlsOiAnZW1haWwnLFxuXHRcdFx0XHRmcmllbmRzOiAnZnJpZW5kcycsXG5cdFx0XHRcdHBob3RvczogJ3Bob3RvcycsXG5cdFx0XHRcdHZpZGVvczogJ3ZpZGVvJyxcblx0XHRcdFx0c2hhcmU6ICdzaGFyZScsXG5cdFx0XHRcdG9mZmxpbmVfYWNjZXNzOiAnb2ZmbGluZSdcblx0XHRcdH0sXG5cblx0XHRcdC8vIFJlZnJlc2ggdGhlIGFjY2Vzc190b2tlblxuXHRcdFx0cmVmcmVzaDogdHJ1ZSxcblxuXHRcdFx0bG9naW46IGZ1bmN0aW9uKHApIHtcblx0XHRcdFx0cC5xcy5kaXNwbGF5ID0gd2luZG93Lm5hdmlnYXRvciAmJlxuXHRcdFx0XHRcdHdpbmRvdy5uYXZpZ2F0b3IudXNlckFnZW50ICYmXG5cdFx0XHRcdFx0L2lwYWR8cGhvbmV8cGhvbmV8YW5kcm9pZC8udGVzdCh3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpKSA/ICdtb2JpbGUnIDogJ3BvcHVwJztcblx0XHRcdH0sXG5cblx0XHRcdC8vIEFQSSBCYXNlIFVSTFxuXHRcdFx0YmFzZTogJ2h0dHBzOi8vYXBpLnZrLmNvbS9tZXRob2QvJyxcblxuXHRcdFx0Ly8gTWFwIEdFVCByZXF1ZXN0c1xuXHRcdFx0Z2V0OiB7XG5cdFx0XHRcdG1lOiBmdW5jdGlvbihwLCBjYWxsYmFjaykge1xuXHRcdFx0XHRcdHAucXVlcnkuZmllbGRzID0gJ2lkLGZpcnN0X25hbWUsbGFzdF9uYW1lLHBob3RvX21heCc7XG5cdFx0XHRcdFx0Y2FsbGJhY2soJ3VzZXJzLmdldCcpO1xuXHRcdFx0XHR9XG5cdFx0XHR9LFxuXG5cdFx0XHR3cmFwOiB7XG5cdFx0XHRcdG1lOiBmdW5jdGlvbihyZXMsIGhlYWRlcnMsIHJlcSkge1xuXHRcdFx0XHRcdGZvcm1hdEVycm9yKHJlcyk7XG5cdFx0XHRcdFx0cmV0dXJuIGZvcm1hdFVzZXIocmVzLCByZXEpO1xuXHRcdFx0XHR9XG5cdFx0XHR9LFxuXG5cdFx0XHQvLyBObyBYSFJcblx0XHRcdHhocjogZmFsc2UsXG5cblx0XHRcdC8vIEFsbCByZXF1ZXN0cyBzaG91bGQgYmUgSlNPTlAgYXMgb2YgbWlzc2luZyBDT1JTIGhlYWRlcnMgaW4gaHR0cHM6Ly9hcGkudmsuY29tL21ldGhvZC8qXG5cdFx0XHRqc29ucDogdHJ1ZSxcblxuXHRcdFx0Ly8gTm8gZm9ybVxuXHRcdFx0Zm9ybTogZmFsc2Vcblx0XHR9XG5cdH0pO1xuXG5cdGZ1bmN0aW9uIGZvcm1hdFVzZXIobywgcmVxKSB7XG5cblx0XHRpZiAobyAhPT0gbnVsbCAmJiAncmVzcG9uc2UnIGluIG8gJiYgby5yZXNwb25zZSAhPT0gbnVsbCAmJiBvLnJlc3BvbnNlLmxlbmd0aCkge1xuXHRcdFx0byA9IG8ucmVzcG9uc2VbMF07XG5cdFx0XHRvLmlkID0gby51aWQ7XG5cdFx0XHRvLnRodW1ibmFpbCA9IG8ucGljdHVyZSA9IG8ucGhvdG9fbWF4O1xuXHRcdFx0by5uYW1lID0gby5maXJzdF9uYW1lICsgJyAnICsgby5sYXN0X25hbWU7XG5cblx0XHRcdGlmIChyZXEuYXV0aFJlc3BvbnNlICYmIHJlcS5hdXRoUmVzcG9uc2UuZW1haWwgIT09IG51bGwpXG5cdFx0XHRcdG8uZW1haWwgPSByZXEuYXV0aFJlc3BvbnNlLmVtYWlsO1xuXHRcdH1cblxuXHRcdHJldHVybiBvO1xuXHR9XG5cblx0ZnVuY3Rpb24gZm9ybWF0RXJyb3Iobykge1xuXG5cdFx0aWYgKG8uZXJyb3IpIHtcblx0XHRcdHZhciBlID0gby5lcnJvcjtcblx0XHRcdG8uZXJyb3IgPSB7XG5cdFx0XHRcdGNvZGU6IGUuZXJyb3JfY29kZSxcblx0XHRcdFx0bWVzc2FnZTogZS5lcnJvcl9tc2dcblx0XHRcdH07XG5cdFx0fVxuXHR9XG5cbn0pKGhlbGxvKTtcblxuKGZ1bmN0aW9uKGhlbGxvKSB7XG5cblx0aGVsbG8uaW5pdCh7XG5cdFx0d2luZG93czoge1xuXHRcdFx0bmFtZTogJ1dpbmRvd3MgbGl2ZScsXG5cblx0XHRcdC8vIFJFRjogaHR0cDovL21zZG4ubWljcm9zb2Z0LmNvbS9lbi11cy9saWJyYXJ5L2hoMjQzNjQxLmFzcHhcblx0XHRcdG9hdXRoOiB7XG5cdFx0XHRcdHZlcnNpb246IDIsXG5cdFx0XHRcdGF1dGg6ICdodHRwczovL2xvZ2luLmxpdmUuY29tL29hdXRoMjBfYXV0aG9yaXplLnNyZicsXG5cdFx0XHRcdGdyYW50OiAnaHR0cHM6Ly9sb2dpbi5saXZlLmNvbS9vYXV0aDIwX3Rva2VuLnNyZidcblx0XHRcdH0sXG5cblx0XHRcdC8vIFJlZnJlc2ggdGhlIGFjY2Vzc190b2tlbiBvbmNlIGV4cGlyZWRcblx0XHRcdHJlZnJlc2g6IHRydWUsXG5cblx0XHRcdGxvZ291dDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiAnaHR0cDovL2xvZ2luLmxpdmUuY29tL29hdXRoMjBfbG9nb3V0LnNyZj90cz0nICsgKG5ldyBEYXRlKCkpLmdldFRpbWUoKTtcblx0XHRcdH0sXG5cblx0XHRcdC8vIEF1dGhvcml6YXRpb24gc2NvcGVzXG5cdFx0XHRzY29wZToge1xuXHRcdFx0XHRiYXNpYzogJ3dsLnNpZ25pbix3bC5iYXNpYycsXG5cdFx0XHRcdGVtYWlsOiAnd2wuZW1haWxzJyxcblx0XHRcdFx0YmlydGhkYXk6ICd3bC5iaXJ0aGRheScsXG5cdFx0XHRcdGV2ZW50czogJ3dsLmNhbGVuZGFycycsXG5cdFx0XHRcdHBob3RvczogJ3dsLnBob3RvcycsXG5cdFx0XHRcdHZpZGVvczogJ3dsLnBob3RvcycsXG5cdFx0XHRcdGZyaWVuZHM6ICd3bC5jb250YWN0c19lbWFpbHMnLFxuXHRcdFx0XHRmaWxlczogJ3dsLnNreWRyaXZlJyxcblx0XHRcdFx0cHVibGlzaDogJ3dsLnNoYXJlJyxcblx0XHRcdFx0cHVibGlzaF9maWxlczogJ3dsLnNreWRyaXZlX3VwZGF0ZScsXG5cdFx0XHRcdHNoYXJlOiAnd2wuc2hhcmUnLFxuXHRcdFx0XHRjcmVhdGVfZXZlbnQ6ICd3bC5jYWxlbmRhcnNfdXBkYXRlLHdsLmV2ZW50c19jcmVhdGUnLFxuXHRcdFx0XHRvZmZsaW5lX2FjY2VzczogJ3dsLm9mZmxpbmVfYWNjZXNzJ1xuXHRcdFx0fSxcblxuXHRcdFx0Ly8gQVBJIGJhc2UgVVJMXG5cdFx0XHRiYXNlOiAnaHR0cHM6Ly9hcGlzLmxpdmUubmV0L3Y1LjAvJyxcblxuXHRcdFx0Ly8gTWFwIEdFVCByZXF1ZXN0c1xuXHRcdFx0Z2V0OiB7XG5cblx0XHRcdFx0Ly8gRnJpZW5kc1xuXHRcdFx0XHRtZTogJ21lJyxcblx0XHRcdFx0J21lL2ZyaWVuZHMnOiAnbWUvZnJpZW5kcycsXG5cdFx0XHRcdCdtZS9mb2xsb3dpbmcnOiAnbWUvY29udGFjdHMnLFxuXHRcdFx0XHQnbWUvZm9sbG93ZXJzJzogJ21lL2ZyaWVuZHMnLFxuXHRcdFx0XHQnbWUvY29udGFjdHMnOiAnbWUvY29udGFjdHMnLFxuXG5cdFx0XHRcdCdtZS9hbGJ1bXMnOiAnbWUvYWxidW1zJyxcblxuXHRcdFx0XHQvLyBJbmNsdWRlIHRoZSBkYXRhW2lkXSBpbiB0aGUgcGF0aFxuXHRcdFx0XHQnbWUvYWxidW0nOiAnQHtpZH0vZmlsZXMnLFxuXHRcdFx0XHQnbWUvcGhvdG8nOiAnQHtpZH0nLFxuXG5cdFx0XHRcdC8vIEZpbGVzXG5cdFx0XHRcdCdtZS9maWxlcyc6ICdAe3BhcmVudHxtZS9za3lkcml2ZX0vZmlsZXMnLFxuXHRcdFx0XHQnbWUvZm9sZGVycyc6ICdAe2lkfG1lL3NreWRyaXZlfS9maWxlcycsXG5cdFx0XHRcdCdtZS9mb2xkZXInOiAnQHtpZHxtZS9za3lkcml2ZX0vZmlsZXMnXG5cdFx0XHR9LFxuXG5cdFx0XHQvLyBNYXAgUE9TVCByZXF1ZXN0c1xuXHRcdFx0cG9zdDoge1xuXHRcdFx0XHQnbWUvYWxidW1zJzogJ21lL2FsYnVtcycsXG5cdFx0XHRcdCdtZS9hbGJ1bSc6ICdAe2lkfS9maWxlcy8nLFxuXG5cdFx0XHRcdCdtZS9mb2xkZXJzJzogJ0B7aWR8bWUvc2t5ZHJpdmUvfScsXG5cdFx0XHRcdCdtZS9maWxlcyc6ICdAe3BhcmVudHxtZS9za3lkcml2ZX0vZmlsZXMnXG5cdFx0XHR9LFxuXG5cdFx0XHQvLyBNYXAgREVMRVRFIHJlcXVlc3RzXG5cdFx0XHRkZWw6IHtcblx0XHRcdFx0Ly8gSW5jbHVkZSB0aGUgZGF0YVtpZF0gaW4gdGhlIHBhdGhcblx0XHRcdFx0J21lL2FsYnVtJzogJ0B7aWR9Jyxcblx0XHRcdFx0J21lL3Bob3RvJzogJ0B7aWR9Jyxcblx0XHRcdFx0J21lL2ZvbGRlcic6ICdAe2lkfScsXG5cdFx0XHRcdCdtZS9maWxlcyc6ICdAe2lkfSdcblx0XHRcdH0sXG5cblx0XHRcdHdyYXA6IHtcblx0XHRcdFx0bWU6IGZvcm1hdFVzZXIsXG5cblx0XHRcdFx0J21lL2ZyaWVuZHMnOiBmb3JtYXRGcmllbmRzLFxuXHRcdFx0XHQnbWUvY29udGFjdHMnOiBmb3JtYXRGcmllbmRzLFxuXHRcdFx0XHQnbWUvZm9sbG93ZXJzJzogZm9ybWF0RnJpZW5kcyxcblx0XHRcdFx0J21lL2ZvbGxvd2luZyc6IGZvcm1hdEZyaWVuZHMsXG5cdFx0XHRcdCdtZS9hbGJ1bXMnOiBmb3JtYXRBbGJ1bXMsXG5cdFx0XHRcdCdtZS9waG90b3MnOiBmb3JtYXREZWZhdWx0LFxuXHRcdFx0XHQnZGVmYXVsdCc6IGZvcm1hdERlZmF1bHRcblx0XHRcdH0sXG5cblx0XHRcdHhocjogZnVuY3Rpb24ocCkge1xuXHRcdFx0XHRpZiAocC5tZXRob2QgIT09ICdnZXQnICYmIHAubWV0aG9kICE9PSAnZGVsZXRlJyAmJiAhaGVsbG8udXRpbHMuaGFzQmluYXJ5KHAuZGF0YSkpIHtcblxuXHRcdFx0XHRcdC8vIERvZXMgdGhpcyBoYXZlIGEgZGF0YS11cmkgdG8gdXBsb2FkIGFzIGEgZmlsZT9cblx0XHRcdFx0XHRpZiAodHlwZW9mIChwLmRhdGEuZmlsZSkgPT09ICdzdHJpbmcnKSB7XG5cdFx0XHRcdFx0XHRwLmRhdGEuZmlsZSA9IGhlbGxvLnV0aWxzLnRvQmxvYihwLmRhdGEuZmlsZSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGVsc2Uge1xuXHRcdFx0XHRcdFx0cC5kYXRhID0gSlNPTi5zdHJpbmdpZnkocC5kYXRhKTtcblx0XHRcdFx0XHRcdHAuaGVhZGVycyA9IHtcblx0XHRcdFx0XHRcdFx0J0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuXHRcdFx0XHRcdFx0fTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdH0sXG5cblx0XHRcdGpzb25wOiBmdW5jdGlvbihwKSB7XG5cdFx0XHRcdGlmIChwLm1ldGhvZCAhPT0gJ2dldCcgJiYgIWhlbGxvLnV0aWxzLmhhc0JpbmFyeShwLmRhdGEpKSB7XG5cdFx0XHRcdFx0cC5kYXRhLm1ldGhvZCA9IHAubWV0aG9kO1xuXHRcdFx0XHRcdHAubWV0aG9kID0gJ2dldCc7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdH0pO1xuXG5cdGZ1bmN0aW9uIGZvcm1hdERlZmF1bHQobykge1xuXHRcdGlmICgnZGF0YScgaW4gbykge1xuXHRcdFx0by5kYXRhLmZvckVhY2goZnVuY3Rpb24oZCkge1xuXHRcdFx0XHRpZiAoZC5waWN0dXJlKSB7XG5cdFx0XHRcdFx0ZC50aHVtYm5haWwgPSBkLnBpY3R1cmU7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAoZC5pbWFnZXMpIHtcblx0XHRcdFx0XHRkLnBpY3R1cmVzID0gZC5pbWFnZXNcblx0XHRcdFx0XHRcdC5tYXAoZm9ybWF0SW1hZ2UpXG5cdFx0XHRcdFx0XHQuc29ydChmdW5jdGlvbihhLCBiKSB7XG5cdFx0XHRcdFx0XHRcdHJldHVybiBhLndpZHRoIC0gYi53aWR0aDtcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHR9XG5cblx0XHRyZXR1cm4gbztcblx0fVxuXG5cdGZ1bmN0aW9uIGZvcm1hdEltYWdlKGltYWdlKSB7XG5cdFx0cmV0dXJuIHtcblx0XHRcdHdpZHRoOiBpbWFnZS53aWR0aCxcblx0XHRcdGhlaWdodDogaW1hZ2UuaGVpZ2h0LFxuXHRcdFx0c291cmNlOiBpbWFnZS5zb3VyY2Vcblx0XHR9O1xuXHR9XG5cblx0ZnVuY3Rpb24gZm9ybWF0QWxidW1zKG8pIHtcblx0XHRpZiAoJ2RhdGEnIGluIG8pIHtcblx0XHRcdG8uZGF0YS5mb3JFYWNoKGZ1bmN0aW9uKGQpIHtcblx0XHRcdFx0ZC5waG90b3MgPSBkLmZpbGVzID0gJ2h0dHBzOi8vYXBpcy5saXZlLm5ldC92NS4wLycgKyBkLmlkICsgJy9waG90b3MnO1xuXHRcdFx0fSk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIG87XG5cdH1cblxuXHRmdW5jdGlvbiBmb3JtYXRVc2VyKG8sIGhlYWRlcnMsIHJlcSkge1xuXHRcdGlmIChvLmlkKSB7XG5cdFx0XHR2YXIgdG9rZW4gPSByZXEucXVlcnkuYWNjZXNzX3Rva2VuO1xuXHRcdFx0aWYgKG8uZW1haWxzKSB7XG5cdFx0XHRcdG8uZW1haWwgPSBvLmVtYWlscy5wcmVmZXJyZWQ7XG5cdFx0XHR9XG5cblx0XHRcdC8vIElmIHRoaXMgaXMgbm90IGFuIG5vbi1uZXR3b3JrIGZyaWVuZFxuXHRcdFx0aWYgKG8uaXNfZnJpZW5kICE9PSBmYWxzZSkge1xuXHRcdFx0XHQvLyBVc2UgdGhlIGlkIG9mIHRoZSB1c2VyX2lkIGlmIGF2YWlsYWJsZVxuXHRcdFx0XHR2YXIgaWQgPSAoby51c2VyX2lkIHx8IG8uaWQpO1xuXHRcdFx0XHRvLnRodW1ibmFpbCA9IG8ucGljdHVyZSA9ICdodHRwczovL2FwaXMubGl2ZS5uZXQvdjUuMC8nICsgaWQgKyAnL3BpY3R1cmU/YWNjZXNzX3Rva2VuPScgKyB0b2tlbjtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4gbztcblx0fVxuXG5cdGZ1bmN0aW9uIGZvcm1hdEZyaWVuZHMobywgaGVhZGVycywgcmVxKSB7XG5cdFx0aWYgKCdkYXRhJyBpbiBvKSB7XG5cdFx0XHRvLmRhdGEuZm9yRWFjaChmdW5jdGlvbihkKSB7XG5cdFx0XHRcdGZvcm1hdFVzZXIoZCwgaGVhZGVycywgcmVxKTtcblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdHJldHVybiBvO1xuXHR9XG5cbn0pKGhlbGxvKTtcblxuKGZ1bmN0aW9uKGhlbGxvKSB7XG5cblx0aGVsbG8uaW5pdCh7XG5cblx0XHR5YWhvbzoge1xuXG5cdFx0XHQvLyBFbnN1cmUgdGhhdCB5b3UgZGVmaW5lIGFuIG9hdXRoX3Byb3h5XG5cdFx0XHRvYXV0aDoge1xuXHRcdFx0XHR2ZXJzaW9uOiAnMS4wYScsXG5cdFx0XHRcdGF1dGg6ICdodHRwczovL2FwaS5sb2dpbi55YWhvby5jb20vb2F1dGgvdjIvcmVxdWVzdF9hdXRoJyxcblx0XHRcdFx0cmVxdWVzdDogJ2h0dHBzOi8vYXBpLmxvZ2luLnlhaG9vLmNvbS9vYXV0aC92Mi9nZXRfcmVxdWVzdF90b2tlbicsXG5cdFx0XHRcdHRva2VuOiAnaHR0cHM6Ly9hcGkubG9naW4ueWFob28uY29tL29hdXRoL3YyL2dldF90b2tlbidcblx0XHRcdH0sXG5cblx0XHRcdC8vIExvZ2luIGhhbmRsZXJcblx0XHRcdGxvZ2luOiBmdW5jdGlvbihwKSB7XG5cdFx0XHRcdC8vIENoYW5nZSB0aGUgZGVmYXVsdCBwb3B1cCB3aW5kb3cgdG8gYmUgYXQgbGVhc3QgNTYwXG5cdFx0XHRcdC8vIFlhaG9vIGRvZXMgZHluYW1pY2FsbHkgY2hhbmdlIGl0IG9uIHRoZSBmbHkgZm9yIHRoZSBzaWduaW4gc2NyZWVuIChvbmx5LCB3aGF0IGlmIHlvdXIgYWxyZWFkeSBzaWduZWQgaW4pXG5cdFx0XHRcdHAub3B0aW9ucy5wb3B1cC53aWR0aCA9IDU2MDtcblxuXHRcdFx0XHQvLyBZYWhvbyB0aHJvd3MgYW4gcGFyYW1ldGVyIGVycm9yIGlmIGZvciB3aGF0ZXZlciByZWFzb24gdGhlIHN0YXRlLnNjb3BlIGNvbnRhaW5zIGEgY29tbWEsIHNvIGxldHMgcmVtb3ZlIHNjb3BlXG5cdFx0XHRcdHRyeSB7ZGVsZXRlIHAucXMuc3RhdGUuc2NvcGU7fVxuXHRcdFx0XHRjYXRjaCAoZSkge31cblx0XHRcdH0sXG5cblx0XHRcdGJhc2U6ICdodHRwczovL3NvY2lhbC55YWhvb2FwaXMuY29tL3YxLycsXG5cblx0XHRcdGdldDoge1xuXHRcdFx0XHRtZTogeXFsKCdzZWxlY3QgKiBmcm9tIHNvY2lhbC5wcm9maWxlKDApIHdoZXJlIGd1aWQ9bWUnKSxcblx0XHRcdFx0J21lL2ZyaWVuZHMnOiB5cWwoJ3NlbGVjdCAqIGZyb20gc29jaWFsLmNvbnRhY3RzKDApIHdoZXJlIGd1aWQ9bWUnKSxcblx0XHRcdFx0J21lL2ZvbGxvd2luZyc6IHlxbCgnc2VsZWN0ICogZnJvbSBzb2NpYWwuY29udGFjdHMoMCkgd2hlcmUgZ3VpZD1tZScpXG5cdFx0XHR9LFxuXHRcdFx0d3JhcDoge1xuXHRcdFx0XHRtZTogZm9ybWF0VXNlcixcblxuXHRcdFx0XHQvLyBDYW4ndCBnZXQgSURzXG5cdFx0XHRcdC8vIEl0IG1pZ2h0IGJlIGJldHRlciB0byBsb29wIHRocm91Z2ggdGhlIHNvY2lhbC5yZWxhdGlvbnNoaXAgdGFibGUgd2l0aCBoYXMgdW5pcXVlIElEcyBvZiB1c2Vycy5cblx0XHRcdFx0J21lL2ZyaWVuZHMnOiBmb3JtYXRGcmllbmRzLFxuXHRcdFx0XHQnbWUvZm9sbG93aW5nJzogZm9ybWF0RnJpZW5kcyxcblx0XHRcdFx0J2RlZmF1bHQnOiBwYWdpbmdcblx0XHRcdH1cblx0XHR9XG5cdH0pO1xuXG5cdC8qXG5cdFx0Ly8gQXV0by1yZWZyZXNoIGZpeDogYnVnIGluIFlhaG9vIGNhbid0IGdldCB0aGlzIHRvIHdvcmsgd2l0aCBub2RlLW9hdXRoLXNoaW1cblx0XHRsb2dpbiA6IGZ1bmN0aW9uKG8pe1xuXHRcdFx0Ly8gSXMgdGhlIHVzZXIgYWxyZWFkeSBsb2dnZWQgaW5cblx0XHRcdHZhciBhdXRoID0gaGVsbG8oJ3lhaG9vJykuZ2V0QXV0aFJlc3BvbnNlKCk7XG5cblx0XHRcdC8vIElzIHRoaXMgYSByZWZyZXNoIHRva2VuP1xuXHRcdFx0aWYoby5vcHRpb25zLmRpc3BsYXk9PT0nbm9uZScmJmF1dGgmJmF1dGguYWNjZXNzX3Rva2VuJiZhdXRoLnJlZnJlc2hfdG9rZW4pe1xuXHRcdFx0XHQvLyBBZGQgdGhlIG9sZCB0b2tlbiBhbmQgdGhlIHJlZnJlc2ggdG9rZW4sIGluY2x1ZGluZyBwYXRoIHRvIHRoZSBxdWVyeVxuXHRcdFx0XHQvLyBTZWUgaHR0cDovL2RldmVsb3Blci55YWhvby5jb20vb2F1dGgvZ3VpZGUvb2F1dGgtcmVmcmVzaGFjY2Vzc3Rva2VuLmh0bWxcblx0XHRcdFx0by5xcy5hY2Nlc3NfdG9rZW4gPSBhdXRoLmFjY2Vzc190b2tlbjtcblx0XHRcdFx0by5xcy5yZWZyZXNoX3Rva2VuID0gYXV0aC5yZWZyZXNoX3Rva2VuO1xuXHRcdFx0XHRvLnFzLnRva2VuX3VybCA9ICdodHRwczovL2FwaS5sb2dpbi55YWhvby5jb20vb2F1dGgvdjIvZ2V0X3Rva2VuJztcblx0XHRcdH1cblx0XHR9LFxuXHQqL1xuXG5cdGZ1bmN0aW9uIGZvcm1hdEVycm9yKG8pIHtcblx0XHRpZiAobyAmJiAnbWV0YScgaW4gbyAmJiAnZXJyb3JfdHlwZScgaW4gby5tZXRhKSB7XG5cdFx0XHRvLmVycm9yID0ge1xuXHRcdFx0XHRjb2RlOiBvLm1ldGEuZXJyb3JfdHlwZSxcblx0XHRcdFx0bWVzc2FnZTogby5tZXRhLmVycm9yX21lc3NhZ2Vcblx0XHRcdH07XG5cdFx0fVxuXHR9XG5cblx0ZnVuY3Rpb24gZm9ybWF0VXNlcihvKSB7XG5cblx0XHRmb3JtYXRFcnJvcihvKTtcblx0XHRpZiAoby5xdWVyeSAmJiBvLnF1ZXJ5LnJlc3VsdHMgJiYgby5xdWVyeS5yZXN1bHRzLnByb2ZpbGUpIHtcblx0XHRcdG8gPSBvLnF1ZXJ5LnJlc3VsdHMucHJvZmlsZTtcblx0XHRcdG8uaWQgPSBvLmd1aWQ7XG5cdFx0XHRvLmxhc3RfbmFtZSA9IG8uZmFtaWx5TmFtZTtcblx0XHRcdG8uZmlyc3RfbmFtZSA9IG8uZ2l2ZW5OYW1lIHx8IG8ubmlja25hbWU7XG5cdFx0XHR2YXIgYSA9IFtdO1xuXHRcdFx0aWYgKG8uZmlyc3RfbmFtZSkge1xuXHRcdFx0XHRhLnB1c2goby5maXJzdF9uYW1lKTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKG8ubGFzdF9uYW1lKSB7XG5cdFx0XHRcdGEucHVzaChvLmxhc3RfbmFtZSk7XG5cdFx0XHR9XG5cblx0XHRcdG8ubmFtZSA9IGEuam9pbignICcpO1xuXHRcdFx0by5lbWFpbCA9IChvLmVtYWlscyAmJiBvLmVtYWlsc1swXSkgPyBvLmVtYWlsc1swXS5oYW5kbGUgOiBudWxsO1xuXHRcdFx0by50aHVtYm5haWwgPSBvLmltYWdlID8gby5pbWFnZS5pbWFnZVVybCA6IG51bGw7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIG87XG5cdH1cblxuXHRmdW5jdGlvbiBmb3JtYXRGcmllbmRzKG8sIGhlYWRlcnMsIHJlcXVlc3QpIHtcblx0XHRmb3JtYXRFcnJvcihvKTtcblx0XHRwYWdpbmcobywgaGVhZGVycywgcmVxdWVzdCk7XG5cdFx0dmFyIGNvbnRhY3Q7XG5cdFx0dmFyIGZpZWxkO1xuXHRcdGlmIChvLnF1ZXJ5ICYmIG8ucXVlcnkucmVzdWx0cyAmJiBvLnF1ZXJ5LnJlc3VsdHMuY29udGFjdCkge1xuXHRcdFx0by5kYXRhID0gby5xdWVyeS5yZXN1bHRzLmNvbnRhY3Q7XG5cdFx0XHRkZWxldGUgby5xdWVyeTtcblxuXHRcdFx0aWYgKCFBcnJheS5pc0FycmF5KG8uZGF0YSkpIHtcblx0XHRcdFx0by5kYXRhID0gW28uZGF0YV07XG5cdFx0XHR9XG5cblx0XHRcdG8uZGF0YS5mb3JFYWNoKGZvcm1hdEZyaWVuZCk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIG87XG5cdH1cblxuXHRmdW5jdGlvbiBmb3JtYXRGcmllbmQoY29udGFjdCkge1xuXHRcdGNvbnRhY3QuaWQgPSBudWxsO1xuXG5cdFx0Ly8gIzM2MjogUmVwb3J0cyBvZiByZXNwb25zZXMgcmV0dXJuaW5nIGEgc2luZ2xlIGl0ZW0sIHJhdGhlciB0aGFuIGFuIEFycmF5IG9mIGl0ZW1zLlxuXHRcdC8vIEZvcm1hdCB0aGUgY29udGFjdC5maWVsZHMgdG8gYmUgYW4gYXJyYXkuXG5cdFx0aWYgKGNvbnRhY3QuZmllbGRzICYmICEoY29udGFjdC5maWVsZHMgaW5zdGFuY2VvZiBBcnJheSkpIHtcblx0XHRcdGNvbnRhY3QuZmllbGRzID0gW2NvbnRhY3QuZmllbGRzXTtcblx0XHR9XG5cblx0XHQoY29udGFjdC5maWVsZHMgfHwgW10pLmZvckVhY2goZnVuY3Rpb24oZmllbGQpIHtcblx0XHRcdGlmIChmaWVsZC50eXBlID09PSAnZW1haWwnKSB7XG5cdFx0XHRcdGNvbnRhY3QuZW1haWwgPSBmaWVsZC52YWx1ZTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKGZpZWxkLnR5cGUgPT09ICduYW1lJykge1xuXHRcdFx0XHRjb250YWN0LmZpcnN0X25hbWUgPSBmaWVsZC52YWx1ZS5naXZlbk5hbWU7XG5cdFx0XHRcdGNvbnRhY3QubGFzdF9uYW1lID0gZmllbGQudmFsdWUuZmFtaWx5TmFtZTtcblx0XHRcdFx0Y29udGFjdC5uYW1lID0gZmllbGQudmFsdWUuZ2l2ZW5OYW1lICsgJyAnICsgZmllbGQudmFsdWUuZmFtaWx5TmFtZTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKGZpZWxkLnR5cGUgPT09ICd5YWhvb2lkJykge1xuXHRcdFx0XHRjb250YWN0LmlkID0gZmllbGQudmFsdWU7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblxuXHRmdW5jdGlvbiBwYWdpbmcocmVzLCBoZWFkZXJzLCByZXF1ZXN0KSB7XG5cblx0XHQvLyBTZWU6IGh0dHA6Ly9kZXZlbG9wZXIueWFob28uY29tL3lxbC9ndWlkZS9wYWdpbmcuaHRtbCNsb2NhbF9saW1pdHNcblx0XHRpZiAocmVzLnF1ZXJ5ICYmIHJlcy5xdWVyeS5jb3VudCAmJiByZXF1ZXN0Lm9wdGlvbnMpIHtcblx0XHRcdHJlcy5wYWdpbmcgPSB7XG5cdFx0XHRcdG5leHQ6ICc/c3RhcnQ9JyArIChyZXMucXVlcnkuY291bnQgKyAoK3JlcXVlc3Qub3B0aW9ucy5zdGFydCB8fCAxKSlcblx0XHRcdH07XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHJlcztcblx0fVxuXG5cdGZ1bmN0aW9uIHlxbChxKSB7XG5cdFx0cmV0dXJuICdodHRwczovL3F1ZXJ5LnlhaG9vYXBpcy5jb20vdjEveXFsP3E9JyArIChxICsgJyBsaW1pdCBAe2xpbWl0fDEwMH0gb2Zmc2V0IEB7c3RhcnR8MH0nKS5yZXBsYWNlKC9cXHMvZywgJyUyMCcpICsgJyZmb3JtYXQ9anNvbic7XG5cdH1cblxufSkoaGVsbG8pO1xuXG4vLyBSZWdpc3RlciBhcyBhbm9ueW1vdXMgQU1EIG1vZHVsZVxuaWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkge1xuXHRkZWZpbmUoZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIGhlbGxvO1xuXHR9KTtcbn1cblxuLy8gQ29tbW9uSlMgbW9kdWxlIGZvciBicm93c2VyaWZ5XG5pZiAodHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcgJiYgbW9kdWxlLmV4cG9ydHMpIHtcblx0bW9kdWxlLmV4cG9ydHMgPSBoZWxsbztcbn1cbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
