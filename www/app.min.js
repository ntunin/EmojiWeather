angular.module("app",["ionic","app.routes","app.directives"]).run(["$ionicPlatform",function(o){o.ready(function(){window.cordova&&window.cordova.plugins&&window.cordova.plugins.Keyboard&&(cordova.plugins.Keyboard.hideKeyboardAccessoryBar(!0),cordova.plugins.Keyboard.disableScroll(!0)),window.StatusBar&&StatusBar.styleDefault()})}]);
angular.module("app.directives",[]).directive("blankDirective",[function(){}]).directive("background",function(){return{restrict:"A",link:function(i,c,r){i.$broadcast("scroll.resize")},compile:function(i,c){i.html('<div class = "background" style = "background-image: url({{background}});"></div>')}}});
angular.module("app.routes",[]).config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("overview",{url:"/overview",templateUrl:"templates/overview.html",controller:"overviewCtrl"}).state("login",{url:"/login",templateUrl:"templates/login.html",controller:"loginCtrl"}).state("preview",{url:"/preview",templateUrl:"templates/preview.html",controller:"previewCtrl"}).state("error",{url:"/login_error",templateUrl:"templates/error.html",controller:"errorCtrl"}).state("main",{url:"/main_screen",templateUrl:"templates/main.html",controller:"mainCtrl"}).state("menu",{url:"/menu",templateUrl:"templates/menu.html",controller:"menuCtrl"}).state("weeklyForecast",{url:"/weekly",templateUrl:"templates/weeklyForecast.html",controller:"weeklyForecastCtrl"}).state("hourlyForecast",{url:"/hourly",templateUrl:"templates/hourlyForecast.html",controller:"hourlyForecastCtrl"}).state("map",{url:"/map",templateUrl:"templates/map.html",controller:"mapCtrl"}).state("addEmojis",{url:"/add_emojis",templateUrl:"templates/addEmojis.html",controller:"addEmojisCtrl"}).state("search",{url:"/search",templateUrl:"templates/search.html",controller:"searchCtrl"}).state("backgroundSelection",{url:"/page12",templateUrl:"templates/backgroundSelection.html",controller:"backgroundSelectionCtrl"}),t.otherwise("/overview")}]);
angular.module("app").controller("addEmojisCtrl",["$scope","$state","Background",function(o,a,t){t.setup(o,a)}]);
angular.module("app").controller("backgroundSelectionCtrl",["$scope","$state","Background",function(e,t,c){var n=c.setup(e,t);e.backgrounds=c.list(),e.select=function(e){n.set(e)},e.isSelected=function(e){return c.isSelected(e)?"background-selected":""}}]);
angular.module("app").controller("errorCtrl",["$scope",function(r){}]);
angular.module("app").controller("hourlyForecastCtrl",["$scope","$state","Background","Weather","UserData",function(o,t,e,n,r){function a(t){o.hourlyForecast=t}function u(o){}e.setup(o,t);var c=r();n(c.location,"hourly").then(a,u),o.moment=moment}]);
angular.module("app").controller("loginCtrl",["$scope","$state","Background","UserData","Location",function(o,t,a,n,s){a.setup(o,t),o.user={name:"nik",location:{state:"siberia",country:"russia",city:"omsk"}},o.submit=function(){n(o.user),s(o.user.location)}}]);
angular.module("app").controller("mainCtrl",["$scope","$state","Background","$stateParams","UserData","Weather","Location","$ionicPopup",function(n,t,a,e,o,c,r,i){function u(){function t(t){n.hourlyForecast=t}function a(n){i.alert({title:"Warning",template:n})}n.moment=moment;var e=o();n.username=e.name,n.location=r();setInterval(function(){n.date=new Date,n.$apply()},1e3);c(n.location,"hourly").then(t,a)}a.setup(n,t),n.$on("$stateChangeSuccess",function(n,t,a,e,o){"main"===t.name&&u()})}]);
angular.module("app").controller("menuCtrl",["$scope","$state","Background",function(e,n,o){o.setup(e,n)}]);
angular.module("app").controller("overviewCtrl",["$scope","$state","Background","UserData",function(a,e,o,r){o.setup(a,e),r()&&e.go("main")}]);
angular.module("app").controller("previewCtrl",["$scope","$state","Background","UserData",function(e,t,a,n){a.setup(e,t),e.user=n(),e.submit=function(){t.go("main")}}]);
angular.module("app").controller("searchCtrl",["$scope","$state","Background","Location",function(t,o,c,n){c.setup(t,o),t.location={state:"",country:"",city:""},t.submit=function(){n(t.location)}}]);
angular.module("app").controller("weeklyForecastCtrl",["$scope","$state","Background","Weather","UserData",function(t,n,e,o,r){function a(n){function e(t){function n(t){return moment(t.date).format("ddd")}for(var e={},o=0;o<t.length;o++){var r=t[o],a=n(r);e[a]=e[a]||[],e[a].push(r)}return e}t.forecast=e(n)}function u(t){}e.setup(t,n);var c=r();o(c.location,"hourly10day").then(a,u),t.moment=moment}]);
angular.module("app").controller("mapCtrl",["$scope","$state","Map",function(a,p,l){l("map-canvas")}]);
angular.module("app").service("Background",function(){function n(n,t){function c(t){g=t,n.background=g}return n.background=g,n.$on("$stateChangeSuccess",function(c,o,a,e,r){o.name===t.current.name&&g!==n.background&&(n.background=g)}),{set:c}}function t(){return r}function c(n,t){o(),a(n,t),g=localStorage.userBackground||r[0]}function o(){var n=localStorage.backgrounds;n&&(n=n.split(" "),r.concat(n))}function a(n,t){function c(n,t){var c="http://wallpaperscraft.ru/image/priroda_gory_nebo_ozero_oblaka_81150_1920x1080.jpg",a="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQEyIqhnqQgXLoL_Ho76-rXQvB5cKI_gyEHPgGYgp8nQC6OCGql",e="https://encrypted-tbn3.gstatic.com/images?q=tbn:ANd9GcRX6J0BQoXqYPAoZNh2lq855jb7DcPb2oK6gMgK3lgTmgj8jsHL",r="https://encrypted-tbn2.gstatic.com/images?q=tbn:ANd9GcSzgt2HXZ6g3jnJoUezcxqob8xLQmDyUlNG3CDICeeQ7td06a4a",g=[c,a,e,r];o(g)}function o(n){r=r||[],r=r.concat(n)}c(n,t)}function e(n){return g===n}var r,g;return c(),{setup:n,list:t,isSelected:e}});
angular.module("app").service("Location",["UserData",function(n){var a,o=n();return o&&(a=o.location),function(n){return n?void(a=n):a}}]);
angular.module("app").service("UserData",function(){function r(){if(!n){var r=localStorage.ew_user;console.log(r),r&&(n=JSON.parse(r))}return n}function e(r){n=r,localStorage.ew_user=JSON.stringify(n)}var n;return function(o){return o?void e(o):n=r()}});
angular.module("app").service("Weather",["$http","config",function(n,r){function o(o,t){return new Promise(function(e,i){function u(){function n(){for(var n="/"+t+"/q",r=["country","state","city"],e=0;e<r.length;e++){var i=r[e];o[i]&&o[i].length>0&&(n+="/"+o[i])}return n+".json"}var e=n(),i="http://api.wunderground.com/api/"+r.wundergroundApiKey+e;return i}function a(n){function r(){return{condition:u.condition,icon:u.icon_url,date:new Date(1e3*u.FCTTIME.epoch)}}var o=[],t=n.data.hourly_forecast;if(!t)return void c(n.data.response);for(var i=0;i<t.length;i++){var u=t[i],a=r();o.push(a)}e(o)}function c(n){i(n.error?error.description:"Geo info is not enough"),i(error)}var f=u();n.get(f).then(a,c)})}return o}]);
angular.module("app").service("config",function(){return{openWeatherApiKey:"7d7815cd5721b778c79d97dff92ea533",wundergroundApiKey:"a7f3e44e9dfd4036"}});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImRpcmVjdGl2ZXMuanMiLCJyb3V0ZXMuanMiLCJjb250cm9sbGVycy9BZGRFbW9qaUN0cmwuanMiLCJjb250cm9sbGVycy9CYWNrZ3JvdW5kU2VsZWN0aW9uQ3RybC5qcyIsImNvbnRyb2xsZXJzL0Vycm9yQ3RybC5qcyIsImNvbnRyb2xsZXJzL0hvdXJseUZvcmVjYXN0Q3RybC5qcyIsImNvbnRyb2xsZXJzL0xvZ2luQ3RybC5qcyIsImNvbnRyb2xsZXJzL01haW5QYWdlQ3RybC5qcyIsImNvbnRyb2xsZXJzL01lbnVDdHJsLmpzIiwiY29udHJvbGxlcnMvT3ZlcnZpZXdDdHJsLmpzIiwiY29udHJvbGxlcnMvUHJldmlld0N0cmwuanMiLCJjb250cm9sbGVycy9TZWFyY2hDdHJsLmpzIiwiY29udHJvbGxlcnMvV2Vla2x5Rm9yZWNhc3RDdHJsLmpzIiwiY29udHJvbGxlcnMvbWFwQ3RybC5qcyIsInNlcnZpY2VzL0JhY2tyb3VuZC5qcyIsInNlcnZpY2VzL0xvY2F0aW9uLmpzIiwic2VydmljZXMvVXNlckRhdGEuanMiLCJzZXJ2aWNlcy9XZWF0aGVyLmpzIiwic2VydmljZXMvY29uZmlnLmpzIl0sIm5hbWVzIjpbImFuZ3VsYXIiLCJtb2R1bGUiLCJydW4iLCIkaW9uaWNQbGF0Zm9ybSIsInJlYWR5Iiwid2luZG93IiwiY29yZG92YSIsInBsdWdpbnMiLCJLZXlib2FyZCIsImhpZGVLZXlib2FyZEFjY2Vzc29yeUJhciIsImRpc2FibGVTY3JvbGwiLCJTdGF0dXNCYXIiLCJzdHlsZURlZmF1bHQiLCJkaXJlY3RpdmUiLCJyZXN0cmljdCIsImxpbmsiLCIkc2NvcGUiLCIkZWxlbWVudCIsIiRhdHRycyIsIiRicm9hZGNhc3QiLCJjb21waWxlIiwiaHRtbCIsImNvbmZpZyIsIiRzdGF0ZVByb3ZpZGVyIiwiJHVybFJvdXRlclByb3ZpZGVyIiwic3RhdGUiLCJ1cmwiLCJ0ZW1wbGF0ZVVybCIsImNvbnRyb2xsZXIiLCJvdGhlcndpc2UiLCIkc3RhdGUiLCJCYWNrZ3JvdW5kIiwic2V0dXAiLCJiYWNrZ3JvdW5kU2V0dGluZ3MiLCJiYWNrZ3JvdW5kcyIsImxpc3QiLCJzZWxlY3QiLCJpdGVtIiwic2V0IiwiaXNTZWxlY3RlZCIsIldlYXRoZXIiLCJVc2VyRGF0YSIsInN1Y2Nlc3MiLCJyZXNwb25zZSIsImhvdXJseUZvcmVjYXN0IiwiZXJyb3IiLCJlIiwidXNlciIsImxvY2F0aW9uIiwidGhlbiIsIm1vbWVudCIsIkxvY2F0aW9uIiwibmFtZSIsImNvdW50cnkiLCJjaXR5Iiwic3VibWl0IiwiJHN0YXRlUGFyYW1zIiwiJGlvbmljUG9wdXAiLCJ1cGRhdGUiLCJyZXNwb3NlIiwiYWxlcnQiLCJ0aXRsZSIsInRlbXBsYXRlIiwidXNlcm5hbWUiLCJzZXRJbnRlcnZhbCIsImRhdGUiLCJEYXRlIiwiJGFwcGx5IiwiJG9uIiwiZXZlbnQiLCJ0b1N0YXRlIiwidG9QYXJhbXMiLCJmcm9tU3RhdGUiLCJmcm9tUGFyYW1zIiwiZ28iLCJzb3J0QnlEYXlzIiwiZ2V0S2V5Rm9yIiwiZm9ybWF0IiwiZGF5cyIsImkiLCJsZW5ndGgiLCJrZXkiLCJwdXNoIiwiZm9yZWNhc3QiLCJNYXAiLCJzZXJ2aWNlIiwic2NvcGUiLCJiYWNrZ3JvdW5kIiwiX2JhY2tncm91bmQiLCJjdXJyZW50IiwiX2JhY2tncm91bmRzIiwibG9hZCIsImxvYWRVc2VyQmFja3JvdW5kcyIsImxvYWRBcHBCYWNrZ3JvdW5kcyIsImxvY2FsU3RvcmFnZSIsInVzZXJCYWNrZ3JvdW5kIiwic3BsaXQiLCJjb25jYXQiLCJyZXF1ZXN0IiwiaTEiLCJpMiIsImkzIiwiaTQiLCJ1c2VSZXNwb25zZSIsImRhdGEiLCJnZXREYXRhIiwidXNlckluZm8iLCJld191c2VyIiwiY29uc29sZSIsImxvZyIsIkpTT04iLCJwYXJzZSIsInNldERhdGEiLCJzdHJpbmdpZnkiLCIkaHR0cCIsIndlYXRoZXIiLCJxdWVyeSIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwiZ2V0VVJMIiwiZ2V0UXVlcnlTdHJpbmciLCJyZXN1bHQiLCJmaWVsZHMiLCJmaWVsZCIsInF1ZXJ5U3RyaW5nIiwid3VuZGVyZ3JvdW5kQXBpS2V5IiwiZ2V0Rm9yZWNhc3QiLCJjb25kaXRpb24iLCJpY29uIiwiaWNvbl91cmwiLCJGQ1RUSU1FIiwiZXBvY2giLCJpdGVtcyIsImhvdXJseV9mb3JlY2FzdCIsInVzZUVycm9yIiwiZGVzY3JpcHRpb24iLCJnZXQiLCJvcGVuV2VhdGhlckFwaUtleSJdLCJtYXBwaW5ncyI6IkFBT0FBLFFBQVFDLE9BQU8sT0FBUSxRQUFTLGFBQWMsbUJBRTdDQyxLQUFBLGlCQUFJLFNBQVNDLEdBQ1pBLEVBQWVDLE1BQU0sV0FHZkMsT0FBT0MsU0FBV0QsT0FBT0MsUUFBUUMsU0FBV0YsT0FBT0MsUUFBUUMsUUFBUUMsV0FDckVGLFFBQVFDLFFBQVFDLFNBQVNDLDBCQUF5QixHQUNsREgsUUFBUUMsUUFBUUMsU0FBU0UsZUFBYyxJQUVyQ0wsT0FBT00sV0FFVEEsVUFBVUM7QUNuQmhCWixRQUFRQyxPQUFPLHFCQUVkWSxVQUFVLGtCQUFtQixlQUs3QkEsVUFBVSxhQUFjLFdBQ3ZCLE9BQ0VDLFNBQVUsSUFDVkMsS0FBTSxTQUFVQyxFQUFRQyxFQUFVQyxHQUNqQ0YsRUFBT0csV0FBVyxrQkFFbkJDLFFBQVMsU0FBU0gsRUFBVUMsR0FDMUJELEVBQVNJLEtBQ1A7QUNmUnJCLFFBQVFDLE9BQU8saUJBRWRxQixRQUFBLGlCQUFBLHFCQUFPLFNBQVNDLEVBQWdCQyxHQU0vQkQsRUFJS0UsTUFBTSxZQUNUQyxJQUFLLFlBQ0xDLFlBQWEsMEJBQ2JDLFdBQVksaUJBR2JILE1BQU0sU0FDTEMsSUFBSyxTQUNMQyxZQUFhLHVCQUNiQyxXQUFZLGNBR2JILE1BQU0sV0FDTEMsSUFBSyxXQUNMQyxZQUFhLHlCQUNiQyxXQUFZLGdCQUdiSCxNQUFNLFNBQ0xDLElBQUssZUFDTEMsWUFBYSx1QkFDYkMsV0FBWSxjQUdiSCxNQUFNLFFBQ0xDLElBQUssZUFDTEMsWUFBYSxzQkFDYkMsV0FBWSxhQUdiSCxNQUFN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QUFJMUUsRUFBUzRFLElBR3hCLE1BQU9GLEdBQVMsUUFkcEIsR0FBSUcsR0FBY0osSUFDZC9GLEVBQU0sbUNBQW1DSixFQUFPd0csbUJBQW1CRCxDQUNwRSxPQUFPbkcsR0FnQlgsUUFBUzZFLEdBQVk1RCxHQVduQixRQUFTb0YsS0FDUixPQUNDQyxVQUFXM0YsRUFBSzJGLFVBQ2hCQyxLQUFNNUYsRUFBSzZGLFNBQ1hqRSxLQUFNLEdBQUlDLE1BQXlCLElBQW5CN0IsRUFBSzhGLFFBQVFDLFFBZGhDLEdBQUlWLE1BQ0FXLEVBQVExRixFQUFTNkQsS0FBSzhCLGVBQzFCLEtBQUlELEVBRUgsV0FEQUUsR0FBUzVGLEVBQVM2RCxLQUFLN0QsU0FHeEIsS0FBSSxHQUFJb0MsR0FBSSxFQUFHQSxFQUFHc0QsRUFBTXJELE9BQVFELElBQUssQ0FDcEMsR0FBSTFDLEdBQU9nRyxFQUFNdEQsR0FDYkksRUFBVzRDLEdBQ2ZMLEdBQU94QyxLQUFLQyxHQVNibUMsRUFBUUksR0FFVCxRQUFTYSxHQUFTekYsR0FFaEJ5RSxFQURFekUsRUFBRUQsTUFDR0EsTUFBTTJGLFlBRU4sMEJBRVJqQixFQUFPMUUsT0FqRFIsR0FBSW5CLEdBQU04RixHQUNWTixHQUFNdUIsSUFBSS9HLEdBQUt1QixLQUFLc0QsRUFBYWdDLEtBcURuQyxNQUFPcEI7QUMxRFJuSCxRQUFRQyxPQUFPLE9BRWRvRixRQUFRLFNBQVUsV0FDbEIsT0FDQ3FELGtCQUFtQixtQ0FDbkJaLG1CQUFvQiIsImZpbGUiOiJ3d3cvYXBwLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vIElvbmljIFN0YXJ0ZXIgQXBwXG5cbi8vIGFuZ3VsYXIubW9kdWxlIGlzIGEgZ2xvYmFsIHBsYWNlIGZvciBjcmVhdGluZywgcmVnaXN0ZXJpbmcgYW5kIHJldHJpZXZpbmcgQW5ndWxhciBtb2R1bGVzXG4vLyAnc3RhcnRlcicgaXMgdGhlIG5hbWUgb2YgdGhpcyBhbmd1bGFyIG1vZHVsZSBleGFtcGxlIChhbHNvIHNldCBpbiBhIDxib2R5PiBhdHRyaWJ1dGUgaW4gaW5kZXguaHRtbClcbi8vIHRoZSAybmQgcGFyYW1ldGVyIGlzIGFuIGFycmF5IG9mICdyZXF1aXJlcydcbi8vICdzdGFydGVyLnNlcnZpY2VzJyBpcyBmb3VuZCBpbiBzZXJ2aWNlcy5qc1xuLy8gJ3N0YXJ0ZXIuY29udHJvbGxlcnMnIGlzIGZvdW5kIGluIGNvbnRyb2xsZXJzLmpzXG5hbmd1bGFyLm1vZHVsZSgnYXBwJywgWydpb25pYycsICdhcHAucm91dGVzJywgJ2FwcC5kaXJlY3RpdmVzJ10pXG5cbi5ydW4oZnVuY3Rpb24oJGlvbmljUGxhdGZvcm0pIHtcbiAgJGlvbmljUGxhdGZvcm0ucmVhZHkoZnVuY3Rpb24oKSB7XG4gICAgLy8gSGlkZSB0aGUgYWNjZXNzb3J5IGJhciBieSBkZWZhdWx0IChyZW1vdmUgdGhpcyB0byBzaG93IHRoZSBhY2Nlc3NvcnkgYmFyIGFib3ZlIHRoZSBrZXlib2FyZFxuICAgIC8vIGZvciBmb3JtIGlucHV0cylcbiAgICBpZiAod2luZG93LmNvcmRvdmEgJiYgd2luZG93LmNvcmRvdmEucGx1Z2lucyAmJiB3aW5kb3cuY29yZG92YS5wbHVnaW5zLktleWJvYXJkKSB7XG4gICAgICBjb3Jkb3ZhLnBsdWdpbnMuS2V5Ym9hcmQuaGlkZUtleWJvYXJkQWNjZXNzb3J5QmFyKHRydWUpO1xuICAgICAgY29yZG92YS5wbHVnaW5zLktleWJvYXJkLmRpc2FibGVTY3JvbGwodHJ1ZSk7XG4gICAgfVxuICAgIGlmICh3aW5kb3cuU3RhdHVzQmFyKSB7XG4gICAgICAvLyBvcmcuYXBhY2hlLmNvcmRvdmEuc3RhdHVzYmFyIHJlcXVpcmVkXG4gICAgICBTdGF0dXNCYXIuc3R5bGVEZWZhdWx0KCk7XG4gICAgfVxuICB9KTtcbn0pIiwiYW5ndWxhci5tb2R1bGUoJ2FwcC5kaXJlY3RpdmVzJywgW10pXG5cbi5kaXJlY3RpdmUoJ2JsYW5rRGlyZWN0aXZlJywgW2Z1bmN0aW9uKCl7XG5cbn1dKVxuXG5cbi5kaXJlY3RpdmUoJ2JhY2tncm91bmQnLCBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIHtcbiAgICByZXN0cmljdDogJ0EnLFxuICAgIGxpbms6IGZ1bmN0aW9uICgkc2NvcGUsICRlbGVtZW50LCAkYXR0cnMpIHtcbiAgICBcdCRzY29wZS4kYnJvYWRjYXN0KCdzY3JvbGwucmVzaXplJyk7XG4gICAgfSxcbiAgICBjb21waWxlOiBmdW5jdGlvbigkZWxlbWVudCwgJGF0dHJzKSB7XG4gICAgICAkZWxlbWVudC5odG1sKFxuICAgICAgICAnPGRpdiBjbGFzcyA9IFwiYmFja2dyb3VuZFwiIHN0eWxlID0gXCJiYWNrZ3JvdW5kLWltYWdlOiB1cmwoe3tiYWNrZ3JvdW5kfX0pO1wiPjwvZGl2PidcbiAgICAgICk7ICAgIFxuICAgIH1cbiAgfVxufSkiLCJhbmd1bGFyLm1vZHVsZSgnYXBwLnJvdXRlcycsIFtdKVxuXG4uY29uZmlnKGZ1bmN0aW9uKCRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIpIHtcblxuICAvLyBJb25pYyB1c2VzIEFuZ3VsYXJVSSBSb3V0ZXIgd2hpY2ggdXNlcyB0aGUgY29uY2VwdCBvZiBzdGF0ZXNcbiAgLy8gTGVhcm4gbW9yZSBoZXJlOiBodHRwczovL2dpdGh1Yi5jb20vYW5ndWxhci11aS91aS1yb3V0ZXJcbiAgLy8gU2V0IHVwIHRoZSB2YXJpb3VzIHN0YXRlcyB3aGljaCB0aGUgYXBwIGNhbiBiZSBpbi5cbiAgLy8gRWFjaCBzdGF0ZSdzIGNvbnRyb2xsZXIgY2FuIGJlIGZvdW5kIGluIGNvbnRyb2xsZXJzLmpzXG4gICRzdGF0ZVByb3ZpZGVyXG4gICAgXG4gIFxuXG4gICAgICAuc3RhdGUoJ292ZXJ2aWV3Jywge1xuICAgIHVybDogJy9vdmVydmlldycsXG4gICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvb3ZlcnZpZXcuaHRtbCcsXG4gICAgY29udHJvbGxlcjogJ292ZXJ2aWV3Q3RybCdcbiAgfSlcblxuICAuc3RhdGUoJ2xvZ2luJywge1xuICAgIHVybDogJy9sb2dpbicsXG4gICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvbG9naW4uaHRtbCcsXG4gICAgY29udHJvbGxlcjogJ2xvZ2luQ3RybCdcbiAgfSlcblxuICAuc3RhdGUoJ3ByZXZpZXcnLCB7XG4gICAgdXJsOiAnL3ByZXZpZXcnLFxuICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL3ByZXZpZXcuaHRtbCcsXG4gICAgY29udHJvbGxlcjogJ3ByZXZpZXdDdHJsJ1xuICB9KVxuXG4gIC5zdGF0ZSgnZXJyb3InLCB7XG4gICAgdXJsOiAnL2xvZ2luX2Vycm9yJyxcbiAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy9lcnJvci5odG1sJyxcbiAgICBjb250cm9sbGVyOiAnZXJyb3JDdHJsJ1xuICB9KVxuXG4gIC5zdGF0ZSgnbWFpbicsIHtcbiAgICB1cmw6ICcvbWFpbl9zY3JlZW4nLFxuICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL21haW4uaHRtbCcsXG4gICAgY29udHJvbGxlcjogJ21haW5DdHJsJ1xuICB9KVxuXG4gIC5zdGF0ZSgnbWVudScsIHtcbiAgICB1cmw6ICcvbWVudScsXG4gICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvbWVudS5odG1sJyxcbiAgICBjb250cm9sbGVyOiAnbWVudUN0cmwnXG4gIH0pXG5cbiAgLnN0YXRlKCd3ZWVrbHlGb3JlY2FzdCcsIHtcbiAgICB1cmw6ICcvd2Vla2x5JyxcbiAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy93ZWVrbHlGb3JlY2FzdC5odG1sJyxcbiAgICBjb250cm9sbGVyOiAnd2Vla2x5Rm9yZWNhc3RDdHJsJ1xuICB9KVxuXG4gIC5zdGF0ZSgnaG91cmx5Rm9yZWNhc3QnLCB7XG4gICAgdXJsOiAnL2hvdXJseScsXG4gICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvaG91cmx5Rm9yZWNhc3QuaHRtbCcsXG4gICAgY29udHJvbGxlcjogJ2hvdXJseUZvcmVjYXN0Q3RybCdcbiAgfSlcblxuICAuc3RhdGUoJ21hcCcsIHtcbiAgICB1cmw6ICcvbWFwJyxcbiAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy9tYXAuaHRtbCcsXG4gICAgY29udHJvbGxlcjogJ21hcEN0cmwnXG4gIH0pXG5cbiAgLnN0YXRlKCdhZGRFbW9qaXMnLCB7XG4gICAgdXJsOiAnL2FkZF9lbW9qaXMnLFxuICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL2FkZEVtb2ppcy5odG1sJyxcbiAgICBjb250cm9sbGVyOiAnYWRkRW1vamlzQ3RybCdcbiAgfSlcblxuICAuc3RhdGUoJ3NlYXJjaCcsIHtcbiAgICB1cmw6ICcvc2VhcmNoJyxcbiAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy9zZWFyY2guaHRtbCcsXG4gICAgY29udHJvbGxlcjogJ3NlYXJjaEN0cmwnXG4gIH0pXG5cbiAgLnN0YXRlKCdiYWNrZ3JvdW5kU2VsZWN0aW9uJywge1xuICAgIHVybDogJy9wYWdlMTInLFxuICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL2JhY2tncm91bmRTZWxlY3Rpb24uaHRtbCcsXG4gICAgY29udHJvbGxlcjogJ2JhY2tncm91bmRTZWxlY3Rpb25DdHJsJ1xuICB9KVxuXG4kdXJsUm91dGVyUHJvdmlkZXIub3RoZXJ3aXNlKCcvb3ZlcnZpZXcnKVxuXG4gIFxuXG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcblxuICAgXG4uY29udHJvbGxlcignYWRkRW1vamlzQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgJHN0YXRlLCBCYWNrZ3JvdW5kKSB7XG5cdEJhY2tncm91bmQuc2V0dXAoJHNjb3BlLCAkc3RhdGUpO1xuXG59KSIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuXG4gICBcbi5jb250cm9sbGVyKCdiYWNrZ3JvdW5kU2VsZWN0aW9uQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgJHN0YXRlLCBCYWNrZ3JvdW5kKSB7XG5cdHZhciBiYWNrZ3JvdW5kU2V0dGluZ3MgPSBCYWNrZ3JvdW5kLnNldHVwKCRzY29wZSwgJHN0YXRlKTtcblx0JHNjb3BlLmJhY2tncm91bmRzID0gQmFja2dyb3VuZC5saXN0KCk7XG5cdCRzY29wZS5zZWxlY3QgPSBmdW5jdGlvbihpdGVtKSB7XG5cdFx0YmFja2dyb3VuZFNldHRpbmdzLnNldChpdGVtKTtcblx0fVxuXHQkc2NvcGUuaXNTZWxlY3RlZCA9IGZ1bmN0aW9uKCBpdGVtICkge1xuXHRcdHJldHVybiBCYWNrZ3JvdW5kLmlzU2VsZWN0ZWQoaXRlbSk/IFwiYmFja2dyb3VuZC1zZWxlY3RlZFwiOiBcIlwiO1xuXHR9XG5cbn0pXG4gIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG5cbiAgIFxuLmNvbnRyb2xsZXIoJ2Vycm9yQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSkge1xuXG59KVxuICAgIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG5cbi5jb250cm9sbGVyKCdob3VybHlGb3JlY2FzdEN0cmwnLCBmdW5jdGlvbigkc2NvcGUsICRzdGF0ZSwgQmFja2dyb3VuZCwgV2VhdGhlciwgVXNlckRhdGEpIHtcblx0QmFja2dyb3VuZC5zZXR1cCgkc2NvcGUsICRzdGF0ZSk7XG5cdHZhciB1c2VyID0gVXNlckRhdGEoKTtcblx0V2VhdGhlcih1c2VyLmxvY2F0aW9uLCAnaG91cmx5JykudGhlbihzdWNjZXNzLCBlcnJvcik7XG5cdCRzY29wZS5tb21lbnQgPSBtb21lbnQ7XG5cdGZ1bmN0aW9uIHN1Y2Nlc3MocmVzcG9uc2UpIHtcblx0XHQkc2NvcGUuaG91cmx5Rm9yZWNhc3QgPSByZXNwb25zZTtcblx0fSBcblx0ZnVuY3Rpb24gZXJyb3IoZSkge1xuXG5cdH1cblxufSlcbiAgICIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuICBcbiAgXG4uY29udHJvbGxlcignbG9naW5DdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkc3RhdGUsIEJhY2tncm91bmQsIFVzZXJEYXRhLCBMb2NhdGlvbikge1xuXHRCYWNrZ3JvdW5kLnNldHVwKCRzY29wZSwgJHN0YXRlKTtcblx0JHNjb3BlLnVzZXIgPSB7XG5cdFx0bmFtZTogXCJuaWtcIixcblxuXHRcdGxvY2F0aW9uOiB7XG5cdFx0XHRzdGF0ZTogXCJzaWJlcmlhXCIsXG5cdFx0XHRjb3VudHJ5OiBcInJ1c3NpYVwiLFxuXHRcdFx0Y2l0eTogXCJvbXNrXCJcblx0XHR9XG5cdH1cblx0JHNjb3BlLnN1Ym1pdCA9IGZ1bmN0aW9uKCkge1xuXHRcdFVzZXJEYXRhKCRzY29wZS51c2VyKTtcblx0XHRMb2NhdGlvbigkc2NvcGUudXNlci5sb2NhdGlvbik7XG5cdH1cbn0pIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4gIFxuLmNvbnRyb2xsZXIoJ21haW5DdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkc3RhdGUsIEJhY2tncm91bmQsICRzdGF0ZVBhcmFtcywgVXNlckRhdGEsIFdlYXRoZXIsIExvY2F0aW9uLCAkaW9uaWNQb3B1cCkge1xuXHRCYWNrZ3JvdW5kLnNldHVwKCRzY29wZSwgJHN0YXRlKTtcblxuXHQkc2NvcGUuJG9uKFwiJHN0YXRlQ2hhbmdlU3VjY2Vzc1wiLCBmdW5jdGlvbihldmVudCwgdG9TdGF0ZSwgdG9QYXJhbXMsIGZyb21TdGF0ZSwgZnJvbVBhcmFtcykge1xuXHQgICAgaWYgKHRvU3RhdGUubmFtZSA9PT0gXCJtYWluXCIpIHsgXG5cdCAgICBcdHVwZGF0ZSgpO1xuXHQgICAgfVxuXHR9KTtcblx0XG5cdGZ1bmN0aW9uIHVwZGF0ZSgpIHtcblx0XHQkc2NvcGUubW9tZW50ID0gbW9tZW50OyBcblx0XHR2YXIgdXNlciA9IFVzZXJEYXRhKCk7XG5cdFx0JHNjb3BlLnVzZXJuYW1lID0gdXNlci5uYW1lO1xuXHRcdCRzY29wZS5sb2NhdGlvbiA9IExvY2F0aW9uKCk7XG5cdFx0dmFyIHRpbWUgPSBzZXRJbnRlcnZhbChmdW5jdGlvbigpe1xuXHRcdFx0JHNjb3BlLmRhdGUgPSBuZXcgRGF0ZSgpO1xuXHRcdFx0JHNjb3BlLiRhcHBseSgpO1xuXHRcdH0sIDEwMDApO1xuXHRcdFdlYXRoZXIoJHNjb3BlLmxvY2F0aW9uLCBcImhvdXJseVwiKS50aGVuKHN1Y2Nlc3MsIGVycm9yKTtcblxuXHRcdGZ1bmN0aW9uIHN1Y2Nlc3MocmVzcG9zZSkge1xuXHRcdFx0JHNjb3BlLmhvdXJseUZvcmVjYXN0ID0gcmVzcG9zZTtcblx0XHR9XG5cblx0XHRmdW5jdGlvbiBlcnJvcihlKSB7XG5cdFx0XHQkaW9uaWNQb3B1cC5hbGVydCh7dGl0bGU6IFwiV2FybmluZ1wiLCB0ZW1wbGF0ZTogZX0pXG5cdFx0fVxuXHR9XG5cblxufSkiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcblxuICAgXG4uY29udHJvbGxlcignbWVudUN0cmwnLCBmdW5jdGlvbigkc2NvcGUsICRzdGF0ZSwgQmFja2dyb3VuZCkge1xuXHRCYWNrZ3JvdW5kLnNldHVwKCRzY29wZSwgJHN0YXRlKTtcbn0pXG4gICAiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbiAgXG4uY29udHJvbGxlcignb3ZlcnZpZXdDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkc3RhdGUsIEJhY2tncm91bmQsIFVzZXJEYXRhKSB7XG5cdEJhY2tncm91bmQuc2V0dXAoJHNjb3BlLCAkc3RhdGUpO1xuXHRpZihVc2VyRGF0YSgpKSB7XG5cdFx0JHN0YXRlLmdvKCdtYWluJyk7XG5cdH1cbn0pIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG5cbiAgIFxuLmNvbnRyb2xsZXIoJ3ByZXZpZXdDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkc3RhdGUsIEJhY2tncm91bmQsIFVzZXJEYXRhKSB7XG5cdEJhY2tncm91bmQuc2V0dXAoJHNjb3BlLCAkc3RhdGUpO1xuXHQkc2NvcGUudXNlciA9IFVzZXJEYXRhKCk7XG5cdCRzY29wZS5zdWJtaXQgPSBmdW5jdGlvbigpIHtcblx0XHQkc3RhdGUuZ28oJ21haW4nKTtcblx0fVxufSkiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcblxuICAgXG4uY29udHJvbGxlcignc2VhcmNoQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgJHN0YXRlLCBCYWNrZ3JvdW5kLCBMb2NhdGlvbikge1xuXHRCYWNrZ3JvdW5kLnNldHVwKCRzY29wZSwgJHN0YXRlKTtcblx0JHNjb3BlLmxvY2F0aW9uID0ge1xuXHRcdHN0YXRlOiBcIlwiLFxuXHRcdGNvdW50cnk6IFwiXCIsXG5cdFx0Y2l0eTogXCJcIlxuXHR9XG5cdCRzY29wZS5zdWJtaXQgPSBmdW5jdGlvbigpIHtcblx0XHRMb2NhdGlvbigkc2NvcGUubG9jYXRpb24pO1xuXHR9XG59KSIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuXG4uY29udHJvbGxlcignd2Vla2x5Rm9yZWNhc3RDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkc3RhdGUsIEJhY2tncm91bmQsIFdlYXRoZXIsIFVzZXJEYXRhKSB7XG5cdEJhY2tncm91bmQuc2V0dXAoJHNjb3BlLCAkc3RhdGUpO1xuXHR2YXIgdXNlciA9IFVzZXJEYXRhKCk7XG5cdFdlYXRoZXIodXNlci5sb2NhdGlvbiwgJ2hvdXJseTEwZGF5JykudGhlbihzdWNjZXNzLCBlcnJvcik7XG5cdCRzY29wZS5tb21lbnQgPSBtb21lbnQ7XG5cblx0ZnVuY3Rpb24gc3VjY2VzcyhyZXNwb25zZSkge1xuXHRcdCRzY29wZS5mb3JlY2FzdCA9IHNvcnRCeURheXMocmVzcG9uc2UpO1xuXG5cdFx0ZnVuY3Rpb24gc29ydEJ5RGF5cyhsaXN0KSB7XG5cdFx0XHR2YXIgZGF5cyA9IHt9O1xuXHRcdFx0dmFyIGN1cnJlbnRLZXk7XG5cdFx0XHRmb3IodmFyIGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHR2YXIgaXRlbSA9IGxpc3RbaV07XG5cdFx0XHRcdHZhciBrZXkgPSBnZXRLZXlGb3IoaXRlbSk7XG5cdFx0XHRcdGRheXNba2V5XSA9IGRheXNba2V5XSB8fCBbXTtcblxuXHRcdFx0XHRkYXlzW2tleV0ucHVzaChpdGVtKTtcblx0XHRcdH1cblx0XHRcdHJldHVybiBkYXlzO1xuXG5cdFx0XHRmdW5jdGlvbiBnZXRLZXlGb3IoIGl0ZW0gKSB7XG5cdFx0XHRcdHJldHVybiBtb21lbnQoaXRlbS5kYXRlKS5mb3JtYXQoXCJkZGRcIik7XHRcdFx0XHRcblx0XHRcdH1cblx0XHR9XG5cdH0gXG5cdGZ1bmN0aW9uIGVycm9yKGUpIHtcblxuXHR9XG5cbn0pIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG5cbiAgIFxuLmNvbnRyb2xsZXIoJ21hcEN0cmwnLCBmdW5jdGlvbigkc2NvcGUsICRzdGF0ZSwgTWFwKSB7XG5cdE1hcCgnbWFwLWNhbnZhcycpO1xuXHQvLyBmdW5jdGlvbiBnZXRDb29yZHMoKSB7XG5cdC8vICAgICB2YXIgYm91bmRzID0gbWFwLmdldEJvdW5kcygpO1xuXHQvLyAgICAgdmFyIE5FID0gYm91bmRzLmdldE5vcnRoRWFzdCgpO1xuXHQvLyAgICAgdmFyIFNXID0gYm91bmRzLmdldFNvdXRoV2VzdCgpO1xuXHQvLyAgICAgTWFwKE5FLmxhdCgpLCBORS5sbmcoKSwgU1cubGF0KCksIFNXLmxuZygpKTtcblx0Ly8gfTtcblx0ICBcblx0Ly8gICBmdW5jdGlvbiBpbml0aWFsaXplKCkge1xuXG5cdC8vICAgICAvLyBBZGQgaW50ZXJhY3Rpb24gbGlzdGVuZXJzIHRvIG1ha2Ugd2VhdGhlciByZXF1ZXN0c1xuXG5cdC8vICAgICAvLyBTZXRzIHVwIGFuZCBwb3B1bGF0ZXMgdGhlIGluZm8gd2luZG93IHdpdGggZGV0YWlsc1xuXHQvLyAgICAgbWFwLmRhdGEuYWRkTGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZXZlbnQpIHtcblx0Ly8gICAgICAgaW5mb3dpbmRvdy5zZXRDb250ZW50KFxuXHQvLyAgICAgICAgXCI8aW1nIHNyYz1cIiArIGV2ZW50LmZlYXR1cmUuZ2V0UHJvcGVydHkoXCJpY29uXCIpICsgXCI+XCJcblx0Ly8gICAgICAgICsgXCI8YnIgLz48c3Ryb25nPlwiICsgZXZlbnQuZmVhdHVyZS5nZXRQcm9wZXJ0eShcImNpdHlcIikgKyBcIjwvc3Ryb25nPlwiXG5cdC8vICAgICAgICArIFwiPGJyIC8+XCIgKyBldmVudC5mZWF0dXJlLmdldFByb3BlcnR5KFwidGVtcGVyYXR1cmVcIikgKyBcIiZkZWc7Q1wiXG5cdC8vICAgICAgICArIFwiPGJyIC8+XCIgKyBldmVudC5mZWF0dXJlLmdldFByb3BlcnR5KFwid2VhdGhlclwiKVxuXHQvLyAgICAgICAgKTtcblx0Ly8gICAgICAgaW5mb3dpbmRvdy5zZXRPcHRpb25zKHtcblx0Ly8gICAgICAgICAgIHBvc2l0aW9uOntcblx0Ly8gICAgICAgICAgICAgbGF0OiBldmVudC5sYXRMbmcubGF0KCksXG5cdC8vICAgICAgICAgICAgIGxuZzogZXZlbnQubGF0TG5nLmxuZygpXG5cdC8vICAgICAgICAgICB9LFxuXHQvLyAgICAgICAgICAgcGl4ZWxPZmZzZXQ6IHtcblx0Ly8gICAgICAgICAgICAgd2lkdGg6IDAsXG5cdC8vICAgICAgICAgICAgIGhlaWdodDogLTE1XG5cdC8vICAgICAgICAgICB9XG5cdC8vICAgICAgICAgfSk7XG5cdC8vICAgICAgIGluZm93aW5kb3cub3BlbihtYXApO1xuXHQvLyAgICAgfSk7XG5cdC8vICAgfVxuXG5cblx0Ly8gICAvLyBHZXQgdGhlIGNvb3JkaW5hdGVzIGZyb20gdGhlIE1hcCBib3VuZHNcblxuXG5cdC8vICAgdmFyIGluZm93aW5kb3cgPSBuZXcgZ29vZ2xlLm1hcHMuSW5mb1dpbmRvdygpO1xuXG5cdC8vICAgLy8gRm9yIGVhY2ggcmVzdWx0IHRoYXQgY29tZXMgYmFjaywgY29udmVydCB0aGUgZGF0YSB0byBnZW9KU09OXG5cdC8vICAgdmFyIGpzb25Ub0dlb0pzb24gPSBmdW5jdGlvbiAod2VhdGhlckl0ZW0pIHtcblx0Ly8gICAgIHZhciBmZWF0dXJlID0ge1xuXHQvLyAgICAgICB0eXBlOiBcIkZlYXR1cmVcIixcblx0Ly8gICAgICAgcHJvcGVydGllczoge1xuXHQvLyAgICAgICAgIGNpdHk6IHdlYXRoZXJJdGVtLm5hbWUsXG5cdC8vICAgICAgICAgd2VhdGhlcjogd2VhdGhlckl0ZW0ud2VhdGhlclswXS5tYWluLFxuXHQvLyAgICAgICAgIHRlbXBlcmF0dXJlOiB3ZWF0aGVySXRlbS5tYWluLnRlbXAsXG5cdC8vICAgICAgICAgbWluOiB3ZWF0aGVySXRlbS5tYWluLnRlbXBfbWluLFxuXHQvLyAgICAgICAgIG1heDogd2VhdGhlckl0ZW0ubWFpbi50ZW1wX21heCxcblx0Ly8gICAgICAgICBodW1pZGl0eTogd2VhdGhlckl0ZW0ubWFpbi5odW1pZGl0eSxcblx0Ly8gICAgICAgICBwcmVzc3VyZTogd2VhdGhlckl0ZW0ubWFpbi5wcmVzc3VyZSxcblx0Ly8gICAgICAgICB3aW5kU3BlZWQ6IHdlYXRoZXJJdGVtLndpbmQuc3BlZWQsXG5cdC8vICAgICAgICAgd2luZERlZ3JlZXM6IHdlYXRoZXJJdGVtLndpbmQuZGVnLFxuXHQvLyAgICAgICAgIHdpbmRHdXN0OiB3ZWF0aGVySXRlbS53aW5kLmd1c3QsXG5cdC8vICAgICAgICAgaWNvbjogXCJodHRwOi8vb3BlbndlYXRoZXJtYXAub3JnL2ltZy93L1wiXG5cdC8vICAgICAgICAgICAgICAgKyB3ZWF0aGVySXRlbS53ZWF0aGVyWzBdLmljb24gICsgXCIucG5nXCIsXG5cdC8vICAgICAgICAgY29vcmRpbmF0ZXM6IFt3ZWF0aGVySXRlbS5jb29yZC5sb24sIHdlYXRoZXJJdGVtLmNvb3JkLmxhdF1cblx0Ly8gICAgICAgfSxcblx0Ly8gICAgICAgZ2VvbWV0cnk6IHtcblx0Ly8gICAgICAgICB0eXBlOiBcIlBvaW50XCIsXG5cdC8vICAgICAgICAgY29vcmRpbmF0ZXM6IFt3ZWF0aGVySXRlbS5jb29yZC5sb24sIHdlYXRoZXJJdGVtLmNvb3JkLmxhdF1cblx0Ly8gICAgICAgfVxuXHQvLyAgICAgfTtcblx0Ly8gICAgIC8vIFNldCB0aGUgY3VzdG9tIG1hcmtlciBpY29uXG5cdC8vICAgICBtYXAuZGF0YS5zZXRTdHlsZShmdW5jdGlvbihmZWF0dXJlKSB7XG5cdC8vICAgICAgIHJldHVybiB7XG5cdC8vICAgICAgICAgaWNvbjoge1xuXHQvLyAgICAgICAgICAgdXJsOiBmZWF0dXJlLmdldFByb3BlcnR5KCdpY29uJyksXG5cdC8vICAgICAgICAgICBhbmNob3I6IG5ldyBnb29nbGUubWFwcy5Qb2ludCgyNSwgMjUpXG5cdC8vICAgICAgICAgfVxuXHQvLyAgICAgICB9O1xuXHQvLyAgICAgfSk7XG5cblx0Ly8gICAgIC8vIHJldHVybnMgb2JqZWN0XG5cdC8vICAgICByZXR1cm4gZmVhdHVyZTtcblx0Ly8gICB9O1xuXG5cdC8vICAgLy8gQWRkIHRoZSBtYXJrZXJzIHRvIHRoZSBtYXBcblx0Ly8gICB2YXIgZHJhd0ljb25zID0gZnVuY3Rpb24gKHdlYXRoZXIpIHtcblx0Ly8gICAgICBtYXAuZGF0YS5hZGRHZW9Kc29uKGdlb0pTT04pO1xuXHQvLyAgICAgIC8vIFNldCB0aGUgZmxhZyB0byBmaW5pc2hlZFxuXHQvLyAgICAgIGdldHRpbmdEYXRhID0gZmFsc2U7XG5cdC8vICAgfTtcblxuXHQvLyAgIC8vIENsZWFyIGRhdGEgbGF5ZXIgYW5kIGdlb0pTT05cblx0Ly8gICB2YXIgcmVzZXREYXRhID0gZnVuY3Rpb24gKCkge1xuXHQvLyAgICAgZ2VvSlNPTiA9IHtcblx0Ly8gICAgICAgdHlwZTogXCJGZWF0dXJlQ29sbGVjdGlvblwiLFxuXHQvLyAgICAgICBmZWF0dXJlczogW11cblx0Ly8gICAgIH07XG5cdC8vICAgICBtYXAuZGF0YS5mb3JFYWNoKGZ1bmN0aW9uKGZlYXR1cmUpIHtcblx0Ly8gICAgICAgbWFwLmRhdGEucmVtb3ZlKGZlYXR1cmUpO1xuXHQvLyAgICAgfSk7XG5cdC8vICAgfTtcblxufSkiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcblxuLnNlcnZpY2UoJ0JhY2tncm91bmQnLCBmdW5jdGlvbigpIHtcblx0dmFyIF9iYWNrZ3JvdW5kcztcblx0dmFyIF9iYWNrZ3JvdW5kO1xuXHRsb2FkKCk7XG5cblx0cmV0dXJuIHtcblx0XHRzZXR1cDogc2V0dXAsXG5cdFx0bGlzdDogbGlzdCxcblx0XHRpc1NlbGVjdGVkOiBpc1NlbGVjdGVkXG5cdH0gXG5cblx0ZnVuY3Rpb24gc2V0dXAoc2NvcGUsIHN0YXRlKSB7XG5cdFx0c2NvcGUuYmFja2dyb3VuZCA9IF9iYWNrZ3JvdW5kO1xuXHRcdHNjb3BlLiRvbihcIiRzdGF0ZUNoYW5nZVN1Y2Nlc3NcIiwgZnVuY3Rpb24oZXZlbnQsIHRvU3RhdGUsIHRvUGFyYW1zLCBmcm9tU3RhdGUsIGZyb21QYXJhbXMpIHtcblx0XHQgICAgaWYgKHRvU3RhdGUubmFtZSA9PT0gc3RhdGUuY3VycmVudC5uYW1lICYmIF9iYWNrZ3JvdW5kICE9PSBzY29wZS5iYWNrZ3JvdW5kKSB7IFxuXHRcdCAgICBcdHNjb3BlLmJhY2tncm91bmQgPSBfYmFja2dyb3VuZDtcblx0XHQgICAgfVxuXHQgIFx0fSk7XG5cdCAgXHRyZXR1cm4ge1xuXHQgIFx0XHRzZXQ6IHNldFxuXHQgIFx0fVxuXHQgIFx0ZnVuY3Rpb24gc2V0KCBiYWNrZ3JvdW5kICkge1xuXHQgIFx0XHRfYmFja2dyb3VuZCA9IGJhY2tncm91bmQ7XG5cdCAgXHRcdHNjb3BlLmJhY2tncm91bmQgPSBfYmFja2dyb3VuZDtcblx0ICBcdH1cblx0fVxuXHRmdW5jdGlvbiBsaXN0KCkge1xuXHRcdHJldHVybiBfYmFja2dyb3VuZHM7XG5cdH1cblx0ZnVuY3Rpb24gbG9hZChzdWNjZXNzLCBlcnJvcikge1xuXHRcdGxvYWRVc2VyQmFja3JvdW5kcygpO1xuXHRcdGxvYWRBcHBCYWNrZ3JvdW5kcyhzdWNjZXNzLCBlcnJvcik7XG5cdFx0X2JhY2tncm91bmQgPSBsb2NhbFN0b3JhZ2UudXNlckJhY2tncm91bmQgfHwgX2JhY2tncm91bmRzIFswXTtcblx0fVxuXHRmdW5jdGlvbiBsb2FkVXNlckJhY2tyb3VuZHMoKSB7XG5cdFx0dmFyIGJhY2tncm91bmRzID0gbG9jYWxTdG9yYWdlLmJhY2tncm91bmRzO1xuXHRcdGlmKCFiYWNrZ3JvdW5kcykgcmV0dXJuO1xuXHRcdGJhY2tncm91bmRzID0gYmFja2dyb3VuZHMuc3BsaXQoJyAnKTtcblx0XHRfYmFja2dyb3VuZHMuY29uY2F0KGJhY2tncm91bmRzKTtcblx0fVxuXHRmdW5jdGlvbiBsb2FkQXBwQmFja2dyb3VuZHMoc3VjY2VzcywgZXJyb3IpIHtcblx0XHRyZXF1ZXN0KHN1Y2Nlc3MsIGVycm9yKTtcblx0XHRmdW5jdGlvbiByZXF1ZXN0KCBzdWNjZXNzLCBlcnJvcikge1xuXHRcdFx0dmFyIGkxID0gXCJodHRwOi8vd2FsbHBhcGVyc2NyYWZ0LnJ1L2ltYWdlL3ByaXJvZGFfZ29yeV9uZWJvX296ZXJvX29ibGFrYV84MTE1MF8xOTIweDEwODAuanBnXCI7XG5cdFx0XHR2YXIgaTIgPSBcImh0dHBzOi8vZW5jcnlwdGVkLXRibjAuZ3N0YXRpYy5jb20vaW1hZ2VzP3E9dGJuOkFOZDlHY1FFeUlxaG5xUWdYTG9MX0hvNzYtclhRdkI1Y0tJX2d5RUhQZ0dZZ3A4blFDNk9DR3FsXCI7XG5cdFx0XHR2YXIgaTMgPSBcImh0dHBzOi8vZW5jcnlwdGVkLXRibjMuZ3N0YXRpYy5jb20vaW1hZ2VzP3E9dGJuOkFOZDlHY1JYNkowQlFvWHFZUEFvWk5oMmxxODU1amI3RGNQYjJvSzZnTWdLM2xnVG1najhqc0hMXCI7XG5cdFx0XHR2YXIgaTQgPSBcImh0dHBzOi8vZW5jcnlwdGVkLXRibjIuZ3N0YXRpYy5jb20vaW1hZ2VzP3E9dGJuOkFOZDlHY1N6Z3QySFhaNmczam5Kb1VlemN4cW9iOHhMUW1EeVVsTkczQ0RJQ2VlUTd0ZDA2YTRhXCI7XG5cdFx0XHRcblx0XHRcdHZhciBiYWNrZ3JvdW5kcyA9ICBbaTEsIGkyLCBpMywgaTRdO1xuXHRcdFx0dXNlUmVzcG9uc2UoYmFja2dyb3VuZHMpO1xuXHRcdH1cdFx0XG5cblxuXHRcdGZ1bmN0aW9uIHVzZVJlc3BvbnNlKGJhY2tncm91bmRzKSB7XG5cdFx0XHRfYmFja2dyb3VuZHMgPSBfYmFja2dyb3VuZHMgfHwgW107XG5cdFx0XHRfYmFja2dyb3VuZHMgPSBfYmFja2dyb3VuZHMuY29uY2F0KGJhY2tncm91bmRzKTtcblx0XHR9XG5cdFx0ZnVuY3Rpb24gdXNlRXJyb3IoKSB7XG5cblx0XHR9XG5cdH1cblx0ZnVuY3Rpb24gaXNTZWxlY3RlZCAoaXRlbSkge1xuXHRcdHJldHVybiBfYmFja2dyb3VuZCA9PT0gaXRlbTtcblx0fVxufSk7IiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG5cbi5zZXJ2aWNlKCdMb2NhdGlvbicsIGZ1bmN0aW9uKFVzZXJEYXRhKSB7XG5cdHZhciBsb2NhdGlvbjtcblx0dmFyIHVzZXIgPSBVc2VyRGF0YSgpO1xuXHRpZih1c2VyKSB7XG5cdFx0bG9jYXRpb24gPSB1c2VyLmxvY2F0aW9uO1xuXHR9XG5cdHJldHVybiBmdW5jdGlvbihkYXRhKSB7XG5cdFx0aWYgKGRhdGEpIHtcblx0XHRcdGxvY2F0aW9uID0gZGF0YVxuXHRcdH0gZWxzZSB7XG5cdFx0XHRyZXR1cm4gbG9jYXRpb247XG5cdFx0fVxuXHR9XG59KSAiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcblxuLnNlcnZpY2UoJ1VzZXJEYXRhJywgZnVuY3Rpb24oKSB7XG5cdHZhciB1c2VyO1xuXHRyZXR1cm4gZnVuY3Rpb24oZGF0YSkge1xuXHRcdGlmKGRhdGEpIHtcblx0XHRcdHNldERhdGEoZGF0YSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHVzZXIgPSBnZXREYXRhKCk7XG5cdFx0XHRyZXR1cm4gdXNlcjtcblx0XHR9XG5cdH1cblxuXHRmdW5jdGlvbiBnZXREYXRhKCkge1xuXHRcdGlmKCF1c2VyKSB7XG5cdFx0XHR2YXIgdXNlckluZm8gPSBsb2NhbFN0b3JhZ2UuZXdfdXNlcjtcblx0XHRcdGNvbnNvbGUubG9nKHVzZXJJbmZvKTtcblx0XHRcdGlmKHVzZXJJbmZvKSB7XG5cdFx0XHRcdHVzZXIgPSBKU09OLnBhcnNlKHVzZXJJbmZvKTtcblx0XHRcdH0gXG5cdFx0fVxuXHRcdHJldHVybiB1c2VyO1xuXHR9XG5cdGZ1bmN0aW9uIHNldERhdGEoZGF0YSkge1xuXHRcdHVzZXIgPSBkYXRhO1xuXHRcdGxvY2FsU3RvcmFnZS5ld191c2VyID0gSlNPTi5zdHJpbmdpZnkodXNlcik7XG5cdH1cbn0pIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uc2VydmljZSgnV2VhdGhlcicsIGZ1bmN0aW9uKCRodHRwLCBjb25maWcpIHtcblx0ZnVuY3Rpb24gd2VhdGhlcihsb2NhdGlvbiwgcXVlcnkpIHtcblx0XHRyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdFx0XHR2YXIgdXJsID0gZ2V0VVJMKCk7XG5cdFx0XHQkaHR0cC5nZXQodXJsKS50aGVuKHVzZVJlc3BvbnNlLCB1c2VFcnJvcik7XG5cblx0XHRcdGZ1bmN0aW9uIGdldFVSTCgpIHtcblx0XHRcdFx0dmFyIHF1ZXJ5U3RyaW5nID0gZ2V0UXVlcnlTdHJpbmcoKTtcblx0XHRcdFx0dmFyIHVybCA9IFwiaHR0cDovL2FwaS53dW5kZXJncm91bmQuY29tL2FwaS9cIitjb25maWcud3VuZGVyZ3JvdW5kQXBpS2V5K3F1ZXJ5U3RyaW5nO1xuXHRcdCAgICBcdHJldHVybiB1cmw7XG5cblx0XHQgICAgXHRmdW5jdGlvbiBnZXRRdWVyeVN0cmluZygpIHtcblx0XHQgICAgXHRcdHZhciByZXN1bHQgPSBcIi9cIitxdWVyeStcIi9xXCI7XG5cdFx0ICAgIFx0XHR2YXIgZmllbGRzID0gW1wiY291bnRyeVwiLCBcInN0YXRlXCIsIFwiY2l0eVwiXTtcblxuXHRcdCAgICBcdFx0Zm9yKHZhciBpID0gMDsgaSA8IGZpZWxkcy5sZW5ndGg7IGkrKykge1xuXHRcdCAgICBcdFx0XHR2YXIgZmllbGQgPSBmaWVsZHNbaV07XG5cdFx0ICAgIFx0XHRcdGlmKGxvY2F0aW9uW2ZpZWxkXSAmJiBsb2NhdGlvbltmaWVsZF0ubGVuZ3RoID4gMCkge1xuXHRcdCAgICBcdFx0XHRcdHJlc3VsdCs9IFwiL1wiK2xvY2F0aW9uW2ZpZWxkXTtcblx0XHQgICAgXHRcdFx0fVxuXHRcdCAgICBcdFx0fVxuXHRcdCAgICBcdFx0cmV0dXJuIHJlc3VsdCArIFwiLmpzb25cIjtcblx0XHQgICAgXHR9XG5cdFx0XHR9XG5cblx0XHRcdGZ1bmN0aW9uIHVzZVJlc3BvbnNlKHJlc3BvbnNlKSB7XG5cdFx0XHRcdHZhciByZXN1bHQgPSBbXTtcblx0XHRcdFx0dmFyIGl0ZW1zID0gcmVzcG9uc2UuZGF0YS5ob3VybHlfZm9yZWNhc3Q7XG5cdFx0XHRcdGlmKCFpdGVtcykge1xuXHRcdFx0XHRcdHVzZUVycm9yKHJlc3BvbnNlLmRhdGEucmVzcG9uc2UpO1xuXHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0fVxuXHRcdFx0XHRmb3IodmFyIGkgPSAwOyBpPCBpdGVtcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdHZhciBpdGVtID0gaXRlbXNbaV07XG5cdFx0XHRcdFx0dmFyIGZvcmVjYXN0ID0gZ2V0Rm9yZWNhc3QoKTtcblx0XHRcdFx0XHRyZXN1bHQucHVzaChmb3JlY2FzdCk7XG5cdFx0XHRcdFx0ZnVuY3Rpb24gZ2V0Rm9yZWNhc3QoKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRcdFx0XHRjb25kaXRpb246IGl0ZW0uY29uZGl0aW9uLFxuXHRcdFx0XHRcdFx0XHRpY29uOiBpdGVtLmljb25fdXJsLFxuXHRcdFx0XHRcdFx0XHRkYXRlOiBuZXcgRGF0ZSggaXRlbS5GQ1RUSU1FLmVwb2NoKjEwMDApXG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHRcdHJlc29sdmUocmVzdWx0KTtcblx0XHRcdH1cblx0XHRcdGZ1bmN0aW9uIHVzZUVycm9yKGUpIHtcblx0XHRcdFx0aWYoZS5lcnJvcikge1xuXHRcdFx0XHRcdHJlamVjdChlcnJvci5kZXNjcmlwdGlvbilcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRyZWplY3QoXCJHZW8gaW5mbyBpcyBub3QgZW5vdWdoXCIpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHJlamVjdChlcnJvcik7XG5cdFx0XHR9XG5cblx0XHR9KTtcblx0fVxuXHRyZXR1cm4gd2VhdGhlcjtcblx0XHRcbn0pIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG5cbi5zZXJ2aWNlKCdjb25maWcnLCBmdW5jdGlvbigpIHtcblx0cmV0dXJuIHtcblx0XHRvcGVuV2VhdGhlckFwaUtleTogXCI3ZDc4MTVjZDU3MjFiNzc4Yzc5ZDk3ZGZmOTJlYTUzM1wiLFxuXHRcdHd1bmRlcmdyb3VuZEFwaUtleTogXCJhN2YzZTQ0ZTlkZmQ0MDM2XCJcblx0fVxufSkiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
