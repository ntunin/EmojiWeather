angular.module("app",["ionic","app.routes","app.directives","ngCordova"]).run(["$ionicPlatform",function(o){o.ready(function(){window.cordova&&window.cordova.plugins&&window.cordova.plugins.Keyboard&&(cordova.plugins.Keyboard.hideKeyboardAccessoryBar(!0),cordova.plugins.Keyboard.disableScroll(!0)),window.StatusBar&&StatusBar.styleDefault()})}]);
angular.module("app.directives",[]).directive("blankDirective",[function(){}]).directive("background",function(){return{restrict:"A",link:function(i,c,r){i.$broadcast("scroll.resize")},compile:function(i,c){i.html('<div class = "background" style = "background-image: url({{background}});"></div>')}}});
angular.module("app.routes",[]).config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("overview",{url:"/overview",templateUrl:"templates/overview.html",controller:"overviewCtrl"}).state("login",{url:"/login",templateUrl:"templates/login.html",controller:"loginCtrl"}).state("preview",{url:"/preview",templateUrl:"templates/preview.html",controller:"previewCtrl"}).state("error",{url:"/login_error",templateUrl:"templates/error.html",controller:"errorCtrl"}).state("main",{url:"/main_screen",templateUrl:"templates/main.html",controller:"mainCtrl"}).state("menu",{url:"/menu",templateUrl:"templates/menu.html",controller:"menuCtrl"}).state("weeklyForecast",{url:"/weekly",templateUrl:"templates/weeklyForecast.html",controller:"weeklyForecastCtrl"}).state("hourlyForecast",{url:"/hourly",templateUrl:"templates/hourlyForecast.html",controller:"hourlyForecastCtrl"}).state("map",{url:"/map",templateUrl:"templates/map.html",controller:"mapCtrl"}).state("addEmojis",{url:"/add_emojis",templateUrl:"templates/addEmojis.html",controller:"addEmojisCtrl"}).state("search",{url:"/search",templateUrl:"templates/search.html",controller:"searchCtrl"}).state("backgroundSelection",{url:"/page12",templateUrl:"templates/backgroundSelection.html",controller:"backgroundSelectionCtrl"}),t.otherwise("/overview")}]);
angular.module("app").controller("addEmojisCtrl",["$scope","$state","Background",function(o,a,t){t.setup(o,a)}]);
angular.module("app").controller("backgroundSelectionCtrl",["$scope","$state","Background",function(e,t,c){var n=c.setup(e,t);e.backgrounds=c.list(),e.select=function(e){n.set(e)},e.isSelected=function(e){return c.isSelected(e)?"background-selected":""}}]);
angular.module("app").controller("errorCtrl",["$scope",function(r){}]);
angular.module("app").controller("hourlyForecastCtrl",["$scope","$state","Background","Weather","UserData",function(o,t,e,n,r){function a(t){o.hourlyForecast=t}function u(o){}e.setup(o,t);var c=r();n(c.location,"hourly").then(a,u),o.moment=moment}]);
angular.module("app").controller("loginCtrl",["$scope","$state","Background","UserData","Location",function(o,t,a,n,s){a.setup(o,t),o.user={name:"nik",location:{state:"siberia",country:"russia",city:"omsk"}},o.submit=function(){n(o.user),s(o.user.location)}}]);
angular.module("app").controller("mainCtrl",["$scope","$state","Background","$stateParams","UserData","Weather","Location","$ionicPopup",function(n,t,a,e,o,c,r,i){function u(){function t(t){n.hourlyForecast=t}function a(n){i.alert({title:"Warning",template:n})}n.moment=moment;var e=o();n.username=e.name,n.location=r();setInterval(function(){n.date=new Date,n.$apply()},1e3);c(n.location,"hourly").then(t,a)}a.setup(n,t),n.$on("$stateChangeSuccess",function(n,t,a,e,o){"main"===t.name&&u()})}]);
angular.module("app").controller("menuCtrl",["$scope","$state","Background",function(e,n,o){o.setup(e,n)}]);
angular.module("app").controller("overviewCtrl",["$scope","$state","Background","UserData",function(a,e,o,r){o.setup(a,e),r()&&e.go("main")}]);
angular.module("app").controller("previewCtrl",["$scope","$state","Background","UserData",function(e,t,a,n){a.setup(e,t),e.user=n(),e.submit=function(){t.go("main")}}]);
angular.module("app").controller("searchCtrl",["$scope","$state","Background","Location",function(t,o,c,n){c.setup(t,o),t.location={state:"",country:"",city:""},t.submit=function(){n(t.location)}}]);
angular.module("app").controller("weeklyForecastCtrl",["$scope","$state","Background","Weather","UserData",function(t,n,e,o,r){function a(n){function e(t){function n(t){return moment(t.date).format("ddd")}for(var e={},o=0;o<t.length;o++){var r=t[o],a=n(r);e[a]=e[a]||[],e[a].push(r)}return e}t.forecast=e(n)}function u(t){}e.setup(t,n);var c=r();o(c.location,"hourly10day").then(a,u),t.moment=moment}]);
angular.module("app").controller("mapCtrl",["$scope","$state","Map",function(a,p,l){l("map-canvas")}]);
angular.module("app").service("Background",function(){function n(n,t){function c(t){g=t,n.background=g}return n.background=g,n.$on("$stateChangeSuccess",function(c,o,a,e,r){o.name===t.current.name&&g!==n.background&&(n.background=g)}),{set:c}}function t(){return r}function c(n,t){o(),a(n,t),g=localStorage.userBackground||r[0]}function o(){var n=localStorage.backgrounds;n&&(n=n.split(" "),r.concat(n))}function a(n,t){function c(n,t){var c="http://wallpaperscraft.ru/image/priroda_gory_nebo_ozero_oblaka_81150_1920x1080.jpg",a="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQEyIqhnqQgXLoL_Ho76-rXQvB5cKI_gyEHPgGYgp8nQC6OCGql",e="https://encrypted-tbn3.gstatic.com/images?q=tbn:ANd9GcRX6J0BQoXqYPAoZNh2lq855jb7DcPb2oK6gMgK3lgTmgj8jsHL",r="https://encrypted-tbn2.gstatic.com/images?q=tbn:ANd9GcSzgt2HXZ6g3jnJoUezcxqob8xLQmDyUlNG3CDICeeQ7td06a4a",g=[c,a,e,r];o(g)}function o(n){r=r||[],r=r.concat(n)}c(n,t)}function e(n){return g===n}var r,g;return c(),{setup:n,list:t,isSelected:e}});
angular.module("app").service("Location",["UserData",function(n){var a,o=n();return o&&(a=o.location),function(n){return n?void(a=n):a}}]);
angular.module("app").service("Map",["$http","config","Location","$cordovaGeolocation",function(e,t,o,n){return function(o){function a(n){function a(){for(;g===!0;)g=!1;i()}function i(){var e=p.getBounds(),t=e.getNorthEast(),o=e.getSouthWest();r(t.lat(),t.lng(),o.lat(),o.lng())}function r(t,o,n,a){function i(e){var t=e.data;if(t.list.length>0){d();for(var o=0;o<t.list.length;o++)s.features.push(c(t.list[o]));u(s)}}function r(){}g=!0;var l="http://api.openweathermap.org/data/2.5/box/city?bbox="+a+","+t+","+o+","+n+","+p.getZoom()+"&cluster=yes&format=json&APPID="+m;e.get(l).then(i,r)}function c(e){var t={type:"Feature",properties:{city:e.name,weather:e.weather[0].main,temperature:e.main.temp,min:e.main.temp_min,max:e.main.temp_max,humidity:e.main.humidity,pressure:e.main.pressure,windSpeed:e.wind.speed,windDegrees:e.wind.deg,windGust:e.wind.gust,icon:"http://openweathermap.org/img/w/"+e.weather[0].icon+".png",coordinates:[e.coord.lon,e.coord.lat]},geometry:{type:"Point",coordinates:[e.coord.lon,e.coord.lat]}};return p.data.setStyle(function(e){return{icon:{url:e.getProperty("icon"),anchor:new google.maps.Point(25,25)}}}),t}function u(e){p.data.addGeoJson(s),g=!1}function d(){s={type:"FeatureCollection",features:[]},p.data.forEach(function(e){p.data.remove(e)})}var p,s,g=!1,m=t.openWeatherApiKey,l={zoom:4,center:new google.maps.LatLng(n.coords.latitude,n.coords.longitude)};o=document.getElementById(o),p=new google.maps.Map(o,l),google.maps.event.addListener(p,"idle",a)}n.getCurrentPosition().then(a)}}]);
angular.module("app").service("UserData",function(){function r(){if(!n){var r=localStorage.ew_user;console.log(r),r&&(n=JSON.parse(r))}return n}function e(r){n=r,localStorage.ew_user=JSON.stringify(n)}var n;return function(o){return o?void e(o):n=r()}});
angular.module("app").service("Weather",["$http","config",function(n,r){function t(t,o){return new Promise(function(e,i){function u(){function n(){for(var n="/"+o+"/q",r=["country","state","city"],e=0;e<r.length;e++){var i=r[e];t[i]&&t[i].length>0&&(n+="/"+t[i])}return n+".json"}var e=n(),i="http://api.wunderground.com/api/"+r.wundergroundApiKey+e;return i}function a(n){function r(){return{condition:u.condition,icon:u.icon_url,date:new Date(1e3*u.FCTTIME.epoch)}}var t=[],o=n.data.hourly_forecast;if(!o)return void c(n.data.response);for(var i=0;i<o.length;i++){var u=o[i],a=r();t.push(a)}e(t)}function c(n){i(n.error?error.description:"Geo info is not enough")}var f=u();n.get(f).then(a,c)})}return t}]);
angular.module("app").service("config",function(){return{openWeatherApiKey:"7d7815cd5721b778c79d97dff92ea533",wundergroundApiKey:"a7f3e44e9dfd4036"}});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImRpcmVjdGl2ZXMuanMiLCJyb3V0ZXMuanMiLCJjb250cm9sbGVycy9BZGRFbW9qaUN0cmwuanMiLCJjb250cm9sbGVycy9CYWNrZ3JvdW5kU2VsZWN0aW9uQ3RybC5qcyIsImNvbnRyb2xsZXJzL0Vycm9yQ3RybC5qcyIsImNvbnRyb2xsZXJzL0hvdXJseUZvcmVjYXN0Q3RybC5qcyIsImNvbnRyb2xsZXJzL0xvZ2luQ3RybC5qcyIsImNvbnRyb2xsZXJzL01haW5QYWdlQ3RybC5qcyIsImNvbnRyb2xsZXJzL01lbnVDdHJsLmpzIiwiY29udHJvbGxlcnMvT3ZlcnZpZXdDdHJsLmpzIiwiY29udHJvbGxlcnMvUHJldmlld0N0cmwuanMiLCJjb250cm9sbGVycy9TZWFyY2hDdHJsLmpzIiwiY29udHJvbGxlcnMvV2Vla2x5Rm9yZWNhc3RDdHJsLmpzIiwiY29udHJvbGxlcnMvbWFwQ3RybC5qcyIsInNlcnZpY2VzL0JhY2tyb3VuZC5qcyIsInNlcnZpY2VzL0xvY2F0aW9uLmpzIiwic2VydmljZXMvTWFwLmpzIiwic2VydmljZXMvVXNlckRhdGEuanMiLCJzZXJ2aWNlcy9XZWF0aGVyLmpzIiwic2VydmljZXMvY29uZmlnLmpzIl0sIm5hbWVzIjpbImFuZ3VsYXIiLCJtb2R1bGUiLCJydW4iLCIkaW9uaWNQbGF0Zm9ybSIsInJlYWR5Iiwid2luZG93IiwiY29yZG92YSIsInBsdWdpbnMiLCJLZXlib2FyZCIsImhpZGVLZXlib2FyZEFjY2Vzc29yeUJhciIsImRpc2FibGVTY3JvbGwiLCJTdGF0dXNCYXIiLCJzdHlsZURlZmF1bHQiLCJkaXJlY3RpdmUiLCJyZXN0cmljdCIsImxpbmsiLCIkc2NvcGUiLCIkZWxlbWVudCIsIiRhdHRycyIsIiRicm9hZGNhc3QiLCJjb21waWxlIiwiaHRtbCIsImNvbmZpZyIsIiRzdGF0ZVByb3ZpZGVyIiwiJHVybFJvdXRlclByb3ZpZGVyIiwic3RhdGUiLCJ1cmwiLCJ0ZW1wbGF0ZVVybCIsImNvbnRyb2xsZXIiLCJvdGhlcndpc2UiLCIkc3RhdGUiLCJCYWNrZ3JvdW5kIiwic2V0dXAiLCJiYWNrZ3JvdW5kU2V0dGluZ3MiLCJiYWNrZ3JvdW5kcyIsImxpc3QiLCJzZWxlY3QiLCJpdGVtIiwic2V0IiwiaXNTZWxlY3RlZCIsIldlYXRoZXIiLCJVc2VyRGF0YSIsInN1Y2Nlc3MiLCJyZXNwb25zZSIsImhvdXJseUZvcmVjYXN0IiwiZXJyb3IiLCJlIiwidXNlciIsImxvY2F0aW9uIiwidGhlbiIsIm1vbWVudCIsIkxvY2F0aW9uIiwibmFtZSIsImNvdW50cnkiLCJjaXR5Iiwic3VibWl0IiwiJHN0YXRlUGFyYW1zIiwiJGlvbmljUG9wdXAiLCJ1cGRhdGUiLCJyZXNwb3NlIiwiYWxlcnQiLCJ0aXRsZSIsInRlbXBsYXRlIiwidXNlcm5hbWUiLCJzZXRJbnRlcnZhbCIsImRhdGUiLCJEYXRlIiwiJGFwcGx5IiwiJG9uIiwiZXZlbnQiLCJ0b1N0YXRlIiwidG9QYXJhbXMiLCJmcm9tU3RhdGUiLCJmcm9tUGFyYW1zIiwiZ28iLCJzb3J0QnlEYXlzIiwiZ2V0S2V5Rm9yIiwiZm9ybWF0IiwiZGF5cyIsImkiLCJsZW5ndGgiLCJrZXkiLCJwdXNoIiwiZm9yZWNhc3QiLCJNYXAiLCJzZXJ2aWNlIiwic2NvcGUiLCJiYWNrZ3JvdW5kIiwiX2JhY2tncm91bmQiLCJjdXJyZW50IiwiX2JhY2tncm91bmRzIiwibG9hZCIsImxvYWRVc2VyQmFja3JvdW5kcyIsImxvYWRBcHBCYWNrZ3JvdW5kcyIsImxvY2FsU3RvcmFnZSIsInVzZXJCYWNrZ3JvdW5kIiwic3BsaXQiLCJjb25jYXQiLCJyZXF1ZXN0IiwiaTEiLCJpMiIsImkzIiwiaTQiLCJ1c2VSZXNwb25zZSIsImRhdGEiLCIkaHR0cCIsIiRjb3Jkb3ZhR2VvbG9jYXRpb24iLCJjYW52YXMiLCJpbml0aWFsaXplIiwicG9zaXRpb24iLCJjaGVja0lmRGF0YVJlcXVlc3RlZCIsImdldHRpbmdEYXRhIiwiZ2V0Q29vcmRzIiwiYm91bmRzIiwibWFwIiwiZ2V0Qm91bmRzIiwiTkUiLCJnZXROb3J0aEVhc3QiLCJTVyIsImdldFNvdXRoV2VzdCIsImdldFdlYXRoZXIiLCJsYXQiLCJsbmciLCJub3J0aExhdCIsImVhc3RMbmciLCJzb3V0aExhdCIsIndlc3RMbmciLCJyZXN1bHRzIiwicmVzZXREYXRhIiwiZ2VvSlNPTiIsImZlYXR1cmVzIiwianNvblRvR2VvSnNvbiIsImRyYXdJY29ucyIsInJlcXVlc3RTdHJpbmciLCJnZXRab29tIiwib3BlbldlYXRoZXJNYXBLZXkiLCJnZXQiLCJ3ZWF0aGVySXRlbSIsImZlYXR1cmUiLCJ0eXBlIiwicHJvcGVydGllcyIsIndlYXRoZXIiLCJtYWluIiwidGVtcGVyYXR1cmUiLCJ0ZW1wIiwibWluIiwidGVtcF9taW4iLCJtYXgiLCJ0ZW1wX21heCIsImh1bWlkaXR5IiwicHJlc3N1cmUiLCJ3aW5kU3BlZWQiLCJ3aW5kIiwic3BlZWQiLCJ3aW5kRGVncmVlcyIsImRlZyIsIndpbmRHdXN0IiwiZ3VzdCIsImljb24iLCJjb29yZGluYXRlcyIsImNvb3JkIiwibG9uIiwiZ2VvbWV0cnkiLCJzZXRTdHlsZSIsImdldFByb3BlcnR5IiwiYW5jaG9yIiwiZ29vZ2xlIiwibWFwcyIsIlBvaW50IiwiYWRkR2VvSnNvbiIsImZvckVhY2giLCJyZW1vdmUiLCJvcGVuV2VhdGhlckFwaUtleSIsIm1hcE9wdGlvbnMiLCJ6b29tIiwiY2VudGVyIiwiTGF0TG5nIiwiY29vcmRzIiwibGF0aXR1ZGUiLCJsb25naXR1ZGUiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiYWRkTGlzdGVuZXIiLCJnZXRDdXJyZW50UG9zaXRpb24iLCJnZXREYXRhIiwidXNlckluZm8iLCJld191c2VyIiwiY29uc29sZSIsImxvZyIsIkpTT04iLCJwYXJzZSIsInNldERhdGEiLCJzdHJpbmdpZnkiLCJxdWVyeSIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwiZ2V0VVJMIiwiZ2V0UXVlcnlTdHJpbmciLCJyZXN1bHQiLCJmaWVsZHMiLCJmaWVsZCIsInF1ZXJ5U3RyaW5nIiwid3VuZGVyZ3JvdW5kQXBpS2V5IiwiZ2V0Rm9yZWNhc3QiLCJjb25kaXRpb24iLCJpY29uX3VybCIsIkZDVFRJTUUiLCJlcG9jaCIsIml0ZW1zIiwiaG91cmx5X2ZvcmVjYXN0IiwidXNlRXJyb3IiLCJkZXNjcmlwdGlvbiJdLCJtYXBwaW5ncyI6IkFBT0FBLFFBQVFDLE9BQU8sT0FBUSxRQUFTLGFBQWMsaUJBQWtCLGNBRS9EQyxLQUFBLGlCQUFJLFNBQVNDLEdBQ1pBLEVBQWVDLE1BQU0sV0FHZkMsT0FBT0MsU0FBV0QsT0FBT0MsUUFBUUMsU0FBV0YsT0FBT0MsUUFBUUMsUUFBUUMsV0FDckVGLFFBQVFDLFFBQVFDLFNBQVNDLDBCQUF5QixHQUNsREgsUUFBUUMsUUFBUUMsU0FBU0UsZUFBYyxJQUVyQ0wsT0FBT00sV0FFVEEsVUFBVUM7QUNuQmhCWixRQUFRQyxPQUFPLHFCQUVkWSxVQUFVLGtCQUFtQixlQUs3QkEsVUFBVSxhQUFjLFdBQ3ZCLE9BQ0VDLFNBQVUsSUFDVkMsS0FBTSxTQUFVQyxFQUFRQyxFQUFVQyxHQUNqQ0YsRUFBT0csV0FBVyxrQkFFbkJDLFFBQVMsU0FBU0gsRUFBVUMsR0FDMUJELEVBQVNJLEtBQ1A7QUNmUnJCLFFBQVFDLE9BQU8saUJBRWRxQixRQUFBLGlCQUFBLHFCQUFPLFNBQVNDLEVBQWdCQyxHQU0vQkQsRUFJS0UsTUFBTSxZQUNUQyxJQUFLLFlBQ0xDLFlBQWEsMEJBQ2JDLFdBQVksaUJBR2JILE1BQU0sU0FDTEMsSUFBSyxTQUNMQyxZQUFhLHVCQUNiQyxXQUFZLGNBR2JILE1BQU0sV0FDTEMsSUFBSyxXQUNMQyxZQUFhLHlCQUNiQyxXQUFZLGdCQUdiSCxNQUFNLFNBQ0xDLElBQUssZUFDTEMsWUFBYSx1QkFDYkMsV0FBWSxjQUdiSCxNQUFNLFFBQ0xDLElBQUssZUFDTEMsWUFBYSxzQkFDYkMsV0FBWSxhQUdiSCxNQUFNLFFBQ0xDLElBQUssUUFDTEMsWUFBYSxzQkFDYkMsV0FBWSxhQUdiSCxNQUFNLGtCQUNMQyxJQUFLLFVBQ0xDLFlB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QUNDQyxVQUFXeEssRUFBS3dLLFVBQ2hCL0MsS0FBTXpILEVBQUt5SyxTQUNYN0ksS0FBTSxHQUFJQyxNQUF5QixJQUFuQjdCLEVBQUswSyxRQUFRQyxRQWRoQyxHQUFJVCxNQUNBVSxFQUFRdEssRUFBUzZELEtBQUswRyxlQUMxQixLQUFJRCxFQUVILFdBREFFLEdBQVN4SyxFQUFTNkQsS0FBSzdELFNBR3hCLEtBQUksR0FBSW9DLEdBQUksRUFBR0EsRUFBR2tJLEVBQU1qSSxPQUFRRCxJQUFLLENBQ3BDLEdBQUkxQyxHQUFPNEssRUFBTWxJLEdBQ2JJLEVBQVd5SCxHQUNmTCxHQUFPckgsS0FBS0MsR0FTYmdILEVBQVFJLEdBRVQsUUFBU1ksR0FBU3JLLEdBRWhCc0osRUFERXRKLEVBQUVELE1BQ0dBLE1BQU11SyxZQUVOLDBCQS9DVCxHQUFJMUwsR0FBTTJLLEdBQ1Y1RixHQUFNK0IsSUFBSTlHLEdBQUt1QixLQUFLc0QsRUFBYTRHLEtBb0RuQyxNQUFPdEU7QUN6RFI3SSxRQUFRQyxPQUFPLE9BRWRvRixRQUFRLFNBQVUsV0FDbEIsT0FDQ3VGLGtCQUFtQixtQ0FDbkIrQixtQkFBb0IiLCJmaWxlIjoid3d3L2FwcC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBJb25pYyBTdGFydGVyIEFwcFxuXG4vLyBhbmd1bGFyLm1vZHVsZSBpcyBhIGdsb2JhbCBwbGFjZSBmb3IgY3JlYXRpbmcsIHJlZ2lzdGVyaW5nIGFuZCByZXRyaWV2aW5nIEFuZ3VsYXIgbW9kdWxlc1xuLy8gJ3N0YXJ0ZXInIGlzIHRoZSBuYW1lIG9mIHRoaXMgYW5ndWxhciBtb2R1bGUgZXhhbXBsZSAoYWxzbyBzZXQgaW4gYSA8Ym9keT4gYXR0cmlidXRlIGluIGluZGV4Lmh0bWwpXG4vLyB0aGUgMm5kIHBhcmFtZXRlciBpcyBhbiBhcnJheSBvZiAncmVxdWlyZXMnXG4vLyAnc3RhcnRlci5zZXJ2aWNlcycgaXMgZm91bmQgaW4gc2VydmljZXMuanNcbi8vICdzdGFydGVyLmNvbnRyb2xsZXJzJyBpcyBmb3VuZCBpbiBjb250cm9sbGVycy5qc1xuYW5ndWxhci5tb2R1bGUoJ2FwcCcsIFsnaW9uaWMnLCAnYXBwLnJvdXRlcycsICdhcHAuZGlyZWN0aXZlcycsICduZ0NvcmRvdmEnXSlcblxuLnJ1bihmdW5jdGlvbigkaW9uaWNQbGF0Zm9ybSkge1xuICAkaW9uaWNQbGF0Zm9ybS5yZWFkeShmdW5jdGlvbigpIHtcbiAgICAvLyBIaWRlIHRoZSBhY2Nlc3NvcnkgYmFyIGJ5IGRlZmF1bHQgKHJlbW92ZSB0aGlzIHRvIHNob3cgdGhlIGFjY2Vzc29yeSBiYXIgYWJvdmUgdGhlIGtleWJvYXJkXG4gICAgLy8gZm9yIGZvcm0gaW5wdXRzKVxuICAgIGlmICh3aW5kb3cuY29yZG92YSAmJiB3aW5kb3cuY29yZG92YS5wbHVnaW5zICYmIHdpbmRvdy5jb3Jkb3ZhLnBsdWdpbnMuS2V5Ym9hcmQpIHtcbiAgICAgIGNvcmRvdmEucGx1Z2lucy5LZXlib2FyZC5oaWRlS2V5Ym9hcmRBY2Nlc3NvcnlCYXIodHJ1ZSk7XG4gICAgICBjb3Jkb3ZhLnBsdWdpbnMuS2V5Ym9hcmQuZGlzYWJsZVNjcm9sbCh0cnVlKTtcbiAgICB9XG4gICAgaWYgKHdpbmRvdy5TdGF0dXNCYXIpIHtcbiAgICAgIC8vIG9yZy5hcGFjaGUuY29yZG92YS5zdGF0dXNiYXIgcmVxdWlyZWRcbiAgICAgIFN0YXR1c0Jhci5zdHlsZURlZmF1bHQoKTtcbiAgICB9XG4gIH0pO1xufSkiLCJhbmd1bGFyLm1vZHVsZSgnYXBwLmRpcmVjdGl2ZXMnLCBbXSlcblxuLmRpcmVjdGl2ZSgnYmxhbmtEaXJlY3RpdmUnLCBbZnVuY3Rpb24oKXtcblxufV0pXG5cblxuLmRpcmVjdGl2ZSgnYmFja2dyb3VuZCcsIGZ1bmN0aW9uKCkge1xuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0OiAnQScsXG4gICAgbGluazogZnVuY3Rpb24gKCRzY29wZSwgJGVsZW1lbnQsICRhdHRycykge1xuICAgIFx0JHNjb3BlLiRicm9hZGNhc3QoJ3Njcm9sbC5yZXNpemUnKTtcbiAgICB9LFxuICAgIGNvbXBpbGU6IGZ1bmN0aW9uKCRlbGVtZW50LCAkYXR0cnMpIHtcbiAgICAgICRlbGVtZW50Lmh0bWwoXG4gICAgICAgICc8ZGl2IGNsYXNzID0gXCJiYWNrZ3JvdW5kXCIgc3R5bGUgPSBcImJhY2tncm91bmQtaW1hZ2U6IHVybCh7e2JhY2tncm91bmR9fSk7XCI+PC9kaXY+J1xuICAgICAgKTsgICAgXG4gICAgfVxuICB9XG59KSIsImFuZ3VsYXIubW9kdWxlKCdhcHAucm91dGVzJywgW10pXG5cbi5jb25maWcoZnVuY3Rpb24oJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlcikge1xuXG4gIC8vIElvbmljIHVzZXMgQW5ndWxhclVJIFJvdXRlciB3aGljaCB1c2VzIHRoZSBjb25jZXB0IG9mIHN0YXRlc1xuICAvLyBMZWFybiBtb3JlIGhlcmU6IGh0dHBzOi8vZ2l0aHViLmNvbS9hbmd1bGFyLXVpL3VpLXJvdXRlclxuICAvLyBTZXQgdXAgdGhlIHZhcmlvdXMgc3RhdGVzIHdoaWNoIHRoZSBhcHAgY2FuIGJlIGluLlxuICAvLyBFYWNoIHN0YXRlJ3MgY29udHJvbGxlciBjYW4gYmUgZm91bmQgaW4gY29udHJvbGxlcnMuanNcbiAgJHN0YXRlUHJvdmlkZXJcbiAgICBcbiAgXG5cbiAgICAgIC5zdGF0ZSgnb3ZlcnZpZXcnLCB7XG4gICAgdXJsOiAnL292ZXJ2aWV3JyxcbiAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy9vdmVydmlldy5odG1sJyxcbiAgICBjb250cm9sbGVyOiAnb3ZlcnZpZXdDdHJsJ1xuICB9KVxuXG4gIC5zdGF0ZSgnbG9naW4nLCB7XG4gICAgdXJsOiAnL2xvZ2luJyxcbiAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy9sb2dpbi5odG1sJyxcbiAgICBjb250cm9sbGVyOiAnbG9naW5DdHJsJ1xuICB9KVxuXG4gIC5zdGF0ZSgncHJldmlldycsIHtcbiAgICB1cmw6ICcvcHJldmlldycsXG4gICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvcHJldmlldy5odG1sJyxcbiAgICBjb250cm9sbGVyOiAncHJldmlld0N0cmwnXG4gIH0pXG5cbiAgLnN0YXRlKCdlcnJvcicsIHtcbiAgICB1cmw6ICcvbG9naW5fZXJyb3InLFxuICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL2Vycm9yLmh0bWwnLFxuICAgIGNvbnRyb2xsZXI6ICdlcnJvckN0cmwnXG4gIH0pXG5cbiAgLnN0YXRlKCdtYWluJywge1xuICAgIHVybDogJy9tYWluX3NjcmVlbicsXG4gICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvbWFpbi5odG1sJyxcbiAgICBjb250cm9sbGVyOiAnbWFpbkN0cmwnXG4gIH0pXG5cbiAgLnN0YXRlKCdtZW51Jywge1xuICAgIHVybDogJy9tZW51JyxcbiAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy9tZW51Lmh0bWwnLFxuICAgIGNvbnRyb2xsZXI6ICdtZW51Q3RybCdcbiAgfSlcblxuICAuc3RhdGUoJ3dlZWtseUZvcmVjYXN0Jywge1xuICAgIHVybDogJy93ZWVrbHknLFxuICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL3dlZWtseUZvcmVjYXN0Lmh0bWwnLFxuICAgIGNvbnRyb2xsZXI6ICd3ZWVrbHlGb3JlY2FzdEN0cmwnXG4gIH0pXG5cbiAgLnN0YXRlKCdob3VybHlGb3JlY2FzdCcsIHtcbiAgICB1cmw6ICcvaG91cmx5JyxcbiAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy9ob3VybHlGb3JlY2FzdC5odG1sJyxcbiAgICBjb250cm9sbGVyOiAnaG91cmx5Rm9yZWNhc3RDdHJsJ1xuICB9KVxuXG4gIC5zdGF0ZSgnbWFwJywge1xuICAgIHVybDogJy9tYXAnLFxuICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL21hcC5odG1sJyxcbiAgICBjb250cm9sbGVyOiAnbWFwQ3RybCdcbiAgfSlcblxuICAuc3RhdGUoJ2FkZEVtb2ppcycsIHtcbiAgICB1cmw6ICcvYWRkX2Vtb2ppcycsXG4gICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvYWRkRW1vamlzLmh0bWwnLFxuICAgIGNvbnRyb2xsZXI6ICdhZGRFbW9qaXNDdHJsJ1xuICB9KVxuXG4gIC5zdGF0ZSgnc2VhcmNoJywge1xuICAgIHVybDogJy9zZWFyY2gnLFxuICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL3NlYXJjaC5odG1sJyxcbiAgICBjb250cm9sbGVyOiAnc2VhcmNoQ3RybCdcbiAgfSlcblxuICAuc3RhdGUoJ2JhY2tncm91bmRTZWxlY3Rpb24nLCB7XG4gICAgdXJsOiAnL3BhZ2UxMicsXG4gICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvYmFja2dyb3VuZFNlbGVjdGlvbi5odG1sJyxcbiAgICBjb250cm9sbGVyOiAnYmFja2dyb3VuZFNlbGVjdGlvbkN0cmwnXG4gIH0pXG5cbiR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoJy9vdmVydmlldycpXG5cbiAgXG5cbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuXG4gICBcbi5jb250cm9sbGVyKCdhZGRFbW9qaXNDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkc3RhdGUsIEJhY2tncm91bmQpIHtcblx0QmFja2dyb3VuZC5zZXR1cCgkc2NvcGUsICRzdGF0ZSk7XG5cbn0pIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG5cbiAgIFxuLmNvbnRyb2xsZXIoJ2JhY2tncm91bmRTZWxlY3Rpb25DdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkc3RhdGUsIEJhY2tncm91bmQpIHtcblx0dmFyIGJhY2tncm91bmRTZXR0aW5ncyA9IEJhY2tncm91bmQuc2V0dXAoJHNjb3BlLCAkc3RhdGUpO1xuXHQkc2NvcGUuYmFja2dyb3VuZHMgPSBCYWNrZ3JvdW5kLmxpc3QoKTtcblx0JHNjb3BlLnNlbGVjdCA9IGZ1bmN0aW9uKGl0ZW0pIHtcblx0XHRiYWNrZ3JvdW5kU2V0dGluZ3Muc2V0KGl0ZW0pO1xuXHR9XG5cdCRzY29wZS5pc1NlbGVjdGVkID0gZnVuY3Rpb24oIGl0ZW0gKSB7XG5cdFx0cmV0dXJuIEJhY2tncm91bmQuaXNTZWxlY3RlZChpdGVtKT8gXCJiYWNrZ3JvdW5kLXNlbGVjdGVkXCI6IFwiXCI7XG5cdH1cblxufSlcbiAiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcblxuICAgXG4uY29udHJvbGxlcignZXJyb3JDdHJsJywgZnVuY3Rpb24oJHNjb3BlKSB7XG5cbn0pXG4gICAiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcblxuLmNvbnRyb2xsZXIoJ2hvdXJseUZvcmVjYXN0Q3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgJHN0YXRlLCBCYWNrZ3JvdW5kLCBXZWF0aGVyLCBVc2VyRGF0YSkge1xuXHRCYWNrZ3JvdW5kLnNldHVwKCRzY29wZSwgJHN0YXRlKTtcblx0dmFyIHVzZXIgPSBVc2VyRGF0YSgpO1xuXHRXZWF0aGVyKHVzZXIubG9jYXRpb24sICdob3VybHknKS50aGVuKHN1Y2Nlc3MsIGVycm9yKTtcblx0JHNjb3BlLm1vbWVudCA9IG1vbWVudDtcblx0ZnVuY3Rpb24gc3VjY2VzcyhyZXNwb25zZSkge1xuXHRcdCRzY29wZS5ob3VybHlGb3JlY2FzdCA9IHJlc3BvbnNlO1xuXHR9IFxuXHRmdW5jdGlvbiBlcnJvcihlKSB7XG5cblx0fVxuXG59KVxuICAgIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4gIFxuICBcbi5jb250cm9sbGVyKCdsb2dpbkN0cmwnLCBmdW5jdGlvbigkc2NvcGUsICRzdGF0ZSwgQmFja2dyb3VuZCwgVXNlckRhdGEsIExvY2F0aW9uKSB7XG5cdEJhY2tncm91bmQuc2V0dXAoJHNjb3BlLCAkc3RhdGUpO1xuXHQkc2NvcGUudXNlciA9IHtcblx0XHRuYW1lOiBcIm5pa1wiLFxuXG5cdFx0bG9jYXRpb246IHtcblx0XHRcdHN0YXRlOiBcInNpYmVyaWFcIixcblx0XHRcdGNvdW50cnk6IFwicnVzc2lhXCIsXG5cdFx0XHRjaXR5OiBcIm9tc2tcIlxuXHRcdH1cblx0fVxuXHQkc2NvcGUuc3VibWl0ID0gZnVuY3Rpb24oKSB7XG5cdFx0VXNlckRhdGEoJHNjb3BlLnVzZXIpO1xuXHRcdExvY2F0aW9uKCRzY29wZS51c2VyLmxvY2F0aW9uKTtcblx0fVxufSkiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbiAgXG4uY29udHJvbGxlcignbWFpbkN0cmwnLCBmdW5jdGlvbigkc2NvcGUsICRzdGF0ZSwgQmFja2dyb3VuZCwgJHN0YXRlUGFyYW1zLCBVc2VyRGF0YSwgV2VhdGhlciwgTG9jYXRpb24sICRpb25pY1BvcHVwKSB7XG5cdEJhY2tncm91bmQuc2V0dXAoJHNjb3BlLCAkc3RhdGUpO1xuXG5cdCRzY29wZS4kb24oXCIkc3RhdGVDaGFuZ2VTdWNjZXNzXCIsIGZ1bmN0aW9uKGV2ZW50LCB0b1N0YXRlLCB0b1BhcmFtcywgZnJvbVN0YXRlLCBmcm9tUGFyYW1zKSB7XG5cdCAgICBpZiAodG9TdGF0ZS5uYW1lID09PSBcIm1haW5cIikgeyBcblx0ICAgIFx0dXBkYXRlKCk7XG5cdCAgICB9XG5cdH0pO1xuXHRcblx0ZnVuY3Rpb24gdXBkYXRlKCkge1xuXHRcdCRzY29wZS5tb21lbnQgPSBtb21lbnQ7IFxuXHRcdHZhciB1c2VyID0gVXNlckRhdGEoKTtcblx0XHQkc2NvcGUudXNlcm5hbWUgPSB1c2VyLm5hbWU7XG5cdFx0JHNjb3BlLmxvY2F0aW9uID0gTG9jYXRpb24oKTtcblx0XHR2YXIgdGltZSA9IHNldEludGVydmFsKGZ1bmN0aW9uKCl7XG5cdFx0XHQkc2NvcGUuZGF0ZSA9IG5ldyBEYXRlKCk7XG5cdFx0XHQkc2NvcGUuJGFwcGx5KCk7XG5cdFx0fSwgMTAwMCk7XG5cdFx0V2VhdGhlcigkc2NvcGUubG9jYXRpb24sIFwiaG91cmx5XCIpLnRoZW4oc3VjY2VzcywgZXJyb3IpO1xuXG5cdFx0ZnVuY3Rpb24gc3VjY2VzcyhyZXNwb3NlKSB7XG5cdFx0XHQkc2NvcGUuaG91cmx5Rm9yZWNhc3QgPSByZXNwb3NlO1xuXHRcdH1cblxuXHRcdGZ1bmN0aW9uIGVycm9yKGUpIHtcblx0XHRcdCRpb25pY1BvcHVwLmFsZXJ0KHt0aXRsZTogXCJXYXJuaW5nXCIsIHRlbXBsYXRlOiBlfSlcblx0XHR9XG5cdH1cblxuXG59KSIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuXG4gICBcbi5jb250cm9sbGVyKCdtZW51Q3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgJHN0YXRlLCBCYWNrZ3JvdW5kKSB7XG5cdEJhY2tncm91bmQuc2V0dXAoJHNjb3BlLCAkc3RhdGUpO1xufSlcbiAgICIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuICBcbi5jb250cm9sbGVyKCdvdmVydmlld0N0cmwnLCBmdW5jdGlvbigkc2NvcGUsICRzdGF0ZSwgQmFja2dyb3VuZCwgVXNlckRhdGEpIHtcblx0QmFja2dyb3VuZC5zZXR1cCgkc2NvcGUsICRzdGF0ZSk7XG5cdGlmKFVzZXJEYXRhKCkpIHtcblx0XHQkc3RhdGUuZ28oJ21haW4nKTtcblx0fVxufSkiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcblxuICAgXG4uY29udHJvbGxlcigncHJldmlld0N0cmwnLCBmdW5jdGlvbigkc2NvcGUsICRzdGF0ZSwgQmFja2dyb3VuZCwgVXNlckRhdGEpIHtcblx0QmFja2dyb3VuZC5zZXR1cCgkc2NvcGUsICRzdGF0ZSk7XG5cdCRzY29wZS51c2VyID0gVXNlckRhdGEoKTtcblx0JHNjb3BlLnN1Ym1pdCA9IGZ1bmN0aW9uKCkge1xuXHRcdCRzdGF0ZS5nbygnbWFpbicpO1xuXHR9XG59KSIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuXG4gICBcbi5jb250cm9sbGVyKCdzZWFyY2hDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkc3RhdGUsIEJhY2tncm91bmQsIExvY2F0aW9uKSB7XG5cdEJhY2tncm91bmQuc2V0dXAoJHNjb3BlLCAkc3RhdGUpO1xuXHQkc2NvcGUubG9jYXRpb24gPSB7XG5cdFx0c3RhdGU6IFwiXCIsXG5cdFx0Y291bnRyeTogXCJcIixcblx0XHRjaXR5OiBcIlwiXG5cdH1cblx0JHNjb3BlLnN1Ym1pdCA9IGZ1bmN0aW9uKCkge1xuXHRcdExvY2F0aW9uKCRzY29wZS5sb2NhdGlvbik7XG5cdH1cbn0pIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG5cbi5jb250cm9sbGVyKCd3ZWVrbHlGb3JlY2FzdEN0cmwnLCBmdW5jdGlvbigkc2NvcGUsICRzdGF0ZSwgQmFja2dyb3VuZCwgV2VhdGhlciwgVXNlckRhdGEpIHtcblx0QmFja2dyb3VuZC5zZXR1cCgkc2NvcGUsICRzdGF0ZSk7XG5cdHZhciB1c2VyID0gVXNlckRhdGEoKTtcblx0V2VhdGhlcih1c2VyLmxvY2F0aW9uLCAnaG91cmx5MTBkYXknKS50aGVuKHN1Y2Nlc3MsIGVycm9yKTtcblx0JHNjb3BlLm1vbWVudCA9IG1vbWVudDtcblxuXHRmdW5jdGlvbiBzdWNjZXNzKHJlc3BvbnNlKSB7XG5cdFx0JHNjb3BlLmZvcmVjYXN0ID0gc29ydEJ5RGF5cyhyZXNwb25zZSk7XG5cblx0XHRmdW5jdGlvbiBzb3J0QnlEYXlzKGxpc3QpIHtcblx0XHRcdHZhciBkYXlzID0ge307XG5cdFx0XHR2YXIgY3VycmVudEtleTtcblx0XHRcdGZvcih2YXIgaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdHZhciBpdGVtID0gbGlzdFtpXTtcblx0XHRcdFx0dmFyIGtleSA9IGdldEtleUZvcihpdGVtKTtcblx0XHRcdFx0ZGF5c1trZXldID0gZGF5c1trZXldIHx8IFtdO1xuXG5cdFx0XHRcdGRheXNba2V5XS5wdXNoKGl0ZW0pO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIGRheXM7XG5cblx0XHRcdGZ1bmN0aW9uIGdldEtleUZvciggaXRlbSApIHtcblx0XHRcdFx0cmV0dXJuIG1vbWVudChpdGVtLmRhdGUpLmZvcm1hdChcImRkZFwiKTtcdFx0XHRcdFxuXHRcdFx0fVxuXHRcdH1cblx0fSBcblx0ZnVuY3Rpb24gZXJyb3IoZSkge1xuXG5cdH1cblxufSkiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcblxuICAgXG4uY29udHJvbGxlcignbWFwQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgJHN0YXRlLCBNYXApIHtcblx0TWFwKCdtYXAtY2FudmFzJyk7XG59KSIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuXG4uc2VydmljZSgnQmFja2dyb3VuZCcsIGZ1bmN0aW9uKCkge1xuXHR2YXIgX2JhY2tncm91bmRzO1xuXHR2YXIgX2JhY2tncm91bmQ7XG5cdGxvYWQoKTtcblxuXHRyZXR1cm4ge1xuXHRcdHNldHVwOiBzZXR1cCxcblx0XHRsaXN0OiBsaXN0LFxuXHRcdGlzU2VsZWN0ZWQ6IGlzU2VsZWN0ZWRcblx0fSBcblxuXHRmdW5jdGlvbiBzZXR1cChzY29wZSwgc3RhdGUpIHtcblx0XHRzY29wZS5iYWNrZ3JvdW5kID0gX2JhY2tncm91bmQ7XG5cdFx0c2NvcGUuJG9uKFwiJHN0YXRlQ2hhbmdlU3VjY2Vzc1wiLCBmdW5jdGlvbihldmVudCwgdG9TdGF0ZSwgdG9QYXJhbXMsIGZyb21TdGF0ZSwgZnJvbVBhcmFtcykge1xuXHRcdCAgICBpZiAodG9TdGF0ZS5uYW1lID09PSBzdGF0ZS5jdXJyZW50Lm5hbWUgJiYgX2JhY2tncm91bmQgIT09IHNjb3BlLmJhY2tncm91bmQpIHsgXG5cdFx0ICAgIFx0c2NvcGUuYmFja2dyb3VuZCA9IF9iYWNrZ3JvdW5kO1xuXHRcdCAgICB9XG5cdCAgXHR9KTtcblx0ICBcdHJldHVybiB7XG5cdCAgXHRcdHNldDogc2V0XG5cdCAgXHR9XG5cdCAgXHRmdW5jdGlvbiBzZXQoIGJhY2tncm91bmQgKSB7XG5cdCAgXHRcdF9iYWNrZ3JvdW5kID0gYmFja2dyb3VuZDtcblx0ICBcdFx0c2NvcGUuYmFja2dyb3VuZCA9IF9iYWNrZ3JvdW5kO1xuXHQgIFx0fVxuXHR9XG5cdGZ1bmN0aW9uIGxpc3QoKSB7XG5cdFx0cmV0dXJuIF9iYWNrZ3JvdW5kcztcblx0fVxuXHRmdW5jdGlvbiBsb2FkKHN1Y2Nlc3MsIGVycm9yKSB7XG5cdFx0bG9hZFVzZXJCYWNrcm91bmRzKCk7XG5cdFx0bG9hZEFwcEJhY2tncm91bmRzKHN1Y2Nlc3MsIGVycm9yKTtcblx0XHRfYmFja2dyb3VuZCA9IGxvY2FsU3RvcmFnZS51c2VyQmFja2dyb3VuZCB8fCBfYmFja2dyb3VuZHMgWzBdO1xuXHR9XG5cdGZ1bmN0aW9uIGxvYWRVc2VyQmFja3JvdW5kcygpIHtcblx0XHR2YXIgYmFja2dyb3VuZHMgPSBsb2NhbFN0b3JhZ2UuYmFja2dyb3VuZHM7XG5cdFx0aWYoIWJhY2tncm91bmRzKSByZXR1cm47XG5cdFx0YmFja2dyb3VuZHMgPSBiYWNrZ3JvdW5kcy5zcGxpdCgnICcpO1xuXHRcdF9iYWNrZ3JvdW5kcy5jb25jYXQoYmFja2dyb3VuZHMpO1xuXHR9XG5cdGZ1bmN0aW9uIGxvYWRBcHBCYWNrZ3JvdW5kcyhzdWNjZXNzLCBlcnJvcikge1xuXHRcdHJlcXVlc3Qoc3VjY2VzcywgZXJyb3IpO1xuXHRcdGZ1bmN0aW9uIHJlcXVlc3QoIHN1Y2Nlc3MsIGVycm9yKSB7XG5cdFx0XHR2YXIgaTEgPSBcImh0dHA6Ly93YWxscGFwZXJzY3JhZnQucnUvaW1hZ2UvcHJpcm9kYV9nb3J5X25lYm9fb3plcm9fb2JsYWthXzgxMTUwXzE5MjB4MTA4MC5qcGdcIjtcblx0XHRcdHZhciBpMiA9IFwiaHR0cHM6Ly9lbmNyeXB0ZWQtdGJuMC5nc3RhdGljLmNvbS9pbWFnZXM/cT10Ym46QU5kOUdjUUV5SXFobnFRZ1hMb0xfSG83Ni1yWFF2QjVjS0lfZ3lFSFBnR1lncDhuUUM2T0NHcWxcIjtcblx0XHRcdHZhciBpMyA9IFwiaHR0cHM6Ly9lbmNyeXB0ZWQtdGJuMy5nc3RhdGljLmNvbS9pbWFnZXM/cT10Ym46QU5kOUdjUlg2SjBCUW9YcVlQQW9aTmgybHE4NTVqYjdEY1BiMm9LNmdNZ0szbGdUbWdqOGpzSExcIjtcblx0XHRcdHZhciBpNCA9IFwiaHR0cHM6Ly9lbmNyeXB0ZWQtdGJuMi5nc3RhdGljLmNvbS9pbWFnZXM/cT10Ym46QU5kOUdjU3pndDJIWFo2ZzNqbkpvVWV6Y3hxb2I4eExRbUR5VWxORzNDRElDZWVRN3RkMDZhNGFcIjtcblx0XHRcdFxuXHRcdFx0dmFyIGJhY2tncm91bmRzID0gIFtpMSwgaTIsIGkzLCBpNF07XG5cdFx0XHR1c2VSZXNwb25zZShiYWNrZ3JvdW5kcyk7XG5cdFx0fVx0XHRcblxuXG5cdFx0ZnVuY3Rpb24gdXNlUmVzcG9uc2UoYmFja2dyb3VuZHMpIHtcblx0XHRcdF9iYWNrZ3JvdW5kcyA9IF9iYWNrZ3JvdW5kcyB8fCBbXTtcblx0XHRcdF9iYWNrZ3JvdW5kcyA9IF9iYWNrZ3JvdW5kcy5jb25jYXQoYmFja2dyb3VuZHMpO1xuXHRcdH1cblx0XHRmdW5jdGlvbiB1c2VFcnJvcigpIHtcblxuXHRcdH1cblx0fVxuXHRmdW5jdGlvbiBpc1NlbGVjdGVkIChpdGVtKSB7XG5cdFx0cmV0dXJuIF9iYWNrZ3JvdW5kID09PSBpdGVtO1xuXHR9XG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcblxuLnNlcnZpY2UoJ0xvY2F0aW9uJywgZnVuY3Rpb24oVXNlckRhdGEpIHtcblx0dmFyIGxvY2F0aW9uO1xuXHR2YXIgdXNlciA9IFVzZXJEYXRhKCk7XG5cdGlmKHVzZXIpIHtcblx0XHRsb2NhdGlvbiA9IHVzZXIubG9jYXRpb247XG5cdH1cblx0cmV0dXJuIGZ1bmN0aW9uKGRhdGEpIHtcblx0XHRpZiAoZGF0YSkge1xuXHRcdFx0bG9jYXRpb24gPSBkYXRhXG5cdFx0fSBlbHNlIHtcblx0XHRcdHJldHVybiBsb2NhdGlvbjtcblx0XHR9XG5cdH1cbn0pICIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLnNlcnZpY2UoJ01hcCcsIGZ1bmN0aW9uKCRodHRwLCBjb25maWcsIExvY2F0aW9uLCAkY29yZG92YUdlb2xvY2F0aW9uKSB7XG5cdHJldHVybiBmdW5jdGlvbihjYW52YXMpIHtcdFx0XG5cblx0XHRcblx0ICBcdCRjb3Jkb3ZhR2VvbG9jYXRpb24uZ2V0Q3VycmVudFBvc2l0aW9uKCkudGhlbihpbml0aWFsaXplKTtcblxuXHQgIFx0ZnVuY3Rpb24gaW5pdGlhbGl6ZShwb3NpdGlvbikge1xuXHRcdCAgXHR2YXIgbWFwO1xuXHRcdCAgXHR2YXIgZ2VvSlNPTjtcblx0XHQgIFx0dmFyIHJlcXVlc3Q7XG5cdFx0ICBcdHZhciBnZXR0aW5nRGF0YSA9IGZhbHNlO1xuXHRcdCAgXHR2YXIgb3BlbldlYXRoZXJNYXBLZXkgPSBjb25maWcub3BlbldlYXRoZXJBcGlLZXk7XG5cblx0XHQgICAgdmFyIG1hcE9wdGlvbnMgPSB7XG5cdFx0ICAgICAgem9vbTogNCxcblx0XHQgICAgICBjZW50ZXI6IG5ldyBnb29nbGUubWFwcy5MYXRMbmcocG9zaXRpb24uY29vcmRzLmxhdGl0dWRlLCBwb3NpdGlvbi5jb29yZHMubG9uZ2l0dWRlKVxuXHRcdCAgICB9O1xuXHRcdCAgICBjYW52YXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChjYW52YXMpO1xuXHRcdCAgICBtYXAgPSBuZXcgZ29vZ2xlLm1hcHMuTWFwKGNhbnZhcywgIG1hcE9wdGlvbnMpO1xuXG5cdFx0ICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcCwgJ2lkbGUnLCBjaGVja0lmRGF0YVJlcXVlc3RlZCk7XG5cblx0XHQgICAgZnVuY3Rpb24gY2hlY2tJZkRhdGFSZXF1ZXN0ZWQoKSB7XG5cdFx0XHRcdHdoaWxlIChnZXR0aW5nRGF0YSA9PT0gdHJ1ZSkge1xuICAgICAgXHRcdFx0XHRnZXR0aW5nRGF0YSA9IGZhbHNlO1xuICAgIFx0XHRcdH1cbiAgICBcdFx0XHRnZXRDb29yZHMoKTtcbiAgXHRcdFx0fTtcblxuICBcdFx0XHRmdW5jdGlvbiBnZXRDb29yZHMoKSB7XG5cdFx0XHQgICAgdmFyIGJvdW5kcyA9IG1hcC5nZXRCb3VuZHMoKTtcblx0XHRcdCAgICB2YXIgTkUgPSBib3VuZHMuZ2V0Tm9ydGhFYXN0KCk7XG5cdFx0XHQgICAgdmFyIFNXID0gYm91bmRzLmdldFNvdXRoV2VzdCgpO1xuXHRcdFx0ICAgIGdldFdlYXRoZXIoTkUubGF0KCksIE5FLmxuZygpLCBTVy5sYXQoKSwgU1cubG5nKCkpO1xuICBcdFx0XHR9O1xuXG4gIFx0XHRcdGZ1bmN0aW9uIGdldFdlYXRoZXIobm9ydGhMYXQsIGVhc3RMbmcsIHNvdXRoTGF0LCB3ZXN0TG5nKSB7XG5cdFx0XHQgICAgZ2V0dGluZ0RhdGEgPSB0cnVlO1xuXHRcdFx0ICAgIHZhciByZXF1ZXN0U3RyaW5nID0gXCJodHRwOi8vYXBpLm9wZW53ZWF0aGVybWFwLm9yZy9kYXRhLzIuNS9ib3gvY2l0eT9iYm94PVwiXG5cdFx0XHQgICAgICAgICAgICAgICAgICAgICAgICArIHdlc3RMbmcgKyBcIixcIiArIG5vcnRoTGF0ICsgXCIsXCIgLy9sZWZ0IHRvcFxuXHRcdFx0ICAgICAgICAgICAgICAgICAgICAgICAgKyBlYXN0TG5nICsgXCIsXCIgKyBzb3V0aExhdCArIFwiLFwiIC8vcmlnaHQgYm90dG9tXG5cdFx0XHQgICAgICAgICAgICAgICAgICAgICAgICArIG1hcC5nZXRab29tKClcblx0XHRcdCAgICAgICAgICAgICAgICAgICAgICAgICsgXCImY2x1c3Rlcj15ZXMmZm9ybWF0PWpzb25cIlxuXHRcdFx0ICAgICAgICAgICAgICAgICAgICAgICAgKyBcIiZBUFBJRD1cIiArIG9wZW5XZWF0aGVyTWFwS2V5O1xuXG5cdFx0XHQgICAgJGh0dHAuZ2V0KHJlcXVlc3RTdHJpbmcpLnRoZW4oc3VjY2VzcywgZXJyb3IpO1xuXG5cdFx0XHQgICAgZnVuY3Rpb24gc3VjY2VzcyhyZXNwb25zZSkge1xuXHRcdFx0ICAgIFx0dmFyIHJlc3VsdHMgPSByZXNwb25zZS5kYXRhO1xuXHRcdFx0XHQgICAgXG5cdFx0XHRcdCAgICBpZiAocmVzdWx0cy5saXN0Lmxlbmd0aCA+IDApIHtcblx0XHRcdFx0ICAgICAgICByZXNldERhdGEoKTtcblx0XHRcdFx0ICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJlc3VsdHMubGlzdC5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHQgICAgICAgICAgZ2VvSlNPTi5mZWF0dXJlcy5wdXNoKGpzb25Ub0dlb0pzb24ocmVzdWx0cy5saXN0W2ldKSk7XG5cdFx0XHRcdCAgICAgICAgfVxuXG5cdFx0XHRcdCAgICAgICAgZHJhd0ljb25zKGdlb0pTT04pO1xuXHRcdFx0XHQgICAgfVxuXG5cdFx0XHQgICAgfVxuXG5cdFx0XHQgICAgZnVuY3Rpb24gZXJyb3IoKSB7XG5cblx0XHRcdCAgICB9XG4gIFx0XHRcdH07XG5cbiAgXHRcdFx0ZnVuY3Rpb24ganNvblRvR2VvSnNvbih3ZWF0aGVySXRlbSkge1xuXHRcdFx0ICAgIHZhciBmZWF0dXJlID0ge1xuXHRcdFx0ICAgICAgdHlwZTogXCJGZWF0dXJlXCIsXG5cdFx0XHQgICAgICBwcm9wZXJ0aWVzOiB7XG5cdFx0XHQgICAgICAgIGNpdHk6IHdlYXRoZXJJdGVtLm5hbWUsXG5cdFx0XHQgICAgICAgIHdlYXRoZXI6IHdlYXRoZXJJdGVtLndlYXRoZXJbMF0ubWFpbixcblx0XHRcdCAgICAgICAgdGVtcGVyYXR1cmU6IHdlYXRoZXJJdGVtLm1haW4udGVtcCxcblx0XHRcdCAgICAgICAgbWluOiB3ZWF0aGVySXRlbS5tYWluLnRlbXBfbWluLFxuXHRcdFx0ICAgICAgICBtYXg6IHdlYXRoZXJJdGVtLm1haW4udGVtcF9tYXgsXG5cdFx0XHQgICAgICAgIGh1bWlkaXR5OiB3ZWF0aGVySXRlbS5tYWluLmh1bWlkaXR5LFxuXHRcdFx0ICAgICAgICBwcmVzc3VyZTogd2VhdGhlckl0ZW0ubWFpbi5wcmVzc3VyZSxcblx0XHRcdCAgICAgICAgd2luZFNwZWVkOiB3ZWF0aGVySXRlbS53aW5kLnNwZWVkLFxuXHRcdFx0ICAgICAgICB3aW5kRGVncmVlczogd2VhdGhlckl0ZW0ud2luZC5kZWcsXG5cdFx0XHQgICAgICAgIHdpbmRHdXN0OiB3ZWF0aGVySXRlbS53aW5kLmd1c3QsXG5cdFx0XHQgICAgICAgIGljb246IFwiaHR0cDovL29wZW53ZWF0aGVybWFwLm9yZy9pbWcvdy9cIlxuXHRcdFx0ICAgICAgICAgICAgICArIHdlYXRoZXJJdGVtLndlYXRoZXJbMF0uaWNvbiAgKyBcIi5wbmdcIixcblx0XHRcdCAgICAgICAgY29vcmRpbmF0ZXM6IFt3ZWF0aGVySXRlbS5jb29yZC5sb24sIHdlYXRoZXJJdGVtLmNvb3JkLmxhdF1cblx0XHRcdCAgICAgIH0sXG5cdFx0XHQgICAgICBnZW9tZXRyeToge1xuXHRcdFx0ICAgICAgICB0eXBlOiBcIlBvaW50XCIsXG5cdFx0XHQgICAgICAgIGNvb3JkaW5hdGVzOiBbd2VhdGhlckl0ZW0uY29vcmQubG9uLCB3ZWF0aGVySXRlbS5jb29yZC5sYXRdXG5cdFx0XHQgICAgICB9XG5cdFx0XHQgICAgfTtcblx0XHRcdCAgICAvLyBTZXQgdGhlIGN1c3RvbSBtYXJrZXIgaWNvblxuXHRcdFx0ICAgIG1hcC5kYXRhLnNldFN0eWxlKGZ1bmN0aW9uKGZlYXR1cmUpIHtcblx0XHRcdCAgICAgIHJldHVybiB7XG5cdFx0XHQgICAgICAgIGljb246IHtcblx0XHRcdCAgICAgICAgICB1cmw6IGZlYXR1cmUuZ2V0UHJvcGVydHkoJ2ljb24nKSxcblx0XHRcdCAgICAgICAgICBhbmNob3I6IG5ldyBnb29nbGUubWFwcy5Qb2ludCgyNSwgMjUpXG5cdFx0XHQgICAgICAgIH1cblx0XHRcdCAgICAgIH07XG5cdFx0XHQgICAgfSk7XG5cblx0XHRcdCAgICAvLyByZXR1cm5zIG9iamVjdFxuXHRcdFx0ICAgIHJldHVybiBmZWF0dXJlO1xuXHRcdFx0fVxuXG5cdFx0XHRmdW5jdGlvbiBkcmF3SWNvbnMod2VhdGhlcikge1xuXHRcdCAgICBcdG1hcC5kYXRhLmFkZEdlb0pzb24oZ2VvSlNPTik7XG5cdFx0ICAgICAvLyBTZXQgdGhlIGZsYWcgdG8gZmluaXNoZWRcblx0XHQgICAgIFx0Z2V0dGluZ0RhdGEgPSBmYWxzZTtcblx0XHQgIFx0fTtcbiAgLy8gQ2xlYXIgZGF0YSBsYXllciBhbmQgZ2VvSlNPTlxuICBcdFx0XHRmdW5jdGlvbiByZXNldERhdGEoKSB7XG5cdFx0XHQgICAgZ2VvSlNPTiA9IHtcblx0XHRcdCAgICAgIHR5cGU6IFwiRmVhdHVyZUNvbGxlY3Rpb25cIixcblx0XHRcdCAgICAgIGZlYXR1cmVzOiBbXVxuXHRcdFx0ICAgIH07XG5cdFx0XHQgICAgbWFwLmRhdGEuZm9yRWFjaChmdW5jdGlvbihmZWF0dXJlKSB7XG5cdFx0XHQgICAgICBtYXAuZGF0YS5yZW1vdmUoZmVhdHVyZSk7XG4gICAgXHRcdFx0fSk7XG4gIFx0XHRcdH07XG5cblx0XHR9XG5cdH1cbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuXG4uc2VydmljZSgnVXNlckRhdGEnLCBmdW5jdGlvbigpIHtcblx0dmFyIHVzZXI7XG5cdHJldHVybiBmdW5jdGlvbihkYXRhKSB7XG5cdFx0aWYoZGF0YSkge1xuXHRcdFx0c2V0RGF0YShkYXRhKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dXNlciA9IGdldERhdGEoKTtcblx0XHRcdHJldHVybiB1c2VyO1xuXHRcdH1cblx0fVxuXG5cdGZ1bmN0aW9uIGdldERhdGEoKSB7XG5cdFx0aWYoIXVzZXIpIHtcblx0XHRcdHZhciB1c2VySW5mbyA9IGxvY2FsU3RvcmFnZS5ld191c2VyO1xuXHRcdFx0Y29uc29sZS5sb2codXNlckluZm8pO1xuXHRcdFx0aWYodXNlckluZm8pIHtcblx0XHRcdFx0dXNlciA9IEpTT04ucGFyc2UodXNlckluZm8pO1xuXHRcdFx0fSBcblx0XHR9XG5cdFx0cmV0dXJuIHVzZXI7XG5cdH1cblx0ZnVuY3Rpb24gc2V0RGF0YShkYXRhKSB7XG5cdFx0dXNlciA9IGRhdGE7XG5cdFx0bG9jYWxTdG9yYWdlLmV3X3VzZXIgPSBKU09OLnN0cmluZ2lmeSh1c2VyKTtcblx0fVxufSkiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5zZXJ2aWNlKCdXZWF0aGVyJywgZnVuY3Rpb24oJGh0dHAsIGNvbmZpZykge1xuXHRmdW5jdGlvbiB3ZWF0aGVyKGxvY2F0aW9uLCBxdWVyeSkge1xuXHRcdHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblx0XHRcdHZhciB1cmwgPSBnZXRVUkwoKTtcblx0XHRcdCRodHRwLmdldCh1cmwpLnRoZW4odXNlUmVzcG9uc2UsIHVzZUVycm9yKTtcblxuXHRcdFx0ZnVuY3Rpb24gZ2V0VVJMKCkge1xuXHRcdFx0XHR2YXIgcXVlcnlTdHJpbmcgPSBnZXRRdWVyeVN0cmluZygpO1xuXHRcdFx0XHR2YXIgdXJsID0gXCJodHRwOi8vYXBpLnd1bmRlcmdyb3VuZC5jb20vYXBpL1wiK2NvbmZpZy53dW5kZXJncm91bmRBcGlLZXkrcXVlcnlTdHJpbmc7XG5cdFx0ICAgIFx0cmV0dXJuIHVybDtcblxuXHRcdCAgICBcdGZ1bmN0aW9uIGdldFF1ZXJ5U3RyaW5nKCkge1xuXHRcdCAgICBcdFx0dmFyIHJlc3VsdCA9IFwiL1wiK3F1ZXJ5K1wiL3FcIjtcblx0XHQgICAgXHRcdHZhciBmaWVsZHMgPSBbXCJjb3VudHJ5XCIsIFwic3RhdGVcIiwgXCJjaXR5XCJdO1xuXG5cdFx0ICAgIFx0XHRmb3IodmFyIGkgPSAwOyBpIDwgZmllbGRzLmxlbmd0aDsgaSsrKSB7XG5cdFx0ICAgIFx0XHRcdHZhciBmaWVsZCA9IGZpZWxkc1tpXTtcblx0XHQgICAgXHRcdFx0aWYobG9jYXRpb25bZmllbGRdICYmIGxvY2F0aW9uW2ZpZWxkXS5sZW5ndGggPiAwKSB7XG5cdFx0ICAgIFx0XHRcdFx0cmVzdWx0Kz0gXCIvXCIrbG9jYXRpb25bZmllbGRdO1xuXHRcdCAgICBcdFx0XHR9XG5cdFx0ICAgIFx0XHR9XG5cdFx0ICAgIFx0XHRyZXR1cm4gcmVzdWx0ICsgXCIuanNvblwiO1xuXHRcdCAgICBcdH1cblx0XHRcdH1cblxuXHRcdFx0ZnVuY3Rpb24gdXNlUmVzcG9uc2UocmVzcG9uc2UpIHtcblx0XHRcdFx0dmFyIHJlc3VsdCA9IFtdO1xuXHRcdFx0XHR2YXIgaXRlbXMgPSByZXNwb25zZS5kYXRhLmhvdXJseV9mb3JlY2FzdDtcblx0XHRcdFx0aWYoIWl0ZW1zKSB7XG5cdFx0XHRcdFx0dXNlRXJyb3IocmVzcG9uc2UuZGF0YS5yZXNwb25zZSk7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGZvcih2YXIgaSA9IDA7IGk8IGl0ZW1zLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0dmFyIGl0ZW0gPSBpdGVtc1tpXTtcblx0XHRcdFx0XHR2YXIgZm9yZWNhc3QgPSBnZXRGb3JlY2FzdCgpO1xuXHRcdFx0XHRcdHJlc3VsdC5wdXNoKGZvcmVjYXN0KTtcblx0XHRcdFx0XHRmdW5jdGlvbiBnZXRGb3JlY2FzdCgpIHtcblx0XHRcdFx0XHRcdHJldHVybiB7XG5cdFx0XHRcdFx0XHRcdGNvbmRpdGlvbjogaXRlbS5jb25kaXRpb24sXG5cdFx0XHRcdFx0XHRcdGljb246IGl0ZW0uaWNvbl91cmwsXG5cdFx0XHRcdFx0XHRcdGRhdGU6IG5ldyBEYXRlKCBpdGVtLkZDVFRJTUUuZXBvY2gqMTAwMClcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0cmVzb2x2ZShyZXN1bHQpO1xuXHRcdFx0fVxuXHRcdFx0ZnVuY3Rpb24gdXNlRXJyb3IoZSkge1xuXHRcdFx0XHRpZihlLmVycm9yKSB7XG5cdFx0XHRcdFx0cmVqZWN0KGVycm9yLmRlc2NyaXB0aW9uKVxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHJlamVjdChcIkdlbyBpbmZvIGlzIG5vdCBlbm91Z2hcIik7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdH0pO1xuXHR9XG5cdHJldHVybiB3ZWF0aGVyO1xuXHRcdFxufSkiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcblxuLnNlcnZpY2UoJ2NvbmZpZycsIGZ1bmN0aW9uKCkge1xuXHRyZXR1cm4ge1xuXHRcdG9wZW5XZWF0aGVyQXBpS2V5OiBcIjdkNzgxNWNkNTcyMWI3NzhjNzlkOTdkZmY5MmVhNTMzXCIsXG5cdFx0d3VuZGVyZ3JvdW5kQXBpS2V5OiBcImE3ZjNlNDRlOWRmZDQwMzZcIlxuXHR9XG59KSJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
